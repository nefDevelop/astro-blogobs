/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => AstroComposerPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian15 = require("obsidian");

// src/types.ts
var KNOWN_ARRAY_KEYS = ["tags", "aliases", "cssclasses"];
var CONSTANTS = {
  DEBOUNCE_MS: 500,
  STAT_MTIME_THRESHOLD: 1e3,
  EDITOR_STABILIZE_DELAY: 100,
  FILE_EXPLORER_REVEAL_DELAY: 200
};

// src/settings.ts
var DEFAULT_SETTINGS = {
  defaultTemplate: '---\ntitle: "{{title}}"\ndate: {{date}}\ntags: []\n---\n',
  autoInsertProperties: true,
  dateFormat: "YYYY-MM-DD",
  enableCopyHeadingLink: true,
  copyHeadingLinkFormat: "obsidian",
  addTrailingSlashToLinks: false,
  enableOpenTerminalCommand: false,
  terminalProjectRootPath: "",
  terminalApplicationName: "",
  enableTerminalDebugLogging: false,
  enableTerminalRibbonIcon: false,
  enableOpenConfigFileCommand: false,
  configFilePath: "",
  enableConfigRibbonIcon: false,
  contentTypes: [],
  migrationCompleted: false,
  helpButtonReplacement: {
    enabled: false,
    commandId: "edit-astro-config",
    iconId: "rocket"
  },
  showMdxFilesInExplorer: false,
  processBackgroundFileChanges: true,
  syncDraftDate: false,
  draftProperty: "",
  draftLogic: "true-is-draft",
  publishDateField: "",
  updateModifiedDate: false,
  modifiedDateField: ""
};

// src/commands/index.ts
var import_obsidian5 = require("obsidian");

// src/utils/file-operations.ts
var import_obsidian = require("obsidian");

// src/utils/path-matching.ts
function matchesFolderPattern(filePath, folderPattern) {
  const normalizedFilePath = filePath.toLowerCase();
  const normalizedPattern = folderPattern.toLowerCase().replace(/^\/|\/$/g, "");
  if (!normalizedPattern || normalizedPattern.trim() === "") {
    return !normalizedFilePath.includes("/") || normalizedFilePath.split("/").length === 1;
  }
  if (!normalizedPattern.includes("*")) {
    return normalizedFilePath === normalizedPattern || normalizedFilePath.startsWith(normalizedPattern + "/");
  }
  const escapedPattern = normalizedPattern.replace(/[.+?^${}()|[\]\\]/g, "\\$&").replace(/\*/g, "[^/]+");
  const regexPattern = `^${escapedPattern}(?:/|$)`;
  const regex = new RegExp(regexPattern);
  return regex.test(normalizedFilePath);
}
function getPatternDepth(folderPattern) {
  if (!folderPattern || folderPattern.trim() === "") return 0;
  return folderPattern.split("/").length;
}
function sortByPatternSpecificity(types) {
  return [...types].sort((a, b) => {
    const depthA = getPatternDepth(a.folder);
    const depthB = getPatternDepth(b.folder);
    return depthB - depthA;
  });
}

// src/utils/string-utils.ts
function toKebabCase(str) {
  return str.replace(/([a-z0-9])([A-Z])/g, "$1-$2").replace(/([A-Z])([A-Z][a-z])/g, "$1-$2$3").toLowerCase().replace(/[^a-z0-9\s-]/g, "").trim().replace(/\s+/g, "-").replace(/-+/g, "-").replace(/^-|-$/g, "");
}

// src/utils/file-operations.ts
var FileOperations = class {
  constructor(app, settings, plugin) {
    this.app = app;
    this.settings = settings;
    this.plugin = plugin;
  }
  // Get fresh settings from plugin if available, otherwise use stored settings
  getSettings() {
    var _a;
    if ((_a = this.plugin) == null ? void 0 : _a.settings) {
      return this.plugin.settings;
    }
    return this.settings;
  }
  generateFilename(title, enableUnderscorePrefix = false) {
    const kebabTitle = toKebabCase(title);
    const safeKebabTitle = kebabTitle || "untitled";
    const prefix = enableUnderscorePrefix ? "_" : "";
    return `${prefix}${safeKebabTitle}`;
  }
  determineType(file) {
    const filePath = file.path;
    const settings = this.getSettings();
    const contentTypes = settings.contentTypes || [];
    const sortedTypes = sortByPatternSpecificity(contentTypes);
    for (const contentType of sortedTypes) {
      if (!contentType.enabled) continue;
      if (!contentType.folder || contentType.folder.trim() === "") {
        if (!filePath.includes("/") || filePath.split("/").length === 1) {
          return contentType.id;
        }
      } else if (matchesFolderPattern(filePath, contentType.folder)) {
        if (contentType.ignoreSubfolders) {
          const pathSegments = filePath.split("/");
          const pathDepth = pathSegments.length;
          const patternSegments = contentType.folder.split("/");
          const expectedDepth = patternSegments.length;
          if (contentType.creationMode === "folder") {
            const folderDepth = pathDepth - 1;
            if (folderDepth === expectedDepth || folderDepth === expectedDepth + 1) {
              return contentType.id;
            }
          } else {
            if (pathDepth === expectedDepth) {
              return contentType.id;
            }
          }
        } else {
          return contentType.id;
        }
      }
    }
    return "note";
  }
  getContentType(typeId) {
    const settings = this.getSettings();
    const contentTypes = settings.contentTypes || [];
    return contentTypes.find((ct) => ct.id === typeId) || null;
  }
  /**
   * Helper to get content type for a given file path
   */
  getContentTypeByPath(filePath) {
    const dummyFile = { path: filePath };
    const typeId = this.determineType(dummyFile);
    if (typeId === "note") return null;
    return this.getContentType(typeId);
  }
  getTitleKey(type) {
    if (type === "note") return "title";
    const contentType = this.getContentType(type);
    if (!contentType) return "title";
    const template = contentType.template;
    const lines = template.split("\n");
    let inProperties = false;
    for (const line of lines) {
      const trimmed = line.trim();
      if (trimmed === "---") {
        inProperties = !inProperties;
        continue;
      }
      if (inProperties) {
        const match = trimmed.match(/^(\w+):\s*(.+)$/);
        if (match) {
          const key = match[1];
          const value = match[2];
          if (value.includes("{{title}}")) {
            return key;
          }
        }
      }
    }
    return "title";
  }
  async createFile(options) {
    var _a;
    const { file, title, type } = options;
    if (!title) {
      new import_obsidian.Notice(`Title is required to create a ${type}.`);
      return null;
    }
    const contentType = this.getContentType(type);
    if (!contentType && type !== "note") {
      new import_obsidian.Notice(`Content type ${type} not found.`);
      return null;
    }
    const kebabTitle = toKebabCase(title);
    const enableUnderscorePrefix = (contentType == null ? void 0 : contentType.enableUnderscorePrefix) || false;
    const prefix = enableUnderscorePrefix ? "_" : "";
    let targetFolder = "";
    if (type === "note") {
      targetFolder = "";
    } else if (contentType) {
      const originalDir = ((_a = file.parent) == null ? void 0 : _a.path) || "";
      if (originalDir === "" || originalDir === "/") {
        targetFolder = contentType.folder || "";
      } else {
        targetFolder = originalDir;
      }
    }
    if (targetFolder) {
      const folder = this.app.vault.getAbstractFileByPath(targetFolder);
      if (!(folder instanceof import_obsidian.TFolder)) {
        await this.app.vault.createFolder(targetFolder);
      }
    }
    const creationMode = (contentType == null ? void 0 : contentType.creationMode) || "file";
    if (creationMode === "folder") {
      return this.createFolderStructure(file, kebabTitle, prefix, targetFolder, type, contentType);
    } else {
      return this.createFileStructure(file, kebabTitle, prefix, targetFolder, contentType);
    }
  }
  async createFolderStructure(file, kebabTitle, prefix, targetFolder, type, contentType) {
    const folderName = `${prefix}${kebabTitle}`;
    let folderPath;
    if (targetFolder) {
      folderPath = `${targetFolder}/${folderName}`;
    } else {
      const currentDir = file.parent ? file.parent.path : "";
      if (currentDir && currentDir !== "/") {
        folderPath = `${currentDir}/${folderName}`;
      } else {
        folderPath = folderName;
      }
    }
    try {
      const folder = this.app.vault.getAbstractFileByPath(folderPath);
      if (!(folder instanceof import_obsidian.TFolder)) {
        await this.app.vault.createFolder(folderPath);
      }
    } catch (e) {
    }
    const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "index";
    const extension = (contentType == null ? void 0 : contentType.useMdxExtension) ? ".mdx" : ".md";
    const fileName = `${indexFileName}${extension}`;
    const newPath = `${folderPath}/${fileName}`;
    const existingFile = this.app.vault.getAbstractFileByPath(newPath);
    if (existingFile instanceof import_obsidian.TFile) {
      new import_obsidian.Notice(`File already exists at ${newPath}.`);
      return null;
    }
    if (this.plugin) {
      this.plugin.pluginCreatedFiles.set(newPath, Date.now());
    }
    try {
      await this.app.fileManager.renameFile(file, newPath);
      const newFile = this.app.vault.getAbstractFileByPath(newPath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        return null;
      }
      setTimeout(() => {
        const fileExplorer = this.app.workspace.getLeavesOfType("file-explorer")[0];
        if (fileExplorer && fileExplorer.view) {
          const view = fileExplorer.view;
          if (view && typeof view === "object" && "tree" in view) {
            const fileTree = view.tree;
            if (fileTree && newFile instanceof import_obsidian.TFile && typeof fileTree.revealFile === "function") {
              fileTree.revealFile(newFile);
            }
          }
        }
      }, 200);
      const leaf = this.app.workspace.getLeaf(false);
      await leaf.openFile(newFile);
      const positionCursor = () => {
        var _a;
        const view = leaf.view;
        if (view && "editor" in view) {
          const editor = view.editor;
          if (editor) {
            const content = editor.getValue();
            if (content) {
              const lines = content.split("\n");
              const lastLine = lines.length - 1;
              const lastLineLength = ((_a = lines[lastLine]) == null ? void 0 : _a.length) || 0;
              editor.setCursor({ line: lastLine, ch: lastLineLength });
              editor.focus();
              return true;
            }
          }
        }
        return false;
      };
      setTimeout(() => {
        if (!positionCursor()) {
          setTimeout(() => {
            positionCursor();
          }, 200);
        }
      }, 100);
      return newFile;
    } catch (error) {
      const errorMessage = error instanceof Error ? error.message : String(error);
      new import_obsidian.Notice(`Failed to create folder structure: ${errorMessage}.`);
      return null;
    }
  }
  async createFileStructure(file, kebabTitle, prefix, targetFolder, contentType) {
    const extension = (contentType == null ? void 0 : contentType.useMdxExtension) ? ".mdx" : ".md";
    const newName = `${prefix}${kebabTitle}${extension}`;
    let newPath;
    if (targetFolder) {
      newPath = `${targetFolder}/${newName}`;
    } else {
      const currentDir = file.parent ? file.parent.path : "";
      if (currentDir && currentDir !== "/") {
        newPath = `${currentDir}/${newName}`;
      } else {
        newPath = newName;
      }
    }
    const existingFile = this.app.vault.getAbstractFileByPath(newPath);
    if (existingFile instanceof import_obsidian.TFile && existingFile !== file) {
      new import_obsidian.Notice(`File with name "${newName}" already exists.`);
      return null;
    }
    if (this.plugin) {
      this.plugin.pluginCreatedFiles.set(newPath, Date.now());
    }
    try {
      await this.app.fileManager.renameFile(file, newPath);
      const newFile = this.app.vault.getAbstractFileByPath(newPath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      const leaf = this.app.workspace.getLeaf(false);
      await leaf.openFile(newFile);
      const positionCursor = () => {
        var _a;
        const view = leaf.view;
        if (view && "editor" in view) {
          const editor = view.editor;
          if (editor) {
            const content = editor.getValue();
            if (content) {
              const lines = content.split("\n");
              const lastLine = lines.length - 1;
              const lastLineLength = ((_a = lines[lastLine]) == null ? void 0 : _a.length) || 0;
              editor.setCursor({ line: lastLine, ch: lastLineLength });
              editor.focus();
              return true;
            }
          }
        }
        return false;
      };
      setTimeout(() => {
        if (!positionCursor()) {
          setTimeout(() => {
            positionCursor();
          }, 200);
        }
      }, 100);
      return newFile;
    } catch (error) {
      const errorMessage = error instanceof Error ? error.message : String(error);
      new import_obsidian.Notice(`Failed to rename file: ${errorMessage}.`);
      return null;
    }
  }
  async renameFile(options) {
    const { file, title, type } = options;
    if (!title) {
      new import_obsidian.Notice(`Title is required to rename the content.`);
      return null;
    }
    const contentType = this.getContentType(type);
    if (!contentType && type !== "note") {
      new import_obsidian.Notice(`Content type ${type} not found.`);
      return null;
    }
    const kebabTitle = toKebabCase(title);
    const prefix = "";
    const creationMode = (contentType == null ? void 0 : contentType.creationMode) || "file";
    if (creationMode === "folder") {
      return this.renameFolderStructure(file, kebabTitle, prefix, type, contentType);
    } else {
      return this.renameFileStructure(file, kebabTitle, prefix, contentType);
    }
  }
  async renameFolderStructure(file, kebabTitle, prefix, type, contentType) {
    const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "index";
    const isIndex = file.basename === indexFileName;
    if (isIndex) {
      if (!file.parent) {
        new import_obsidian.Notice("Cannot rename: file has no parent folder.");
        return null;
      }
      prefix = file.parent.name.startsWith("_") ? "_" : "";
      const newFolderName = `${prefix}${kebabTitle}`;
      const parentFolder = file.parent.parent;
      if (!parentFolder) {
        new import_obsidian.Notice("Cannot rename: parent folder has no parent.");
        return null;
      }
      let newFolderPath;
      if (parentFolder.path === "" || parentFolder.path === "/") {
        newFolderPath = newFolderName;
      } else {
        newFolderPath = `${parentFolder.path}/${newFolderName}`;
      }
      const existingFolder = this.app.vault.getAbstractFileByPath(newFolderPath);
      if (existingFolder instanceof import_obsidian.TFolder) {
        new import_obsidian.Notice(`Folder already exists at ${newFolderPath}.`);
        return null;
      }
      try {
        await this.app.fileManager.renameFile(file.parent, newFolderPath);
      } catch (error) {
        const errorMessage = error instanceof Error ? error.message : String(error);
        new import_obsidian.Notice(`Failed to rename folder: ${errorMessage}.`);
        return null;
      }
      const newFilePath = `${newFolderPath}/${file.name}`;
      const newFile = this.app.vault.getAbstractFileByPath(newFilePath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      return newFile;
    } else {
      if (!file.parent) {
        new import_obsidian.Notice("Cannot rename: file has no parent folder.");
        return null;
      }
      prefix = file.basename.startsWith("_") ? "_" : "";
      const extension = file.extension;
      const newName = `${prefix}${kebabTitle}.${extension}`;
      const newPath = `${file.parent.path}/${newName}`;
      const existingFile = this.app.vault.getAbstractFileByPath(newPath);
      if (existingFile instanceof import_obsidian.TFile && existingFile !== file) {
        new import_obsidian.Notice(`File already exists at ${newPath}.`);
        return null;
      }
      await this.app.fileManager.renameFile(file, newPath);
      const newFile = this.app.vault.getAbstractFileByPath(newPath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      return newFile;
    }
  }
  async renameFileStructure(file, kebabTitle, prefix, contentType) {
    if (!file.parent) {
      new import_obsidian.Notice("Cannot rename: file has no parent folder.");
      return null;
    }
    const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "";
    const isIndex = indexFileName && indexFileName.trim() !== "" && file.basename === indexFileName;
    if (isIndex) {
      prefix = file.parent.name.startsWith("_") ? "_" : "";
      const newFolderName = `${prefix}${kebabTitle}`;
      const parentFolder = file.parent.parent;
      if (!parentFolder) {
        new import_obsidian.Notice("Cannot rename: parent folder has no parent.");
        return null;
      }
      let newFolderPath;
      if (parentFolder.path === "" || parentFolder.path === "/") {
        newFolderPath = newFolderName;
      } else {
        newFolderPath = `${parentFolder.path}/${newFolderName}`;
      }
      const existingFolder = this.app.vault.getAbstractFileByPath(newFolderPath);
      if (existingFolder instanceof import_obsidian.TFolder) {
        new import_obsidian.Notice(`Folder already exists at ${newFolderPath}.`);
        return null;
      }
      const newFilePath = `${newFolderPath}/${file.name}`;
      if (this.plugin) {
        this.plugin.pluginCreatedFiles.set(newFilePath, Date.now());
      }
      try {
        await this.app.fileManager.renameFile(file.parent, newFolderPath);
      } catch (error) {
        console.error("FileOperations: Folder rename failed:", error);
        const errorMessage = error instanceof Error ? error.message : String(error);
        new import_obsidian.Notice(`Failed to rename folder: ${errorMessage}.`);
        return null;
      }
      const newFile2 = this.app.vault.getAbstractFileByPath(newFilePath);
      if (!(newFile2 instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      return newFile2;
    }
    prefix = file.basename.startsWith("_") ? "_" : "";
    const extension = file.extension;
    const newName = `${prefix}${kebabTitle}.${extension}`;
    let newPath;
    if (file.parent.path === "" || file.parent.path === "/") {
      newPath = newName;
    } else {
      newPath = `${file.parent.path}/${newName}`;
    }
    const existingFile = this.app.vault.getAbstractFileByPath(newPath);
    if (existingFile instanceof import_obsidian.TFile && existingFile !== file) {
      new import_obsidian.Notice(`File already exists at ${newPath}.`);
      return null;
    }
    if (this.plugin) {
      this.plugin.pluginCreatedFiles.set(newPath, Date.now());
    }
    try {
      await this.app.fileManager.renameFile(file, newPath);
    } catch (error) {
      console.error("FileOperations: File rename failed:", error);
      const errorMessage = error instanceof Error ? error.message : String(error);
      new import_obsidian.Notice(`Failed to rename file: ${errorMessage}.`);
      return null;
    }
    const newFile = this.app.vault.getAbstractFileByPath(newPath);
    if (!(newFile instanceof import_obsidian.TFile)) {
      new import_obsidian.Notice("Failed to locate renamed file.");
      return null;
    }
    return newFile;
  }
};

// src/utils/template-parsing.ts
var import_obsidian2 = require("obsidian");
var TemplateParser = class {
  constructor(app, settings) {
    this.app = app;
    this.settings = settings;
  }
  /**
   * Convert a string to kebab-case for slug generation
   */
  toKebabCase(str) {
    return str.toLowerCase().replace(/[^a-z0-9\s-]/g, "").trim().replace(/\s+/g, "-").replace(/-+/g, "-").replace(/^-|-$/g, "");
  }
  parseFrontmatter(content) {
    let propertiesEnd = 0;
    let propertiesText = "";
    const existingProperties = {};
    if (content.startsWith("---")) {
      propertiesEnd = content.indexOf("\n---", 3);
      if (propertiesEnd === -1) {
        propertiesEnd = content.length;
      } else {
        propertiesEnd += 4;
      }
      propertiesText = content.slice(4, propertiesEnd - 4).trim();
      try {
        let currentKey = null;
        const arrayKeys = /* @__PURE__ */ new Set();
        propertiesText.split("\n").forEach((line) => {
          const trimmedLine = line.trim();
          const match = trimmedLine.match(/^([a-zA-Z_][a-zA-Z0-9_-]*):\s*(.*)$/);
          if (match) {
            const [, key, value] = match;
            currentKey = key;
            const trimmedValue = value ? value.trim() : "";
            const bracketArrayMatch = trimmedValue.match(/^\[(.*)\]$/);
            if (bracketArrayMatch) {
              const arrayContent = bracketArrayMatch[1].trim();
              existingProperties[key] = [];
              arrayKeys.add(key);
              if (arrayContent) {
                const items = [];
                let currentItem = "";
                let inQuotes = false;
                let quoteChar = "";
                for (let i = 0; i < arrayContent.length; i++) {
                  const char = arrayContent[i];
                  if (!inQuotes && (char === '"' || char === "'")) {
                    inQuotes = true;
                    quoteChar = char;
                  } else if (inQuotes && char === quoteChar) {
                    if (i > 0 && arrayContent[i - 1] === "\\") {
                      currentItem += char;
                    } else {
                      inQuotes = false;
                      quoteChar = "";
                    }
                  } else if (!inQuotes && char === ",") {
                    const trimmedItem = currentItem.trim();
                    if (trimmedItem) {
                      const unquoted = trimmedItem.replace(/^["']|["']$/g, "");
                      items.push(unquoted);
                    }
                    currentItem = "";
                  } else {
                    currentItem += char;
                  }
                }
                if (currentItem.trim()) {
                  const trimmedItem = currentItem.trim();
                  const unquoted = trimmedItem.replace(/^["']|["']$/g, "");
                  items.push(unquoted);
                }
                existingProperties[key] = items;
              }
            } else {
              const isKnownArrayKey = KNOWN_ARRAY_KEYS.includes(key);
              const isEmptyArray = !trimmedValue || trimmedValue === "";
              const isArrayProperty = isKnownArrayKey || isEmptyArray;
              if (isArrayProperty) {
                existingProperties[key] = [];
                arrayKeys.add(key);
              } else {
                const unquotedValue = trimmedValue.replace(/^["']|["']$/g, "");
                existingProperties[key] = [unquotedValue];
              }
            }
          } else if (currentKey && trimmedLine.startsWith("- ")) {
            const isArrayProperty = arrayKeys.has(currentKey);
            if (isArrayProperty) {
              const item = trimmedLine.replace(/^-\s*/, "");
              if (item) existingProperties[currentKey].push(item);
            }
          } else if (trimmedLine && !trimmedLine.startsWith("- ") && !trimmedLine.startsWith("#")) {
            const keyMatch = trimmedLine.match(/^([^:]+):\s*(.*)$/);
            if (keyMatch) {
              const [, key, value] = keyMatch;
              if (!existingProperties[key]) {
                existingProperties[key] = [value ? value.trim() : ""];
              }
            }
          }
        });
        KNOWN_ARRAY_KEYS.forEach((key) => {
          if (propertiesText.includes(key + ":") && !existingProperties[key]) {
            existingProperties[key] = [];
          }
        });
      } catch (e) {
        new import_obsidian2.Notice("Falling back to template due to parsing error.");
      }
    }
    const bodyContent = content.slice(propertiesEnd);
    return {
      properties: existingProperties,
      propertiesText,
      propertiesEnd,
      bodyContent
    };
  }
  parseTemplate(templateString, title) {
    const templateLines = templateString.split("\n");
    const templateProps = [];
    const templateValues = {};
    let inProperties = false;
    for (let i = 0; i < templateLines.length; i++) {
      const line = templateLines[i].trim();
      if (line === "---") {
        inProperties = !inProperties;
        if (!inProperties) {
          break;
        }
        continue;
      }
      if (inProperties) {
        const match = line.match(/^(\w+):\s*(.*)$/);
        if (match) {
          const [, key, value] = match;
          templateProps.push(key);
          const isKnownArrayKey = KNOWN_ARRAY_KEYS.includes(key);
          const isEmptyArray = !value || value.trim() === "" || value.trim() === "[]";
          const isArrayProperty = isKnownArrayKey || isEmptyArray;
          if (isArrayProperty) {
            if (value && value.startsWith("[")) {
              const items = value.replace(/[[\]]/g, "").split(",").map((t) => t.trim()).filter((t) => t);
              templateValues[key] = items;
            } else {
              templateValues[key] = [];
              for (let j = i + 1; j < templateLines.length; j++) {
                const nextLine = templateLines[j].trim();
                if (nextLine.startsWith("- ")) {
                  const item = nextLine.replace(/^-\s*/, "").trim();
                  if (item) {
                    const arrayValue = templateValues[key];
                    if (Array.isArray(arrayValue)) {
                      arrayValue.push(item);
                    }
                  }
                } else if (nextLine === "---" || nextLine && !nextLine.startsWith("- ") && nextLine.includes(":")) {
                  break;
                }
              }
            }
          } else {
            const slug = this.toKebabCase(title);
            const stringValue = (value || "").replace(/\{\{title\}\}/g, title).replace(/\{\{date\}\}/g, window.moment(/* @__PURE__ */ new Date()).format(this.settings.dateFormat)).replace(/\{\{slug\}\}/g, slug);
            templateValues[key] = stringValue;
          }
        }
      }
    }
    return { templateProps, templateValues };
  }
  buildFrontmatterContent(finalProps, arrayKeys) {
    let newContent = "---\n";
    for (const key in finalProps) {
      const isArrayProperty = KNOWN_ARRAY_KEYS.includes(key) || arrayKeys && arrayKeys.has(key);
      if (isArrayProperty) {
        newContent += `${key}:
`;
        if (finalProps[key].length > 0) {
          finalProps[key].forEach((item) => {
            newContent += `  - ${item}
`;
          });
        }
      } else {
        newContent += `${key}: ${finalProps[key][0] || ""}
`;
      }
    }
    newContent += "---";
    return newContent;
  }
  async updateTitleInFrontmatter(file, newTitle, type) {
    const titleKey = this.getTitleKey(type);
    const hasTitleInTemplate = this.templateHasTitle(type);
    if (!hasTitleInTemplate) {
      return;
    }
    const content = await this.app.vault.read(file);
    let propertiesEnd = 0;
    let propertiesText = "";
    let hasFrontmatter = false;
    if (content.startsWith("---")) {
      hasFrontmatter = true;
      propertiesEnd = content.indexOf("\n---", 3);
      if (propertiesEnd === -1) {
        propertiesEnd = content.length;
      } else {
        propertiesEnd += 4;
      }
      propertiesText = content.slice(4, propertiesEnd - 4).trim();
    }
    const propOrder = [];
    const existing = {};
    let currentKey = null;
    let titleKeyPosition = -1;
    const arrayKeys = /* @__PURE__ */ new Set();
    propertiesText.split("\n").forEach((line, index) => {
      const trimmedLine = line.trim();
      const match = trimmedLine.match(/^([a-zA-Z_][a-zA-Z0-9_-]*):\s*(.*)$/);
      if (match) {
        const [, key, value] = match;
        propOrder.push(key);
        currentKey = key;
        if (key === titleKey) {
          titleKeyPosition = index;
        }
        const isKnownArrayKey = KNOWN_ARRAY_KEYS.includes(key);
        const isEmptyArray = !value || value.trim() === "" || value.trim() === "[]";
        const isArrayProperty = isKnownArrayKey || isEmptyArray;
        if (isArrayProperty) {
          existing[key] = [];
          arrayKeys.add(key);
        } else {
          existing[key] = value ? value.trim() : "";
        }
      } else if (currentKey && arrayKeys.has(currentKey) && trimmedLine.startsWith("- ")) {
        const item = trimmedLine.replace(/^-\s*/, "");
        if (item) existing[currentKey].push(item);
      } else if (trimmedLine && !trimmedLine.startsWith("- ") && !trimmedLine.startsWith("#")) {
        const keyMatch = trimmedLine.match(/^([^:]+):\s*(.*)$/);
        if (keyMatch) {
          const [, key, value] = keyMatch;
          if (!propOrder.includes(key)) {
            propOrder.push(key);
            existing[key] = value ? value.trim() : "";
          }
        }
      }
    });
    let titleVal;
    if (newTitle.includes('"') || newTitle.includes("'") || newTitle.includes("\n") || newTitle.includes("\\")) {
      titleVal = `'${newTitle.replace(/'/g, "''")}'`;
    } else if (newTitle.includes(" ") || newTitle.includes(":") || newTitle.includes("#") || newTitle.includes("@")) {
      titleVal = `"${newTitle.replace(/"/g, '\\"')}"`;
    } else {
      titleVal = newTitle;
    }
    existing[titleKey] = titleVal;
    if ("slug" in existing) {
      const newSlug = this.toKebabCase(newTitle);
      existing["slug"] = newSlug;
    }
    if (titleKeyPosition === -1) {
      propOrder.push(titleKey);
    }
    if (!hasFrontmatter) {
      return;
    }
    let newContent = "---\n";
    for (const key of propOrder) {
      const val = existing[key];
      if (Array.isArray(val)) {
        newContent += `${key}:
`;
        if (val.length > 0) {
          val.forEach((item) => {
            newContent += `  - ${item}
`;
          });
        }
      } else {
        newContent += `${key}: ${val || ""}
`;
      }
    }
    newContent += "---\n";
    const bodyContent = content.slice(propertiesEnd);
    newContent += bodyContent;
    await this.app.vault.modify(file, newContent);
  }
  getTitleKey(type) {
    if (type === "note") return "title";
    const contentTypes = this.settings.contentTypes || [];
    const contentType = contentTypes.find((ct) => ct.id === type);
    if (!contentType) return "title";
    const template = contentType.template;
    const lines = template.split("\n");
    let inProperties = false;
    for (const line of lines) {
      const trimmed = line.trim();
      if (trimmed === "---") {
        inProperties = !inProperties;
        continue;
      }
      if (inProperties) {
        const match = trimmed.match(/^(\w+):\s*(.+)$/);
        if (match) {
          const key = match[1];
          const value = match[2];
          if (value.includes("{{title}}")) {
            return key;
          }
        }
      }
    }
    return "title";
  }
  // Check if the template for this content type has {{title}}
  templateHasTitle(type) {
    if (type === "note") return true;
    const contentTypes = this.settings.contentTypes || [];
    const contentType = contentTypes.find((ct) => ct.id === type);
    if (!contentType) return true;
    const template = contentType.template;
    return template.includes("{{title}}");
  }
};

// src/utils/link-conversion.ts
var import_obsidian3 = require("obsidian");
var LinkConverter = class {
  constructor(settings, plugin) {
    this.settings = settings;
    this.plugin = plugin;
  }
  // Get fresh settings from plugin if available, otherwise use stored settings
  getSettings() {
    var _a;
    if ((_a = this.plugin) == null ? void 0 : _a.settings) {
      return this.plugin.settings;
    }
    return this.settings;
  }
  // Local toKebabCase removed, using imported one instead
  getAstroUrlFromInternalLink(link) {
    const hashIndex = link.indexOf("#");
    let path = hashIndex >= 0 ? link.slice(0, hashIndex) : link;
    const anchor = hashIndex >= 0 ? link.slice(hashIndex) : "";
    path = decodeURIComponent(path);
    path = path.replace(/\.(md|mdx)$/, "");
    const fileExtension = link.endsWith(".mdx") ? ".mdx" : ".md";
    const contentTypeInfo = this.getContentTypeForPath(path + fileExtension);
    let basePath = contentTypeInfo.basePath || "";
    let contentFolder = contentTypeInfo.contentFolder || "";
    let indexFileName = contentTypeInfo.indexFileName || "";
    if (contentFolder) {
      path = path.slice(contentFolder.length + 1);
    }
    let addTrailingSlash = false;
    const parts = path.split("/");
    const lastPart = parts[parts.length - 1];
    if (indexFileName && indexFileName.trim() !== "" && lastPart === indexFileName) {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    } else if ((!indexFileName || indexFileName.trim() === "") && lastPart === "index") {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    }
    const slugParts = path.split("/").map((part) => toKebabCase(part));
    const slug = slugParts.join("/");
    if (basePath) {
      if (!basePath.startsWith("/")) {
        basePath = "/" + basePath;
      }
      if (!basePath.endsWith("/")) {
        basePath += "/";
      }
    } else {
      basePath = "/";
    }
    const settings = this.getSettings();
    const shouldAddTrailingSlash = (settings.addTrailingSlashToLinks || addTrailingSlash) && !anchor;
    return `${basePath}${slug}${shouldAddTrailingSlash ? "/" : ""}${anchor}`;
  }
  getAstroUrlFromInternalLinkWithContext(link, currentFilePath, currentFileContentType) {
    const hashIndex = link.indexOf("#");
    let path = hashIndex >= 0 ? link.slice(0, hashIndex) : link;
    const anchor = hashIndex >= 0 ? link.slice(hashIndex) : "";
    path = decodeURIComponent(path);
    path = path.replace(/\.(md|mdx)$/, "");
    let basePath = "";
    let contentFolder = "";
    let indexFileName = "";
    const fileExtension = link.endsWith(".mdx") ? ".mdx" : ".md";
    const targetContentType = this.getContentTypeForPath(path + fileExtension);
    if (!targetContentType.basePath && currentFileContentType.basePath) {
      basePath = currentFileContentType.basePath;
      indexFileName = currentFileContentType.indexFileName;
      contentFolder = currentFileContentType.contentFolder;
    } else {
      basePath = targetContentType.basePath;
      indexFileName = targetContentType.indexFileName;
      contentFolder = targetContentType.contentFolder;
    }
    if (contentFolder) {
      path = path.slice(contentFolder.length + 1);
    }
    let addTrailingSlash = false;
    const parts = path.split("/");
    const lastPart = parts[parts.length - 1];
    if (indexFileName && indexFileName.trim() !== "" && lastPart === indexFileName) {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    } else if ((!indexFileName || indexFileName.trim() === "") && lastPart === "index") {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    }
    const slugParts = path.split("/").map((part) => toKebabCase(part));
    const slug = slugParts.join("/");
    if (basePath) {
      if (!basePath.startsWith("/")) {
        basePath = "/" + basePath;
      }
      if (!basePath.endsWith("/")) {
        basePath += "/";
      }
    } else {
      basePath = "/";
    }
    const settings = this.getSettings();
    const shouldAddTrailingSlash = (settings.addTrailingSlashToLinks || addTrailingSlash) && !anchor;
    return `${basePath}${slug}${shouldAddTrailingSlash ? "/" : ""}${anchor}`;
  }
  isInConfiguredContentDirectory(filePath) {
    const settings = this.getSettings();
    const contentTypes = settings.contentTypes || [];
    const sortedTypes = sortByPatternSpecificity(contentTypes);
    for (const contentType of sortedTypes) {
      if (!contentType.enabled) continue;
      if (!contentType.folder || contentType.folder.trim() === "") {
        if (!filePath.includes("/") || filePath.split("/").length === 1) {
          return true;
        }
      } else if (matchesFolderPattern(filePath, contentType.folder)) {
        if (contentType.ignoreSubfolders) {
          const pathSegments = filePath.split("/");
          const pathDepth = pathSegments.length;
          const patternSegments = contentType.folder.split("/");
          const expectedDepth = patternSegments.length;
          if (contentType.creationMode === "folder") {
            const folderDepth = pathDepth - 1;
            if (folderDepth === expectedDepth || folderDepth === expectedDepth + 1) {
              return true;
            }
          } else {
            if (pathDepth === expectedDepth) {
              return true;
            }
          }
        } else {
          return true;
        }
      }
    }
    return false;
  }
  getContentTypeForPath(filePath) {
    const settings = this.getSettings();
    const contentTypes = settings.contentTypes || [];
    const sortedTypes = sortByPatternSpecificity(contentTypes);
    for (const contentType of sortedTypes) {
      if (!contentType.enabled) continue;
      if (!contentType.folder || contentType.folder.trim() === "") {
        if (!filePath.includes("/") || filePath.split("/").length === 1) {
          return {
            basePath: contentType.linkBasePath || "",
            creationMode: contentType.creationMode,
            indexFileName: contentType.indexFileName || "",
            contentFolder: ""
          };
        }
      } else if (matchesFolderPattern(filePath, contentType.folder)) {
        if (contentType.ignoreSubfolders) {
          const pathSegments = filePath.split("/");
          const pathDepth = pathSegments.length;
          const patternSegments = contentType.folder.split("/");
          const expectedDepth = patternSegments.length;
          if (contentType.creationMode === "folder") {
            const folderDepth = pathDepth - 1;
            if (folderDepth === expectedDepth || folderDepth === expectedDepth + 1) {
              return {
                basePath: contentType.linkBasePath || "",
                creationMode: contentType.creationMode,
                indexFileName: contentType.indexFileName || "",
                contentFolder: contentType.folder
              };
            }
          } else {
            if (pathDepth === expectedDepth) {
              return {
                basePath: contentType.linkBasePath || "",
                creationMode: contentType.creationMode,
                indexFileName: contentType.indexFileName || "",
                contentFolder: contentType.folder
              };
            }
          }
        } else {
          return {
            basePath: contentType.linkBasePath || "",
            creationMode: contentType.creationMode,
            indexFileName: contentType.indexFileName || "",
            contentFolder: contentType.folder
          };
        }
      }
    }
    return {
      basePath: "",
      creationMode: "file",
      indexFileName: "",
      contentFolder: ""
    };
  }
  convertWikilinksForAstro(editor, file) {
    var _a, _b;
    if (!(file instanceof import_obsidian3.TFile)) {
      new import_obsidian3.Notice("No active file.");
      return;
    }
    const cursor = editor.getCursor();
    const originalLine = cursor.line;
    const originalCh = cursor.ch;
    const originalContent = editor.getValue();
    const originalLineCount = originalContent.split("\n").length;
    const originalLineLength = ((_a = originalContent.split("\n")[originalLine]) == null ? void 0 : _a.length) || 0;
    const content = editor.getValue();
    let newContent = content;
    let convertedCount = 0;
    let skippedCount = 0;
    const skippedLinks = [];
    const currentFileContentType = this.getContentTypeForPath(file.path);
    const imageExtensions = /\.(png|jpg|jpeg|gif|svg)$/i;
    const canConvertLink = (linkText) => {
      if (imageExtensions.test(linkText)) {
        return false;
      }
      if (linkText.match(/^https?:\/\//)) {
        return false;
      }
      if (!linkText.includes(".md") && !linkText.includes(".mdx") && !linkText.match(/^[a-zA-Z0-9_-]+(\/[a-zA-Z0-9_-]+)*$/)) {
        return false;
      }
      let targetPath;
      if (linkText.endsWith(".md") || linkText.endsWith(".mdx")) {
        targetPath = linkText;
      } else {
        targetPath = linkText + ".md";
      }
      const isInConfiguredDirectory = this.isInConfiguredContentDirectory(targetPath);
      const isSimpleFilename = !targetPath.includes("/");
      const hasCurrentContentType = currentFileContentType.basePath !== "" || currentFileContentType.creationMode !== "file" || currentFileContentType.indexFileName !== "";
      return isInConfiguredDirectory || isSimpleFilename && hasCurrentContentType;
    };
    newContent = newContent.replace(
      /\[\[([^\]|]+)(\|([^\]]+))?\]\]/g,
      (match, linkText, _pipe, displayText) => {
        if (imageExtensions.test(linkText)) {
          skippedCount++;
          skippedLinks.push(linkText);
          return match;
        }
        if (!canConvertLink(linkText)) {
          skippedCount++;
          skippedLinks.push(linkText);
          return match;
        }
        const display = displayText || linkText.replace(/\.(md|mdx)$/, "");
        const url = this.getAstroUrlFromInternalLinkWithContext(linkText, file.path, currentFileContentType);
        convertedCount++;
        return `[${display}](${url})`;
      }
    );
    newContent = newContent.replace(
      /\[([^\]]+)\]\(([^)]+\.(md|mdx)[^)]*)\)/g,
      (match, displayText, link) => {
        if (link.match(/^https?:\/\//) || imageExtensions.test(link)) {
          skippedCount++;
          skippedLinks.push(link);
          return match;
        }
        if (!canConvertLink(link)) {
          skippedCount++;
          skippedLinks.push(link);
          return match;
        }
        const url = this.getAstroUrlFromInternalLinkWithContext(link, file.path, currentFileContentType);
        convertedCount++;
        return `[${displayText}](${url})`;
      }
    );
    newContent = newContent.replace(
      /!\[(.*?)\]\(([^)]+)\)/g,
      (match) => {
        skippedCount++;
        return match;
      }
    );
    newContent = newContent.replace(/\{\{([^}]+)\}\}/g, (match, fileName) => {
      if (imageExtensions.test(fileName)) {
        skippedCount++;
        skippedLinks.push(fileName);
        return match;
      }
      if (!canConvertLink(fileName)) {
        skippedCount++;
        skippedLinks.push(fileName);
        return match;
      }
      const url = this.getAstroUrlFromInternalLinkWithContext(fileName, file.path, currentFileContentType);
      convertedCount++;
      return `[Embedded: ${fileName}](${url})`;
    });
    editor.setValue(newContent);
    const newLineCount = newContent.split("\n").length;
    const newLineLength = ((_b = newContent.split("\n")[originalLine]) == null ? void 0 : _b.length) || 0;
    let newLine = originalLine;
    let newCh = originalCh;
    if (newLineCount !== originalLineCount) {
      if (newLine >= newLineCount) {
        newLine = Math.max(0, newLineCount - 1);
      }
    }
    if (newLineLength !== originalLineLength) {
      if (newCh > newLineLength) {
        newCh = Math.max(0, newLineLength);
      }
    }
    editor.setCursor({ line: newLine, ch: newCh });
    if (convertedCount > 0 && skippedCount === 0) {
      new import_obsidian3.Notice(`Converted ${convertedCount} internal link${convertedCount > 1 ? "s" : ""} for Astro.`);
    } else if (convertedCount > 0 && skippedCount > 0) {
      new import_obsidian3.Notice(`Converted ${convertedCount} link${convertedCount > 1 ? "s" : ""} for Astro. Skipped ${skippedCount} link${skippedCount > 1 ? "s" : ""} outside configured content directories.`);
    } else if (skippedCount > 0) {
      new import_obsidian3.Notice(`No links converted. All ${skippedCount} link${skippedCount > 1 ? "s" : ""} are outside configured content directories or are images/external links.`);
    } else {
      new import_obsidian3.Notice("No internal links found to convert.");
    }
  }
};

// src/ui/title-modal.ts
var import_obsidian4 = require("obsidian");
var TitleModal = class extends import_obsidian4.Modal {
  constructor(app, file, plugin, type, isRename = false, isNewNote = false) {
    super(app);
    this.file = file;
    this.plugin = plugin;
    this.type = type;
    this.isRename = isRename;
    this.isNewNote = isNewNote;
    const settings = plugin.settings;
    this.fileOps = new FileOperations(app, settings, plugin);
    this.templateParser = new TemplateParser(app, settings);
  }
  async getCurrentTitleAsync() {
    if (!this.file) {
      return "";
    }
    try {
      const content = await this.app.vault.read(this.file);
      const titleKey = this.fileOps.getTitleKey(this.type);
      const { properties } = this.templateParser.parseFrontmatter(content);
      if (titleKey in properties) {
        const titleValue = properties[titleKey];
        if (Array.isArray(titleValue) && titleValue.length > 0) {
          return String(titleValue[0]);
        }
        if (titleValue !== null && titleValue !== void 0) {
          return String(titleValue);
        }
      }
    } catch (error) {
      console.error("Error reading file for title:", error);
    }
    return this.getFallbackTitle();
  }
  getCurrentTitle() {
    if (!this.file) {
      return "";
    }
    const titleKey = this.fileOps.getTitleKey(this.type);
    const cache = this.app.metadataCache.getFileCache(this.file);
    if ((cache == null ? void 0 : cache.frontmatter) && titleKey in cache.frontmatter) {
      const titleValue = cache.frontmatter[titleKey];
      if (typeof titleValue === "string") {
        return titleValue;
      }
      if (Array.isArray(titleValue) && titleValue.length > 0) {
        const firstValue = titleValue[0];
        if (typeof firstValue === "string") {
          return firstValue;
        }
        if (firstValue != null) {
          if (typeof firstValue === "number" || typeof firstValue === "boolean") {
            return String(firstValue);
          }
          if (typeof firstValue === "string") {
            return firstValue;
          }
        }
      }
      if (titleValue == null) {
        return "";
      }
      if (typeof titleValue === "number" || typeof titleValue === "boolean") {
        return String(titleValue);
      }
      if (typeof titleValue === "string") {
        return titleValue;
      }
      return "";
    }
    return this.getFallbackTitle();
  }
  getFallbackTitle() {
    if (!this.file) {
      return "";
    }
    let basename = this.file.basename;
    if (this.file.parent && this.type !== "note") {
      const contentType = this.fileOps.getContentType(this.type);
      const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "";
      if (indexFileName.trim() !== "" && basename === indexFileName) {
        basename = this.file.parent.name;
      }
    }
    if (basename.startsWith("_")) {
      basename = basename.slice(1);
    }
    return basename.replace(/-/g, " ").split(" ").map((word) => word.charAt(0).toUpperCase() + word.slice(1)).join(" ");
  }
  /**
   * Extracts a suggested title from the file basename for newly created files.
   * This is used when a file is created from a link (e.g., [[sEfsleif]]).
   * Preserves the original text as much as possible.
   */
  getSuggestedTitleFromBasename() {
    if (!this.file) {
      return "";
    }
    let basename = this.file.basename;
    if (this.file.parent && this.type !== "note") {
      const contentType = this.fileOps.getContentType(this.type);
      const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "";
      if (indexFileName.trim() !== "" && basename === indexFileName) {
        basename = this.file.parent.name;
      }
    }
    if (basename.startsWith("_")) {
      basename = basename.slice(1);
    }
    return basename;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    const isMobile = window.innerWidth <= 768 || import_obsidian4.Platform.isMobile;
    if (isMobile) {
      this.modalEl.addClass("astro-composer-mobile-modal");
    }
    if (this.isRename) {
      const typeName = this.getTypeDisplayName();
      if (this.type === "note") {
        contentEl.createEl("h2", { text: "Rename content" });
        contentEl.createEl("p", { text: "Enter a title for this content:" });
      } else {
        contentEl.createEl("h2", { text: `Rename ${typeName} content` });
        contentEl.createEl("p", { text: `Enter new title for your ${typeName} content:` });
      }
      this.titleInput = contentEl.createEl("input", {
        type: "text",
        placeholder: "New Title",
        cls: "astro-composer-title-input"
      });
      void this.getCurrentTitleAsync().then((title) => {
        this.titleInput.value = title;
      });
    } else if (this.isNewNote) {
      const typeName = this.getTypeDisplayName();
      if (this.type === "note") {
        contentEl.createEl("h2", { text: "New content" });
        contentEl.createEl("p", { text: "Enter a title for this content:" });
      } else {
        contentEl.createEl("h2", { text: `Create new ${typeName} content` });
        contentEl.createEl("p", { text: `Enter a title for your new ${typeName} content:` });
      }
      this.titleInput = contentEl.createEl("input", {
        type: "text",
        placeholder: "New Title",
        cls: "astro-composer-title-input"
      });
    } else {
      const typeName = this.getTypeDisplayName();
      if (this.type === "note") {
        contentEl.createEl("h2", { text: "New content" });
        contentEl.createEl("p", { text: "Enter a title for this content:" });
      } else {
        contentEl.createEl("h2", { text: `Create new ${typeName} content` });
        contentEl.createEl("p", { text: `Enter a title for your new ${typeName} content:` });
      }
      this.titleInput = contentEl.createEl("input", {
        type: "text",
        placeholder: "New Title",
        cls: "astro-composer-title-input"
      });
      if (this.file) {
        const suggestedTitle = this.getSuggestedTitleFromBasename();
        if (suggestedTitle) {
          this.titleInput.value = suggestedTitle;
        }
      }
    }
    this.titleInput.focus();
    if (this.isNewNote) {
      setTimeout(() => {
        this.titleInput.setSelectionRange(0, 0);
      }, 0);
    }
    const buttonContainer = contentEl.createDiv({ cls: "astro-composer-button-container" });
    const cancelButton = buttonContainer.createEl("button", { text: "Cancel", cls: "astro-composer-cancel-button" });
    cancelButton.onclick = () => this.close();
    const submitButton = buttonContainer.createEl("button", { text: this.isRename ? "Rename" : "Create", cls: ["astro-composer-create-button", "mod-cta"] });
    submitButton.onclick = () => this.submit();
    this.titleInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter") void this.submit();
    });
  }
  async submit() {
    const title = this.titleInput.value.trim();
    if (!title) {
      new import_obsidian4.Notice("Please enter a title.");
      return;
    }
    try {
      let newFile = null;
      if (this.isRename) {
        newFile = await this.fileOps.renameFile({ file: this.file, title, type: this.type });
        if (newFile) {
          await this.templateParser.updateTitleInFrontmatter(newFile, title, this.type);
        } else {
          this.close();
          return;
        }
      } else if (this.isNewNote) {
        if (this.file) {
          newFile = await this.fileOps.createFile({ file: this.file, title, type: this.type });
          const shouldInsertProperties = this.plugin.settings.autoInsertProperties;
          if (newFile && shouldInsertProperties) {
            await this.addPropertiesToFile(newFile, title, this.type);
            this.positionCursorAtEnd(newFile);
          }
        }
      } else if (this.file) {
        newFile = await this.fileOps.createFile({ file: this.file, title, type: this.type });
        const shouldInsertProperties = this.plugin.settings.autoInsertProperties;
        if (newFile && shouldInsertProperties) {
          await this.addPropertiesToFile(newFile, title, this.type);
          this.positionCursorAtEnd(newFile);
        }
      } else {
        newFile = await this.createNewFile(title);
      }
      if (!newFile) {
        new import_obsidian4.Notice(`Failed to ${this.isRename ? "rename" : "create"} ${this.type}.`);
        this.close();
        return;
      }
    } catch (error) {
      console.error("TitleModal: Error during process:", error);
      const errorMessage = error instanceof Error ? error.message : String(error);
      new import_obsidian4.Notice(`Error ${this.isRename ? "renaming" : "creating"} ${this.type}: ${errorMessage}.`);
      this.close();
      return;
    }
    this.close();
  }
  getTypeDisplayName() {
    if (this.type === "note") {
      return "Content";
    }
    const contentType = this.fileOps.getContentType(this.type);
    return contentType ? contentType.name : "Content";
  }
  async createNewFile(title) {
    var _a, _b;
    let targetFolder;
    const originalDir = ((_b = (_a = this.file) == null ? void 0 : _a.parent) == null ? void 0 : _b.path) || "";
    if (this.type !== "note") {
      const contentType2 = this.fileOps.getContentType(this.type);
      if (originalDir === "" || originalDir === "/") {
        targetFolder = (contentType2 == null ? void 0 : contentType2.folder) || "";
      } else {
        targetFolder = originalDir;
      }
    } else {
      targetFolder = originalDir;
    }
    const filename = this.fileOps.generateFilename(title);
    const contentType = this.fileOps.getContentType(this.type);
    const extension = (contentType == null ? void 0 : contentType.useMdxExtension) ? ".mdx" : ".md";
    const filePath = targetFolder ? `${targetFolder}/${filename}${extension}` : `${filename}${extension}`;
    if (this.plugin) {
      this.plugin.pluginCreatedFiles.set(filePath, Date.now());
    }
    let initialContent = "";
    if (this.plugin.settings.autoInsertProperties) {
      initialContent = this.generateInitialContent(title);
    }
    try {
      const newFile = await this.app.vault.create(filePath, initialContent);
      const leaf = this.app.workspace.getLeaf();
      await leaf.openFile(newFile);
      const positionCursor = () => {
        var _a2;
        const view = leaf.view;
        if (view instanceof import_obsidian4.MarkdownView && view.editor) {
          const editor = view.editor;
          const content = editor.getValue();
          if (content) {
            const lines = content.split("\n");
            const lastLine = lines.length - 1;
            const lastLineLength = ((_a2 = lines[lastLine]) == null ? void 0 : _a2.length) || 0;
            editor.setCursor({ line: lastLine, ch: lastLineLength });
            editor.focus();
            return true;
          }
        }
        return false;
      };
      setTimeout(() => {
        if (!positionCursor()) {
          setTimeout(() => {
            positionCursor();
          }, 200);
        }
      }, 100);
      return newFile;
    } catch (error) {
      const errorMessage = error instanceof Error ? error.message : String(error);
      throw new Error(`Failed to create file: ${errorMessage}`);
    }
  }
  generateInitialContent(title) {
    const now = /* @__PURE__ */ new Date();
    const dateString = window.moment(now).format(this.plugin.settings.dateFormat);
    const slug = toKebabCase(title);
    let template;
    if (this.type === "note") {
      const escapedTitle = this.escapeYamlString(title);
      template = `---
title: ${escapedTitle}
date: ${dateString}
---
`;
    } else {
      const contentType = this.fileOps.getContentType(this.type);
      if (!contentType) {
        const escapedTitle = this.escapeYamlString(title);
        template = `---
title: ${escapedTitle}
date: ${dateString}
---
`;
      } else {
        template = contentType.template;
      }
    }
    template = template.replace(/\{\{title\}\}/g, title);
    template = template.replace(/\{\{date\}\}/g, dateString);
    template = template.replace(/\{\{slug\}\}/g, slug);
    return template;
  }
  async addPropertiesToFile(file, title, type) {
    const now = /* @__PURE__ */ new Date();
    const dateString = window.moment(now).format(this.plugin.settings.dateFormat);
    const slug = toKebabCase(title);
    let template;
    if (type === "note") {
      const escapedTitle = this.escapeYamlString(title);
      template = `---
title: ${escapedTitle}
date: ${dateString}
---
`;
    } else {
      const contentType = this.fileOps.getContentType(type);
      if (!contentType) {
        const escapedTitle = this.escapeYamlString(title);
        template = `---
title: ${escapedTitle}
date: ${dateString}
---
`;
      } else {
        template = contentType.template;
      }
    }
    template = template.replace(/\{\{title\}\}/g, title);
    template = template.replace(/\{\{date\}\}/g, dateString);
    template = template.replace(/\{\{slug\}\}/g, slug);
    await this.app.vault.modify(file, template);
  }
  positionCursorAtEnd(file) {
    const positionCursor = () => {
      var _a;
      const view = this.app.workspace.getActiveViewOfType(import_obsidian4.MarkdownView);
      if (view && view.file === file && view.editor) {
        const editor = view.editor;
        const content = editor.getValue();
        if (content) {
          const lines = content.split("\n");
          const lastLine = lines.length - 1;
          const lastLineLength = ((_a = lines[lastLine]) == null ? void 0 : _a.length) || 0;
          editor.setCursor({ line: lastLine, ch: lastLineLength });
          editor.focus();
          return true;
        }
      }
      return false;
    };
    setTimeout(() => {
      if (!positionCursor()) {
        setTimeout(() => {
          positionCursor();
        }, 200);
      }
    }, 100);
  }
  escapeYamlString(str) {
    if (str.includes('"') || str.includes("'") || str.includes("\n") || str.includes("\\")) {
      return `'${str.replace(/'/g, "''")}'`;
    } else if (str.includes(" ") || str.includes(":") || str.includes("#") || str.includes("@")) {
      return `"${str.replace(/"/g, '\\"')}"`;
    } else {
      return str;
    }
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/commands/index.ts
function registerCommands(plugin, settings) {
  const isMobile = import_obsidian5.Platform.isMobile;
  if (isMobile) {
    let hasMatchingContentType2 = function(file, settings2) {
      const type = fileOps.determineType(file);
      if (type === "note") {
        return false;
      }
      const contentType = fileOps.getContentType(type);
      return contentType !== null && contentType.enabled;
    };
    var hasMatchingContentType = hasMatchingContentType2;
    const pluginInterface2 = plugin;
    const fileOps = new FileOperations(plugin.app, settings, pluginInterface2);
    const linkConverter = new LinkConverter(settings, pluginInterface2);
    plugin.addCommand({
      id: "standardize-properties",
      name: "Standardize properties",
      icon: "file-check",
      editorCallback: (editor, ctx) => {
        const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
        if (file instanceof import_obsidian5.TFile) {
          const currentSettings = pluginInterface2.settings || settings;
          void standardizeProperties(plugin.app, currentSettings, file, pluginInterface2, editor);
        }
      }
    });
    plugin.addCommand({
      id: "convert-wikilinks-astro",
      name: "Convert internal links for astro",
      icon: "link-2",
      editorCallback: (editor, ctx) => {
        const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
        if (file instanceof import_obsidian5.TFile) {
          linkConverter.convertWikilinksForAstro(editor, file);
        }
      }
    });
    plugin.addCommand({
      id: "rename-content",
      name: "Rename current content",
      icon: "pencil",
      editorCallback: (editor, ctx) => {
        const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
        if (file instanceof import_obsidian5.TFile) {
          if (!hasMatchingContentType2(file, settings)) {
            new import_obsidian5.Notice("Cannot rename: this file is not part of a configured content type folder.");
            return;
          }
          const type = fileOps.determineType(file);
          const cache = plugin.app.metadataCache.getFileCache(file);
          const titleKey = fileOps.getTitleKey(type);
          if (!(cache == null ? void 0 : cache.frontmatter) || !(titleKey in cache.frontmatter)) {
            new import_obsidian5.Notice(`Cannot rename: No ${titleKey} found in properties`);
            return;
          }
          new TitleModal(plugin.app, file, plugin, type, true).open();
        }
      }
    });
    return;
  }
  const pluginInterface = plugin;
  function hasMatchingContentType(file, settings2) {
    const currentSettings = (plugin == null ? void 0 : plugin.settings) || settings2;
    const tempFileOps = new FileOperations(plugin.app, currentSettings, plugin);
    const type = tempFileOps.determineType(file);
    if (type === "note") {
      return false;
    }
    const contentType = tempFileOps.getContentType(type);
    return contentType !== null && contentType.enabled;
  }
  plugin.addCommand({
    id: "standardize-properties",
    name: "Standardize properties",
    icon: "file-check",
    editorCallback: (editor, ctx) => {
      const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
      if (file instanceof import_obsidian5.TFile) {
        void standardizeProperties(plugin.app, settings, file, plugin, editor);
      }
    }
  });
  plugin.addCommand({
    id: "convert-wikilinks-astro",
    name: "Convert internal links for astro",
    icon: "link-2",
    editorCallback: (editor, ctx) => {
      const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
      if (file instanceof import_obsidian5.TFile) {
        const currentSettings = pluginInterface.settings || settings;
        const currentLinkConverter = new LinkConverter(currentSettings, pluginInterface);
        currentLinkConverter.convertWikilinksForAstro(editor, file);
      }
    }
  });
  plugin.addCommand({
    id: "rename-content",
    name: "Rename current content",
    icon: "pencil",
    editorCallback: (editor, ctx) => {
      const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
      if (file instanceof import_obsidian5.TFile) {
        const currentSettings = pluginInterface.settings || settings;
        const currentFileOps = new FileOperations(plugin.app, currentSettings, pluginInterface);
        if (!hasMatchingContentType(file, currentSettings)) {
          new import_obsidian5.Notice("Cannot rename: this file is not part of a configured content type folder.");
          return;
        }
        const type = currentFileOps.determineType(file);
        new TitleModal(plugin.app, file, pluginInterface, type, true).open();
      }
    }
  });
  if (!isMobile) {
    plugin.addCommand({
      id: "open-project-terminal",
      name: "Open project terminal",
      icon: "terminal-square",
      callback: () => {
        const currentSettings = plugin.settings;
        if (!currentSettings.enableOpenTerminalCommand) {
          new import_obsidian5.Notice("Open terminal command is disabled. Enable it in settings to use this command.");
          return;
        }
        openTerminalInProjectRoot(plugin.app, currentSettings);
      }
    });
  }
  if (!isMobile) {
    plugin.addCommand({
      id: "edit-astro-config",
      name: "Edit astro config",
      icon: "rocket",
      callback: async () => {
        const currentSettings = plugin.settings;
        if (!currentSettings.enableOpenConfigFileCommand) {
          new import_obsidian5.Notice("Edit config file command is disabled. Enable it in settings to use this command.");
          return;
        }
        await openConfigFile(plugin.app, currentSettings);
      }
    });
  }
}
async function standardizeProperties(app, settings, file, plugin, editor) {
  var _a;
  const currentSettings = (plugin == null ? void 0 : plugin.settings) || settings;
  const templateParser = new TemplateParser(app, currentSettings);
  const fileOps = new FileOperations(app, currentSettings, plugin);
  let cursorPosition = null;
  let originalContent = "";
  if (editor) {
    const cursor = editor.getCursor();
    cursorPosition = { line: cursor.line, ch: cursor.ch };
    originalContent = editor.getValue();
  }
  const type = fileOps.determineType(file);
  if (type === "note") {
    new import_obsidian5.Notice("No properties template specified for this content. This file doesn't match any configured content type folders.");
    return;
  }
  let templateString;
  if (type === "note") {
    new import_obsidian5.Notice("No properties template specified for this content. This file doesn't match any configured content type folders.");
    return;
  }
  const contentType = fileOps.getContentType(type);
  if (!contentType) {
    new import_obsidian5.Notice("Content type not found.");
    return;
  }
  templateString = contentType.template;
  await new Promise((resolve) => setTimeout(resolve, 100));
  const content = await app.vault.read(file);
  const title = file.basename.replace(/^_/, "");
  const parsed = templateParser.parseFrontmatter(content);
  const { templateProps, templateValues } = templateParser.parseTemplate(templateString, title);
  const finalProps = { ...parsed.properties };
  const arrayKeys = /* @__PURE__ */ new Set();
  const slug = toKebabCase(title);
  for (const key of templateProps) {
    if (!(key in parsed.properties)) {
      const templateValue = templateValues[key];
      if (Array.isArray(templateValue)) {
        finalProps[key] = templateValue;
        arrayKeys.add(key);
      } else {
        finalProps[key] = [templateValue || ""];
      }
    } else {
      const templateValue = templateValues[key];
      const isArrayValue = Array.isArray(templateValue);
      if (isArrayValue) {
        const existingItems = parsed.properties[key] || [];
        const newItems = templateValue.filter((item) => !existingItems.includes(item));
        finalProps[key] = [...existingItems, ...newItems];
        arrayKeys.add(key);
      } else {
        if (key === "slug") {
          const existingSlug = parsed.properties[key][0] || "";
          if (!existingSlug || existingSlug.trim() === "") {
            finalProps[key] = [slug];
          }
        }
      }
    }
  }
  if ("slug" in parsed.properties && templateString.includes("{{slug}}")) {
    const existingSlug = parsed.properties["slug"][0] || "";
    if (!existingSlug || existingSlug.trim() === "") {
      finalProps["slug"] = [slug];
    }
  }
  for (const key in parsed.properties) {
    if (parsed.properties[key].length > 1) {
      arrayKeys.add(key);
    }
  }
  const newContent = templateParser.buildFrontmatterContent(finalProps, arrayKeys) + parsed.bodyContent;
  await app.vault.modify(file, newContent);
  if (editor && cursorPosition) {
    await new Promise((resolve) => setTimeout(resolve, 50));
    const activeView = app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
    if (activeView && activeView.file === file && activeView.editor) {
      const activeEditor = activeView.editor;
      const newLineCount = newContent.split("\n").length;
      const originalLineCount = originalContent.split("\n").length;
      let newLine = cursorPosition.line;
      let newCh = cursorPosition.ch;
      if (newLineCount !== originalLineCount) {
        if (newLine >= newLineCount) {
          newLine = Math.max(0, newLineCount - 1);
        }
      }
      const newLineLength = ((_a = newContent.split("\n")[newLine]) == null ? void 0 : _a.length) || 0;
      if (newCh > newLineLength) {
        newCh = Math.max(0, newLineLength);
      }
      activeEditor.setCursor({ line: newLine, ch: newCh });
    }
  }
  new import_obsidian5.Notice("Properties standardized using template.");
}
function renameContentByPath(app, filePath, settings, plugin) {
  const file = app.vault.getAbstractFileByPath(filePath);
  if (!(file instanceof import_obsidian5.TFile)) {
    new import_obsidian5.Notice(`File not found: ${filePath}`);
    return;
  }
  const fileOps = new FileOperations(app, settings, plugin);
  function hasMatchingContentType(file2, settings2) {
    const type2 = fileOps.determineType(file2);
    if (type2 === "note") {
      return false;
    }
    const contentType = fileOps.getContentType(type2);
    return contentType !== null && contentType.enabled;
  }
  if (!hasMatchingContentType(file, settings)) {
    new import_obsidian5.Notice("Cannot rename: this file is not part of a configured content type folder.");
    return;
  }
  const type = fileOps.determineType(file);
  new TitleModal(app, file, plugin, type, true).open();
}
function registerContentTypeCommands(plugin, settings) {
  const pluginInterface = plugin;
  const contentTypes = settings.contentTypes || [];
  for (const contentType of contentTypes) {
    if (!contentType.enabled) {
      continue;
    }
    const commandId = `create-content-type-${contentType.id}`;
    const commandName = `Create new content type: ${contentType.name}`;
    plugin.addCommand({
      id: commandId,
      name: commandName,
      callback: async () => {
        let targetFolder = contentType.folder || "";
        if (targetFolder && targetFolder.trim() !== "") {
          const folder = plugin.app.vault.getAbstractFileByPath(targetFolder);
          if (!(folder instanceof import_obsidian5.TFolder)) {
            try {
              await plugin.app.vault.createFolder(targetFolder);
            } catch (error) {
              const errorMessage = error instanceof Error ? error.message : String(error);
              new import_obsidian5.Notice(`Failed to create folder: ${errorMessage}`);
              return;
            }
          }
        }
        const tempFileName = "Untitled.md";
        const filePath = targetFolder ? `${targetFolder}/${tempFileName}` : tempFileName;
        const existingFile = plugin.app.vault.getAbstractFileByPath(filePath);
        if (existingFile instanceof import_obsidian5.TFile) {
          new TitleModal(plugin.app, existingFile, pluginInterface, contentType.id, false, true).open();
          return;
        }
        if (pluginInterface && "pluginCreatedFiles" in pluginInterface) {
          pluginInterface.pluginCreatedFiles.set(filePath, Date.now());
        }
        try {
          const tempFile = await plugin.app.vault.create(filePath, "");
          new TitleModal(plugin.app, tempFile, pluginInterface, contentType.id, false, true).open();
        } catch (error) {
          const errorMessage = error instanceof Error ? error.message : String(error);
          new import_obsidian5.Notice(`Failed to create file: ${errorMessage}`);
          if (pluginInterface && "pluginCreatedFiles" in pluginInterface) {
            pluginInterface.pluginCreatedFiles.delete(filePath);
          }
        }
      }
    });
  }
}
var terminalLogger = {
  enabled: false,
  setEnabled(value) {
    this.enabled = value;
  },
  log(...args) {
    if (this.enabled) {
      console.debug("[astro-composer:terminal]", ...args);
    }
  }
};
function getDefaultTerminalApp() {
  if (!import_obsidian5.Platform.isDesktopApp) {
    return "";
  }
  if (import_obsidian5.Platform.isMacOS) {
    return "Terminal";
  }
  if (import_obsidian5.Platform.isWin) {
    try {
      const os = require("os");
      const release = os.release();
      const majorVersion = parseInt(release.split(".")[0]);
      const buildNumber = parseInt(release.split(".")[2]);
      if (majorVersion > 10 || majorVersion === 10 && buildNumber >= 22e3) {
        return "wt.exe";
      }
    } catch (e) {
    }
    return "cmd.exe";
  }
  if (import_obsidian5.Platform.isLinux) {
    return "gnome-terminal";
  }
  return "";
}
function sanitizeTerminalApp(value) {
  return value.trim();
}
function escapeDoubleQuotes(value) {
  return value.replace(/"/g, '\\"');
}
function openTerminalInProjectRoot(app, settings) {
  terminalLogger.setEnabled(settings.enableTerminalDebugLogging);
  try {
    const { exec } = require("child_process");
    const path = require("path");
    const fs = require("fs");
    const adapter = app.vault.adapter;
    const vaultPath = adapter.basePath || adapter.path;
    const vaultPathString = typeof vaultPath === "string" ? vaultPath : String(vaultPath);
    let projectPath;
    if (settings.terminalProjectRootPath && settings.terminalProjectRootPath.trim()) {
      projectPath = path.resolve(vaultPathString, settings.terminalProjectRootPath);
    } else {
      projectPath = vaultPathString;
    }
    if (!fs.existsSync(projectPath)) {
      new import_obsidian5.Notice(`Project root directory not found at: ${projectPath}`);
      return;
    }
    const configuredApp = sanitizeTerminalApp(settings.terminalApplicationName || "");
    const terminalApp = configuredApp || getDefaultTerminalApp();
    if (!configuredApp && !terminalApp) {
      new import_obsidian5.Notice("Terminal application name is empty. Please configure it in settings.");
      return;
    }
    const platform = process.platform;
    terminalLogger.log("Opening terminal", { platform, terminalApp, projectPath });
    if (platform === "win32") {
      const escapedPath = projectPath.replace(/"/g, '"');
      const lowerApp = terminalApp.toLowerCase();
      if (lowerApp === "wt.exe" || lowerApp === "wt" || lowerApp === "windows terminal") {
        exec("where wt", (error) => {
          if (!error) {
            const command = `start "" wt.exe -d "${escapedPath}"`;
            terminalLogger.log("Windows launch (wt)", { command, projectPath });
            exec(command, (execError) => {
              if (execError) {
                terminalLogger.log("Windows Terminal failed, falling back to cmd", { error: execError.message });
                const fallbackCommand = `start "" cmd.exe /K "cd /d "${escapedPath}""`;
                exec(fallbackCommand, (cmdError) => {
                  if (cmdError) {
                    new import_obsidian5.Notice(`Error opening terminal: ${cmdError.message || "Unknown error"}`);
                  }
                });
              }
            });
          } else {
            terminalLogger.log("Windows Terminal not found, using cmd", {});
            const fallbackCommand = `start "" cmd.exe /K "cd /d "${escapedPath}""`;
            exec(fallbackCommand, (cmdError) => {
              if (cmdError) {
                new import_obsidian5.Notice(`Error opening terminal: ${cmdError.message || "Unknown error"}`);
              }
            });
          }
        });
      } else if (lowerApp === "powershell" || lowerApp === "powershell.exe") {
        const escapedPathForPS = projectPath.replace(/'/g, "''");
        const command = `start "" powershell -NoExit -Command "Set-Location '${escapedPathForPS}';"`;
        terminalLogger.log("Windows launch (powershell)", { command, projectPath });
        exec(command, (error) => {
          if (error) {
            new import_obsidian5.Notice(`Error opening terminal: ${error.message || "Unknown error"}`);
          }
        });
      } else if (lowerApp === "cmd.exe" || lowerApp === "cmd") {
        const command = `start "" cmd.exe /K "cd /d "${escapedPath}""`;
        terminalLogger.log("Windows launch (cmd)", { command, projectPath });
        exec(command, (error) => {
          if (error) {
            new import_obsidian5.Notice(`Error opening terminal: ${error.message || "Unknown error"}`);
          }
        });
      } else {
        const command = `start "" "${terminalApp}"`;
        terminalLogger.log("Windows launch (generic)", { command, terminalApp, projectPath });
        exec(command, (error) => {
          if (error) {
            terminalLogger.log("Generic terminal failed, falling back to cmd", { error: error.message });
            const fallbackCommand = `start "" cmd.exe /K "cd /d "${escapedPath}""`;
            exec(fallbackCommand, (cmdError) => {
              if (cmdError) {
                new import_obsidian5.Notice(`Error opening terminal: ${cmdError.message || "Unknown error"}`);
              }
            });
          }
        });
      }
    } else if (platform === "darwin") {
      const escapedApp = escapeDoubleQuotes(terminalApp);
      const escapedPath = escapeDoubleQuotes(projectPath);
      const command = `open -na "${escapedApp}" "${escapedPath}"`;
      terminalLogger.log("macOS launch", { command, terminalApp, projectPath });
      exec(command, (error) => {
        if (error) {
          new import_obsidian5.Notice(`Error opening terminal: ${error.message || "Unknown error"}`);
        }
      });
    } else {
      const terminals = terminalApp ? [terminalApp] : ["gnome-terminal", "konsole", "xterm"];
      const projectPathEscaped = projectPath.replace(/"/g, '\\"');
      const tryTerminal = (index) => {
        if (index >= terminals.length) {
          new import_obsidian5.Notice("No supported terminal found. Please install a terminal application or configure one in settings.");
          return;
        }
        const currentTerminal = terminals[index];
        const terminalName = currentTerminal.split(" ")[0];
        exec(`which ${terminalName}`, (error) => {
          if (!error) {
            let command;
            if (currentTerminal.includes("gnome-terminal")) {
              command = `gnome-terminal --working-directory="${projectPathEscaped}"`;
            } else if (currentTerminal.includes("konsole")) {
              command = `konsole --workdir "${projectPathEscaped}"`;
            } else {
              command = `${currentTerminal} -e "cd \\"${projectPathEscaped}\\" && bash"`;
            }
            terminalLogger.log("Linux launch", { command, terminal: currentTerminal, projectPath });
            exec(command, (execError) => {
              if (execError && index < terminals.length - 1) {
                terminalLogger.log("Terminal launch failed, trying next", { terminal: currentTerminal, error: execError.message });
                tryTerminal(index + 1);
              } else if (execError) {
                new import_obsidian5.Notice(`Error opening terminal: ${execError.message || "Unknown error"}`);
              }
            });
          } else {
            terminalLogger.log("Terminal not found, trying next", { terminal: currentTerminal });
            tryTerminal(index + 1);
          }
        });
      };
      tryTerminal(0);
    }
  } catch (error) {
    terminalLogger.log("Unexpected error", { error });
    new import_obsidian5.Notice(`Error opening terminal: ${error instanceof Error ? error.message : String(error)}`);
  }
}
async function openConfigFile(app, settings) {
  try {
    const fs = require("fs");
    const path = require("path");
    const { shell } = require("electron");
    const adapter = app.vault.adapter;
    const vaultPath = adapter.basePath || adapter.path;
    const vaultPathString = typeof vaultPath === "string" ? vaultPath : String(vaultPath);
    if (!settings.configFilePath || !settings.configFilePath.trim()) {
      new import_obsidian5.Notice("Please specify a config file path in settings.");
      return;
    }
    const configPath = path.resolve(vaultPathString, settings.configFilePath);
    if (!fs.existsSync(configPath)) {
      new import_obsidian5.Notice(`Config file not found at: ${configPath}`);
      return;
    }
    await shell.openPath(configPath);
  } catch (error) {
    new import_obsidian5.Notice(`Error opening config file: ${error instanceof Error ? error.message : String(error)}`);
  }
}

// src/ui/settings-tab.ts
var import_obsidian10 = require("obsidian");

// src/ui/components/CommandPickerModal.ts
var import_obsidian6 = require("obsidian");
var CommandPickerModal = class extends import_obsidian6.FuzzySuggestModal {
  constructor(app, onSelect) {
    super(app);
    this.onSelect = onSelect;
  }
  getItems() {
    const commandRegistry = this.app.commands;
    const commandMap = /* @__PURE__ */ new Map();
    if (commandRegistry && typeof commandRegistry.listCommands === "function") {
      try {
        const commands = commandRegistry.listCommands();
        for (const command of commands) {
          if (command && command.id && command.name && !commandMap.has(command.id)) {
            commandMap.set(command.id, {
              id: command.id,
              name: command.name
            });
          }
        }
      } catch (e) {
        console.warn("[Astro Composer] Error getting commands via listCommands():", e);
      }
    }
    try {
      const registry = commandRegistry == null ? void 0 : commandRegistry.commands;
      if (registry && typeof registry === "object") {
        const allCommands = Object.values(registry);
        for (const command of allCommands) {
          if (command && command.id && command.name && !commandMap.has(command.id)) {
            commandMap.set(command.id, {
              id: command.id,
              name: command.name
            });
          }
        }
      }
    } catch (e) {
      console.warn("[Astro Composer] Error getting commands via registry:", e);
    }
    try {
      const internalRegistry = commandRegistry == null ? void 0 : commandRegistry.commandRegistry;
      if (internalRegistry && typeof internalRegistry === "object") {
        const allCommands = Object.values(internalRegistry);
        for (const command of allCommands) {
          if (command && command.id && command.name && !commandMap.has(command.id)) {
            commandMap.set(command.id, {
              id: command.id,
              name: command.name
            });
          }
        }
      }
    } catch (e) {
      console.warn("[Astro Composer] Error getting commands via internal registry:", e);
    }
    const commandOptions = Array.from(commandMap.values());
    commandOptions.sort((a, b) => a.name.localeCompare(b.name));
    return commandOptions;
  }
  getItemText(item) {
    return item.name;
  }
  onChooseItem(item, evt) {
    this.onSelect(item.id);
  }
  // Override to show command name only
  renderSuggestion(match, el) {
    const item = match.item;
    el.createDiv({ cls: "suggestion-title", text: item.name });
  }
};

// src/ui/components/IconPickerModal.ts
var import_obsidian7 = require("obsidian");
var getIconList = () => {
  if (import_obsidian7.requireApiVersion && (0, import_obsidian7.requireApiVersion)("1.7.3") && import_obsidian7.getIconIds) {
    try {
      return (0, import_obsidian7.getIconIds)();
    } catch (e) {
      console.warn("[Astro Composer] Error getting icon IDs from Obsidian:", e);
    }
  }
  return [
    "settings-2",
    "settings",
    "help-circle",
    "info",
    "star",
    "heart",
    "bookmark",
    "home",
    "search",
    "bell",
    "mail",
    "user",
    "users",
    "folder",
    "file",
    "file-text",
    "image",
    "video",
    "music",
    "calendar",
    "clock",
    "edit",
    "pencil",
    "trash",
    "copy",
    "cut",
    "paste",
    "download",
    "upload",
    "save",
    "share",
    "link",
    "external-link",
    "lock",
    "unlock",
    "eye",
    "eye-off",
    "key",
    "shield",
    "check",
    "x",
    "plus",
    "minus",
    "arrow-left",
    "arrow-right",
    "arrow-up",
    "arrow-down",
    "chevron-left",
    "chevron-right",
    "chevron-up",
    "chevron-down",
    "menu",
    "more-horizontal",
    "more-vertical",
    "grid",
    "list",
    "layout",
    "columns",
    "rows",
    "maximize",
    "minimize",
    "zoom-in",
    "zoom-out",
    "refresh-cw",
    "play",
    "pause",
    "stop",
    "sun",
    "moon",
    "cloud",
    "zap",
    "wand-2",
    "wand",
    "wand-sparkles",
    "palette",
    "brush",
    "sliders",
    "power",
    "wifi",
    "bluetooth",
    "monitor",
    "laptop",
    "smartphone",
    "camera",
    "mic",
    "headphones",
    "code",
    "terminal",
    "terminal-square",
    "github",
    "gitlab",
    "git-branch",
    "git-commit",
    "database",
    "server",
    "cloud-download",
    "cloud-upload",
    "tag",
    "tags",
    "flag",
    "pin",
    "map-pin",
    "compass",
    "globe",
    "rocket",
    "car",
    "bike",
    "robot",
    "apple",
    "windows",
    "linux",
    "chrome",
    "firefox",
    "safari",
    "credit-card",
    "wallet",
    "coins",
    "book",
    "book-open",
    "award",
    "trophy",
    "badge",
    "wrench",
    "tool",
    "package",
    "box",
    "archive",
    "send",
    "reply",
    "forward",
    "mail-open",
    "tag-plus",
    "tag-minus",
    "flag-off",
    "pin-off",
    "map-pin-off",
    "navigation",
    "map",
    "earth",
    "plane",
    "ship",
    "anchor",
    "helicopter",
    "drone",
    "android",
    "keyhole",
    "keys",
    "fingerprint",
    "scan",
    "qr-code",
    "barcode",
    "receipt",
    "piggy-bank",
    "banknote"
  ];
};
var LUCIDE_ICONS = getIconList().map((id) => ({
  id,
  name: id.replace(/^lucide-/, "").replace(/-/g, " ").replace(/(^\w{1})|(\s+\w{1})/g, (letter) => letter.toUpperCase())
})).sort((a, b) => a.name.localeCompare(b.name));
var IconPickerModal = class extends import_obsidian7.FuzzySuggestModal {
  constructor(app, onSelect) {
    super(app);
    this.onSelect = onSelect;
  }
  getItems() {
    return LUCIDE_ICONS;
  }
  getItemText(item) {
    return item.name;
  }
  onChooseItem(item, evt) {
    const normalizedId = item.id.replace(/^lucide-/, "");
    this.onSelect(normalizedId);
  }
  // Override to show icon preview
  renderSuggestion(match, el) {
    const item = match.item;
    el.addClass("mod-complex");
    const content = el.createDiv({ cls: "suggestion-content" });
    content.createDiv({ cls: "suggestion-title", text: item.name });
    const aux = el.createDiv({ cls: "suggestion-aux" });
    (0, import_obsidian7.setIcon)(aux.createSpan({ cls: "suggestion-flair" }), item.id);
  }
};

// src/ui/components/ConfirmModal.ts
var import_obsidian8 = require("obsidian");
var ConfirmModal = class extends import_obsidian8.Modal {
  constructor(app, message, confirmText = "Confirm", cancelText = "Cancel") {
    super(app);
    this.message = message;
    this.confirmText = confirmText;
    this.cancelText = cancelText;
    this.result = false;
    this.resolvePromise = null;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("astro-composer-confirm-modal");
    contentEl.createEl("p", { text: this.message });
    const buttonContainer = contentEl.createDiv({ cls: "modal-button-container" });
    const cancelButton = buttonContainer.createEl("button", {
      text: this.cancelText
    });
    cancelButton.onclick = () => {
      this.result = false;
      this.close();
    };
    const confirmButton = buttonContainer.createEl("button", {
      text: this.confirmText,
      cls: "mod-cta mod-warning"
    });
    confirmButton.onclick = () => {
      this.result = true;
      this.close();
    };
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    if (this.resolvePromise) {
      this.resolvePromise(this.result);
    }
  }
  async waitForResult() {
    return new Promise((resolve) => {
      this.resolvePromise = resolve;
      this.open();
    });
  }
};

// src/utils/settings-compat.ts
var import_obsidian9 = require("obsidian");
var ObsidianModule = __toESM(require("obsidian"), 1);
function createSettingsGroup(containerEl, heading, manifestId) {
  if ((0, import_obsidian9.requireApiVersion)("1.11.0")) {
    const SettingGroupClass = ObsidianModule.SettingGroup;
    if (SettingGroupClass) {
      const group = heading ? new SettingGroupClass(containerEl).setHeading(heading) : new SettingGroupClass(containerEl);
      return {
        addSetting(cb) {
          group.addSetting(cb);
        }
      };
    }
  }
  if (manifestId) {
    containerEl.addClass(`${manifestId}-settings-compat`);
  }
  {
    if (heading) {
      const headingEl = containerEl.createDiv("setting-group-heading");
      headingEl.createEl("h3", { text: heading });
    }
    return {
      addSetting(cb) {
        const setting = new import_obsidian9.Setting(containerEl);
        cb(setting);
      }
    };
  }
}

// src/ui/settings-tab.ts
var AstroComposerSettingTab = class extends import_obsidian10.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.icon = "lucide-pencil-line";
    this.autoRenameContainer = null;
    this.postsFolderContainer = null;
    this.onlyAutomateContainer = null;
    this.creationModeContainer = null;
    this.indexFileContainer = null;
    this.excludedDirsContainer = null;
    this.underscorePrefixContainer = null;
    this.autoInsertContainer = null;
    this.pagesFieldsContainer = null;
    this.pagesIndexFileContainer = null;
    this.pagesOnlyAutomateContainer = null;
    this.terminalCommandContainer = null;
    this.configCommandContainer = null;
    this.customContentTypesContainer = null;
    this.terminalRibbonToggle = null;
    this.configRibbonToggle = null;
    this.terminalRibbonToggleComponent = null;
    this.configRibbonToggleComponent = null;
    this.plugin = plugin;
  }
  /**
   * Refresh just the content types section
   * More efficient than refreshing the entire settings tab
   */
  refreshContentTypes() {
    if (this.customContentTypesContainer) {
      this.renderCustomContentTypes();
    }
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    const settings = this.plugin.settings;
    this.renderSettingsTab(containerEl, settings);
  }
  renderSettingsTab(containerEl, settings) {
    var _a;
    const generalGroup = createSettingsGroup(containerEl, void 0, "astro-composer");
    generalGroup.addSetting((setting) => {
      setting.setName("Date format").setDesc("Format for the date in properties (e.g., yyyy-mm-dd, MMMM D, yyyy, yyyy-mm-dd HH:mm)").addText(
        (text) => text.setPlaceholder("YYYY-MM-DD").setValue(settings.dateFormat).onChange(async (value) => {
          settings.dateFormat = value || "YYYY-MM-DD";
          await this.plugin.saveSettings();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Enable copy heading links").setDesc("Add right-click context menu option to copy heading links in various formats.").addToggle(
        (toggle) => toggle.setValue(settings.enableCopyHeadingLink).onChange(async (value) => {
          settings.enableCopyHeadingLink = value;
          await this.plugin.saveSettings();
          this.updateCopyHeadingFields();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Default heading link format").setDesc("Choose the default format for copied heading links. Obsidian format respects your Obsidian settings for wikilink vs markdown preference. Astro link uses your link base path from above and converts the heading into kebab-case format as an anchor link").addDropdown(
        (dropdown) => dropdown.addOption("obsidian", "Obsidian link").addOption("astro", "Astro link").setValue(settings.copyHeadingLinkFormat).onChange(async (value) => {
          settings.copyHeadingLinkFormat = value;
          await this.plugin.saveSettings();
        })
      );
      setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableCopyHeadingLink);
      setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableCopyHeadingLink);
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Add trailing slash to links").setDesc("Add trailing slashes to all converted internal links (e.g., /about/ instead of /about).").addToggle(
        (toggle) => toggle.setValue(settings.addTrailingSlashToLinks).onChange(async (value) => {
          settings.addTrailingSlashToLinks = value;
          await this.plugin.saveSettings();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Process background file changes").setDesc("Automatically process new files when they're changed in the background (by Git or other plugins). Disable to prevent modal spam when files are already processed on other devices during a sync.").addToggle(
        (toggle) => toggle.setValue(settings.processBackgroundFileChanges).onChange(async (value) => {
          settings.processBackgroundFileChanges = value;
          await this.plugin.saveSettings();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Show MDX files in file explorer").setDesc("Make .mdx files visible in Obsidian's file explorer. Requires reload to take effect.").addToggle(
        (toggle) => toggle.setValue(settings.showMdxFilesInExplorer).onChange(async (value) => {
          settings.showMdxFilesInExplorer = value;
          await this.plugin.saveSettings();
        })
      );
    });
    const automationGroup = createSettingsGroup(containerEl, "Property automation", "astro-composer");
    automationGroup.addSetting((setting) => {
      setting.setName("Auto-insert properties").setDesc("Automatically insert the properties template when creating new files.").addToggle(
        (toggle) => toggle.setValue(settings.autoInsertProperties).onChange(async (value) => {
          settings.autoInsertProperties = value;
          await this.plugin.saveSettings();
        })
      );
    });
    let draftPropertySetting;
    let draftLogicSetting;
    let publishDateFieldSetting;
    automationGroup.addSetting((setting) => {
      setting.setName("Update date on publish").setDesc("Update 'date' property when switching from draft to published status.").addToggle(
        (toggle) => toggle.setValue(settings.syncDraftDate).onChange(async (value) => {
          settings.syncDraftDate = value;
          await this.plugin.saveSettings();
          if (draftPropertySetting) draftPropertySetting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !value);
          if (draftLogicSetting) draftLogicSetting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !value);
          if (publishDateFieldSetting) publishDateFieldSetting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !value);
        })
      );
    });
    automationGroup.addSetting((setting) => {
      draftPropertySetting = setting;
      setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.syncDraftDate);
      setting.setName("Draft property name").setDesc("The property field to use for draft status.").addText(
        (text) => text.setPlaceholder("draft").setValue(settings.draftProperty || "").onChange(async (value) => {
          var _a2;
          settings.draftProperty = value;
          await this.plugin.saveSettings();
          (_a2 = this.plugin.frontmatterService) == null ? void 0 : _a2.initializeDraftStatusMap();
        })
      );
    });
    automationGroup.addSetting((setting) => {
      draftLogicSetting = setting;
      setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.syncDraftDate);
      setting.setName("Draft logic").setDesc("Whether the property value 'true' means it is a draft or published.").addDropdown(
        (dropdown) => dropdown.addOption("true-is-draft", "True = Draft").addOption("false-is-draft", "True = Published").setValue(settings.draftLogic || "true-is-draft").onChange(async (value) => {
          var _a2;
          settings.draftLogic = value;
          await this.plugin.saveSettings();
          (_a2 = this.plugin.frontmatterService) == null ? void 0 : _a2.initializeDraftStatusMap();
        })
      );
    });
    automationGroup.addSetting((setting) => {
      publishDateFieldSetting = setting;
      setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.syncDraftDate);
      setting.setName("Published date property name").setDesc("The property field to update when published (e.g., 'date' or 'pubDate').").addText(
        (text) => text.setPlaceholder("date").setValue(settings.publishDateField || "").onChange(async (value) => {
          settings.publishDateField = value;
          await this.plugin.saveSettings();
        })
      );
    });
    let modifiedDateFieldSetting;
    automationGroup.addSetting((setting) => {
      setting.setName("Update modified date").setDesc("Automatically update a property with current date when a file is edited.").addToggle(
        (toggle) => toggle.setValue(settings.updateModifiedDate).onChange(async (value) => {
          settings.updateModifiedDate = value;
          await this.plugin.saveSettings();
          if (modifiedDateFieldSetting) {
            modifiedDateFieldSetting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !value);
          }
        })
      );
    });
    automationGroup.addSetting((setting) => {
      modifiedDateFieldSetting = setting;
      setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.updateModifiedDate);
      setting.setName("Modified date property name").setDesc("The property field to update with the modified date.").addText(
        (text) => text.setPlaceholder("modified").setValue(settings.modifiedDateField || "").onChange(async (value) => {
          settings.modifiedDateField = value;
          await this.plugin.saveSettings();
        })
      );
    });
    const contentTypesGroup = createSettingsGroup(containerEl, "Content types", "astro-composer");
    contentTypesGroup.addSetting((setting) => {
      setting.settingEl.addClass("astro-composer-setting-hidden-elements");
      setting.settingEl.addClass("astro-composer-setting-container-full-width");
      this.customContentTypesContainer = setting.settingEl.createDiv({
        cls: "custom-content-types-container astro-composer-custom-types-container-visible"
      });
    });
    if (this.customContentTypesContainer) {
      this.renderCustomContentTypes();
    }
    if (!import_obsidian10.Platform.isMobile) {
      const developerGroup = createSettingsGroup(containerEl, "Developer commands", "astro-composer");
      developerGroup.addSetting((setting) => {
        setting.setName("Enable open terminal command").setDesc("Enable command to open terminal in project root directory.").addToggle(
          (toggle) => toggle.setValue(settings.enableOpenTerminalCommand).onChange(async (value) => {
            settings.enableOpenTerminalCommand = value;
            await this.plugin.saveSettings();
            this.updateTerminalCommandFields();
            if (this.plugin.registerRibbonIcons) {
              this.plugin.registerRibbonIcons();
            }
          })
        );
      });
      this.terminalCommandContainer = containerEl.createDiv({ cls: "terminal-command-fields" });
      this.terminalCommandContainer.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
      this.terminalCommandContainer.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
      developerGroup.addSetting((setting) => {
        const descFragment = document.createDocumentFragment();
        descFragment.createEl("div", { text: "Path relative to the Obsidian vault root folder. Use ../.. for two levels up. Leave blank to use the vault folder" });
        descFragment.createEl("div", { text: "This is where the terminal will open. Absolute paths work also." });
        setting.setName("Project root directory path").setDesc(descFragment).addText(
          (text) => text.setPlaceholder("../..").setValue(settings.terminalProjectRootPath).onChange(async (value) => {
            settings.terminalProjectRootPath = value;
            await this.plugin.saveSettings();
          })
        );
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
      });
      developerGroup.addSetting((setting) => {
        const descFragment = document.createDocumentFragment();
        descFragment.createEl("div", { text: "Leave blank to use platform defaults. On macOS, the default is Terminal. On Windows, it's Windows Terminal (Win 11) or cmd.exe (Win 10). On Linux, it's gnome-terminal, konsole, or xterm" });
        descFragment.createEl("div", { text: "Examples include Terminal, iTerm, PowerShell, and Alacritty" });
        setting.setName("Terminal application name").setDesc(descFragment).addText(
          (text) => text.setPlaceholder("Terminal").setValue(settings.terminalApplicationName).onChange(async (value) => {
            settings.terminalApplicationName = value;
            await this.plugin.saveSettings();
          })
        );
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Enable debug logging").setDesc("Log terminal launch commands and platform decisions to the developer console for troubleshooting.").addToggle(
          (toggle) => toggle.setValue(settings.enableTerminalDebugLogging).onChange(async (value) => {
            settings.enableTerminalDebugLogging = value;
            await this.plugin.saveSettings();
          })
        );
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Show open terminal ribbon icon").setDesc("Add a ribbon icon to launch the terminal command.").addToggle((toggle) => {
          this.terminalRibbonToggleComponent = toggle;
          toggle.setValue(settings.enableTerminalRibbonIcon).setDisabled(!settings.enableOpenTerminalCommand).onChange(async (value) => {
            this.plugin.settings.enableTerminalRibbonIcon = value;
            settings.enableTerminalRibbonIcon = value;
            await this.plugin.saveSettings();
            setTimeout(() => {
              if (this.plugin.registerRibbonIcons) {
                this.plugin.registerRibbonIcons();
              }
            }, 50);
          });
        });
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
        this.terminalRibbonToggle = setting;
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Enable edit config file command").setDesc("Enable command to open astro config file in default editor.").addToggle(
          (toggle) => toggle.setValue(settings.enableOpenConfigFileCommand).onChange(async (value) => {
            settings.enableOpenConfigFileCommand = value;
            await this.plugin.saveSettings();
            this.updateConfigCommandFields();
            if (this.plugin.registerRibbonIcons) {
              this.plugin.registerRibbonIcons();
            }
          })
        );
      });
      this.configCommandContainer = containerEl.createDiv({ cls: "config-command-fields" });
      this.configCommandContainer.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenConfigFileCommand);
      this.configCommandContainer.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenConfigFileCommand);
      developerGroup.addSetting((setting) => {
        const descFragment = document.createDocumentFragment();
        descFragment.createEl("div", { text: "Path to the config file relative to the vault root. Use ../config.ts or ../../astro.config.mjs." });
        descFragment.createEl("div", { text: "Absolute paths work also." });
        setting.setName("Config file path").setDesc(descFragment).addText(
          (text) => text.setPlaceholder("../config.ts").setValue(settings.configFilePath).onChange(async (value) => {
            settings.configFilePath = value;
            await this.plugin.saveSettings();
          })
        );
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenConfigFileCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenConfigFileCommand);
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Show open config ribbon icon").setDesc("Add a ribbon icon to launch the config file command.").addToggle((toggle) => {
          this.configRibbonToggleComponent = toggle;
          toggle.setValue(settings.enableConfigRibbonIcon).setDisabled(!settings.enableOpenConfigFileCommand).onChange(async (value) => {
            this.plugin.settings.enableConfigRibbonIcon = value;
            settings.enableConfigRibbonIcon = value;
            await this.plugin.saveSettings();
            setTimeout(() => {
              if (this.plugin.registerRibbonIcons) {
                this.plugin.registerRibbonIcons();
              }
            }, 50);
          });
        });
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenConfigFileCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenConfigFileCommand);
        this.configRibbonToggle = setting;
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Swap out help button for custom action").setDesc("Replace the help button in the vault profile area with a custom action.").addToggle((toggle) => {
          var _a2, _b;
          return toggle.setValue((_b = (_a2 = settings.helpButtonReplacement) == null ? void 0 : _a2.enabled) != null ? _b : false).onChange(async (value) => {
            if (!settings.helpButtonReplacement) {
              settings.helpButtonReplacement = {
                enabled: false,
                commandId: "edit-astro-config",
                iconId: "rocket"
              };
            }
            settings.helpButtonReplacement.enabled = value;
            await this.plugin.saveSettings();
            if (this.plugin.updateHelpButton) {
              await this.plugin.updateHelpButton();
            }
            this.display();
          });
        });
      });
      if ((_a = settings.helpButtonReplacement) == null ? void 0 : _a.enabled) {
        const commandName = this.getCommandName(settings.helpButtonReplacement.commandId);
        developerGroup.addSetting((setting) => {
          setting.setName("Command").setDesc("Select the command to execute when the button is clicked.").addButton((button) => button.setButtonText(commandName || "Select command").onClick(() => {
            const modal = new CommandPickerModal(this.app, (commandId) => {
              void (async () => {
                if (!settings.helpButtonReplacement) {
                  settings.helpButtonReplacement = {
                    enabled: true,
                    commandId: "edit-astro-config",
                    iconId: "rocket"
                  };
                }
                settings.helpButtonReplacement.commandId = commandId;
                await this.plugin.saveSettings();
                if (this.plugin.updateHelpButton) {
                  await this.plugin.updateHelpButton();
                }
                this.display();
              })();
            });
            modal.open();
          }));
        });
        const iconName = this.getIconName(settings.helpButtonReplacement.iconId);
        developerGroup.addSetting((setting) => {
          setting.setName("Icon").setDesc("Select the icon to display on the button.").addButton((button) => button.setButtonText(iconName || "Select icon...").onClick(() => {
            const modal = new IconPickerModal(this.app, (iconId) => {
              void (async () => {
                if (!settings.helpButtonReplacement) {
                  settings.helpButtonReplacement = {
                    enabled: true,
                    commandId: "edit-astro-config",
                    iconId: "rocket"
                  };
                }
                settings.helpButtonReplacement.iconId = iconId;
                await this.plugin.saveSettings();
                if (this.plugin.updateHelpButton) {
                  await this.plugin.updateHelpButton();
                }
                this.display();
              })();
            });
            modal.open();
          }));
        });
      }
    }
    this.updateCopyHeadingFields();
    if (!import_obsidian10.Platform.isMobile) {
      this.updateTerminalCommandFields();
      this.updateConfigCommandFields();
    }
  }
  updateCopyHeadingFields() {
    const settings = this.plugin.settings;
    const isVisible = settings.enableCopyHeadingLink;
    const containerEl = this.containerEl;
    const allSettings = containerEl.querySelectorAll(".setting-item");
    allSettings.forEach((settingEl) => {
      var _a;
      const nameEl = settingEl.querySelector(".setting-item-name");
      if (nameEl && ((_a = nameEl.textContent) == null ? void 0 : _a.trim()) === "Default heading link format") {
        settingEl.classList.toggle("astro-composer-setting-container-visible", isVisible);
        settingEl.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
      }
    });
  }
  updateTerminalCommandFields() {
    const settings = this.plugin.settings;
    const isVisible = settings.enableOpenTerminalCommand;
    if (this.terminalCommandContainer) {
      this.terminalCommandContainer.classList.toggle("astro-composer-setting-container-visible", isVisible);
      this.terminalCommandContainer.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
    }
    const containerEl = this.containerEl;
    const allSettings = containerEl.querySelectorAll(".setting-item");
    allSettings.forEach((settingEl) => {
      var _a;
      const nameEl = settingEl.querySelector(".setting-item-name");
      if (nameEl) {
        const name = (_a = nameEl.textContent) == null ? void 0 : _a.trim();
        if (name === "Project root directory path" || name === "Show open terminal ribbon icon") {
          settingEl.classList.toggle("astro-composer-setting-container-visible", isVisible);
          settingEl.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
        }
      }
    });
    if (this.terminalRibbonToggleComponent) {
      this.terminalRibbonToggleComponent.setDisabled(!this.plugin.settings.enableOpenTerminalCommand);
    }
  }
  updateConfigCommandFields() {
    const settings = this.plugin.settings;
    const isVisible = settings.enableOpenConfigFileCommand;
    if (this.configCommandContainer) {
      this.configCommandContainer.classList.toggle("astro-composer-setting-container-visible", isVisible);
      this.configCommandContainer.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
    }
    const containerEl = this.containerEl;
    const allSettings = containerEl.querySelectorAll(".setting-item");
    allSettings.forEach((settingEl) => {
      var _a;
      const nameEl = settingEl.querySelector(".setting-item-name");
      if (nameEl) {
        const name = (_a = nameEl.textContent) == null ? void 0 : _a.trim();
        if (name === "Config file path" || name === "Show open config ribbon icon") {
          settingEl.classList.toggle("astro-composer-setting-container-visible", isVisible);
          settingEl.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
        }
      }
    });
    if (this.configRibbonToggleComponent) {
      this.configRibbonToggleComponent.setDisabled(!this.plugin.settings.enableOpenConfigFileCommand);
    }
  }
  checkForFolderConflicts() {
    const settings = this.plugin.settings;
    const blankFolders = [];
    const folderConflicts = {};
    const contentTypes = settings.contentTypes || [];
    for (const contentType of contentTypes) {
      if (contentType.enabled) {
        if (!contentType.folder || contentType.folder.trim() === "") {
          blankFolders.push(contentType.name || "Content");
        } else {
          if (!folderConflicts[contentType.folder]) {
            folderConflicts[contentType.folder] = [];
          }
          folderConflicts[contentType.folder].push(contentType.name || "Content");
        }
      }
    }
  }
  addCustomContentType() {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    const newType = {
      id: `content-${Date.now()}`,
      name: `Content ${contentTypes.length + 1}`,
      folder: "",
      linkBasePath: "",
      template: '---\ntitle: "{{title}}"\ndate: {{date}}\n---\n',
      enabled: true,
      creationMode: "file",
      indexFileName: "",
      ignoreSubfolders: false,
      enableUnderscorePrefix: false,
      useMdxExtension: false
    };
    contentTypes.push(newType);
    settings.contentTypes = contentTypes;
    void this.plugin.saveSettings();
    this.renderCustomContentTypes();
    this.plugin.registerCreateEvent();
    registerContentTypeCommands(this.plugin, settings);
  }
  renderCustomContentTypes() {
    if (!this.customContentTypesContainer) return;
    this.customContentTypesContainer.empty();
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    contentTypes.forEach((customType, index) => {
      var _a, _b;
      if (!this.customContentTypesContainer) return;
      const typeContainer = this.customContentTypesContainer.createDiv({
        cls: "custom-content-type-item",
        attr: { "data-type-id": customType.id }
      });
      const header = typeContainer.createDiv({ cls: "custom-content-type-header" });
      header.classList.add("astro-composer-custom-type-header");
      const collapseButton = header.createEl("button", {
        cls: "astro-composer-collapse-button",
        attr: { "aria-label": "Collapse/expand" }
      });
      const isCollapsed = (_a = customType.collapsed) != null ? _a : false;
      (0, import_obsidian10.setIcon)(collapseButton, "chevron-down");
      if (isCollapsed) {
        collapseButton.classList.add("is-collapsed");
      }
      collapseButton.addEventListener("click", () => {
        void this.toggleContentTypeCollapse(customType.id);
        const updatedType = this.plugin.settings.contentTypes.find((ct) => ct.id === customType.id);
        if (updatedType) {
          if (updatedType.collapsed) {
            collapseButton.classList.add("is-collapsed");
          } else {
            collapseButton.classList.remove("is-collapsed");
          }
        }
      });
      const headerName = header.createDiv({ cls: "astro-composer-header-name" });
      headerName.createEl("div", { text: customType.name || `Content ${index + 1}`, cls: "setting-item-name" });
      const reorderContainer = header.createDiv({ cls: "astro-composer-reorder-buttons" });
      const upButton = reorderContainer.createEl("button", {
        cls: "astro-composer-reorder-button",
        attr: { "aria-label": "Move up" }
      });
      (0, import_obsidian10.setIcon)(upButton, "chevron-up");
      upButton.disabled = index === 0;
      upButton.addEventListener("click", () => {
        void this.moveContentTypeUp(customType.id);
      });
      const downButton = reorderContainer.createEl("button", {
        cls: "astro-composer-reorder-button",
        attr: { "aria-label": "Move down" }
      });
      (0, import_obsidian10.setIcon)(downButton, "chevron-down");
      downButton.disabled = index === contentTypes.length - 1;
      downButton.addEventListener("click", () => {
        void this.moveContentTypeDown(customType.id);
      });
      const toggleContainer = header.createDiv({ cls: "checkbox-container" });
      if (customType.enabled) {
        toggleContainer.classList.add("is-enabled");
      }
      const toggle = toggleContainer.createEl("input", { type: "checkbox", cls: "checkbox-input" });
      toggle.checked = customType.enabled;
      toggleContainer.addEventListener("click", (e) => {
        void (async () => {
          e.preventDefault();
          const newValue = !customType.enabled;
          customType.enabled = newValue;
          toggle.checked = newValue;
          await this.plugin.saveSettings();
          this.plugin.registerCreateEvent();
          if (newValue) {
            toggleContainer.classList.add("is-enabled");
          } else {
            toggleContainer.classList.remove("is-enabled");
          }
          this.updateCustomContentTypeVisibility(customType.id, newValue);
          registerContentTypeCommands(this.plugin, this.plugin.settings);
        })();
      });
      toggle.addEventListener("change", (e) => {
        void (async () => {
          const value = e.target.checked;
          customType.enabled = value;
          await this.plugin.saveSettings();
          this.plugin.registerCreateEvent();
          if (value) {
            toggleContainer.classList.add("is-enabled");
          } else {
            toggleContainer.classList.remove("is-enabled");
          }
          this.updateCustomContentTypeVisibility(customType.id, value);
          registerContentTypeCommands(this.plugin, this.plugin.settings);
        })();
      });
      const settingsContainer = typeContainer.createDiv({
        cls: "custom-content-type-settings",
        attr: { "data-type-id": customType.id }
      });
      const initiallyCollapsed = (_b = customType.collapsed) != null ? _b : false;
      const initiallyVisible = customType.enabled && !initiallyCollapsed;
      if (initiallyVisible) {
        settingsContainer.classList.add("astro-composer-setting-container-visible");
      } else {
        settingsContainer.classList.add("astro-composer-setting-container-hidden");
      }
      const nameContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(nameContainer).setName("Content type name").setDesc("Display name for this content type (e.g., 'projects', 'notes', 'tutorials')").addText((text) => {
        text.setPlaceholder("Enter content type name").setValue(customType.name).onChange(async (value) => {
          customType.name = value;
          await this.plugin.saveSettings();
          registerContentTypeCommands(this.plugin, this.plugin.settings);
        });
      });
      const folderContainer = settingsContainer.createDiv();
      const folderSetting = new import_obsidian10.Setting(folderContainer).setName("Folder location").setDesc("Folder path where this content type will be created. Leave blank to use the vault folder. Supports wildcards like directory/* or directory/*/* to match specific folder depths.").addText((text) => {
        text.setPlaceholder("Enter folder path (e.g., 'docs', 'docs/*', 'docs/*/*') or leave blank for vault root").setValue(customType.folder).onChange(async (value) => {
          customType.folder = value;
          await this.plugin.saveSettings();
          this.plugin.registerCreateEvent();
          this.updateCustomContentTypeIgnoreSubfoldersField(customType.id);
          const allContentTypes = this.plugin.settings.contentTypes || [];
          for (const ct of allContentTypes) {
            this.updateFolderConflictWarning(ct.id, null);
          }
        });
      });
      folderContainer.createDiv({ cls: "astro-composer-conflict-warning hidden", attr: { "data-type-id": customType.id } });
      this.updateFolderConflictWarning(customType.id, folderSetting);
      const ignoreSubfoldersContainer = settingsContainer.createDiv({ cls: "custom-ignore-subfolders-field" });
      ignoreSubfoldersContainer.setAttribute("data-type-id", customType.id);
      ignoreSubfoldersContainer.classList.toggle("astro-composer-setting-container-visible", !!customType.folder);
      ignoreSubfoldersContainer.classList.toggle("astro-composer-setting-container-hidden", !customType.folder);
      new import_obsidian10.Setting(ignoreSubfoldersContainer).setName("Ignore subfolders").setDesc("When enabled, automation will only trigger for new .md files within this content type's folder and one level down (for folder-based content). Files in deeper subfolders will be ignored.").addToggle(
        (toggle2) => toggle2.setValue(customType.ignoreSubfolders || false).onChange(async (value) => {
          customType.ignoreSubfolders = value;
          await this.plugin.saveSettings();
        })
      );
      const underscorePrefixContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(underscorePrefixContainer).setName("Use underscore prefix for drafts").setDesc("Add an underscore prefix (_content-title) to new notes by default when enabled. This hides them from astro, which can be helpful for drafts").addToggle(
        (toggle2) => toggle2.setValue(customType.enableUnderscorePrefix || false).onChange(async (value) => {
          customType.enableUnderscorePrefix = value;
          await this.plugin.saveSettings();
        })
      );
      const linkContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(linkContainer).setName("Link base path").setDesc("Base path for converted links (e.g., '/projects/', '/notes/tutorials/', leave blank for root /).").addText((text) => {
        text.setPlaceholder("Enter link base path").setValue(customType.linkBasePath || "").onChange(async (value) => {
          customType.linkBasePath = value;
          await this.plugin.saveSettings();
        });
      });
      const creationModeContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(creationModeContainer).setName("Creation mode").setDesc("How to create new entries: file-based or folder-based with an index file.").addDropdown(
        (dropdown) => dropdown.addOption("file", "File-based (content-title.md)").addOption("folder", "Folder-based (content-title/index.md)").setValue(customType.creationMode).onChange(async (value) => {
          customType.creationMode = value;
          await this.plugin.saveSettings();
          this.updateCustomContentTypeIndexFileField(customType.id);
        })
      );
      const useMdxContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(useMdxContainer).setName("Use MDX instead of MD").setDesc("Create files with .mdx extension instead of .md extension.").addToggle(
        (toggle2) => toggle2.setValue(customType.useMdxExtension || false).onChange(async (value) => {
          customType.useMdxExtension = value;
          await this.plugin.saveSettings();
        })
      );
      const indexFileContainer = settingsContainer.createDiv({ cls: "custom-index-file-field" });
      indexFileContainer.classList.toggle("astro-composer-setting-container-visible", customType.creationMode === "folder");
      indexFileContainer.classList.toggle("astro-composer-setting-container-hidden", customType.creationMode !== "folder");
      new import_obsidian10.Setting(indexFileContainer).setName("Index file name").setDesc("Name for index files in folder-based content (without .md extension). Defaults to 'index' if left blank.").addText(
        (text) => text.setPlaceholder("Index").setValue(customType.indexFileName).onChange(async (value) => {
          customType.indexFileName = value;
          await this.plugin.saveSettings();
        })
      );
      const templateContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(templateContainer).setName("Properties template").addTextArea((text) => {
        text.setPlaceholder('---\ntitle: "{{title}}"\ndate: {{date}}\n---\n').setValue(customType.template).onChange(async (value) => {
          customType.template = value;
          await this.plugin.saveSettings();
        });
        text.inputEl.classList.add("astro-composer-template-textarea");
        return text;
      }).then((setting) => {
        setting.descEl.empty();
        const descDiv = setting.descEl.createEl("div");
        descDiv.createEl("div", { text: "Template for new files of this content type." });
        descDiv.createEl("div", { text: "Variables include {{title}}, {{date}}, and {{slug}}." });
        descDiv.createEl("div", { text: "Do not wrap {{date}} in quotes as it represents a datetime value, not a string." });
      });
      const removeContainer = settingsContainer.createDiv();
      const removeSetting = new import_obsidian10.Setting(removeContainer).setName("").addButton((button) => {
        button.setButtonText("Remove").setWarning().onClick(async () => {
          const contentType = this.plugin.settings.contentTypes.find((ct) => ct.id === customType.id);
          const typeName = (contentType == null ? void 0 : contentType.name) || "content type";
          const modal = new ConfirmModal(
            this.app,
            `Are you sure you want to remove "${typeName}"? This action cannot be undone.`,
            "Remove",
            "Cancel"
          );
          const confirmed = await modal.waitForResult();
          if (confirmed) {
            await this.removeCustomContentType(customType.id);
          }
        });
      });
      removeSetting.settingEl.classList.add("astro-composer-remove-setting");
      this.updateCustomContentTypeVisibility(customType.id, customType.enabled);
    });
    contentTypes.forEach((customType) => {
      this.updateFolderConflictWarning(customType.id, null);
    });
    const addButtonContainer = this.customContentTypesContainer.createDiv({ cls: "astro-composer-add-button-container" });
    const addButton = addButtonContainer.createEl("button", {
      cls: "mod-cta",
      text: "Add content type"
    });
    addButton.addEventListener("click", () => {
      this.addCustomContentType();
    });
  }
  updateCustomContentTypeVisibility(typeId, enabled) {
    var _a, _b;
    const settingsContainer = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"].custom-content-type-settings`);
    if (settingsContainer) {
      const contentTypes = this.plugin.settings.contentTypes || [];
      const contentType = contentTypes.find((ct) => ct.id === typeId);
      const isCollapsed = (_b = contentType == null ? void 0 : contentType.collapsed) != null ? _b : false;
      const shouldBeVisible = enabled && !isCollapsed;
      settingsContainer.classList.toggle("astro-composer-setting-container-visible", shouldBeVisible);
      settingsContainer.classList.toggle("astro-composer-setting-container-hidden", !shouldBeVisible);
    }
  }
  updateCustomContentTypeIndexFileField(typeId) {
    var _a;
    const contentTypes = this.plugin.settings.contentTypes || [];
    const customType = contentTypes.find((type) => type.id === typeId);
    if (!customType) return;
    const indexFileContainer = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"] .custom-index-file-field`);
    if (indexFileContainer) {
      indexFileContainer.classList.toggle("astro-composer-setting-container-visible", customType.creationMode === "folder");
      indexFileContainer.classList.toggle("astro-composer-setting-container-hidden", customType.creationMode !== "folder");
    }
  }
  updateCustomContentTypeIgnoreSubfoldersField(typeId) {
    var _a;
    const contentTypes = this.plugin.settings.contentTypes || [];
    const customType = contentTypes.find((type) => type.id === typeId);
    if (!customType) return;
    const ignoreSubfoldersContainer = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"].custom-ignore-subfolders-field`);
    if (ignoreSubfoldersContainer) {
      ignoreSubfoldersContainer.classList.toggle("astro-composer-setting-container-visible", !!customType.folder && customType.folder.trim() !== "");
      ignoreSubfoldersContainer.classList.toggle("astro-composer-setting-container-hidden", !customType.folder || customType.folder.trim() === "");
    }
  }
  updateFolderConflictWarning(typeId, setting) {
    var _a;
    const contentTypes = this.plugin.settings.contentTypes || [];
    const currentType = contentTypes.find((type) => type.id === typeId);
    if (!currentType) return;
    const conflictWarningEl = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"].astro-composer-conflict-warning`);
    if (!conflictWarningEl) return;
    const currentFolder = (currentType.folder || "").trim();
    const conflictingTypes = [];
    for (const otherType of contentTypes) {
      if (otherType.id === typeId || !otherType.enabled) continue;
      const otherFolder = (otherType.folder || "").trim();
      if (currentFolder === "" && otherFolder === "") {
        conflictingTypes.push(otherType.name || "Unnamed");
      } else if (currentFolder === otherFolder && currentFolder !== "") {
        conflictingTypes.push(otherType.name || "Unnamed");
      }
    }
    if (conflictingTypes.length > 0) {
      conflictWarningEl.removeClass("hidden");
      conflictWarningEl.textContent = `Conflict: ${conflictingTypes.join(", ")} also use${conflictingTypes.length === 1 ? "s" : ""} this folder. More specific patterns will take priority.`;
    } else {
      conflictWarningEl.addClass("hidden");
    }
  }
  async moveContentTypeUp(typeId) {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    const currentIndex = contentTypes.findIndex((ct) => ct.id === typeId);
    if (currentIndex <= 0) return;
    [contentTypes[currentIndex], contentTypes[currentIndex - 1]] = [contentTypes[currentIndex - 1], contentTypes[currentIndex]];
    settings.contentTypes = contentTypes;
    await this.plugin.saveSettings();
    this.renderCustomContentTypes();
  }
  async moveContentTypeDown(typeId) {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    const currentIndex = contentTypes.findIndex((ct) => ct.id === typeId);
    if (currentIndex < 0 || currentIndex >= contentTypes.length - 1) return;
    [contentTypes[currentIndex], contentTypes[currentIndex + 1]] = [contentTypes[currentIndex + 1], contentTypes[currentIndex]];
    settings.contentTypes = contentTypes;
    await this.plugin.saveSettings();
    this.renderCustomContentTypes();
  }
  async toggleContentTypeCollapse(typeId) {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    const contentType = contentTypes.find((ct) => ct.id === typeId);
    if (!contentType) return;
    contentType.collapsed = !contentType.collapsed;
    await this.plugin.saveSettings();
    this.updateCustomContentTypeVisibility(typeId, contentType.enabled);
  }
  async removeCustomContentType(typeId) {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    settings.contentTypes = contentTypes.filter((ct) => ct.id !== typeId);
    await this.plugin.saveSettings();
    this.renderCustomContentTypes();
    this.plugin.registerCreateEvent();
    registerContentTypeCommands(this.plugin, settings);
  }
  getCommandName(commandId) {
    if (!commandId) return "";
    try {
      const commandRegistry = this.app.commands;
      if (commandRegistry && typeof commandRegistry.listCommands === "function") {
        try {
          const allCommands = commandRegistry.listCommands();
          const command = allCommands.find((cmd) => cmd.id === commandId);
          if (command == null ? void 0 : command.name) {
            return command.name;
          }
        } catch (e) {
          console.warn("[Astro Composer] Error getting command name via listCommands():", e);
        }
      }
      try {
        const registry = commandRegistry == null ? void 0 : commandRegistry.commands;
        if (registry && typeof registry === "object") {
          const command = registry[commandId];
          if (command == null ? void 0 : command.name) {
            return command.name;
          }
        }
      } catch (e) {
        console.warn("[Astro Composer] Error getting command name via registry:", e);
      }
    } catch (e) {
      console.warn("[Astro Composer] Error getting command name:", e);
    }
    return "";
  }
  getIconName(iconId) {
    if (!iconId) return "";
    return iconId.replace(/^lucide-/, "").split("-").map((word) => word.charAt(0).toUpperCase() + word.slice(1)).join(" ");
  }
};

// src/utils/heading-link-generator.ts
var HeadingLinkGenerator = class {
  constructor(settings) {
    this.settings = settings;
  }
  /**
   * Converts text to kebab-case slug for URLs
   */
  // Local toKebabCase removed, using imported one instead
  /**
   * Gets the Astro-compatible URL from an internal link (copied from LinkConverter)
   */
  getAstroUrlFromInternalLink(link) {
    const hashIndex = link.indexOf("#");
    let path = hashIndex >= 0 ? link.slice(0, hashIndex) : link;
    const anchor = hashIndex >= 0 ? link.slice(hashIndex) : "";
    path = path.replace(/\.md$/, "");
    let basePath = "";
    let contentFolder = "";
    let creationMode = "file";
    let indexFileName = "";
    const contentTypes = this.settings.contentTypes || [];
    const sortedTypes = sortByPatternSpecificity(contentTypes);
    for (const contentType of sortedTypes) {
      if (!contentType.enabled) continue;
      let matches = false;
      if (!contentType.folder || contentType.folder.trim() === "") {
        if (!path.includes("/") || path.split("/").length === 1) {
          matches = true;
        }
      } else if (matchesFolderPattern(path, contentType.folder)) {
        matches = true;
      }
      if (matches) {
        contentFolder = contentType.folder || "";
        basePath = contentType.linkBasePath || "";
        creationMode = contentType.creationMode;
        indexFileName = contentType.indexFileName || "";
        break;
      }
    }
    if (contentFolder) {
      path = path.slice(contentFolder.length + 1);
    }
    let addTrailingSlash = false;
    if (indexFileName && indexFileName.trim() !== "") {
      const parts = path.split("/");
      if (parts[parts.length - 1] === indexFileName) {
        parts.pop();
        path = parts.join("/");
        addTrailingSlash = true;
      }
    } else if (creationMode === "folder") {
      const defaultIndexName = "index";
      const parts = path.split("/");
      if (parts[parts.length - 1] === defaultIndexName) {
        parts.pop();
        path = parts.join("/");
        addTrailingSlash = true;
      }
    }
    const slugParts = path.split("/").map((part) => toKebabCase(part));
    const slug = slugParts.join("/");
    if (basePath) {
      if (!basePath.startsWith("/")) basePath = "/" + basePath;
      if (!basePath.endsWith("/")) basePath += "/";
    }
    const shouldAddTrailingSlash = (this.settings.addTrailingSlashToLinks || addTrailingSlash) && !anchor;
    return `${basePath}${slug}${shouldAddTrailingSlash ? "/" : ""}${anchor}`;
  }
  /**
   * Generates a standard Obsidian link to a heading, respecting user's link format preference
   */
  generateObsidianLink(app, file, heading) {
    const headingText = heading.heading;
    const testLink = app.fileManager.generateMarkdownLink(file, "", "");
    if (testLink.startsWith("[[")) {
      const fileName = file.basename;
      return `[[${fileName}#${headingText}|${headingText}]]`;
    } else {
      const baseLink = app.fileManager.generateMarkdownLink(file, "", "");
      if (baseLink.startsWith("[[")) {
        const fileName = file.basename;
        return `[[${fileName}#${headingText}|${headingText}]]`;
      } else {
        const match = baseLink.match(/\[([^\]]+)\]\(([^)]+)\)/);
        if (match) {
          const [, , path] = match;
          return `[${headingText}](${path}#${encodeURIComponent(headingText)})`;
        } else {
          const encodedFilename = encodeURIComponent(file.name);
          return `[${headingText}](${encodedFilename}#${encodeURIComponent(headingText)})`;
        }
      }
    }
  }
  /**
   * Generates a standard Obsidian wikilink to a heading
   */
  generateObsidianWikilink(file, heading) {
    const headingText = heading.heading;
    const fileName = file.basename;
    return `[[${fileName}#${headingText}|${headingText}]]`;
  }
  /**
   * Generates an Astro-compatible markdown link to a heading
   */
  generateAstroLink(file, heading) {
    const headingText = heading.heading;
    const anchor = toKebabCase(headingText);
    const internalLink = `${file.path}#${anchor}`;
    const astroUrl = this.getAstroUrlFromInternalLink(internalLink);
    return `[${headingText}](${astroUrl})`;
  }
  /**
   * Generates an Astro-compatible wikilink to a heading
   */
  generateAstroWikilink(file, heading) {
    const headingText = heading.heading;
    const anchor = toKebabCase(headingText);
    const internalLink = `${file.path}#${anchor}`;
    const astroUrl = this.getAstroUrlFromInternalLink(internalLink);
    return `[[${headingText}|${astroUrl}]]`;
  }
  /**
   * Extracts the URL from a markdown link or wikilink
   */
  extractUrl(link) {
    const markdownMatch = link.match(/\[([^\]]+)\]\(([^)]+)\)/);
    if (markdownMatch) {
      return markdownMatch[2];
    }
    const wikilinkMatch = link.match(/\[\[([^\]]+)\]\]/);
    if (wikilinkMatch) {
      const content = wikilinkMatch[1];
      const pathPart = content.split("|")[0];
      return pathPart;
    }
    return link;
  }
  /**
   * Generates the appropriate link format based on settings
   */
  generateLink(app, file, heading) {
    if (this.settings.copyHeadingLinkFormat === "astro") {
      return this.generateAstroLink(file, heading);
    } else {
      return this.generateObsidianLink(app, file, heading);
    }
  }
  /**
   * Finds the heading at a specific line in a file
   */
  findHeadingAtLine(app, file, line) {
    const cache = app.metadataCache.getFileCache(file);
    if (!cache || !cache.headings) {
      return null;
    }
    for (let i = cache.headings.length - 1; i >= 0; i--) {
      const heading = cache.headings[i];
      if (heading.position.start.line <= line) {
        return heading;
      }
    }
    return null;
  }
};

// src/services/MigrationService.ts
var import_obsidian12 = require("obsidian");

// src/ui/components/MigrationModal.ts
var import_obsidian11 = require("obsidian");
var MigrationModal = class extends import_obsidian11.Modal {
  constructor(app, conflicts) {
    super(app);
    this.result = null;
    this.resolvePromise = null;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("astro-composer-migration-modal");
    contentEl.createEl("h2", { text: "Migration conflict detected" });
    contentEl.createEl("p", {
      text: "You have existing content types with names that conflict with posts or pages. How would you like to proceed?"
    });
    const conflictList = contentEl.createEl("ul");
    conflictList.createEl("li", { text: "Skip migration: keep your existing posts/pages settings (they will be ignored)" });
    conflictList.createEl("li", { text: "Migrate with renamed types: create 'posts (migrated)' and 'pages (migrated)' content types" });
    const buttonContainer = contentEl.createDiv({ cls: "modal-button-container" });
    const skipButton = buttonContainer.createEl("button", {
      text: "Skip migration",
      cls: "mod-cta"
    });
    skipButton.onclick = () => {
      this.result = { action: "skip" };
      this.close();
    };
    const migrateButton = buttonContainer.createEl("button", {
      text: "Migrate with renamed types",
      cls: "mod-cta"
    });
    migrateButton.onclick = () => {
      this.result = { action: "migrate" };
      this.close();
    };
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    if (this.resolvePromise && this.result) {
      this.resolvePromise(this.result);
    }
  }
  async waitForResult() {
    return new Promise((resolve) => {
      this.resolvePromise = resolve;
      this.open();
    });
  }
};

// src/services/MigrationService.ts
var MigrationService = class {
  constructor(app, plugin) {
    this.app = app;
    this.plugin = plugin;
  }
  /**
   * Migrate old posts/pages settings to unified content types
   */
  async migrateSettingsIfNeeded() {
    const settings = this.plugin.settings;
    if (settings.migrationCompleted) {
      return;
    }
    const hasPostsSettings = settings.automatePostCreation !== void 0 && settings.automatePostCreation;
    const hasPagesSettings = settings.enablePages !== void 0 && settings.enablePages;
    if (!hasPostsSettings && !hasPagesSettings) {
      settings.migrationCompleted = true;
      await this.plugin.saveSettings();
      return;
    }
    const legacyContentTypes = settings.customContentTypes;
    const existingContentTypes = settings.contentTypes || legacyContentTypes || [];
    const conflicts = [];
    if (existingContentTypes.some((ct) => ct.name === "Posts")) {
      conflicts.push("Posts");
    }
    if (existingContentTypes.some((ct) => ct.name === "Pages")) {
      conflicts.push("Pages");
    }
    let shouldMigrate = true;
    if (conflicts.length > 0) {
      await new Promise((resolve) => {
        setTimeout(() => {
          void (async () => {
            try {
              const modal = new MigrationModal(this.app, conflicts);
              const timeoutPromise = new Promise((timeoutResolve) => {
                setTimeout(() => {
                  timeoutResolve({ action: "skip" });
                }, 3e4);
              });
              const result = await Promise.race([
                modal.waitForResult(),
                timeoutPromise
              ]);
              if (result.action === "skip") {
                shouldMigrate = false;
                new import_obsidian12.Notice("Migration skipped. Old posts/pages settings will be ignored.");
              }
            } catch (error) {
              console.warn("Migration modal error:", error);
              shouldMigrate = false;
              new import_obsidian12.Notice("Migration skipped due to error. You can migrate manually in settings.");
            }
            resolve();
          })();
        }, 500);
      });
    }
    if (!shouldMigrate) {
      settings.migrationCompleted = true;
      await this.plugin.saveSettings();
      return;
    }
    const migratedTypes = [];
    if (hasPostsSettings && !conflicts.includes("Posts")) {
      const postsType = {
        id: `posts-${Date.now()}`,
        name: "Posts",
        folder: settings.postsFolder || "",
        linkBasePath: settings.postsLinkBasePath || "",
        template: settings.defaultTemplate || '---\ntitle: "{{title}}"\ndate: {{date}}\ntags: []\n---\n',
        enabled: true,
        creationMode: settings.creationMode || "file",
        indexFileName: settings.indexFileName || "",
        ignoreSubfolders: settings.onlyAutomateInPostsFolder || false,
        enableUnderscorePrefix: settings.enableUnderscorePrefix || false,
        useMdxExtension: false
      };
      migratedTypes.push(postsType);
    }
    if (hasPagesSettings && !conflicts.includes("Pages")) {
      const pagesType = {
        id: `pages-${Date.now()}`,
        name: "Pages",
        folder: settings.pagesFolder || "",
        linkBasePath: settings.pagesLinkBasePath || "",
        template: settings.pageTemplate || '---\ntitle: "{{title}}"\ndescription: ""\n---\n',
        enabled: true,
        creationMode: settings.pagesCreationMode || "file",
        indexFileName: settings.pagesIndexFileName || "",
        ignoreSubfolders: settings.onlyAutomateInPagesFolder || false,
        enableUnderscorePrefix: false,
        useMdxExtension: false
      };
      migratedTypes.push(pagesType);
    }
    const existingFromNew = settings.contentTypes || [];
    const existingFromLegacy = legacyContentTypes || [];
    let existingTypes = existingFromNew.length > 0 ? existingFromNew : existingFromLegacy;
    let finalTypes = [...existingTypes];
    if (migratedTypes.length > 0) {
      const existingNames = new Set(existingTypes.map((ct) => ct.name));
      const newMigratedTypes = migratedTypes.filter((mt) => !existingNames.has(mt.name));
      if (newMigratedTypes.length > 0) {
        finalTypes = [...existingTypes, ...newMigratedTypes];
      }
    }
    settings.contentTypes = finalTypes;
    const legacyFields = [
      "customContentTypes",
      "enableUnderscorePrefix",
      "postsFolder",
      "postsLinkBasePath",
      "automatePostCreation",
      "creationMode",
      "indexFileName",
      "excludedDirectories",
      "onlyAutomateInPostsFolder",
      "enablePages",
      "pagesFolder",
      "pagesLinkBasePath",
      "pagesCreationMode",
      "pagesIndexFileName",
      "pageTemplate",
      "onlyAutomateInPagesFolder"
    ];
    const settingsRecord = settings;
    for (const field of legacyFields) {
      delete settingsRecord[field];
    }
    settings.migrationCompleted = true;
    await this.plugin.saveSettings();
    await this.plugin.loadSettings();
    if (migratedTypes.length > 0) {
      new import_obsidian12.Notice(`Migration completed: ${migratedTypes.length} content type(s) migrated.`);
      setTimeout(() => {
        if (this.plugin.settingsTab instanceof AstroComposerSettingTab) {
          const settingsTab = this.plugin.settingsTab;
          try {
            if (settingsTab.customContentTypesContainer || settingsTab.containerEl) {
              settingsTab.display();
            }
          } catch (e) {
            console.warn("Could not refresh settings tab after migration:", e);
          }
        }
      }, 300);
    }
  }
};

// src/services/CreateEventService.ts
var import_obsidian13 = require("obsidian");
var CreateEventService = class {
  constructor(app, plugin) {
    this.app = app;
    this.plugin = plugin;
    this.lastProcessedFiles = /* @__PURE__ */ new Map();
  }
  handleCreate(file) {
    void (async () => {
      const now = Date.now();
      if (!(file instanceof import_obsidian13.TFile) || file.extension !== "md" && file.extension !== "mdx") {
        return;
      }
      const filePath = file.path;
      const createdTime = this.plugin.pluginCreatedFiles.get(filePath);
      if (createdTime && now - createdTime < 5 * 60 * 1e3) {
        return;
      }
      const lastProcessed = this.lastProcessedFiles.get(filePath) || 0;
      if (lastProcessed > 0 && now - lastProcessed < CONSTANTS.DEBOUNCE_MS) {
        return;
      }
      if (lastProcessed > 0 && now - lastProcessed > 2e3) {
        this.lastProcessedFiles.delete(filePath);
      }
      const periodicCutoff = now - CONSTANTS.DEBOUNCE_MS * 2;
      for (const [path, time] of this.lastProcessedFiles.entries()) {
        if (time < periodicCutoff) {
          this.lastProcessedFiles.delete(path);
        }
      }
      await this.plugin.loadSettings();
      const activeFile = this.app.workspace.getActiveFile();
      const isActiveFile = activeFile && activeFile.path === file.path;
      if (!this.plugin.settings.processBackgroundFileChanges && !isActiveFile) {
        return;
      }
      const contentTypes = this.plugin.settings.contentTypes || [];
      const hasEnabledContentTypes = contentTypes.some((ct) => ct.enabled);
      if (!hasEnabledContentTypes) {
        return;
      }
      const sortedContentTypes = sortByPatternSpecificity(contentTypes);
      let matchedContentTypeId = null;
      const matchingTypes = [];
      for (const contentType of sortedContentTypes) {
        if (!contentType.enabled) continue;
        let matches = false;
        if (!contentType.folder || contentType.folder.trim() === "") {
          if (!filePath.includes("/") || filePath.split("/").length === 1) {
            matches = true;
          }
        } else if (matchesFolderPattern(filePath, contentType.folder)) {
          if (contentType.ignoreSubfolders) {
            const pathSegments = filePath.split("/");
            const pathDepth = pathSegments.length;
            const patternSegments = contentType.folder.split("/");
            const expectedDepth = patternSegments.length;
            if (contentType.creationMode === "folder") {
              const folderDepth = pathDepth - 1;
              if (folderDepth === expectedDepth || folderDepth === expectedDepth + 1) {
                matches = true;
              }
            } else {
              if (pathDepth === expectedDepth) {
                matches = true;
              }
            }
          } else {
            matches = true;
          }
        }
        if (matches) {
          matchingTypes.push(contentType);
          if (!matchedContentTypeId) {
            matchedContentTypeId = contentType.id;
          }
        }
      }
      if (matchingTypes.length > 1) {
        const typeNames = matchingTypes.map((ct) => ct.name || "Unnamed").join(", ");
        new import_obsidian13.Notice(`Multiple content types (${typeNames}) match this file. Using most specific: ${matchingTypes[0].name || "Unnamed"}`);
      }
      if (!matchedContentTypeId) {
        return;
      }
      const stat = await this.app.vault.adapter.stat(file.path);
      const isNewNote = (stat == null ? void 0 : stat.mtime) && now - stat.mtime < CONSTANTS.STAT_MTIME_THRESHOLD;
      if (!isNewNote) {
        return;
      }
      await new Promise((resolve) => setTimeout(resolve, 50));
      let content;
      try {
        content = await this.app.vault.read(file);
      } catch (error) {
        console.error("Error reading file for create detection:", error);
        return;
      }
      if (content.trim().length > 0) {
        if (content.startsWith("---")) {
          const frontmatterEnd = content.indexOf("\n---", 3);
          if (frontmatterEnd !== -1) {
            const frontmatterText = content.slice(4, frontmatterEnd).trim();
            const lines = frontmatterText.split("\n").filter((line) => line.trim().length > 0);
            if (!this.plugin.settings.processBackgroundFileChanges && lines.length > 0) {
              return;
            }
            if (lines.length > 1 || lines.length === 1 && !lines[0].startsWith("title:")) {
              return;
            }
          }
        }
        const contentWithoutFrontmatter = content.startsWith("---") ? content.slice(content.indexOf("\n---", 3) + 4).trim() : content.trim();
        if (contentWithoutFrontmatter.length > 0) {
          return;
        }
      }
      this.lastProcessedFiles.set(file.path, now);
      setTimeout(() => {
        this.lastProcessedFiles.delete(file.path);
      }, CONSTANTS.DEBOUNCE_MS + 100);
      new TitleModal(this.app, file, this.plugin, matchedContentTypeId, false, true).open();
    })();
  }
};

// src/services/FrontmatterService.ts
var import_obsidian14 = require("obsidian");
var FrontmatterService = class {
  constructor(app, plugin) {
    this.app = app;
    this.plugin = plugin;
    this.lastProcessedFile = "";
    this.lastProcessedTime = 0;
    this.debounceTimeout = null;
    this.draftStatusMap = /* @__PURE__ */ new Map();
    this.registerEvents();
    this.app.workspace.onLayoutReady(() => {
      this.initializeDraftStatusMap();
    });
  }
  initializeDraftStatusMap() {
    var _a;
    this.draftStatusMap.clear();
    const settings = this.plugin.settings;
    const draftProp = settings.draftProperty || "draft";
    const files = this.app.vault.getFiles().filter((f) => f instanceof import_obsidian14.TFile && (f.extension === "md" || f.extension === "mdx"));
    for (const file of files) {
      const cache = this.app.metadataCache.getFileCache(file);
      const rawValue = (_a = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _a[draftProp];
      this.draftStatusMap.set(file.path, this.calculateIsDraft(rawValue, settings));
    }
  }
  calculateIsDraft(rawValue, settings) {
    if (rawValue === void 0 || rawValue === null) return false;
    const val = String(rawValue).toLowerCase();
    if (settings.draftLogic === "false-is-draft") {
      return val === "false" || val === "0" || rawValue === false;
    } else {
      return val === "true" || val === "1" || rawValue === true;
    }
  }
  registerEvents() {
    this.plugin.registerEvent(
      this.app.metadataCache.on("changed", (file) => {
        if (file instanceof import_obsidian14.TFile) {
          this.onMetadataChange(file);
        }
      })
    );
    this.plugin.registerEvent(
      this.app.vault.on("rename", (file, oldPath) => {
        if (file instanceof import_obsidian14.TFile) {
          this.onRename(file, oldPath);
        }
      })
    );
  }
  onRename(file, oldPath) {
    var _a;
    const settings = this.plugin.settings;
    if (!settings.syncDraftDate) return;
    const oldName = oldPath.split("/").pop() || "";
    const newName = file.name;
    if (oldName.startsWith("_") && !newName.startsWith("_")) {
      const contentType = (_a = this.plugin.fileOps) == null ? void 0 : _a.getContentTypeByPath(file.path);
      if (contentType == null ? void 0 : contentType.enableUnderscorePrefix) {
        void this.updateDate(file);
      }
    }
  }
  onMetadataChange(file) {
    var _a;
    const settings = this.plugin.settings;
    if (!settings.syncDraftDate && !settings.updateModifiedDate) {
      return;
    }
    const cache = this.app.metadataCache.getFileCache(file);
    const draftProp = settings.draftProperty || "draft";
    const rawValue = (_a = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _a[draftProp];
    const isCurrentlyDraft = this.calculateIsDraft(rawValue, settings);
    if (!this.draftStatusMap.has(file.path)) {
      this.draftStatusMap.set(file.path, isCurrentlyDraft);
      return;
    }
    const previousDraftStatus = this.draftStatusMap.get(file.path);
    let draftStatusChangedToPublished = false;
    if (previousDraftStatus === true && isCurrentlyDraft === false) {
      draftStatusChangedToPublished = true;
    }
    this.draftStatusMap.set(file.path, isCurrentlyDraft);
    if (!draftStatusChangedToPublished && !settings.updateModifiedDate) {
      return;
    }
    const now = Date.now();
    if (this.lastProcessedFile === file.path && now - this.lastProcessedTime < 2e3) {
      return;
    }
    if (this.debounceTimeout) {
      window.clearTimeout(this.debounceTimeout);
    }
    this.debounceTimeout = window.setTimeout(() => {
      void this.processFile(file, draftStatusChangedToPublished);
    }, 500);
  }
  async updateDate(file) {
    const settings = this.plugin.settings;
    const dateField = settings.publishDateField || "date";
    await this.app.fileManager.processFrontMatter(file, (frontmatter) => {
      const today = (0, import_obsidian14.moment)().format(settings.dateFormat);
      if (frontmatter[dateField] !== today) {
        frontmatter[dateField] = today;
        this.lastProcessedFile = file.path;
        this.lastProcessedTime = Date.now();
      }
    });
  }
  async processFile(file, draftStatusChangedToPublished) {
    const settings = this.plugin.settings;
    const publishDateField = settings.publishDateField || "date";
    await this.app.fileManager.processFrontMatter(file, (frontmatter) => {
      let changed = false;
      if (settings.syncDraftDate && draftStatusChangedToPublished) {
        const today = (0, import_obsidian14.moment)().format(settings.dateFormat);
        if (frontmatter[publishDateField] !== today) {
          frontmatter[publishDateField] = today;
          changed = true;
        }
      }
      const modifiedField = settings.modifiedDateField || "modified";
      if (settings.updateModifiedDate) {
        const now = (0, import_obsidian14.moment)().format(settings.dateFormat);
        if (frontmatter[modifiedField] !== now) {
          frontmatter[modifiedField] = now;
          changed = true;
        }
      }
      if (changed) {
        this.lastProcessedFile = file.path;
        this.lastProcessedTime = Date.now();
      }
    });
  }
};

// src/utils/dom.ts
function waitForElement(selector, timeout = 5e3) {
  return new Promise((resolve, reject) => {
    const element = document.querySelector(selector);
    if (element) {
      return resolve(element);
    }
    const observer = new MutationObserver((mutations) => {
      const targetElement = document.querySelector(selector);
      if (targetElement) {
        resolve(targetElement);
        observer.disconnect();
        clearTimeout(timer);
      }
    });
    observer.observe(document.body, {
      childList: true,
      subtree: true
    });
    const timer = setTimeout(() => {
      observer.disconnect();
      reject(new Error(`Timeout waiting for element matching selector: ${selector}`));
    }, timeout);
  });
}

// src/main.ts
var AstroComposerPlugin = class extends import_obsidian15.Plugin {
  constructor() {
    super(...arguments);
    this.pluginCreatedFiles = /* @__PURE__ */ new Map();
    this.processedFiles = /* @__PURE__ */ new Map();
    this.terminalRibbonIcon = null;
    this.configRibbonIcon = null;
  }
  /**
   * Migrate old posts/pages settings to unified content types
   */
  async migrateSettingsIfNeeded() {
    if (!this.migrationService) {
      this.migrationService = new MigrationService(this.app, this);
    }
    await this.migrationService.migrateSettingsIfNeeded();
  }
  async onload() {
    try {
      await this.loadSettings();
      this.fileOps = new FileOperations(this.app, this.settings, this);
      this.migrationService = new MigrationService(this.app, this);
      this.createEventService = new CreateEventService(this.app, this);
      this.frontmatterService = new FrontmatterService(this.app, this);
      this.templateParser = new TemplateParser(this.app, this.settings);
      this.headingLinkGenerator = new HeadingLinkGenerator(this.settings);
      if (this.settings.showMdxFilesInExplorer) {
        try {
          this.registerExtensions(["mdx"], "markdown");
        } catch (error) {
          console.warn("[Astro Composer] MDX extension already registered:", error);
        }
      }
      this.app.workspace.onLayoutReady(() => {
        this.registerCreateEvent();
        if (!import_obsidian15.Platform.isMobile) {
          void this.updateHelpButton();
        }
        void this.migrateSettingsIfNeeded();
      });
      registerCommands(this, this.settings);
      registerContentTypeCommands(this, this.settings);
      this.settingsTab = new AstroComposerSettingTab(this.app, this);
      this.addSettingTab(this.settingsTab);
      this.registerContextMenu();
      this.registerRibbonIcons();
      this.setupRibbonContextMenuHandling();
    } catch (error) {
      console.error("[Astro Composer] Critical error during onload:", error);
      new import_obsidian15.Notice("Astro Composer failed to load. Check console (Ctrl+Shift+I) for details.");
      throw error;
    }
  }
  registerCreateEvent() {
    if (this.createEventRef) {
      this.app.vault.offref(this.createEventRef);
      this.createEventRef = void 0;
    }
    const createEventRef = this.app.vault.on("create", (file) => {
      if (file instanceof import_obsidian15.TFile) {
        this.createEventService.handleCreate(file);
        this.cleanupPluginCreatedFiles();
      }
    });
    this.registerEvent(createEventRef);
    this.createEventRef = createEventRef;
  }
  cleanupPluginCreatedFiles() {
    const now = Date.now();
    const ttl = 5 * 60 * 1e3;
    for (const [path, timestamp] of this.pluginCreatedFiles.entries()) {
      if (now - timestamp > ttl) {
        this.pluginCreatedFiles.delete(path);
      }
    }
  }
  async loadSettings() {
    const loadedData = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS, loadedData);
    if (!this.settings.contentTypes || !Array.isArray(this.settings.contentTypes)) {
      this.settings.contentTypes = [];
    }
    if (!this.settings.migrationCompleted) {
      const legacySettings = this.settings;
      const hasLegacyTypes = legacySettings.customContentTypes && Array.isArray(legacySettings.customContentTypes) && legacySettings.customContentTypes.length > 0;
      const hasNewTypes = this.settings.contentTypes && Array.isArray(this.settings.contentTypes) && this.settings.contentTypes.length > 0;
      if (hasLegacyTypes && !hasNewTypes) {
        this.settings.contentTypes = legacySettings.customContentTypes || [];
      }
    } else {
      const legacyFields = [
        "customContentTypes",
        "enableUnderscorePrefix",
        "postsFolder",
        "postsLinkBasePath",
        "automatePostCreation",
        "creationMode",
        "indexFileName",
        "excludedDirectories",
        "onlyAutomateInPostsFolder",
        "enablePages",
        "pagesFolder",
        "pagesLinkBasePath",
        "pagesCreationMode",
        "pagesIndexFileName",
        "pageTemplate",
        "onlyAutomateInPagesFolder",
        "linkBasePath",
        "enableAutoRename",
        "enableAutoInsertFrontmatter",
        "draftStyle"
      ];
      const settingsRecord = this.settings;
      let fieldsRemoved = false;
      for (const field of legacyFields) {
        if (settingsRecord[field] !== void 0) {
          delete settingsRecord[field];
          fieldsRemoved = true;
        }
      }
      if (fieldsRemoved) {
        await this.saveSettings();
      }
    }
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  registerContextMenu() {
    this.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor, view) => {
        if (!this.settings.enableCopyHeadingLink) {
          return;
        }
        const cursor = editor.getCursor();
        const file = view.file;
        if (!(file instanceof import_obsidian15.TFile)) {
          return;
        }
        const heading = this.headingLinkGenerator.findHeadingAtLine(this.app, file, cursor.line);
        if (heading) {
          const fullLink = this.headingLinkGenerator.generateLink(this.app, file, heading);
          const urlOnly = this.headingLinkGenerator.extractUrl(fullLink);
          menu.addItem((item) => {
            item.setTitle("Copy heading link").setIcon("link-2").onClick(async () => {
              await navigator.clipboard.writeText(urlOnly);
              new import_obsidian15.Notice("Heading link copied to clipboard");
            });
          });
          menu.addItem((item) => {
            item.setTitle("Copy heading link with text").setIcon("heading").onClick(async () => {
              await navigator.clipboard.writeText(fullLink);
              new import_obsidian15.Notice("Heading link with text copied to clipboard");
            });
          });
        }
      })
    );
  }
  renameContentByPath(filePath) {
    renameContentByPath(this.app, filePath, this.settings, this);
  }
  registerRibbonIcons() {
    if (import_obsidian15.Platform.isMobile) {
      if (this.terminalRibbonIcon) {
        try {
          if (this.terminalRibbonIcon.parentNode) this.terminalRibbonIcon.remove();
        } catch (e) {
        }
        this.terminalRibbonIcon = null;
      }
      if (this.configRibbonIcon) {
        try {
          if (this.configRibbonIcon.parentNode) this.configRibbonIcon.remove();
        } catch (e) {
        }
        this.configRibbonIcon = null;
      }
      try {
        const terminalIcons = document.querySelectorAll('.side-dock-ribbon-action[aria-label="Open project terminal"]');
        terminalIcons.forEach((icon) => icon.remove());
        const configIcons = document.querySelectorAll('.side-dock-ribbon-action[aria-label="Edit astro config"]');
        configIcons.forEach((icon) => icon.remove());
      } catch (e) {
      }
      return;
    }
    const terminalShouldExist = this.settings.enableTerminalRibbonIcon && this.settings.enableOpenTerminalCommand;
    const configShouldExist = this.settings.enableConfigRibbonIcon && this.settings.enableOpenConfigFileCommand;
    if (this.terminalRibbonIcon) {
      try {
        if (this.terminalRibbonIcon.parentNode) this.terminalRibbonIcon.remove();
      } catch (e) {
      }
      this.terminalRibbonIcon = null;
    }
    if (this.configRibbonIcon) {
      try {
        if (this.configRibbonIcon.parentNode) this.configRibbonIcon.remove();
      } catch (e) {
      }
      this.configRibbonIcon = null;
    }
    try {
      document.querySelectorAll('.side-dock-ribbon-action[aria-label="Open project terminal"]').forEach((el) => el.remove());
      document.querySelectorAll('.side-dock-ribbon-action[aria-label="Edit astro config"]').forEach((el) => el.remove());
    } catch (e) {
    }
    if (terminalShouldExist) {
      this.terminalRibbonIcon = this.addRibbonIcon("terminal-square", "Open project terminal", () => {
        if (!this.settings.enableOpenTerminalCommand) {
          new import_obsidian15.Notice("Open terminal command is disabled.");
          return;
        }
        openTerminalInProjectRoot(this.app, this.settings);
      });
      if (this.terminalRibbonIcon) this.terminalRibbonIcon.setAttribute("data-astro-composer-terminal-ribbon", "true");
    }
    if (configShouldExist) {
      this.configRibbonIcon = this.addRibbonIcon("rocket", "Edit astro config", async () => {
        if (!this.settings.enableOpenConfigFileCommand) {
          new import_obsidian15.Notice("Edit config file command is disabled.");
          return;
        }
        await openConfigFile(this.app, this.settings);
      });
      if (this.configRibbonIcon) this.configRibbonIcon.setAttribute("data-astro-composer-config-ribbon", "true");
    }
    this.updateRibbonContextMenuCSS();
    this.setupRibbonContextMenuObserver();
  }
  onunload() {
    if (this.terminalRibbonIcon) {
      this.terminalRibbonIcon.remove();
      this.terminalRibbonIcon = null;
    }
    if (this.configRibbonIcon) {
      this.configRibbonIcon.remove();
      this.configRibbonIcon = null;
    }
    if (this.ribbonContextMenuObserver) {
      this.ribbonContextMenuObserver.disconnect();
      this.ribbonContextMenuObserver = void 0;
    }
    document.body.removeClass("astro-composer-hide-terminal-icon");
    document.body.removeClass("astro-composer-hide-config-icon");
    if (this.helpButtonObserver) {
      this.helpButtonObserver.disconnect();
      this.helpButtonObserver = void 0;
    }
    if (this.customHelpButton) {
      this.customHelpButton.remove();
      this.customHelpButton = void 0;
    }
    this.helpButtonElement = void 0;
  }
  setupRibbonContextMenuHandling() {
    this.updateRibbonContextMenuCSS();
    this.setupRibbonContextMenuObserver();
  }
  updateRibbonContextMenuCSS() {
    const terminalShouldBeHidden = !this.settings.enableTerminalRibbonIcon || !this.settings.enableOpenTerminalCommand;
    const configShouldBeHidden = !this.settings.enableConfigRibbonIcon || !this.settings.enableOpenConfigFileCommand;
    if (terminalShouldBeHidden) document.body.addClass("astro-composer-hide-terminal-icon");
    else document.body.removeClass("astro-composer-hide-terminal-icon");
    if (configShouldBeHidden) document.body.addClass("astro-composer-hide-config-icon");
    else document.body.removeClass("astro-composer-hide-config-icon");
  }
  setupRibbonContextMenuObserver() {
    if (this.ribbonContextMenuObserver) this.ribbonContextMenuObserver.disconnect();
    const terminalShouldBeHidden = !this.settings.enableTerminalRibbonIcon || !this.settings.enableOpenTerminalCommand;
    const configShouldBeHidden = !this.settings.enableConfigRibbonIcon || !this.settings.enableOpenConfigFileCommand;
    if (!terminalShouldBeHidden && !configShouldBeHidden) return;
    this.ribbonContextMenuObserver = new MutationObserver((mutations) => {
      for (const mutation of mutations) {
        if (mutation.addedNodes.length > 0) {
          for (const node of Array.from(mutation.addedNodes)) {
            if (node instanceof HTMLElement) {
              if (node.classList.contains("menu") || node.querySelector(".menu")) {
                this.removeRibbonIconsFromContextMenu(node);
              }
            }
          }
        }
      }
    });
    this.ribbonContextMenuObserver.observe(document.body, { childList: true, subtree: true });
  }
  updateHelpButtonCSS() {
    var _a;
    if ((_a = this.settings.helpButtonReplacement) == null ? void 0 : _a.enabled) document.body.addClass("astro-composer-hide-help-button");
    else document.body.removeClass("astro-composer-hide-help-button");
  }
  async updateHelpButton() {
    var _a, _b, _c;
    if (import_obsidian15.Platform.isMobile) {
      this.restoreHelpButton();
      return;
    }
    if (this.helpButtonObserver) this.helpButtonObserver.disconnect();
    this.updateHelpButtonCSS();
    if (!((_a = this.settings.helpButtonReplacement) == null ? void 0 : _a.enabled)) {
      this.restoreHelpButton();
      this.setupHelpButtonObserver();
      return;
    }
    try {
      const helpButton = await waitForElement(".workspace-drawer-vault-actions .clickable-icon svg.help", 1e4).then((svg) => svg.parentElement);
      if (!helpButton) {
        this.setupHelpButtonObserver();
        return;
      }
      this.helpButtonElement = helpButton;
      if (this.customHelpButton && this.customHelpButton.parentElement && document.body.contains(this.customHelpButton) && this.customHelpButton.hasAttribute("data-astro-composer-help-replacement")) {
        this.customHelpButton.remove();
      }
      this.customHelpButton = void 0;
      const customButton = helpButton.cloneNode(true);
      customButton.addClass("astro-composer-help-replacement");
      customButton.removeAttribute("aria-label");
      customButton.setAttribute("data-astro-composer-help-replacement", "true");
      customButton.classList.add("astro-composer-help-replacement");
      customButton.onclick = null;
      const iconContainer = ((_b = customButton.querySelector("svg")) == null ? void 0 : _b.parentElement) || customButton;
      try {
        if (iconContainer instanceof HTMLElement) {
          (0, import_obsidian15.setIcon)(iconContainer, this.settings.helpButtonReplacement.iconId);
        }
      } catch (error) {
        console.warn("[Astro Composer] Error setting icon:", error);
      }
      customButton.addEventListener("click", (evt) => {
        var _a2;
        evt.preventDefault();
        evt.stopPropagation();
        const commandId = (_a2 = this.settings.helpButtonReplacement) == null ? void 0 : _a2.commandId;
        if (commandId) {
          void (async () => {
            var _a3;
            try {
              const appWithCommands = this.app;
              if ((_a3 = appWithCommands.commands) == null ? void 0 : _a3.executeCommandById) {
                await appWithCommands.commands.executeCommandById(commandId);
              }
            } catch (error) {
              console.warn("[Astro Composer] Error executing command:", error);
              new import_obsidian15.Notice(`Failed to execute command: ${commandId}`);
            }
          })();
        }
      }, true);
      (_c = helpButton.parentElement) == null ? void 0 : _c.insertBefore(customButton, helpButton);
      this.customHelpButton = customButton;
      setTimeout(() => {
        var _a2;
        if ((_a2 = this.settings.helpButtonReplacement) == null ? void 0 : _a2.enabled) this.setupHelpButtonObserver();
      }, 1e3);
    } catch (error) {
      console.warn("[Astro Composer] Error updating help button:", error);
      this.setupHelpButtonObserver();
    }
  }
  setupHelpButtonObserver() {
    var _a;
    if (this.helpButtonObserver) this.helpButtonObserver.disconnect();
    if (!((_a = this.settings.helpButtonReplacement) == null ? void 0 : _a.enabled)) return;
    let updateTimeout = null;
    this.helpButtonObserver = new MutationObserver(() => {
      if (updateTimeout) clearTimeout(updateTimeout);
      updateTimeout = window.setTimeout(() => {
        const vaultActions2 = document.querySelector(".workspace-drawer-vault-actions");
        if (!vaultActions2) return;
        const customButtonExists = this.customHelpButton && this.customHelpButton.parentElement && document.body.contains(this.customHelpButton) && this.customHelpButton.hasAttribute("data-astro-composer-help-replacement");
        if (!customButtonExists) {
          if (this.customHelpButton && (!document.body.contains(this.customHelpButton) || !this.customHelpButton.hasAttribute("data-astro-composer-help-replacement"))) {
            this.customHelpButton = void 0;
          }
          void this.updateHelpButton();
        }
      }, 100);
    });
    const vaultActions = document.querySelector(".workspace-drawer-vault-actions");
    if (vaultActions) this.helpButtonObserver.observe(vaultActions, { childList: true, subtree: true });
    const vaultProfile = document.querySelector(".workspace-sidedock-vault-profile");
    if (vaultProfile) this.helpButtonObserver.observe(vaultProfile, { childList: true, subtree: true });
    if (!vaultActions && !vaultProfile) {
      const workspace = document.querySelector(".workspace-split");
      if (workspace) this.helpButtonObserver.observe(workspace, { childList: true, subtree: true });
      else this.helpButtonObserver.observe(document.body, { childList: true, subtree: true });
    }
  }
  restoreHelpButton() {
    document.body.removeClass("astro-composer-hide-help-button");
    if (this.customHelpButton) {
      this.customHelpButton.remove();
      this.customHelpButton = void 0;
    }
    this.helpButtonElement = void 0;
  }
  removeRibbonIconsFromContextMenu(menuElement) {
    var _a, _b;
    const terminalShouldBeHidden = !this.settings.enableTerminalRibbonIcon || !this.settings.enableOpenTerminalCommand;
    const configShouldBeHidden = !this.settings.enableConfigRibbonIcon || !this.settings.enableOpenConfigFileCommand;
    const menuItems = menuElement.querySelectorAll(".menu-item");
    for (const item of Array.from(menuItems)) {
      const svg = item.querySelector("svg");
      if (svg) {
        let iconName = svg.getAttribute("data-lucide") || svg.getAttribute("xmlns:lucide") || svg.getAttribute("data-icon") || (svg.classList.contains("lucide-terminal-square") ? "terminal-square" : null) || (svg.classList.contains("lucide-rocket") ? "rocket" : null) || (svg.classList.contains("lucide-wrench") ? "wrench" : null);
        if (iconName) iconName = iconName.replace(/^lucide-/, "");
        if (terminalShouldBeHidden && iconName === "terminal-square") {
          if ((_a = item.textContent) == null ? void 0 : _a.toLowerCase().includes("terminal")) item.remove();
        }
        if (configShouldBeHidden && (iconName === "rocket" || iconName === "wrench")) {
          if ((_b = item.textContent) == null ? void 0 : _b.toLowerCase().includes("config")) item.remove();
        }
      }
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3R5cGVzLnRzIiwgInNyYy9zZXR0aW5ncy50cyIsICJzcmMvY29tbWFuZHMvaW5kZXgudHMiLCAic3JjL3V0aWxzL2ZpbGUtb3BlcmF0aW9ucy50cyIsICJzcmMvdXRpbHMvcGF0aC1tYXRjaGluZy50cyIsICJzcmMvdXRpbHMvc3RyaW5nLXV0aWxzLnRzIiwgInNyYy91dGlscy90ZW1wbGF0ZS1wYXJzaW5nLnRzIiwgInNyYy91dGlscy9saW5rLWNvbnZlcnNpb24udHMiLCAic3JjL3VpL3RpdGxlLW1vZGFsLnRzIiwgInNyYy91aS9zZXR0aW5ncy10YWIudHMiLCAic3JjL3VpL2NvbXBvbmVudHMvQ29tbWFuZFBpY2tlck1vZGFsLnRzIiwgInNyYy91aS9jb21wb25lbnRzL0ljb25QaWNrZXJNb2RhbC50cyIsICJzcmMvdWkvY29tcG9uZW50cy9Db25maXJtTW9kYWwudHMiLCAic3JjL3V0aWxzL3NldHRpbmdzLWNvbXBhdC50cyIsICJzcmMvdXRpbHMvaGVhZGluZy1saW5rLWdlbmVyYXRvci50cyIsICJzcmMvc2VydmljZXMvTWlncmF0aW9uU2VydmljZS50cyIsICJzcmMvdWkvY29tcG9uZW50cy9NaWdyYXRpb25Nb2RhbC50cyIsICJzcmMvc2VydmljZXMvQ3JlYXRlRXZlbnRTZXJ2aWNlLnRzIiwgInNyYy9zZXJ2aWNlcy9Gcm9udG1hdHRlclNlcnZpY2UudHMiLCAic3JjL3V0aWxzL2RvbS50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHtcclxuXHRQbHVnaW4sXHJcblx0VEZpbGUsXHJcblx0Tm90aWNlLFxyXG5cdHNldEljb24sXHJcblx0UGxhdGZvcm0sXHJcblx0RXZlbnRSZWYsXHJcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MsIERFRkFVTFRfU0VUVElOR1MgfSBmcm9tIFwiLi9zZXR0aW5nc1wiO1xyXG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlLCBDb250ZW50VHlwZSB9IGZyb20gXCIuL3R5cGVzXCI7XHJcbmltcG9ydCB7IHJlZ2lzdGVyQ29tbWFuZHMsIHJlZ2lzdGVyQ29udGVudFR5cGVDb21tYW5kcywgcmVuYW1lQ29udGVudEJ5UGF0aCBhcyByZW5hbWVDb250ZW50QnlQYXRoRnVuY3Rpb24sIG9wZW5UZXJtaW5hbEluUHJvamVjdFJvb3QsIG9wZW5Db25maWdGaWxlIH0gZnJvbSBcIi4vY29tbWFuZHNcIjtcclxuaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdUYWIgfSBmcm9tIFwiLi91aS9zZXR0aW5ncy10YWJcIjtcclxuaW1wb3J0IHsgRmlsZU9wZXJhdGlvbnMgfSBmcm9tIFwiLi91dGlscy9maWxlLW9wZXJhdGlvbnNcIjtcclxuaW1wb3J0IHsgVGVtcGxhdGVQYXJzZXIgfSBmcm9tIFwiLi91dGlscy90ZW1wbGF0ZS1wYXJzaW5nXCI7XHJcbmltcG9ydCB7IEhlYWRpbmdMaW5rR2VuZXJhdG9yIH0gZnJvbSBcIi4vdXRpbHMvaGVhZGluZy1saW5rLWdlbmVyYXRvclwiO1xyXG5pbXBvcnQgeyBNaWdyYXRpb25TZXJ2aWNlIH0gZnJvbSBcIi4vc2VydmljZXMvTWlncmF0aW9uU2VydmljZVwiO1xyXG5pbXBvcnQgeyBDcmVhdGVFdmVudFNlcnZpY2UgfSBmcm9tIFwiLi9zZXJ2aWNlcy9DcmVhdGVFdmVudFNlcnZpY2VcIjtcclxuaW1wb3J0IHsgRnJvbnRtYXR0ZXJTZXJ2aWNlIH0gZnJvbSBcIi4vc2VydmljZXMvRnJvbnRtYXR0ZXJTZXJ2aWNlXCI7XHJcbmltcG9ydCB7IHdhaXRGb3JFbGVtZW50IH0gZnJvbSBcIi4vdXRpbHMvZG9tXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBc3Ryb0NvbXBvc2VyUGx1Z2luIGV4dGVuZHMgUGx1Z2luIGltcGxlbWVudHMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSB7XHJcblx0c2V0dGluZ3MhOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3M7XHJcblx0cHJpdmF0ZSBjcmVhdGVFdmVudFJlZj86IEV2ZW50UmVmO1xyXG5cdHB1YmxpYyBmaWxlT3BzITogRmlsZU9wZXJhdGlvbnM7XHJcblx0cHVibGljIHRlbXBsYXRlUGFyc2VyITogVGVtcGxhdGVQYXJzZXI7XHJcblx0cHVibGljIGhlYWRpbmdMaW5rR2VuZXJhdG9yITogSGVhZGluZ0xpbmtHZW5lcmF0b3I7XHJcblx0cHVibGljIHBsdWdpbkNyZWF0ZWRGaWxlczogTWFwPHN0cmluZywgbnVtYmVyPiA9IG5ldyBNYXAoKTtcclxuXHRwcml2YXRlIHByb2Nlc3NlZEZpbGVzOiBNYXA8c3RyaW5nLCBudW1iZXI+ID0gbmV3IE1hcCgpO1xyXG5cdHByaXZhdGUgdGVybWluYWxSaWJib25JY29uOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdHByaXZhdGUgY29uZmlnUmliYm9uSWNvbjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuXHRwcml2YXRlIHJpYmJvbkNvbnRleHRNZW51T2JzZXJ2ZXI/OiBNdXRhdGlvbk9ic2VydmVyO1xyXG5cdHByaXZhdGUgaGVscEJ1dHRvbk9ic2VydmVyPzogTXV0YXRpb25PYnNlcnZlcjtcclxuXHRwcml2YXRlIGhlbHBCdXR0b25FbGVtZW50PzogSFRNTEVsZW1lbnQ7XHJcblx0cHJpdmF0ZSBjdXN0b21IZWxwQnV0dG9uPzogSFRNTEVsZW1lbnQ7XHJcblx0cHVibGljIHNldHRpbmdzVGFiPzogQXN0cm9Db21wb3NlclNldHRpbmdUYWI7XHJcblxyXG5cdHByaXZhdGUgbWlncmF0aW9uU2VydmljZSE6IE1pZ3JhdGlvblNlcnZpY2U7XHJcblx0cHJpdmF0ZSBjcmVhdGVFdmVudFNlcnZpY2UhOiBDcmVhdGVFdmVudFNlcnZpY2U7XHJcblx0cHVibGljIGZyb250bWF0dGVyU2VydmljZSE6IEZyb250bWF0dGVyU2VydmljZTtcclxuXHJcblx0LyoqXHJcblx0ICogTWlncmF0ZSBvbGQgcG9zdHMvcGFnZXMgc2V0dGluZ3MgdG8gdW5pZmllZCBjb250ZW50IHR5cGVzXHJcblx0ICovXHJcblx0cHJpdmF0ZSBhc3luYyBtaWdyYXRlU2V0dGluZ3NJZk5lZWRlZCgpOiBQcm9taXNlPHZvaWQ+IHtcclxuXHRcdGlmICghdGhpcy5taWdyYXRpb25TZXJ2aWNlKSB7XHJcblx0XHRcdHRoaXMubWlncmF0aW9uU2VydmljZSA9IG5ldyBNaWdyYXRpb25TZXJ2aWNlKHRoaXMuYXBwLCB0aGlzKTtcclxuXHRcdH1cclxuXHRcdGF3YWl0IHRoaXMubWlncmF0aW9uU2VydmljZS5taWdyYXRlU2V0dGluZ3NJZk5lZWRlZCgpO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgb25sb2FkKCkge1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcclxuXHJcblx0XHRcdC8vIEluaXRpYWxpemUgc2VydmljZXMgKG9yZGVyIG1hdHRlcnM6IGZpbGVPcHMgZmlyc3QgYXMgaXQncyBhIGRlcGVuZGVuY3kpXHJcblx0XHRcdHRoaXMuZmlsZU9wcyA9IG5ldyBGaWxlT3BlcmF0aW9ucyh0aGlzLmFwcCwgdGhpcy5zZXR0aW5ncywgdGhpcyk7XHJcblx0XHRcdHRoaXMubWlncmF0aW9uU2VydmljZSA9IG5ldyBNaWdyYXRpb25TZXJ2aWNlKHRoaXMuYXBwLCB0aGlzKTtcclxuXHRcdFx0dGhpcy5jcmVhdGVFdmVudFNlcnZpY2UgPSBuZXcgQ3JlYXRlRXZlbnRTZXJ2aWNlKHRoaXMuYXBwLCB0aGlzKTtcclxuXHRcdFx0dGhpcy5mcm9udG1hdHRlclNlcnZpY2UgPSBuZXcgRnJvbnRtYXR0ZXJTZXJ2aWNlKHRoaXMuYXBwLCB0aGlzKTtcclxuXHRcdFx0dGhpcy50ZW1wbGF0ZVBhcnNlciA9IG5ldyBUZW1wbGF0ZVBhcnNlcih0aGlzLmFwcCwgdGhpcy5zZXR0aW5ncyk7XHJcblx0XHRcdHRoaXMuaGVhZGluZ0xpbmtHZW5lcmF0b3IgPSBuZXcgSGVhZGluZ0xpbmtHZW5lcmF0b3IodGhpcy5zZXR0aW5ncyk7XHJcblxyXG5cdFx0XHQvLyBSZWdpc3RlciBNRFggZmlsZSB2aXNpYmlsaXR5IGlmIGVuYWJsZWQgKHNhZmVseSBoYW5kbGUgaWYgYWxyZWFkeSByZWdpc3RlcmVkKVxyXG5cdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5zaG93TWR4RmlsZXNJbkV4cGxvcmVyKSB7XHJcblx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdHRoaXMucmVnaXN0ZXJFeHRlbnNpb25zKFtcIm1keFwiXSwgXCJtYXJrZG93blwiKTtcclxuXHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xyXG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiW0FzdHJvIENvbXBvc2VyXSBNRFggZXh0ZW5zaW9uIGFscmVhZHkgcmVnaXN0ZXJlZDpcIiwgZXJyb3IpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gSGFuZGxlIGxheW91dC1yZWFkeSBpbml0aWFsaXphdGlvbiAoZGVza3RvcCBvbmx5KVxyXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5yZWdpc3RlckNyZWF0ZUV2ZW50KCk7XHJcblx0XHRcdFx0Ly8gSW5pdGlhbGl6ZSBoZWxwIGJ1dHRvbiByZXBsYWNlbWVudCAoZGVza3RvcCBvbmx5KVxyXG5cdFx0XHRcdGlmICghUGxhdGZvcm0uaXNNb2JpbGUpIHtcclxuXHRcdFx0XHRcdHZvaWQgdGhpcy51cGRhdGVIZWxwQnV0dG9uKCk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvLyBSdW4gbWlncmF0aW9uIGFmdGVyIHBsdWdpbiBpcyBmdWxseSBsb2FkZWQgKG5vbi1ibG9ja2luZylcclxuXHRcdFx0XHR2b2lkIHRoaXMubWlncmF0ZVNldHRpbmdzSWZOZWVkZWQoKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBSZWdpc3RlciBjb21tYW5kc1xyXG5cdFx0XHRyZWdpc3RlckNvbW1hbmRzKHRoaXMsIHRoaXMuc2V0dGluZ3MpO1xyXG5cdFx0XHRyZWdpc3RlckNvbnRlbnRUeXBlQ29tbWFuZHModGhpcywgdGhpcy5zZXR0aW5ncyk7XHJcblxyXG5cdFx0XHQvLyBBZGQgc2V0dGluZ3MgdGFiXHJcblx0XHRcdHRoaXMuc2V0dGluZ3NUYWIgPSBuZXcgQXN0cm9Db21wb3NlclNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpO1xyXG5cdFx0XHR0aGlzLmFkZFNldHRpbmdUYWIodGhpcy5zZXR0aW5nc1RhYik7XHJcblxyXG5cdFx0XHQvLyBSZWdpc3RlciBVSSBlbGVtZW50c1xyXG5cdFx0XHR0aGlzLnJlZ2lzdGVyQ29udGV4dE1lbnUoKTtcclxuXHRcdFx0dGhpcy5yZWdpc3RlclJpYmJvbkljb25zKCk7XHJcblx0XHRcdHRoaXMuc2V0dXBSaWJib25Db250ZXh0TWVudUhhbmRsaW5nKCk7XHJcblx0XHR9IGNhdGNoIChlcnJvcikge1xyXG5cdFx0XHRjb25zb2xlLmVycm9yKFwiW0FzdHJvIENvbXBvc2VyXSBDcml0aWNhbCBlcnJvciBkdXJpbmcgb25sb2FkOlwiLCBlcnJvcik7XHJcblx0XHRcdG5ldyBOb3RpY2UoXCJBc3RybyBDb21wb3NlciBmYWlsZWQgdG8gbG9hZC4gQ2hlY2sgY29uc29sZSAoQ3RybCtTaGlmdCtJKSBmb3IgZGV0YWlscy5cIik7XHJcblx0XHRcdHRocm93IGVycm9yO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHVibGljIHJlZ2lzdGVyQ3JlYXRlRXZlbnQoKSB7XHJcblx0XHRpZiAodGhpcy5jcmVhdGVFdmVudFJlZikge1xyXG5cdFx0XHR0aGlzLmFwcC52YXVsdC5vZmZyZWYodGhpcy5jcmVhdGVFdmVudFJlZik7XHJcblx0XHRcdHRoaXMuY3JlYXRlRXZlbnRSZWYgPSB1bmRlZmluZWQ7XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3QgY3JlYXRlRXZlbnRSZWYgPSB0aGlzLmFwcC52YXVsdC5vbihcImNyZWF0ZVwiLCAoZmlsZSkgPT4ge1xyXG5cdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRcdFx0dGhpcy5jcmVhdGVFdmVudFNlcnZpY2UuaGFuZGxlQ3JlYXRlKGZpbGUpO1xyXG5cdFx0XHRcdHRoaXMuY2xlYW51cFBsdWdpbkNyZWF0ZWRGaWxlcygpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChjcmVhdGVFdmVudFJlZik7XHJcblx0XHR0aGlzLmNyZWF0ZUV2ZW50UmVmID0gY3JlYXRlRXZlbnRSZWY7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIGNsZWFudXBQbHVnaW5DcmVhdGVkRmlsZXMoKSB7XHJcblx0XHRjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG5cdFx0Y29uc3QgdHRsID0gNSAqIDYwICogMTAwMDsgLy8gNSBtaW51dGVzXHJcblx0XHRmb3IgKGNvbnN0IFtwYXRoLCB0aW1lc3RhbXBdIG9mIHRoaXMucGx1Z2luQ3JlYXRlZEZpbGVzLmVudHJpZXMoKSkge1xyXG5cdFx0XHRpZiAobm93IC0gdGltZXN0YW1wID4gdHRsKSB7XHJcblx0XHRcdFx0dGhpcy5wbHVnaW5DcmVhdGVkRmlsZXMuZGVsZXRlKHBhdGgpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcblx0XHRjb25zdCBsb2FkZWREYXRhID0gKGF3YWl0IHRoaXMubG9hZERhdGEoKSkgYXMgdW5rbm93bjtcclxuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBsb2FkZWREYXRhIGFzIFBhcnRpYWw8QXN0cm9Db21wb3NlclNldHRpbmdzPiB8IG51bGwgfCB1bmRlZmluZWQpO1xyXG5cclxuXHRcdC8vIEVuc3VyZSBjb250ZW50VHlwZXMgaXMgYWx3YXlzIGFuIGFycmF5IChuZXZlciB1bmRlZmluZWQgb3IgbnVsbClcclxuXHRcdGlmICghdGhpcy5zZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgIUFycmF5LmlzQXJyYXkodGhpcy5zZXR0aW5ncy5jb250ZW50VHlwZXMpKSB7XHJcblx0XHRcdHRoaXMuc2V0dGluZ3MuY29udGVudFR5cGVzID0gW107XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCF0aGlzLnNldHRpbmdzLm1pZ3JhdGlvbkNvbXBsZXRlZCkge1xyXG5cdFx0XHRjb25zdCBsZWdhY3lTZXR0aW5ncyA9IHRoaXMuc2V0dGluZ3MgYXMgdW5rbm93biBhcyB7IGN1c3RvbUNvbnRlbnRUeXBlcz86IENvbnRlbnRUeXBlW10gfTtcclxuXHRcdFx0Y29uc3QgaGFzTGVnYWN5VHlwZXMgPSBsZWdhY3lTZXR0aW5ncy5jdXN0b21Db250ZW50VHlwZXMgJiYgQXJyYXkuaXNBcnJheShsZWdhY3lTZXR0aW5ncy5jdXN0b21Db250ZW50VHlwZXMpICYmIGxlZ2FjeVNldHRpbmdzLmN1c3RvbUNvbnRlbnRUeXBlcy5sZW5ndGggPiAwO1xyXG5cdFx0XHRjb25zdCBoYXNOZXdUeXBlcyA9IHRoaXMuc2V0dGluZ3MuY29udGVudFR5cGVzICYmIEFycmF5LmlzQXJyYXkodGhpcy5zZXR0aW5ncy5jb250ZW50VHlwZXMpICYmIHRoaXMuc2V0dGluZ3MuY29udGVudFR5cGVzLmxlbmd0aCA+IDA7XHJcblxyXG5cdFx0XHRpZiAoaGFzTGVnYWN5VHlwZXMgJiYgIWhhc05ld1R5cGVzKSB7XHJcblx0XHRcdFx0dGhpcy5zZXR0aW5ncy5jb250ZW50VHlwZXMgPSBsZWdhY3lTZXR0aW5ncy5jdXN0b21Db250ZW50VHlwZXMgfHwgW107XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGNvbnN0IGxlZ2FjeUZpZWxkcyA9IFtcclxuXHRcdFx0XHQnY3VzdG9tQ29udGVudFR5cGVzJywgJ2VuYWJsZVVuZGVyc2NvcmVQcmVmaXgnLCAncG9zdHNGb2xkZXInLCAncG9zdHNMaW5rQmFzZVBhdGgnLFxyXG5cdFx0XHRcdCdhdXRvbWF0ZVBvc3RDcmVhdGlvbicsICdjcmVhdGlvbk1vZGUnLCAnaW5kZXhGaWxlTmFtZScsICdleGNsdWRlZERpcmVjdG9yaWVzJyxcclxuXHRcdFx0XHQnb25seUF1dG9tYXRlSW5Qb3N0c0ZvbGRlcicsICdlbmFibGVQYWdlcycsICdwYWdlc0ZvbGRlcicsICdwYWdlc0xpbmtCYXNlUGF0aCcsXHJcblx0XHRcdFx0J3BhZ2VzQ3JlYXRpb25Nb2RlJywgJ3BhZ2VzSW5kZXhGaWxlTmFtZScsICdwYWdlVGVtcGxhdGUnLCAnb25seUF1dG9tYXRlSW5QYWdlc0ZvbGRlcicsXHJcblx0XHRcdFx0J2xpbmtCYXNlUGF0aCcsICdlbmFibGVBdXRvUmVuYW1lJywgJ2VuYWJsZUF1dG9JbnNlcnRGcm9udG1hdHRlcicsICdkcmFmdFN0eWxlJ1xyXG5cdFx0XHRdO1xyXG5cclxuXHRcdFx0Y29uc3Qgc2V0dGluZ3NSZWNvcmQgPSB0aGlzLnNldHRpbmdzIGFzIHVua25vd24gYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XHJcblx0XHRcdGxldCBmaWVsZHNSZW1vdmVkID0gZmFsc2U7XHJcblx0XHRcdGZvciAoY29uc3QgZmllbGQgb2YgbGVnYWN5RmllbGRzKSB7XHJcblx0XHRcdFx0aWYgKHNldHRpbmdzUmVjb3JkW2ZpZWxkXSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRkZWxldGUgc2V0dGluZ3NSZWNvcmRbZmllbGRdO1xyXG5cdFx0XHRcdFx0ZmllbGRzUmVtb3ZlZCA9IHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdC8vIE9ubHkgc2F2ZSBpZiB3ZSBhY3R1YWxseSBjbGVhbmVkIHVwIGZpZWxkcyB0byBhdm9pZCByZWR1bmRhbnQgd3JpdGVzXHJcblx0XHRcdGlmIChmaWVsZHNSZW1vdmVkKSB7XHJcblx0XHRcdFx0YXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xyXG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgcmVnaXN0ZXJDb250ZXh0TWVudSgpIHtcclxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcclxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItbWVudScsIChtZW51LCBlZGl0b3IsIHZpZXcpID0+IHtcclxuXHRcdFx0XHRpZiAoIXRoaXMuc2V0dGluZ3MuZW5hYmxlQ29weUhlYWRpbmdMaW5rKSB7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XHJcblx0XHRcdFx0Y29uc3QgZmlsZSA9IHZpZXcuZmlsZTtcclxuXHJcblx0XHRcdFx0aWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0Y29uc3QgaGVhZGluZyA9IHRoaXMuaGVhZGluZ0xpbmtHZW5lcmF0b3IuZmluZEhlYWRpbmdBdExpbmUodGhpcy5hcHAsIGZpbGUsIGN1cnNvci5saW5lKTtcclxuXHJcblx0XHRcdFx0aWYgKGhlYWRpbmcpIHtcclxuXHRcdFx0XHRcdGNvbnN0IGZ1bGxMaW5rID0gdGhpcy5oZWFkaW5nTGlua0dlbmVyYXRvci5nZW5lcmF0ZUxpbmsodGhpcy5hcHAsIGZpbGUsIGhlYWRpbmcpO1xyXG5cdFx0XHRcdFx0Y29uc3QgdXJsT25seSA9IHRoaXMuaGVhZGluZ0xpbmtHZW5lcmF0b3IuZXh0cmFjdFVybChmdWxsTGluayk7XHJcblxyXG5cdFx0XHRcdFx0bWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XHJcblx0XHRcdFx0XHRcdGl0ZW1cclxuXHRcdFx0XHRcdFx0XHQuc2V0VGl0bGUoJ0NvcHkgaGVhZGluZyBsaW5rJylcclxuXHRcdFx0XHRcdFx0XHQuc2V0SWNvbignbGluay0yJylcclxuXHRcdFx0XHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dCh1cmxPbmx5KTtcclxuXHRcdFx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoJ0hlYWRpbmcgbGluayBjb3BpZWQgdG8gY2xpcGJvYXJkJyk7XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0XHRtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcclxuXHRcdFx0XHRcdFx0aXRlbVxyXG5cdFx0XHRcdFx0XHRcdC5zZXRUaXRsZSgnQ29weSBoZWFkaW5nIGxpbmsgd2l0aCB0ZXh0JylcclxuXHRcdFx0XHRcdFx0XHQuc2V0SWNvbignaGVhZGluZycpXHJcblx0XHRcdFx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoZnVsbExpbmspO1xyXG5cdFx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZSgnSGVhZGluZyBsaW5rIHdpdGggdGV4dCBjb3BpZWQgdG8gY2xpcGJvYXJkJyk7XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pXHJcblx0XHQpO1xyXG5cdH1cclxuXHJcblx0cmVuYW1lQ29udGVudEJ5UGF0aChmaWxlUGF0aDogc3RyaW5nKTogdm9pZCB7XHJcblx0XHRyZW5hbWVDb250ZW50QnlQYXRoRnVuY3Rpb24odGhpcy5hcHAsIGZpbGVQYXRoLCB0aGlzLnNldHRpbmdzLCB0aGlzKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyByZWdpc3RlclJpYmJvbkljb25zKCkge1xyXG5cdFx0aWYgKFBsYXRmb3JtLmlzTW9iaWxlKSB7XHJcblx0XHRcdGlmICh0aGlzLnRlcm1pbmFsUmliYm9uSWNvbikge1xyXG5cdFx0XHRcdHRyeSB7IGlmICh0aGlzLnRlcm1pbmFsUmliYm9uSWNvbi5wYXJlbnROb2RlKSB0aGlzLnRlcm1pbmFsUmliYm9uSWNvbi5yZW1vdmUoKTsgfSBjYXRjaCB7IC8qIElnbm9yZSAqLyB9XHJcblx0XHRcdFx0dGhpcy50ZXJtaW5hbFJpYmJvbkljb24gPSBudWxsO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICh0aGlzLmNvbmZpZ1JpYmJvbkljb24pIHtcclxuXHRcdFx0XHR0cnkgeyBpZiAodGhpcy5jb25maWdSaWJib25JY29uLnBhcmVudE5vZGUpIHRoaXMuY29uZmlnUmliYm9uSWNvbi5yZW1vdmUoKTsgfSBjYXRjaCB7IC8qIElnbm9yZSAqLyB9XHJcblx0XHRcdFx0dGhpcy5jb25maWdSaWJib25JY29uID0gbnVsbDtcclxuXHRcdFx0fVxyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGNvbnN0IHRlcm1pbmFsSWNvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2lkZS1kb2NrLXJpYmJvbi1hY3Rpb25bYXJpYS1sYWJlbD1cIk9wZW4gcHJvamVjdCB0ZXJtaW5hbFwiXScpO1xyXG5cdFx0XHRcdHRlcm1pbmFsSWNvbnMuZm9yRWFjaCgoaWNvbjogRWxlbWVudCkgPT4gaWNvbi5yZW1vdmUoKSk7XHJcblx0XHRcdFx0Y29uc3QgY29uZmlnSWNvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2lkZS1kb2NrLXJpYmJvbi1hY3Rpb25bYXJpYS1sYWJlbD1cIkVkaXQgYXN0cm8gY29uZmlnXCJdJyk7XHJcblx0XHRcdFx0Y29uZmlnSWNvbnMuZm9yRWFjaCgoaWNvbjogRWxlbWVudCkgPT4gaWNvbi5yZW1vdmUoKSk7XHJcblx0XHRcdH0gY2F0Y2ggeyAvKiBJZ25vcmUgKi8gfVxyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3QgdGVybWluYWxTaG91bGRFeGlzdCA9IHRoaXMuc2V0dGluZ3MuZW5hYmxlVGVybWluYWxSaWJib25JY29uICYmIHRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZDtcclxuXHRcdGNvbnN0IGNvbmZpZ1Nob3VsZEV4aXN0ID0gdGhpcy5zZXR0aW5ncy5lbmFibGVDb25maWdSaWJib25JY29uICYmIHRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kO1xyXG5cclxuXHRcdGlmICh0aGlzLnRlcm1pbmFsUmliYm9uSWNvbikge1xyXG5cdFx0XHR0cnkgeyBpZiAodGhpcy50ZXJtaW5hbFJpYmJvbkljb24ucGFyZW50Tm9kZSkgdGhpcy50ZXJtaW5hbFJpYmJvbkljb24ucmVtb3ZlKCk7IH0gY2F0Y2ggeyAvKiBJZ25vcmUgKi8gfVxyXG5cdFx0XHR0aGlzLnRlcm1pbmFsUmliYm9uSWNvbiA9IG51bGw7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMuY29uZmlnUmliYm9uSWNvbikge1xyXG5cdFx0XHR0cnkgeyBpZiAodGhpcy5jb25maWdSaWJib25JY29uLnBhcmVudE5vZGUpIHRoaXMuY29uZmlnUmliYm9uSWNvbi5yZW1vdmUoKTsgfSBjYXRjaCB7IC8qIElnbm9yZSAqLyB9XHJcblx0XHRcdHRoaXMuY29uZmlnUmliYm9uSWNvbiA9IG51bGw7XHJcblx0XHR9XHJcblxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNpZGUtZG9jay1yaWJib24tYWN0aW9uW2FyaWEtbGFiZWw9XCJPcGVuIHByb2plY3QgdGVybWluYWxcIl0nKS5mb3JFYWNoKGVsID0+IGVsLnJlbW92ZSgpKTtcclxuXHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNpZGUtZG9jay1yaWJib24tYWN0aW9uW2FyaWEtbGFiZWw9XCJFZGl0IGFzdHJvIGNvbmZpZ1wiXScpLmZvckVhY2goZWwgPT4gZWwucmVtb3ZlKCkpO1xyXG5cdFx0fSBjYXRjaCB7IC8qIElnbm9yZSAqLyB9XHJcblxyXG5cdFx0aWYgKHRlcm1pbmFsU2hvdWxkRXhpc3QpIHtcclxuXHRcdFx0dGhpcy50ZXJtaW5hbFJpYmJvbkljb24gPSB0aGlzLmFkZFJpYmJvbkljb24oJ3Rlcm1pbmFsLXNxdWFyZScsICdPcGVuIHByb2plY3QgdGVybWluYWwnLCAoKSA9PiB7XHJcblx0XHRcdFx0aWYgKCF0aGlzLnNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpIHtcclxuXHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJPcGVuIHRlcm1pbmFsIGNvbW1hbmQgaXMgZGlzYWJsZWQuXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRvcGVuVGVybWluYWxJblByb2plY3RSb290KHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzKTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdGlmICh0aGlzLnRlcm1pbmFsUmliYm9uSWNvbikgdGhpcy50ZXJtaW5hbFJpYmJvbkljb24uc2V0QXR0cmlidXRlKCdkYXRhLWFzdHJvLWNvbXBvc2VyLXRlcm1pbmFsLXJpYmJvbicsICd0cnVlJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGNvbmZpZ1Nob3VsZEV4aXN0KSB7XHJcblx0XHRcdHRoaXMuY29uZmlnUmliYm9uSWNvbiA9IHRoaXMuYWRkUmliYm9uSWNvbigncm9ja2V0JywgJ0VkaXQgYXN0cm8gY29uZmlnJywgYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdGlmICghdGhpcy5zZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpIHtcclxuXHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJFZGl0IGNvbmZpZyBmaWxlIGNvbW1hbmQgaXMgZGlzYWJsZWQuXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRhd2FpdCBvcGVuQ29uZmlnRmlsZSh0aGlzLmFwcCwgdGhpcy5zZXR0aW5ncyk7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRpZiAodGhpcy5jb25maWdSaWJib25JY29uKSB0aGlzLmNvbmZpZ1JpYmJvbkljb24uc2V0QXR0cmlidXRlKCdkYXRhLWFzdHJvLWNvbXBvc2VyLWNvbmZpZy1yaWJib24nLCAndHJ1ZScpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMudXBkYXRlUmliYm9uQ29udGV4dE1lbnVDU1MoKTtcclxuXHRcdHRoaXMuc2V0dXBSaWJib25Db250ZXh0TWVudU9ic2VydmVyKCk7XHJcblx0fVxyXG5cclxuXHRvbnVubG9hZCgpIHtcclxuXHRcdGlmICh0aGlzLnRlcm1pbmFsUmliYm9uSWNvbikge1xyXG5cdFx0XHR0aGlzLnRlcm1pbmFsUmliYm9uSWNvbi5yZW1vdmUoKTtcclxuXHRcdFx0dGhpcy50ZXJtaW5hbFJpYmJvbkljb24gPSBudWxsO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHRoaXMuY29uZmlnUmliYm9uSWNvbikge1xyXG5cdFx0XHR0aGlzLmNvbmZpZ1JpYmJvbkljb24ucmVtb3ZlKCk7XHJcblx0XHRcdHRoaXMuY29uZmlnUmliYm9uSWNvbiA9IG51bGw7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5yaWJib25Db250ZXh0TWVudU9ic2VydmVyKSB7XHJcblx0XHRcdHRoaXMucmliYm9uQ29udGV4dE1lbnVPYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcblx0XHRcdHRoaXMucmliYm9uQ29udGV4dE1lbnVPYnNlcnZlciA9IHVuZGVmaW5lZDtcclxuXHRcdH1cclxuXHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLWhpZGUtdGVybWluYWwtaWNvbicpO1xyXG5cdFx0ZG9jdW1lbnQuYm9keS5yZW1vdmVDbGFzcygnYXN0cm8tY29tcG9zZXItaGlkZS1jb25maWctaWNvbicpO1xyXG5cdFx0aWYgKHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyKSB7XHJcblx0XHRcdHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuXHRcdFx0dGhpcy5oZWxwQnV0dG9uT2JzZXJ2ZXIgPSB1bmRlZmluZWQ7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5jdXN0b21IZWxwQnV0dG9uKSB7XHJcblx0XHRcdHRoaXMuY3VzdG9tSGVscEJ1dHRvbi5yZW1vdmUoKTtcclxuXHRcdFx0dGhpcy5jdXN0b21IZWxwQnV0dG9uID0gdW5kZWZpbmVkO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5oZWxwQnV0dG9uRWxlbWVudCA9IHVuZGVmaW5lZDtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgc2V0dXBSaWJib25Db250ZXh0TWVudUhhbmRsaW5nKCkge1xyXG5cdFx0dGhpcy51cGRhdGVSaWJib25Db250ZXh0TWVudUNTUygpO1xyXG5cdFx0dGhpcy5zZXR1cFJpYmJvbkNvbnRleHRNZW51T2JzZXJ2ZXIoKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgdXBkYXRlUmliYm9uQ29udGV4dE1lbnVDU1MoKSB7XHJcblx0XHRjb25zdCB0ZXJtaW5hbFNob3VsZEJlSGlkZGVuID0gIXRoaXMuc2V0dGluZ3MuZW5hYmxlVGVybWluYWxSaWJib25JY29uIHx8ICF0aGlzLnNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQ7XHJcblx0XHRjb25zdCBjb25maWdTaG91bGRCZUhpZGRlbiA9ICF0aGlzLnNldHRpbmdzLmVuYWJsZUNvbmZpZ1JpYmJvbkljb24gfHwgIXRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kO1xyXG5cclxuXHRcdGlmICh0ZXJtaW5hbFNob3VsZEJlSGlkZGVuKSBkb2N1bWVudC5ib2R5LmFkZENsYXNzKCdhc3Ryby1jb21wb3Nlci1oaWRlLXRlcm1pbmFsLWljb24nKTtcclxuXHRcdGVsc2UgZG9jdW1lbnQuYm9keS5yZW1vdmVDbGFzcygnYXN0cm8tY29tcG9zZXItaGlkZS10ZXJtaW5hbC1pY29uJyk7XHJcblxyXG5cdFx0aWYgKGNvbmZpZ1Nob3VsZEJlSGlkZGVuKSBkb2N1bWVudC5ib2R5LmFkZENsYXNzKCdhc3Ryby1jb21wb3Nlci1oaWRlLWNvbmZpZy1pY29uJyk7XHJcblx0XHRlbHNlIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLWhpZGUtY29uZmlnLWljb24nKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgc2V0dXBSaWJib25Db250ZXh0TWVudU9ic2VydmVyKCkge1xyXG5cdFx0aWYgKHRoaXMucmliYm9uQ29udGV4dE1lbnVPYnNlcnZlcikgdGhpcy5yaWJib25Db250ZXh0TWVudU9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuXHJcblx0XHRjb25zdCB0ZXJtaW5hbFNob3VsZEJlSGlkZGVuID0gIXRoaXMuc2V0dGluZ3MuZW5hYmxlVGVybWluYWxSaWJib25JY29uIHx8ICF0aGlzLnNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQ7XHJcblx0XHRjb25zdCBjb25maWdTaG91bGRCZUhpZGRlbiA9ICF0aGlzLnNldHRpbmdzLmVuYWJsZUNvbmZpZ1JpYmJvbkljb24gfHwgIXRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kO1xyXG5cclxuXHRcdGlmICghdGVybWluYWxTaG91bGRCZUhpZGRlbiAmJiAhY29uZmlnU2hvdWxkQmVIaWRkZW4pIHJldHVybjtcclxuXHJcblx0XHR0aGlzLnJpYmJvbkNvbnRleHRNZW51T2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zKSA9PiB7XHJcblx0XHRcdGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zKSB7XHJcblx0XHRcdFx0aWYgKG11dGF0aW9uLmFkZGVkTm9kZXMubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0Zm9yIChjb25zdCBub2RlIG9mIEFycmF5LmZyb20obXV0YXRpb24uYWRkZWROb2RlcykpIHtcclxuXHRcdFx0XHRcdFx0aWYgKG5vZGUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG5cdFx0XHRcdFx0XHRcdGlmIChub2RlLmNsYXNzTGlzdC5jb250YWlucygnbWVudScpIHx8IG5vZGUucXVlcnlTZWxlY3RvcignLm1lbnUnKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5yZW1vdmVSaWJib25JY29uc0Zyb21Db250ZXh0TWVudShub2RlKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdHRoaXMucmliYm9uQ29udGV4dE1lbnVPYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHsgY2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlIH0pO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSB1cGRhdGVIZWxwQnV0dG9uQ1NTKCkge1xyXG5cdFx0aWYgKHRoaXMuc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50Py5lbmFibGVkKSBkb2N1bWVudC5ib2R5LmFkZENsYXNzKCdhc3Ryby1jb21wb3Nlci1oaWRlLWhlbHAtYnV0dG9uJyk7XHJcblx0XHRlbHNlIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLWhpZGUtaGVscC1idXR0b24nKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBhc3luYyB1cGRhdGVIZWxwQnV0dG9uKCkge1xyXG5cdFx0aWYgKFBsYXRmb3JtLmlzTW9iaWxlKSB7XHJcblx0XHRcdHRoaXMucmVzdG9yZUhlbHBCdXR0b24oKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLmhlbHBCdXR0b25PYnNlcnZlcikgdGhpcy5oZWxwQnV0dG9uT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xyXG5cclxuXHRcdC8vIFJFTU9WRUQgbG9hZFNldHRpbmdzKCkgY2FsbCBoZXJlLiBJdCB3YXMgY2F1c2luZyByZWR1bmRhbnQgZGF0YS5qc29uIHdyaXRlcy5cclxuXHRcdC8vIFRoZSBwbHVnaW4ncyB0aGlzLnNldHRpbmdzIGlzIHVwZGF0ZWQgYnkgdGhlIHNldHRpbmdzIHRhYiBvciBvdGhlciBtZXRob2RzXHJcblx0XHQvLyB0aGF0IGNvcnJlY3RseSBoYW5kbGUgc2F2aW5nLlxyXG5cdFx0dGhpcy51cGRhdGVIZWxwQnV0dG9uQ1NTKCk7XHJcblxyXG5cdFx0aWYgKCF0aGlzLnNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudD8uZW5hYmxlZCkge1xyXG5cdFx0XHR0aGlzLnJlc3RvcmVIZWxwQnV0dG9uKCk7XHJcblx0XHRcdHRoaXMuc2V0dXBIZWxwQnV0dG9uT2JzZXJ2ZXIoKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IGhlbHBCdXR0b24gPSBhd2FpdCB3YWl0Rm9yRWxlbWVudCgnLndvcmtzcGFjZS1kcmF3ZXItdmF1bHQtYWN0aW9ucyAuY2xpY2thYmxlLWljb24gc3ZnLmhlbHAnLCAxMDAwMClcclxuXHRcdFx0XHQudGhlbihzdmcgPT4gc3ZnLnBhcmVudEVsZW1lbnQgYXMgSFRNTEVsZW1lbnQpO1xyXG5cclxuXHRcdFx0aWYgKCFoZWxwQnV0dG9uKSB7XHJcblx0XHRcdFx0dGhpcy5zZXR1cEhlbHBCdXR0b25PYnNlcnZlcigpO1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dGhpcy5oZWxwQnV0dG9uRWxlbWVudCA9IGhlbHBCdXR0b247XHJcblxyXG5cdFx0XHRpZiAodGhpcy5jdXN0b21IZWxwQnV0dG9uICYmIHRoaXMuY3VzdG9tSGVscEJ1dHRvbi5wYXJlbnRFbGVtZW50ICYmIGRvY3VtZW50LmJvZHkuY29udGFpbnModGhpcy5jdXN0b21IZWxwQnV0dG9uKSAmJlxyXG5cdFx0XHRcdHRoaXMuY3VzdG9tSGVscEJ1dHRvbi5oYXNBdHRyaWJ1dGUoJ2RhdGEtYXN0cm8tY29tcG9zZXItaGVscC1yZXBsYWNlbWVudCcpKSB7XHJcblx0XHRcdFx0dGhpcy5jdXN0b21IZWxwQnV0dG9uLnJlbW92ZSgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuY3VzdG9tSGVscEJ1dHRvbiA9IHVuZGVmaW5lZDtcclxuXHJcblx0XHRcdGNvbnN0IGN1c3RvbUJ1dHRvbiA9IGhlbHBCdXR0b24uY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50O1xyXG5cdFx0XHRjdXN0b21CdXR0b24uYWRkQ2xhc3MoXCJhc3Ryby1jb21wb3Nlci1oZWxwLXJlcGxhY2VtZW50XCIpO1xyXG5cdFx0XHRjdXN0b21CdXR0b24ucmVtb3ZlQXR0cmlidXRlKCdhcmlhLWxhYmVsJyk7XHJcblx0XHRcdGN1c3RvbUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtYXN0cm8tY29tcG9zZXItaGVscC1yZXBsYWNlbWVudCcsICd0cnVlJyk7XHJcblx0XHRcdGN1c3RvbUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdhc3Ryby1jb21wb3Nlci1oZWxwLXJlcGxhY2VtZW50Jyk7XHJcblx0XHRcdGN1c3RvbUJ1dHRvbi5vbmNsaWNrID0gbnVsbDtcclxuXHJcblx0XHRcdGNvbnN0IGljb25Db250YWluZXIgPSBjdXN0b21CdXR0b24ucXVlcnlTZWxlY3Rvcignc3ZnJyk/LnBhcmVudEVsZW1lbnQgfHwgY3VzdG9tQnV0dG9uO1xyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGlmIChpY29uQ29udGFpbmVyIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcclxuXHRcdFx0XHRcdHNldEljb24oaWNvbkNvbnRhaW5lciwgdGhpcy5zZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQuaWNvbklkKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XHJcblx0XHRcdFx0Y29uc29sZS53YXJuKCdbQXN0cm8gQ29tcG9zZXJdIEVycm9yIHNldHRpbmcgaWNvbjonLCBlcnJvcik7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGN1c3RvbUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcclxuXHRcdFx0XHRldnQucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0XHRldnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG5cdFx0XHRcdGNvbnN0IGNvbW1hbmRJZCA9IHRoaXMuc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50Py5jb21tYW5kSWQ7XHJcblx0XHRcdFx0aWYgKGNvbW1hbmRJZCkge1xyXG5cdFx0XHRcdFx0dm9pZCAoYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGFwcFdpdGhDb21tYW5kcyA9IHRoaXMuYXBwIGFzIHVua25vd24gYXMgeyBjb21tYW5kcz86IHsgZXhlY3V0ZUNvbW1hbmRCeUlkPzogKGlkOiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD4gfSB9O1xyXG5cdFx0XHRcdFx0XHRcdGlmIChhcHBXaXRoQ29tbWFuZHMuY29tbWFuZHM/LmV4ZWN1dGVDb21tYW5kQnlJZCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgYXBwV2l0aENvbW1hbmRzLmNvbW1hbmRzLmV4ZWN1dGVDb21tYW5kQnlJZChjb21tYW5kSWQpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3IgZXhlY3V0aW5nIGNvbW1hbmQ6JywgZXJyb3IpO1xyXG5cdFx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byBleGVjdXRlIGNvbW1hbmQ6ICR7Y29tbWFuZElkfWApO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KSgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgdHJ1ZSk7XHJcblxyXG5cdFx0XHRoZWxwQnV0dG9uLnBhcmVudEVsZW1lbnQ/Lmluc2VydEJlZm9yZShjdXN0b21CdXR0b24sIGhlbHBCdXR0b24pO1xyXG5cdFx0XHR0aGlzLmN1c3RvbUhlbHBCdXR0b24gPSBjdXN0b21CdXR0b247XHJcblxyXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQ/LmVuYWJsZWQpIHRoaXMuc2V0dXBIZWxwQnV0dG9uT2JzZXJ2ZXIoKTtcclxuXHRcdFx0fSwgMTAwMCk7XHJcblx0XHR9IGNhdGNoIChlcnJvcikge1xyXG5cdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3IgdXBkYXRpbmcgaGVscCBidXR0b246JywgZXJyb3IpO1xyXG5cdFx0XHR0aGlzLnNldHVwSGVscEJ1dHRvbk9ic2VydmVyKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHNldHVwSGVscEJ1dHRvbk9ic2VydmVyKCkge1xyXG5cdFx0aWYgKHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyKSB0aGlzLmhlbHBCdXR0b25PYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcblx0XHRpZiAoIXRoaXMuc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50Py5lbmFibGVkKSByZXR1cm47XHJcblxyXG5cdFx0bGV0IHVwZGF0ZVRpbWVvdXQ6IG51bWJlciB8IG51bGwgPSBudWxsO1xyXG5cdFx0dGhpcy5oZWxwQnV0dG9uT2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7XHJcblx0XHRcdGlmICh1cGRhdGVUaW1lb3V0KSBjbGVhclRpbWVvdXQodXBkYXRlVGltZW91dCk7XHJcblx0XHRcdHVwZGF0ZVRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgdmF1bHRBY3Rpb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndvcmtzcGFjZS1kcmF3ZXItdmF1bHQtYWN0aW9ucycpO1xyXG5cdFx0XHRcdGlmICghdmF1bHRBY3Rpb25zKSByZXR1cm47XHJcblxyXG5cdFx0XHRcdGNvbnN0IGN1c3RvbUJ1dHRvbkV4aXN0cyA9IHRoaXMuY3VzdG9tSGVscEJ1dHRvbiAmJiB0aGlzLmN1c3RvbUhlbHBCdXR0b24ucGFyZW50RWxlbWVudCAmJiBkb2N1bWVudC5ib2R5LmNvbnRhaW5zKHRoaXMuY3VzdG9tSGVscEJ1dHRvbikgJiZcclxuXHRcdFx0XHRcdHRoaXMuY3VzdG9tSGVscEJ1dHRvbi5oYXNBdHRyaWJ1dGUoJ2RhdGEtYXN0cm8tY29tcG9zZXItaGVscC1yZXBsYWNlbWVudCcpO1xyXG5cclxuXHRcdFx0XHRpZiAoIWN1c3RvbUJ1dHRvbkV4aXN0cykge1xyXG5cdFx0XHRcdFx0aWYgKHRoaXMuY3VzdG9tSGVscEJ1dHRvbiAmJiAoIWRvY3VtZW50LmJvZHkuY29udGFpbnModGhpcy5jdXN0b21IZWxwQnV0dG9uKSB8fCAhdGhpcy5jdXN0b21IZWxwQnV0dG9uLmhhc0F0dHJpYnV0ZSgnZGF0YS1hc3Ryby1jb21wb3Nlci1oZWxwLXJlcGxhY2VtZW50JykpKSB7XHJcblx0XHRcdFx0XHRcdHRoaXMuY3VzdG9tSGVscEJ1dHRvbiA9IHVuZGVmaW5lZDtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHZvaWQgdGhpcy51cGRhdGVIZWxwQnV0dG9uKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LCAxMDApO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Y29uc3QgdmF1bHRBY3Rpb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndvcmtzcGFjZS1kcmF3ZXItdmF1bHQtYWN0aW9ucycpO1xyXG5cdFx0aWYgKHZhdWx0QWN0aW9ucykgdGhpcy5oZWxwQnV0dG9uT2JzZXJ2ZXIub2JzZXJ2ZSh2YXVsdEFjdGlvbnMsIHsgY2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlIH0pO1xyXG5cclxuXHRcdGNvbnN0IHZhdWx0UHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53b3Jrc3BhY2Utc2lkZWRvY2stdmF1bHQtcHJvZmlsZScpO1xyXG5cdFx0aWYgKHZhdWx0UHJvZmlsZSkgdGhpcy5oZWxwQnV0dG9uT2JzZXJ2ZXIub2JzZXJ2ZSh2YXVsdFByb2ZpbGUsIHsgY2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlIH0pO1xyXG5cclxuXHRcdGlmICghdmF1bHRBY3Rpb25zICYmICF2YXVsdFByb2ZpbGUpIHtcclxuXHRcdFx0Y29uc3Qgd29ya3NwYWNlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndvcmtzcGFjZS1zcGxpdCcpO1xyXG5cdFx0XHRpZiAod29ya3NwYWNlKSB0aGlzLmhlbHBCdXR0b25PYnNlcnZlci5vYnNlcnZlKHdvcmtzcGFjZSwgeyBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUgfSk7XHJcblx0XHRcdGVsc2UgdGhpcy5oZWxwQnV0dG9uT2JzZXJ2ZXIub2JzZXJ2ZShkb2N1bWVudC5ib2R5LCB7IGNoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZSB9KTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHByaXZhdGUgcmVzdG9yZUhlbHBCdXR0b24oKSB7XHJcblx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUNsYXNzKCdhc3Ryby1jb21wb3Nlci1oaWRlLWhlbHAtYnV0dG9uJyk7XHJcblx0XHRpZiAodGhpcy5jdXN0b21IZWxwQnV0dG9uKSB7XHJcblx0XHRcdHRoaXMuY3VzdG9tSGVscEJ1dHRvbi5yZW1vdmUoKTtcclxuXHRcdFx0dGhpcy5jdXN0b21IZWxwQnV0dG9uID0gdW5kZWZpbmVkO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5oZWxwQnV0dG9uRWxlbWVudCA9IHVuZGVmaW5lZDtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgcmVtb3ZlUmliYm9uSWNvbnNGcm9tQ29udGV4dE1lbnUobWVudUVsZW1lbnQ6IEhUTUxFbGVtZW50KSB7XHJcblx0XHRjb25zdCB0ZXJtaW5hbFNob3VsZEJlSGlkZGVuID0gIXRoaXMuc2V0dGluZ3MuZW5hYmxlVGVybWluYWxSaWJib25JY29uIHx8ICF0aGlzLnNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQ7XHJcblx0XHRjb25zdCBjb25maWdTaG91bGRCZUhpZGRlbiA9ICF0aGlzLnNldHRpbmdzLmVuYWJsZUNvbmZpZ1JpYmJvbkljb24gfHwgIXRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kO1xyXG5cclxuXHRcdGNvbnN0IG1lbnVJdGVtcyA9IG1lbnVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tZW51LWl0ZW0nKTtcclxuXHRcdGZvciAoY29uc3QgaXRlbSBvZiBBcnJheS5mcm9tKG1lbnVJdGVtcykpIHtcclxuXHRcdFx0Y29uc3Qgc3ZnID0gaXRlbS5xdWVyeVNlbGVjdG9yKCdzdmcnKTtcclxuXHRcdFx0aWYgKHN2Zykge1xyXG5cdFx0XHRcdGxldCBpY29uTmFtZSA9IHN2Zy5nZXRBdHRyaWJ1dGUoJ2RhdGEtbHVjaWRlJykgfHwgc3ZnLmdldEF0dHJpYnV0ZSgneG1sbnM6bHVjaWRlJykgfHxcclxuXHRcdFx0XHRcdHN2Zy5nZXRBdHRyaWJ1dGUoJ2RhdGEtaWNvbicpIHx8XHJcblx0XHRcdFx0XHQoc3ZnLmNsYXNzTGlzdC5jb250YWlucygnbHVjaWRlLXRlcm1pbmFsLXNxdWFyZScpID8gJ3Rlcm1pbmFsLXNxdWFyZScgOiBudWxsKSB8fFxyXG5cdFx0XHRcdFx0KHN2Zy5jbGFzc0xpc3QuY29udGFpbnMoJ2x1Y2lkZS1yb2NrZXQnKSA/ICdyb2NrZXQnIDogbnVsbCkgfHxcclxuXHRcdFx0XHRcdChzdmcuY2xhc3NMaXN0LmNvbnRhaW5zKCdsdWNpZGUtd3JlbmNoJykgPyAnd3JlbmNoJyA6IG51bGwpO1xyXG5cclxuXHRcdFx0XHRpZiAoaWNvbk5hbWUpIGljb25OYW1lID0gaWNvbk5hbWUucmVwbGFjZSgvXmx1Y2lkZS0vLCAnJyk7XHJcblxyXG5cdFx0XHRcdGlmICh0ZXJtaW5hbFNob3VsZEJlSGlkZGVuICYmIGljb25OYW1lID09PSAndGVybWluYWwtc3F1YXJlJykge1xyXG5cdFx0XHRcdFx0aWYgKGl0ZW0udGV4dENvbnRlbnQ/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3Rlcm1pbmFsJykpIGl0ZW0ucmVtb3ZlKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmIChjb25maWdTaG91bGRCZUhpZGRlbiAmJiAoaWNvbk5hbWUgPT09ICdyb2NrZXQnIHx8IGljb25OYW1lID09PSAnd3JlbmNoJykpIHtcclxuXHRcdFx0XHRcdGlmIChpdGVtLnRleHRDb250ZW50Py50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdjb25maWcnKSkgaXRlbS5yZW1vdmUoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcbn1cclxuIiwgImltcG9ydCB7IFRGaWxlLCBQbHVnaW5TZXR0aW5nVGFiIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEFzdHJvQ29tcG9zZXJTZXR0aW5ncyB7XHJcblx0ZGVmYXVsdFRlbXBsYXRlOiBzdHJpbmc7IC8vIEtlcHQgdGVtcG9yYXJpbHkgZm9yIG1pZ3JhdGlvblxyXG5cdGF1dG9JbnNlcnRQcm9wZXJ0aWVzOiBib29sZWFuO1xyXG5cdGRhdGVGb3JtYXQ6IHN0cmluZztcclxuXHRlbmFibGVDb3B5SGVhZGluZ0xpbms6IGJvb2xlYW47XHJcblx0Y29weUhlYWRpbmdMaW5rRm9ybWF0OiBcIm9ic2lkaWFuXCIgfCBcImFzdHJvXCI7XHJcblx0YWRkVHJhaWxpbmdTbGFzaFRvTGlua3M6IGJvb2xlYW47XHJcblx0ZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZDogYm9vbGVhbjtcclxuXHR0ZXJtaW5hbFByb2plY3RSb290UGF0aDogc3RyaW5nO1xyXG5cdHRlcm1pbmFsQXBwbGljYXRpb25OYW1lOiBzdHJpbmc7XHJcblx0ZW5hYmxlVGVybWluYWxEZWJ1Z0xvZ2dpbmc6IGJvb2xlYW47XHJcblx0ZW5hYmxlVGVybWluYWxSaWJib25JY29uOiBib29sZWFuO1xyXG5cdGVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZDogYm9vbGVhbjtcclxuXHRjb25maWdGaWxlUGF0aDogc3RyaW5nO1xyXG5cdGVuYWJsZUNvbmZpZ1JpYmJvbkljb246IGJvb2xlYW47XHJcblx0Y29udGVudFR5cGVzOiBDb250ZW50VHlwZVtdO1xyXG5cdGhlbHBCdXR0b25SZXBsYWNlbWVudDogSGVscEJ1dHRvblJlcGxhY2VtZW50U2V0dGluZ3M7XHJcblx0bWlncmF0aW9uQ29tcGxldGVkOiBib29sZWFuO1xyXG5cdHNob3dNZHhGaWxlc0luRXhwbG9yZXI6IGJvb2xlYW47XHJcblx0cHJvY2Vzc0JhY2tncm91bmRGaWxlQ2hhbmdlczogYm9vbGVhbjtcclxuXHRzeW5jRHJhZnREYXRlOiBib29sZWFuO1xyXG5cdGRyYWZ0UHJvcGVydHk6IHN0cmluZztcclxuXHRkcmFmdExvZ2ljOiAndHJ1ZS1pcy1kcmFmdCcgfCAnZmFsc2UtaXMtZHJhZnQnO1xyXG5cdHB1Ymxpc2hEYXRlRmllbGQ6IHN0cmluZztcclxuXHR1cGRhdGVNb2RpZmllZERhdGU6IGJvb2xlYW47XHJcblx0bW9kaWZpZWREYXRlRmllbGQ6IHN0cmluZztcclxuXHQvLyBMZWdhY3kgZmllbGRzIChrZXB0IGZvciBtaWdyYXRpb24sIGlnbm9yZWQgYWZ0ZXIgbWlncmF0aW9uKVxyXG5cdGVuYWJsZVVuZGVyc2NvcmVQcmVmaXg/OiBib29sZWFuO1xyXG5cdHBvc3RzRm9sZGVyPzogc3RyaW5nO1xyXG5cdHBvc3RzTGlua0Jhc2VQYXRoPzogc3RyaW5nO1xyXG5cdGF1dG9tYXRlUG9zdENyZWF0aW9uPzogYm9vbGVhbjtcclxuXHRjcmVhdGlvbk1vZGU/OiBcImZpbGVcIiB8IFwiZm9sZGVyXCI7XHJcblx0aW5kZXhGaWxlTmFtZT86IHN0cmluZztcclxuXHRleGNsdWRlZERpcmVjdG9yaWVzPzogc3RyaW5nO1xyXG5cdG9ubHlBdXRvbWF0ZUluUG9zdHNGb2xkZXI/OiBib29sZWFuO1xyXG5cdGVuYWJsZVBhZ2VzPzogYm9vbGVhbjtcclxuXHRwYWdlc0ZvbGRlcj86IHN0cmluZztcclxuXHRwYWdlc0xpbmtCYXNlUGF0aD86IHN0cmluZztcclxuXHRwYWdlc0NyZWF0aW9uTW9kZT86IFwiZmlsZVwiIHwgXCJmb2xkZXJcIjtcclxuXHRwYWdlc0luZGV4RmlsZU5hbWU/OiBzdHJpbmc7XHJcblx0cGFnZVRlbXBsYXRlPzogc3RyaW5nO1xyXG5cdG9ubHlBdXRvbWF0ZUluUGFnZXNGb2xkZXI/OiBib29sZWFuO1xyXG5cdGN1c3RvbUNvbnRlbnRUeXBlcz86IENvbnRlbnRUeXBlW107IC8vIExlZ2FjeSBuYW1lXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSGVscEJ1dHRvblJlcGxhY2VtZW50U2V0dGluZ3Mge1xyXG5cdGVuYWJsZWQ6IGJvb2xlYW47XHJcblx0Y29tbWFuZElkOiBzdHJpbmc7XHJcblx0aWNvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUGFyc2VkRnJvbnRtYXR0ZXIge1xyXG5cdHByb3BlcnRpZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPjtcclxuXHRwcm9wZXJ0aWVzVGV4dDogc3RyaW5nO1xyXG5cdHByb3BlcnRpZXNFbmQ6IG51bWJlcjtcclxuXHRib2R5Q29udGVudDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFRlbXBsYXRlVmFsdWVzIHtcclxuXHRba2V5OiBzdHJpbmddOiBzdHJpbmdbXSB8IHN0cmluZztcclxufVxyXG5cclxuLy8gQ29udGVudFR5cGUgaXMgbm93IGp1c3QgYSBzdHJpbmcgSUQgLSBubyBkaXN0aW5jdGlvbiBiZXR3ZWVuIGJ1aWx0LWluIGFuZCBjdXN0b20gdHlwZXNcclxuZXhwb3J0IHR5cGUgQ29udGVudFR5cGVJZCA9IHN0cmluZztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ29udGVudFR5cGUge1xyXG5cdGlkOiBzdHJpbmc7XHJcblx0bmFtZTogc3RyaW5nO1xyXG5cdGZvbGRlcjogc3RyaW5nO1xyXG5cdGxpbmtCYXNlUGF0aDogc3RyaW5nO1xyXG5cdHRlbXBsYXRlOiBzdHJpbmc7XHJcblx0ZW5hYmxlZDogYm9vbGVhbjtcclxuXHRjcmVhdGlvbk1vZGU6IFwiZmlsZVwiIHwgXCJmb2xkZXJcIjtcclxuXHRpbmRleEZpbGVOYW1lOiBzdHJpbmc7XHJcblx0aWdub3JlU3ViZm9sZGVyczogYm9vbGVhbjtcclxuXHRlbmFibGVVbmRlcnNjb3JlUHJlZml4OiBib29sZWFuO1xyXG5cdHVzZU1keEV4dGVuc2lvbjogYm9vbGVhbjtcclxuXHRjb2xsYXBzZWQ/OiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEZpbGVDcmVhdGlvbk9wdGlvbnMge1xyXG5cdGZpbGU6IFRGaWxlO1xyXG5cdHRpdGxlOiBzdHJpbmc7XHJcblx0dHlwZTogQ29udGVudFR5cGVJZDsgLy8gQ29udGVudCB0eXBlIElEIChzdHJpbmcpXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUmVuYW1lT3B0aW9ucyB7XHJcblx0ZmlsZTogVEZpbGU7XHJcblx0dGl0bGU6IHN0cmluZztcclxuXHR0eXBlOiBDb250ZW50VHlwZUlkOyAvLyBDb250ZW50IHR5cGUgSUQgKHN0cmluZylcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IEtOT1dOX0FSUkFZX0tFWVMgPSBbJ3RhZ3MnLCAnYWxpYXNlcycsICdjc3NjbGFzc2VzJ10gYXMgY29uc3Q7XHJcblxyXG5leHBvcnQgY29uc3QgQ09OU1RBTlRTID0ge1xyXG5cdERFQk9VTkNFX01TOiA1MDAsXHJcblx0U1RBVF9NVElNRV9USFJFU0hPTEQ6IDEwMDAsXHJcblx0RURJVE9SX1NUQUJJTElaRV9ERUxBWTogMTAwLFxyXG5cdEZJTEVfRVhQTE9SRVJfUkVWRUFMX0RFTEFZOiAyMDAsXHJcbn0gYXMgY29uc3Q7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2Uge1xyXG5cdHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3M7XHJcblx0c2F2ZVNldHRpbmdzKCk6IFByb21pc2U8dm9pZD47XHJcblx0bG9hZFNldHRpbmdzKCk6IFByb21pc2U8dm9pZD47XHJcblx0cmVnaXN0ZXJDcmVhdGVFdmVudCgpOiB2b2lkO1xyXG5cdHJlZ2lzdGVyRXZlbnQoZXZlbnRSZWY6IGFueSk6IHZvaWQ7XHJcblx0cmVnaXN0ZXJFeHRlbnNpb25zKGV4dGVuc2lvbnM6IHN0cmluZ1tdLCB2aWV3VHlwZTogc3RyaW5nKTogdm9pZDtcclxuXHRoZWFkaW5nTGlua0dlbmVyYXRvcjogYW55O1xyXG5cdGZyb250bWF0dGVyU2VydmljZTogYW55O1xyXG5cdHBsdWdpbkNyZWF0ZWRGaWxlczogTWFwPHN0cmluZywgbnVtYmVyPjtcclxuXHRmaWxlT3BzOiBhbnk7XHJcblx0c2V0dGluZ3NUYWI/OiBQbHVnaW5TZXR0aW5nVGFiO1xyXG5cdHJlZ2lzdGVyUmliYm9uSWNvbnM/KCk6IHZvaWQ7XHJcblx0dXBkYXRlSGVscEJ1dHRvbj8oKTogUHJvbWlzZTx2b2lkPjtcclxufSIsICJpbXBvcnQgeyBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MgfSBmcm9tIFwiLi90eXBlc1wiO1xyXG5cclxuZXhwb3J0IHR5cGUgeyBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MgfSBmcm9tIFwiLi90eXBlc1wiO1xyXG5leHBvcnQgeyBDT05TVEFOVFMgfSBmcm9tIFwiLi90eXBlc1wiO1xyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyA9IHtcclxuXHRkZWZhdWx0VGVtcGxhdGU6XHJcblx0XHQnLS0tXFxudGl0bGU6IFwie3t0aXRsZX19XCJcXG5kYXRlOiB7e2RhdGV9fVxcbnRhZ3M6IFtdXFxuLS0tXFxuJyxcclxuXHRhdXRvSW5zZXJ0UHJvcGVydGllczogdHJ1ZSxcclxuXHRkYXRlRm9ybWF0OiBcIllZWVktTU0tRERcIixcclxuXHRlbmFibGVDb3B5SGVhZGluZ0xpbms6IHRydWUsXHJcblx0Y29weUhlYWRpbmdMaW5rRm9ybWF0OiBcIm9ic2lkaWFuXCIsXHJcblx0YWRkVHJhaWxpbmdTbGFzaFRvTGlua3M6IGZhbHNlLFxyXG5cdGVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQ6IGZhbHNlLFxyXG5cdHRlcm1pbmFsUHJvamVjdFJvb3RQYXRoOiBcIlwiLFxyXG5cdHRlcm1pbmFsQXBwbGljYXRpb25OYW1lOiBcIlwiLFxyXG5cdGVuYWJsZVRlcm1pbmFsRGVidWdMb2dnaW5nOiBmYWxzZSxcclxuXHRlbmFibGVUZXJtaW5hbFJpYmJvbkljb246IGZhbHNlLFxyXG5cdGVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZDogZmFsc2UsXHJcblx0Y29uZmlnRmlsZVBhdGg6IFwiXCIsXHJcblx0ZW5hYmxlQ29uZmlnUmliYm9uSWNvbjogZmFsc2UsXHJcblx0Y29udGVudFR5cGVzOiBbXSxcclxuXHRtaWdyYXRpb25Db21wbGV0ZWQ6IGZhbHNlLFxyXG5cdGhlbHBCdXR0b25SZXBsYWNlbWVudDoge1xyXG5cdFx0ZW5hYmxlZDogZmFsc2UsXHJcblx0XHRjb21tYW5kSWQ6ICdlZGl0LWFzdHJvLWNvbmZpZycsXHJcblx0XHRpY29uSWQ6ICdyb2NrZXQnLFxyXG5cdH0sXHJcblx0c2hvd01keEZpbGVzSW5FeHBsb3JlcjogZmFsc2UsXHJcblx0cHJvY2Vzc0JhY2tncm91bmRGaWxlQ2hhbmdlczogdHJ1ZSxcclxuXHRzeW5jRHJhZnREYXRlOiBmYWxzZSxcclxuXHRkcmFmdFByb3BlcnR5OiBcIlwiLFxyXG5cdGRyYWZ0TG9naWM6IFwidHJ1ZS1pcy1kcmFmdFwiLFxyXG5cdHB1Ymxpc2hEYXRlRmllbGQ6IFwiXCIsXHJcblx0dXBkYXRlTW9kaWZpZWREYXRlOiBmYWxzZSxcclxuXHRtb2RpZmllZERhdGVGaWVsZDogXCJcIixcclxufTtcclxuIiwgImltcG9ydCB7IFBsdWdpbiwgRWRpdG9yLCBNYXJrZG93blZpZXcsIFRGaWxlLCBOb3RpY2UsIEFwcCwgTWFya2Rvd25GaWxlSW5mbywgUGxhdGZvcm0sIFRGb2xkZXIgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdzLCBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IEZpbGVPcGVyYXRpb25zIH0gZnJvbSBcIi4uL3V0aWxzL2ZpbGUtb3BlcmF0aW9uc1wiO1xyXG5pbXBvcnQgeyBUZW1wbGF0ZVBhcnNlciB9IGZyb20gXCIuLi91dGlscy90ZW1wbGF0ZS1wYXJzaW5nXCI7XHJcbmltcG9ydCB7IExpbmtDb252ZXJ0ZXIgfSBmcm9tIFwiLi4vdXRpbHMvbGluay1jb252ZXJzaW9uXCI7XHJcbmltcG9ydCB7IFRpdGxlTW9kYWwgfSBmcm9tIFwiLi4vdWkvdGl0bGUtbW9kYWxcIjtcclxuaW1wb3J0IHsgdG9LZWJhYkNhc2UgfSBmcm9tIFwiLi4vdXRpbHMvc3RyaW5nLXV0aWxzXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJDb21tYW5kcyhwbHVnaW46IFBsdWdpbiwgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyk6IHZvaWQge1xyXG5cdC8vIFRlcm1pbmFsIGFuZCBjb25maWcgY29tbWFuZHMgYXJlIGRlc2t0b3Atb25seSAtIE5FVkVSIHJlZ2lzdGVyIG9uIG1vYmlsZVxyXG5cdC8vIENoZWNrIFBsYXRmb3JtLmlzTW9iaWxlIC0gaWYgdHJ1ZSwgdGhlc2UgY29tbWFuZHMgbXVzdCBORVZFUiBiZSByZWdpc3RlcmVkXHJcblx0Y29uc3QgaXNNb2JpbGUgPSBQbGF0Zm9ybS5pc01vYmlsZTtcclxuXHJcblx0Ly8gSWYgb24gbW9iaWxlLCBhYnNvbHV0ZWx5IGRvIG5vdCByZWdpc3RlciB0ZXJtaW5hbC9jb25maWcgY29tbWFuZHNcclxuXHQvLyBUaGV5IHVzZSBOb2RlLmpzL0VsZWN0cm9uIEFQSXMgdGhhdCBkb24ndCBleGlzdCBvbiBtb2JpbGVcclxuXHRpZiAoaXNNb2JpbGUpIHtcclxuXHRcdC8vIE9uIG1vYmlsZSwgb25seSByZWdpc3RlciB0aGUgc2FmZSBjb21tYW5kcyB0aGF0IHdvcmsgb24gbW9iaWxlXHJcblx0XHRjb25zdCBwbHVnaW5JbnRlcmZhY2UgPSBwbHVnaW4gYXMgdW5rbm93biBhcyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlO1xyXG5cdFx0Y29uc3QgZmlsZU9wcyA9IG5ldyBGaWxlT3BlcmF0aW9ucyhwbHVnaW4uYXBwLCBzZXR0aW5ncywgcGx1Z2luSW50ZXJmYWNlKTtcclxuXHRcdGNvbnN0IGxpbmtDb252ZXJ0ZXIgPSBuZXcgTGlua0NvbnZlcnRlcihzZXR0aW5ncywgcGx1Z2luSW50ZXJmYWNlKTtcclxuXHJcblx0XHQvLyBSZWdpc3RlciBvbmx5IG1vYmlsZS1zYWZlIGNvbW1hbmRzXHJcblx0XHRwbHVnaW4uYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiBcInN0YW5kYXJkaXplLXByb3BlcnRpZXNcIixcclxuXHRcdFx0bmFtZTogXCJTdGFuZGFyZGl6ZSBwcm9wZXJ0aWVzXCIsXHJcblx0XHRcdGljb246IFwiZmlsZS1jaGVja1wiLFxyXG5cdFx0XHRlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcclxuXHRcdFx0XHRjb25zdCBmaWxlID0gY3R4IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3ID8gY3R4LmZpbGUgOiBjdHguZmlsZTtcclxuXHRcdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRcdFx0XHQvLyBHZXQgZnJlc2ggc2V0dGluZ3MgZnJvbSBwbHVnaW5cclxuXHRcdFx0XHRcdGNvbnN0IGN1cnJlbnRTZXR0aW5ncyA9IHBsdWdpbkludGVyZmFjZS5zZXR0aW5ncyB8fCBzZXR0aW5ncztcclxuXHRcdFx0XHRcdHZvaWQgc3RhbmRhcmRpemVQcm9wZXJ0aWVzKHBsdWdpbi5hcHAsIGN1cnJlbnRTZXR0aW5ncywgZmlsZSwgcGx1Z2luSW50ZXJmYWNlLCBlZGl0b3IpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdH0pO1xyXG5cclxuXHRcdHBsdWdpbi5hZGRDb21tYW5kKHtcclxuXHRcdFx0aWQ6IFwiY29udmVydC13aWtpbGlua3MtYXN0cm9cIixcclxuXHRcdFx0bmFtZTogXCJDb252ZXJ0IGludGVybmFsIGxpbmtzIGZvciBhc3Ryb1wiLFxyXG5cdFx0XHRpY29uOiBcImxpbmstMlwiLFxyXG5cdFx0XHRlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcclxuXHRcdFx0XHRjb25zdCBmaWxlID0gY3R4IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3ID8gY3R4LmZpbGUgOiBjdHguZmlsZTtcclxuXHRcdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRcdFx0XHRsaW5rQ29udmVydGVyLmNvbnZlcnRXaWtpbGlua3NGb3JBc3RybyhlZGl0b3IsIGZpbGUpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIEhlbHBlciBmdW5jdGlvbiBmb3IgcmVuYW1lIGNvbW1hbmQgKG1vYmlsZSB2ZXJzaW9uKVxyXG5cdFx0Ly8gVXNlcyB0aGUgc2FtZSBsb2dpYyBhcyBGaWxlT3BlcmF0aW9ucy5kZXRlcm1pbmVUeXBlKCkgdG8gZW5zdXJlIGNvbnNpc3RlbmN5XHJcblx0XHRmdW5jdGlvbiBoYXNNYXRjaGluZ0NvbnRlbnRUeXBlKGZpbGU6IFRGaWxlLCBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzKTogYm9vbGVhbiB7XHJcblx0XHRcdGNvbnN0IHR5cGUgPSBmaWxlT3BzLmRldGVybWluZVR5cGUoZmlsZSk7XHJcblx0XHRcdC8vIElmIGRldGVybWluZVR5cGUgcmV0dXJucyBcIm5vdGVcIiwgaXQgbWVhbnMgbm8gY29udGVudCB0eXBlIG1hdGNoZWRcclxuXHRcdFx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSB7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIENoZWNrIGlmIHRoZSBtYXRjaGVkIGNvbnRlbnQgdHlwZSBpcyBlbmFibGVkXHJcblx0XHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gZmlsZU9wcy5nZXRDb250ZW50VHlwZSh0eXBlKTtcclxuXHRcdFx0cmV0dXJuIGNvbnRlbnRUeXBlICE9PSBudWxsICYmIGNvbnRlbnRUeXBlLmVuYWJsZWQ7XHJcblx0XHR9XHJcblxyXG5cdFx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogXCJyZW5hbWUtY29udGVudFwiLFxyXG5cdFx0XHRuYW1lOiBcIlJlbmFtZSBjdXJyZW50IGNvbnRlbnRcIixcclxuXHRcdFx0aWNvbjogXCJwZW5jaWxcIixcclxuXHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgZmlsZSA9IGN0eCBpbnN0YW5jZW9mIE1hcmtkb3duVmlldyA/IGN0eC5maWxlIDogY3R4LmZpbGU7XHJcblx0XHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG5cdFx0XHRcdFx0aWYgKCFoYXNNYXRjaGluZ0NvbnRlbnRUeXBlKGZpbGUsIHNldHRpbmdzKSkge1xyXG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlKFwiQ2Fubm90IHJlbmFtZTogdGhpcyBmaWxlIGlzIG5vdCBwYXJ0IG9mIGEgY29uZmlndXJlZCBjb250ZW50IHR5cGUgZm9sZGVyLlwiKTtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdGNvbnN0IHR5cGUgPSBmaWxlT3BzLmRldGVybWluZVR5cGUoZmlsZSk7XHJcblx0XHRcdFx0XHRjb25zdCBjYWNoZSA9IHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XHJcblx0XHRcdFx0XHRjb25zdCB0aXRsZUtleSA9IGZpbGVPcHMuZ2V0VGl0bGVLZXkodHlwZSk7XHJcblxyXG5cdFx0XHRcdFx0aWYgKCFjYWNoZT8uZnJvbnRtYXR0ZXIgfHwgISh0aXRsZUtleSBpbiBjYWNoZS5mcm9udG1hdHRlcikpIHtcclxuXHRcdFx0XHRcdFx0bmV3IE5vdGljZShgQ2Fubm90IHJlbmFtZTogTm8gJHt0aXRsZUtleX0gZm91bmQgaW4gcHJvcGVydGllc2ApO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0bmV3IFRpdGxlTW9kYWwocGx1Z2luLmFwcCwgZmlsZSwgcGx1Z2luIGFzIHVua25vd24gYXMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSwgdHlwZSwgdHJ1ZSkub3BlbigpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSxcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIERPIE5PVCByZWdpc3RlciB0ZXJtaW5hbCBvciBjb25maWcgY29tbWFuZHMgb24gbW9iaWxlIC0gcmV0dXJuIGVhcmx5XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHQvLyBEZXNrdG9wOiByZWdpc3RlciBhbGwgY29tbWFuZHMgaW5jbHVkaW5nIHRlcm1pbmFsIGFuZCBjb25maWdcclxuXHRjb25zdCBwbHVnaW5JbnRlcmZhY2UgPSBwbHVnaW4gYXMgdW5rbm93biBhcyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlO1xyXG5cclxuXHJcblx0Ly8gSGVscGVyIGZ1bmN0aW9uIHRvIGNoZWNrIGlmIGEgZmlsZSBtYXRjaGVzIGFueSBjb25maWd1cmVkIGNvbnRlbnQgdHlwZVxyXG5cdC8vIFVzZXMgdGhlIHNhbWUgbG9naWMgYXMgRmlsZU9wZXJhdGlvbnMuZGV0ZXJtaW5lVHlwZSgpIHRvIGVuc3VyZSBjb25zaXN0ZW5jeVxyXG5cdC8vIEdldHMgZnJlc2ggc2V0dGluZ3MgZnJvbSBwbHVnaW4gdG8gZW5zdXJlIHdlIGNoZWNrIGFnYWluc3QgY3VycmVudCBjb250ZW50IHR5cGVzXHJcblx0ZnVuY3Rpb24gaGFzTWF0Y2hpbmdDb250ZW50VHlwZShmaWxlOiBURmlsZSwgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyk6IGJvb2xlYW4ge1xyXG5cdFx0Ly8gR2V0IGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luIGlmIGF2YWlsYWJsZVxyXG5cdFx0Y29uc3QgY3VycmVudFNldHRpbmdzID0gKHBsdWdpbiBhcyB1bmtub3duIGFzIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UpPy5zZXR0aW5ncyB8fCBzZXR0aW5ncztcclxuXHRcdC8vIENyZWF0ZSBhIHRlbXBvcmFyeSBGaWxlT3BlcmF0aW9ucyB3aXRoIGZyZXNoIHNldHRpbmdzXHJcblx0XHRjb25zdCB0ZW1wRmlsZU9wcyA9IG5ldyBGaWxlT3BlcmF0aW9ucyhwbHVnaW4uYXBwLCBjdXJyZW50U2V0dGluZ3MsIHBsdWdpbiBhcyB1bmtub3duIGFzIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UpO1xyXG5cdFx0Y29uc3QgdHlwZSA9IHRlbXBGaWxlT3BzLmRldGVybWluZVR5cGUoZmlsZSk7XHJcblx0XHQvLyBJZiBkZXRlcm1pbmVUeXBlIHJldHVybnMgXCJub3RlXCIsIGl0IG1lYW5zIG5vIGNvbnRlbnQgdHlwZSBtYXRjaGVkXHJcblx0XHRpZiAodHlwZSA9PT0gXCJub3RlXCIpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0Ly8gQ2hlY2sgaWYgdGhlIG1hdGNoZWQgY29udGVudCB0eXBlIGlzIGVuYWJsZWRcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gdGVtcEZpbGVPcHMuZ2V0Q29udGVudFR5cGUodHlwZSk7XHJcblx0XHRyZXR1cm4gY29udGVudFR5cGUgIT09IG51bGwgJiYgY29udGVudFR5cGUuZW5hYmxlZDtcclxuXHR9XHJcblxyXG5cdC8vIFN0YW5kYXJkaXplIFByb3BlcnRpZXMgY29tbWFuZFxyXG5cdHBsdWdpbi5hZGRDb21tYW5kKHtcclxuXHRcdGlkOiBcInN0YW5kYXJkaXplLXByb3BlcnRpZXNcIixcclxuXHRcdG5hbWU6IFwiU3RhbmRhcmRpemUgcHJvcGVydGllc1wiLFxyXG5cdFx0aWNvbjogXCJmaWxlLWNoZWNrXCIsXHJcblx0XHRlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcclxuXHRcdFx0Y29uc3QgZmlsZSA9IGN0eCBpbnN0YW5jZW9mIE1hcmtkb3duVmlldyA/IGN0eC5maWxlIDogY3R4LmZpbGU7XHJcblx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuXHRcdFx0XHR2b2lkIHN0YW5kYXJkaXplUHJvcGVydGllcyhwbHVnaW4uYXBwLCBzZXR0aW5ncywgZmlsZSwgcGx1Z2luIGFzIHVua25vd24gYXMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSwgZWRpdG9yKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHR9KTtcclxuXHJcblx0Ly8gQ29udmVydCBXaWtpbGlua3MgY29tbWFuZFxyXG5cdHBsdWdpbi5hZGRDb21tYW5kKHtcclxuXHRcdGlkOiBcImNvbnZlcnQtd2lraWxpbmtzLWFzdHJvXCIsXHJcblx0XHRuYW1lOiBcIkNvbnZlcnQgaW50ZXJuYWwgbGlua3MgZm9yIGFzdHJvXCIsXHJcblx0XHRpY29uOiBcImxpbmstMlwiLFxyXG5cdFx0ZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XHJcblx0XHRcdGNvbnN0IGZpbGUgPSBjdHggaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgPyBjdHguZmlsZSA6IGN0eC5maWxlO1xyXG5cdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRcdFx0Ly8gR2V0IGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luIGFuZCBjcmVhdGUgTGlua0NvbnZlcnRlciB3aXRoIGl0XHJcblx0XHRcdFx0Y29uc3QgY3VycmVudFNldHRpbmdzID0gcGx1Z2luSW50ZXJmYWNlLnNldHRpbmdzIHx8IHNldHRpbmdzO1xyXG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRMaW5rQ29udmVydGVyID0gbmV3IExpbmtDb252ZXJ0ZXIoY3VycmVudFNldHRpbmdzLCBwbHVnaW5JbnRlcmZhY2UpO1xyXG5cdFx0XHRcdGN1cnJlbnRMaW5rQ29udmVydGVyLmNvbnZlcnRXaWtpbGlua3NGb3JBc3RybyhlZGl0b3IsIGZpbGUpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdH0pO1xyXG5cclxuXHQvLyBSZW5hbWUgQ29udGVudCBjb21tYW5kXHJcblx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0aWQ6IFwicmVuYW1lLWNvbnRlbnRcIixcclxuXHRcdG5hbWU6IFwiUmVuYW1lIGN1cnJlbnQgY29udGVudFwiLFxyXG5cdFx0aWNvbjogXCJwZW5jaWxcIixcclxuXHRcdGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xyXG5cdFx0XHRjb25zdCBmaWxlID0gY3R4IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3ID8gY3R4LmZpbGUgOiBjdHguZmlsZTtcclxuXHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG5cdFx0XHRcdC8vIEdldCBmcmVzaCBzZXR0aW5ncyBmcm9tIHBsdWdpblxyXG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRTZXR0aW5ncyA9IHBsdWdpbkludGVyZmFjZS5zZXR0aW5ncyB8fCBzZXR0aW5ncztcclxuXHRcdFx0XHQvLyBDcmVhdGUgRmlsZU9wZXJhdGlvbnMgd2l0aCBmcmVzaCBzZXR0aW5nc1xyXG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRGaWxlT3BzID0gbmV3IEZpbGVPcGVyYXRpb25zKHBsdWdpbi5hcHAsIGN1cnJlbnRTZXR0aW5ncywgcGx1Z2luSW50ZXJmYWNlKTtcclxuXHJcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgdGhpcyBmaWxlIG1hdGNoZXMgYW55IGNvbmZpZ3VyZWQgY29udGVudCB0eXBlXHJcblx0XHRcdFx0aWYgKCFoYXNNYXRjaGluZ0NvbnRlbnRUeXBlKGZpbGUsIGN1cnJlbnRTZXR0aW5ncykpIHtcclxuXHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJDYW5ub3QgcmVuYW1lOiB0aGlzIGZpbGUgaXMgbm90IHBhcnQgb2YgYSBjb25maWd1cmVkIGNvbnRlbnQgdHlwZSBmb2xkZXIuXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0Ly8gRGV0ZXJtaW5lIGNvbnRlbnQgdHlwZSBmcm9tIGZvbGRlciBzdHJ1Y3R1cmVcclxuXHRcdFx0XHRjb25zdCB0eXBlID0gY3VycmVudEZpbGVPcHMuZGV0ZXJtaW5lVHlwZShmaWxlKTtcclxuXHJcblx0XHRcdFx0Ly8gQWx3YXlzIG9wZW4gdGhlIG1vZGFsIC0gaXQgd2lsbCBoYW5kbGUgZmlsZXMgd2l0aG91dCBmcm9udG1hdHRlciBvciB0aXRsZSBrZXlcclxuXHRcdFx0XHQvLyBJZiB0aGVyZSdzIG5vIHRpdGxlIGluIGZyb250bWF0dGVyLCB0aGUgbW9kYWwgd2lsbCB1c2UgdGhlIGZpbGVuYW1lIGFzIGZhbGxiYWNrXHJcblx0XHRcdFx0Ly8gYW5kIHRoZSByZW5hbWUgd2lsbCBwcm9jZWVkIHdpdGgga2ViYWItY2FzZSB2ZXJzaW9uIG9mIHdoYXQgdXNlciB0eXBlc1xyXG5cdFx0XHRcdG5ldyBUaXRsZU1vZGFsKHBsdWdpbi5hcHAsIGZpbGUsIHBsdWdpbkludGVyZmFjZSwgdHlwZSwgdHJ1ZSkub3BlbigpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdH0pO1xyXG5cclxuXHQvLyBPcGVuIFRlcm1pbmFsIGNvbW1hbmQgKGRlc2t0b3Agb25seSAtIG5vdCBhdmFpbGFibGUgb24gbW9iaWxlKVxyXG5cdGlmICghaXNNb2JpbGUpIHtcclxuXHRcdHBsdWdpbi5hZGRDb21tYW5kKHtcclxuXHRcdFx0aWQ6IFwib3Blbi1wcm9qZWN0LXRlcm1pbmFsXCIsXHJcblx0XHRcdG5hbWU6IFwiT3BlbiBwcm9qZWN0IHRlcm1pbmFsXCIsXHJcblx0XHRcdGljb246IFwidGVybWluYWwtc3F1YXJlXCIsXHJcblx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgY3VycmVudFNldHRpbmdzID0gKHBsdWdpbiBhcyB1bmtub3duIGFzIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UpLnNldHRpbmdzO1xyXG5cdFx0XHRcdGlmICghY3VycmVudFNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpIHtcclxuXHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJPcGVuIHRlcm1pbmFsIGNvbW1hbmQgaXMgZGlzYWJsZWQuIEVuYWJsZSBpdCBpbiBzZXR0aW5ncyB0byB1c2UgdGhpcyBjb21tYW5kLlwiKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0b3BlblRlcm1pbmFsSW5Qcm9qZWN0Um9vdChwbHVnaW4uYXBwLCBjdXJyZW50U2V0dGluZ3MpO1xyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHQvLyBFZGl0IENvbmZpZyBGaWxlIGNvbW1hbmQgKGRlc2t0b3Agb25seSAtIG5vdCBhdmFpbGFibGUgb24gbW9iaWxlKVxyXG5cdGlmICghaXNNb2JpbGUpIHtcclxuXHRcdHBsdWdpbi5hZGRDb21tYW5kKHtcclxuXHRcdFx0aWQ6IFwiZWRpdC1hc3Ryby1jb25maWdcIixcclxuXHRcdFx0bmFtZTogXCJFZGl0IGFzdHJvIGNvbmZpZ1wiLFxyXG5cdFx0XHRpY29uOiBcInJvY2tldFwiLFxyXG5cdFx0XHRjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRTZXR0aW5ncyA9IChwbHVnaW4gYXMgdW5rbm93biBhcyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlKS5zZXR0aW5ncztcclxuXHRcdFx0XHRpZiAoIWN1cnJlbnRTZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpIHtcclxuXHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJFZGl0IGNvbmZpZyBmaWxlIGNvbW1hbmQgaXMgZGlzYWJsZWQuIEVuYWJsZSBpdCBpbiBzZXR0aW5ncyB0byB1c2UgdGhpcyBjb21tYW5kLlwiKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0YXdhaXQgb3BlbkNvbmZpZ0ZpbGUocGx1Z2luLmFwcCwgY3VycmVudFNldHRpbmdzKTtcclxuXHRcdFx0fSxcclxuXHRcdH0pO1xyXG5cdH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gc3RhbmRhcmRpemVQcm9wZXJ0aWVzKGFwcDogQXBwLCBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzLCBmaWxlOiBURmlsZSwgcGx1Z2luPzogQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSwgZWRpdG9yPzogRWRpdG9yKTogUHJvbWlzZTx2b2lkPiB7XHJcblx0Ly8gR2V0IGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luIGlmIGF2YWlsYWJsZVxyXG5cdGNvbnN0IGN1cnJlbnRTZXR0aW5ncyA9IHBsdWdpbj8uc2V0dGluZ3MgfHwgc2V0dGluZ3M7XHJcblx0Y29uc3QgdGVtcGxhdGVQYXJzZXIgPSBuZXcgVGVtcGxhdGVQYXJzZXIoYXBwLCBjdXJyZW50U2V0dGluZ3MpO1xyXG5cdGNvbnN0IGZpbGVPcHMgPSBuZXcgRmlsZU9wZXJhdGlvbnMoYXBwLCBjdXJyZW50U2V0dGluZ3MsIHBsdWdpbik7XHJcblxyXG5cdC8vIFByZXNlcnZlIGN1cnNvciBwb3NpdGlvbiBpZiBlZGl0b3IgaXMgcHJvdmlkZWRcclxuXHRsZXQgY3Vyc29yUG9zaXRpb246IHsgbGluZTogbnVtYmVyOyBjaDogbnVtYmVyIH0gfCBudWxsID0gbnVsbDtcclxuXHRsZXQgb3JpZ2luYWxDb250ZW50ID0gXCJcIjtcclxuXHRpZiAoZWRpdG9yKSB7XHJcblx0XHRjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XHJcblx0XHRjdXJzb3JQb3NpdGlvbiA9IHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggfTtcclxuXHRcdG9yaWdpbmFsQ29udGVudCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xyXG5cdH1cclxuXHJcblx0Ly8gRGV0ZXJtaW5lIGNvbnRlbnQgdHlwZSB1c2luZyB0aGUgZXhpc3RpbmcgbG9naWNcclxuXHRjb25zdCB0eXBlID0gZmlsZU9wcy5kZXRlcm1pbmVUeXBlKGZpbGUpO1xyXG5cclxuXHQvLyBDaGVjayBpZiB0aGlzIGZpbGUgaGFzIGEgdmFsaWQgY29udGVudCB0eXBlIChub3QganVzdCBcIm5vdGVcIilcclxuXHRpZiAodHlwZSA9PT0gXCJub3RlXCIpIHtcclxuXHRcdG5ldyBOb3RpY2UoXCJObyBwcm9wZXJ0aWVzIHRlbXBsYXRlIHNwZWNpZmllZCBmb3IgdGhpcyBjb250ZW50LiBUaGlzIGZpbGUgZG9lc24ndCBtYXRjaCBhbnkgY29uZmlndXJlZCBjb250ZW50IHR5cGUgZm9sZGVycy5cIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHRsZXQgdGVtcGxhdGVTdHJpbmc6IHN0cmluZztcclxuXHJcblx0Ly8gRGV0ZXJtaW5lIHRlbXBsYXRlIGJhc2VkIG9uIGNvbnRlbnQgdHlwZVxyXG5cdGlmICh0eXBlID09PSBcIm5vdGVcIikge1xyXG5cdFx0bmV3IE5vdGljZShcIk5vIHByb3BlcnRpZXMgdGVtcGxhdGUgc3BlY2lmaWVkIGZvciB0aGlzIGNvbnRlbnQuIFRoaXMgZmlsZSBkb2Vzbid0IG1hdGNoIGFueSBjb25maWd1cmVkIGNvbnRlbnQgdHlwZSBmb2xkZXJzLlwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdGNvbnN0IGNvbnRlbnRUeXBlID0gZmlsZU9wcy5nZXRDb250ZW50VHlwZSh0eXBlKTtcclxuXHRpZiAoIWNvbnRlbnRUeXBlKSB7XHJcblx0XHRuZXcgTm90aWNlKFwiQ29udGVudCB0eXBlIG5vdCBmb3VuZC5cIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHR0ZW1wbGF0ZVN0cmluZyA9IGNvbnRlbnRUeXBlLnRlbXBsYXRlO1xyXG5cclxuXHQvLyBXYWl0IGJyaWVmbHkgdG8gYWxsb3cgZWRpdG9yIHN0YXRlIHRvIHN0YWJpbGl6ZVxyXG5cdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDApKTtcclxuXHJcblx0Ly8gUmUtcmVhZCBjb250ZW50IHRvIGVuc3VyZSBsYXRlc3Qgc3RhdGUgYWZ0ZXIgZWRpdG9yIGNoYW5nZXNcclxuXHRjb25zdCBjb250ZW50ID0gYXdhaXQgYXBwLnZhdWx0LnJlYWQoZmlsZSk7XHJcblx0Y29uc3QgdGl0bGUgPSBmaWxlLmJhc2VuYW1lLnJlcGxhY2UoL15fLywgXCJcIik7XHJcblxyXG5cdGNvbnN0IHBhcnNlZCA9IHRlbXBsYXRlUGFyc2VyLnBhcnNlRnJvbnRtYXR0ZXIoY29udGVudCk7XHJcblx0Y29uc3QgeyB0ZW1wbGF0ZVByb3BzLCB0ZW1wbGF0ZVZhbHVlcyB9ID0gdGVtcGxhdGVQYXJzZXIucGFyc2VUZW1wbGF0ZSh0ZW1wbGF0ZVN0cmluZywgdGl0bGUpO1xyXG5cclxuXHQvLyBNZXJnZSB0ZW1wbGF0ZSBwcm9wZXJ0aWVzIHdpdGggZXhpc3Rpbmcgb25lcywgcHJlc2VydmluZyBhbGwgZXhpc3RpbmdcclxuXHRjb25zdCBmaW5hbFByb3BzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7IC4uLnBhcnNlZC5wcm9wZXJ0aWVzIH07XHJcblx0Y29uc3QgYXJyYXlLZXlzID0gbmV3IFNldDxzdHJpbmc+KCk7IC8vIFRyYWNrIHdoaWNoIGtleXMgYXJlIGFycmF5c1xyXG5cclxuXHQvLyBHZW5lcmF0ZSBzbHVnIGZyb20gdGl0bGUgZm9yIHNsdWcgcHJvcGVydHkgYXV0by1wb3B1bGF0aW9uXHJcblx0Y29uc3Qgc2x1ZyA9IHRvS2ViYWJDYXNlKHRpdGxlKTtcclxuXHJcblx0Zm9yIChjb25zdCBrZXkgb2YgdGVtcGxhdGVQcm9wcykge1xyXG5cdFx0aWYgKCEoa2V5IGluIHBhcnNlZC5wcm9wZXJ0aWVzKSkge1xyXG5cdFx0XHQvLyBQcm9wZXJ0eSBkb2Vzbid0IGV4aXN0LCBhZGQgaXQgZnJvbSB0ZW1wbGF0ZVxyXG5cdFx0XHRjb25zdCB0ZW1wbGF0ZVZhbHVlID0gdGVtcGxhdGVWYWx1ZXNba2V5XTtcclxuXHRcdFx0aWYgKEFycmF5LmlzQXJyYXkodGVtcGxhdGVWYWx1ZSkpIHtcclxuXHRcdFx0XHRmaW5hbFByb3BzW2tleV0gPSB0ZW1wbGF0ZVZhbHVlO1xyXG5cdFx0XHRcdGFycmF5S2V5cy5hZGQoa2V5KTsgLy8gTWFyayBhcyBhcnJheVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGZpbmFsUHJvcHNba2V5XSA9IFt0ZW1wbGF0ZVZhbHVlIHx8IFwiXCJdO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvLyBQcm9wZXJ0eSBleGlzdHMsIGNoZWNrIGlmIGl0J3MgYW4gYXJyYXkgdHlwZVxyXG5cdFx0XHRjb25zdCB0ZW1wbGF0ZVZhbHVlID0gdGVtcGxhdGVWYWx1ZXNba2V5XTtcclxuXHRcdFx0Y29uc3QgaXNBcnJheVZhbHVlID0gQXJyYXkuaXNBcnJheSh0ZW1wbGF0ZVZhbHVlKTtcclxuXHJcblx0XHRcdGlmIChpc0FycmF5VmFsdWUpIHtcclxuXHRcdFx0XHQvLyBUaGlzIGlzIGFuIGFycmF5IHByb3BlcnR5IC0gcHJlc2VydmUgZXhpc3RpbmcgdmFsdWVzIGFuZCBtZXJnZSB3aXRoIHRlbXBsYXRlXHJcblx0XHRcdFx0Y29uc3QgZXhpc3RpbmdJdGVtcyA9IHBhcnNlZC5wcm9wZXJ0aWVzW2tleV0gfHwgW107XHJcblx0XHRcdFx0Y29uc3QgbmV3SXRlbXMgPSB0ZW1wbGF0ZVZhbHVlLmZpbHRlcihpdGVtID0+ICFleGlzdGluZ0l0ZW1zLmluY2x1ZGVzKGl0ZW0pKTtcclxuXHRcdFx0XHRmaW5hbFByb3BzW2tleV0gPSBbLi4uZXhpc3RpbmdJdGVtcywgLi4ubmV3SXRlbXNdO1xyXG5cdFx0XHRcdGFycmF5S2V5cy5hZGQoa2V5KTsgLy8gTWFyayBhcyBhcnJheVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdC8vIEZvciBub24tYXJyYXkgdmFsdWVzLCBjaGVjayBpZiBpdCdzIHNsdWcgYW5kIG5lZWRzIGF1dG8tcG9wdWxhdGlvblxyXG5cdFx0XHRcdGlmIChrZXkgPT09IFwic2x1Z1wiKSB7XHJcblx0XHRcdFx0XHRjb25zdCBleGlzdGluZ1NsdWcgPSBwYXJzZWQucHJvcGVydGllc1trZXldWzBdIHx8IFwiXCI7XHJcblx0XHRcdFx0XHQvLyBPbmx5IGF1dG8tcG9wdWxhdGUgaWYgc2x1ZyBpcyBlbXB0eSBvciBtaXNzaW5nXHJcblx0XHRcdFx0XHRpZiAoIWV4aXN0aW5nU2x1ZyB8fCBleGlzdGluZ1NsdWcudHJpbSgpID09PSBcIlwiKSB7XHJcblx0XHRcdFx0XHRcdGZpbmFsUHJvcHNba2V5XSA9IFtzbHVnXTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdC8vIElmIHNsdWcgaGFzIGEgdmFsdWUsIHByZXNlcnZlIGl0IChkb24ndCBvdmVyd3JpdGUpXHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdC8vIEZvciBvdGhlciBub24tYXJyYXkgdmFsdWVzLCBrZWVwIGV4aXN0aW5nIHZhbHVlIChkb24ndCBvdmVyd3JpdGUpXHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8vIEFsc28gY2hlY2sgaWYgc2x1ZyBwcm9wZXJ0eSBleGlzdHMgaW4gZnJvbnRtYXR0ZXIgYnV0IGlzIGVtcHR5IChldmVuIGlmIG5vdCBpbiB0ZW1wbGF0ZSlcclxuXHQvLyBPbmx5IGF1dG8tcG9wdWxhdGUgaWYgdGVtcGxhdGUgaGFzIHt7c2x1Z319IHBsYWNlaG9sZGVyXHJcblx0aWYgKFwic2x1Z1wiIGluIHBhcnNlZC5wcm9wZXJ0aWVzICYmIHRlbXBsYXRlU3RyaW5nLmluY2x1ZGVzKFwie3tzbHVnfX1cIikpIHtcclxuXHRcdGNvbnN0IGV4aXN0aW5nU2x1ZyA9IHBhcnNlZC5wcm9wZXJ0aWVzW1wic2x1Z1wiXVswXSB8fCBcIlwiO1xyXG5cdFx0aWYgKCFleGlzdGluZ1NsdWcgfHwgZXhpc3RpbmdTbHVnLnRyaW0oKSA9PT0gXCJcIikge1xyXG5cdFx0XHQvLyBTbHVnIGV4aXN0cyBidXQgaXMgZW1wdHksIGFuZCB0ZW1wbGF0ZSBoYXMge3tzbHVnfX0gLSBhdXRvLXBvcHVsYXRlIGl0XHJcblx0XHRcdGZpbmFsUHJvcHNbXCJzbHVnXCJdID0gW3NsdWddO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Ly8gQWxzbyBhZGQgYW55IGV4aXN0aW5nIGFycmF5IGtleXMgdGhhdCB3ZXJlbid0IGluIHRoZSB0ZW1wbGF0ZVxyXG5cdGZvciAoY29uc3Qga2V5IGluIHBhcnNlZC5wcm9wZXJ0aWVzKSB7XHJcblx0XHRpZiAocGFyc2VkLnByb3BlcnRpZXNba2V5XS5sZW5ndGggPiAxKSB7XHJcblx0XHRcdGFycmF5S2V5cy5hZGQoa2V5KTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGNvbnN0IG5ld0NvbnRlbnQgPSB0ZW1wbGF0ZVBhcnNlci5idWlsZEZyb250bWF0dGVyQ29udGVudChmaW5hbFByb3BzLCBhcnJheUtleXMpICsgcGFyc2VkLmJvZHlDb250ZW50O1xyXG5cclxuXHRhd2FpdCBhcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQpO1xyXG5cclxuXHQvLyBSZXN0b3JlIGN1cnNvciBwb3NpdGlvbiBpZiBlZGl0b3Igd2FzIHByb3ZpZGVkIGFuZCBmaWxlIGlzIHN0aWxsIG9wZW5cclxuXHRpZiAoZWRpdG9yICYmIGN1cnNvclBvc2l0aW9uKSB7XHJcblx0XHQvLyBXYWl0IGZvciBPYnNpZGlhbiB0byByZWxvYWQgdGhlIGZpbGUgaW4gdGhlIGVkaXRvclxyXG5cdFx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwKSk7XHJcblxyXG5cdFx0Ly8gVHJ5IHRvIGdldCB0aGUgYWN0aXZlIGVkaXRvciBmb3IgdGhpcyBmaWxlXHJcblx0XHRjb25zdCBhY3RpdmVWaWV3ID0gYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcblx0XHRpZiAoYWN0aXZlVmlldyAmJiBhY3RpdmVWaWV3LmZpbGUgPT09IGZpbGUgJiYgYWN0aXZlVmlldy5lZGl0b3IpIHtcclxuXHRcdFx0Y29uc3QgYWN0aXZlRWRpdG9yID0gYWN0aXZlVmlldy5lZGl0b3I7XHJcblx0XHRcdGNvbnN0IG5ld0xpbmVDb3VudCA9IG5ld0NvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcclxuXHRcdFx0Y29uc3Qgb3JpZ2luYWxMaW5lQ291bnQgPSBvcmlnaW5hbENvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcclxuXHJcblx0XHRcdC8vIENhbGN1bGF0ZSBuZXcgY3Vyc29yIHBvc2l0aW9uXHJcblx0XHRcdGxldCBuZXdMaW5lID0gY3Vyc29yUG9zaXRpb24ubGluZTtcclxuXHRcdFx0bGV0IG5ld0NoID0gY3Vyc29yUG9zaXRpb24uY2g7XHJcblxyXG5cdFx0XHQvLyBBZGp1c3QgZm9yIGNvbnRlbnQgY2hhbmdlc1xyXG5cdFx0XHRpZiAobmV3TGluZUNvdW50ICE9PSBvcmlnaW5hbExpbmVDb3VudCkge1xyXG5cdFx0XHRcdC8vIElmIGxpbmVzIHdlcmUgYWRkZWQvcmVtb3ZlZCwgYWRqdXN0IGxpbmUgbnVtYmVyXHJcblx0XHRcdFx0aWYgKG5ld0xpbmUgPj0gbmV3TGluZUNvdW50KSB7XHJcblx0XHRcdFx0XHRuZXdMaW5lID0gTWF0aC5tYXgoMCwgbmV3TGluZUNvdW50IC0gMSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBBZGp1c3QgY29sdW1uIHBvc2l0aW9uIGlmIGxpbmUgbGVuZ3RoIGNoYW5nZWRcclxuXHRcdFx0Y29uc3QgbmV3TGluZUxlbmd0aCA9IG5ld0NvbnRlbnQuc3BsaXQoJ1xcbicpW25ld0xpbmVdPy5sZW5ndGggfHwgMDtcclxuXHRcdFx0aWYgKG5ld0NoID4gbmV3TGluZUxlbmd0aCkge1xyXG5cdFx0XHRcdG5ld0NoID0gTWF0aC5tYXgoMCwgbmV3TGluZUxlbmd0aCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIFJlc3RvcmUgY3Vyc29yIHBvc2l0aW9uXHJcblx0XHRcdGFjdGl2ZUVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiBuZXdMaW5lLCBjaDogbmV3Q2ggfSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRuZXcgTm90aWNlKFwiUHJvcGVydGllcyBzdGFuZGFyZGl6ZWQgdXNpbmcgdGVtcGxhdGUuXCIpO1xyXG59XHJcblxyXG4vKipcclxuICogUmVuYW1lIGEgZmlsZSBieSBwYXRoIChmb3IgcHJvZ3JhbW1hdGljIHVzZSwgZS5nLiwgZnJvbSBvdGhlciBwbHVnaW5zKVxyXG4gKiBUaGlzIGFsbG93cyB0aGUgcmVuYW1lIG1vZGFsIHRvIGFwcGVhciB3aXRob3V0IG9wZW5pbmcgdGhlIGZpbGUgZmlyc3RcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5hbWVDb250ZW50QnlQYXRoKFxyXG5cdGFwcDogQXBwLFxyXG5cdGZpbGVQYXRoOiBzdHJpbmcsXHJcblx0c2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyxcclxuXHRwbHVnaW46IEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2VcclxuKTogdm9pZCB7XHJcblx0Y29uc3QgZmlsZSA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xyXG5cdGlmICghKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcclxuXHRcdG5ldyBOb3RpY2UoYEZpbGUgbm90IGZvdW5kOiAke2ZpbGVQYXRofWApO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcblx0Y29uc3QgZmlsZU9wcyA9IG5ldyBGaWxlT3BlcmF0aW9ucyhhcHAsIHNldHRpbmdzLCBwbHVnaW4pO1xyXG5cclxuXHQvLyBIZWxwZXIgZnVuY3Rpb24gdG8gY2hlY2sgaWYgZmlsZSBtYXRjaGVzIGNvbnRlbnQgdHlwZVxyXG5cdC8vIFVzZXMgdGhlIHNhbWUgbG9naWMgYXMgRmlsZU9wZXJhdGlvbnMuZGV0ZXJtaW5lVHlwZSgpIHRvIGVuc3VyZSBjb25zaXN0ZW5jeVxyXG5cdGZ1bmN0aW9uIGhhc01hdGNoaW5nQ29udGVudFR5cGUoZmlsZTogVEZpbGUsIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpOiBib29sZWFuIHtcclxuXHRcdGNvbnN0IHR5cGUgPSBmaWxlT3BzLmRldGVybWluZVR5cGUoZmlsZSk7XHJcblx0XHQvLyBJZiBkZXRlcm1pbmVUeXBlIHJldHVybnMgXCJub3RlXCIsIGl0IG1lYW5zIG5vIGNvbnRlbnQgdHlwZSBtYXRjaGVkXHJcblx0XHRpZiAodHlwZSA9PT0gXCJub3RlXCIpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0Ly8gQ2hlY2sgaWYgdGhlIG1hdGNoZWQgY29udGVudCB0eXBlIGlzIGVuYWJsZWRcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gZmlsZU9wcy5nZXRDb250ZW50VHlwZSh0eXBlKTtcclxuXHRcdHJldHVybiBjb250ZW50VHlwZSAhPT0gbnVsbCAmJiBjb250ZW50VHlwZS5lbmFibGVkO1xyXG5cdH1cclxuXHJcblx0aWYgKCFoYXNNYXRjaGluZ0NvbnRlbnRUeXBlKGZpbGUsIHNldHRpbmdzKSkge1xyXG5cdFx0bmV3IE5vdGljZShcIkNhbm5vdCByZW5hbWU6IHRoaXMgZmlsZSBpcyBub3QgcGFydCBvZiBhIGNvbmZpZ3VyZWQgY29udGVudCB0eXBlIGZvbGRlci5cIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHRjb25zdCB0eXBlID0gZmlsZU9wcy5kZXRlcm1pbmVUeXBlKGZpbGUpO1xyXG5cclxuXHQvLyBBbHdheXMgb3BlbiB0aGUgbW9kYWwgLSBpdCB3aWxsIGhhbmRsZSBmaWxlcyB3aXRob3V0IGZyb250bWF0dGVyIG9yIHRpdGxlIGtleVxyXG5cdC8vIElmIHRoZXJlJ3Mgbm8gdGl0bGUgaW4gZnJvbnRtYXR0ZXIsIHRoZSBtb2RhbCB3aWxsIHVzZSB0aGUgZmlsZW5hbWUgYXMgZmFsbGJhY2tcclxuXHQvLyBhbmQgdGhlIHJlbmFtZSB3aWxsIHByb2NlZWQgd2l0aCBrZWJhYi1jYXNlIHZlcnNpb24gb2Ygd2hhdCB1c2VyIHR5cGVzXHJcblx0bmV3IFRpdGxlTW9kYWwoYXBwLCBmaWxlLCBwbHVnaW4sIHR5cGUsIHRydWUpLm9wZW4oKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJlZ2lzdGVyIGNvbW1hbmRzIGZvciBlYWNoIGVuYWJsZWQgY29udGVudCB0eXBlXHJcbiAqIEVhY2ggY29tbWFuZCBjcmVhdGVzIGEgbmV3IGZpbGUgaW4gdGhlIGNvbnRlbnQgdHlwZSdzIGZvbGRlciBhbmQgb3BlbnMgdGhlIFRpdGxlTW9kYWxcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlckNvbnRlbnRUeXBlQ29tbWFuZHMocGx1Z2luOiBQbHVnaW4sIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpOiB2b2lkIHtcclxuXHRjb25zdCBwbHVnaW5JbnRlcmZhY2UgPSBwbHVnaW4gYXMgdW5rbm93biBhcyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlO1xyXG5cdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcclxuXHJcblx0Ly8gUmVnaXN0ZXIgYSBjb21tYW5kIGZvciBlYWNoIGVuYWJsZWQgY29udGVudCB0eXBlXHJcblx0Zm9yIChjb25zdCBjb250ZW50VHlwZSBvZiBjb250ZW50VHlwZXMpIHtcclxuXHRcdGlmICghY29udGVudFR5cGUuZW5hYmxlZCkge1xyXG5cdFx0XHRjb250aW51ZTsgLy8gU2tpcCBkaXNhYmxlZCBjb250ZW50IHR5cGVzXHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3QgY29tbWFuZElkID0gYGNyZWF0ZS1jb250ZW50LXR5cGUtJHtjb250ZW50VHlwZS5pZH1gO1xyXG5cdFx0Y29uc3QgY29tbWFuZE5hbWUgPSBgQ3JlYXRlIG5ldyBjb250ZW50IHR5cGU6ICR7Y29udGVudFR5cGUubmFtZX1gO1xyXG5cclxuXHRcdHBsdWdpbi5hZGRDb21tYW5kKHtcclxuXHRcdFx0aWQ6IGNvbW1hbmRJZCxcclxuXHRcdFx0bmFtZTogY29tbWFuZE5hbWUsXHJcblx0XHRcdGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0Ly8gRGV0ZXJtaW5lIHRhcmdldCBmb2xkZXIgZnJvbSBjb250ZW50IHR5cGUgKG9yIHZhdWx0IHJvb3QgaWYgYmxhbmspXHJcblx0XHRcdFx0bGV0IHRhcmdldEZvbGRlciA9IGNvbnRlbnRUeXBlLmZvbGRlciB8fCBcIlwiO1xyXG5cclxuXHRcdFx0XHQvLyBDcmVhdGUgZm9sZGVyIGlmIGl0IGRvZXNuJ3QgZXhpc3QgYW5kIGlzIHNwZWNpZmllZFxyXG5cdFx0XHRcdGlmICh0YXJnZXRGb2xkZXIgJiYgdGFyZ2V0Rm9sZGVyLnRyaW0oKSAhPT0gXCJcIikge1xyXG5cdFx0XHRcdFx0Y29uc3QgZm9sZGVyID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgodGFyZ2V0Rm9sZGVyKTtcclxuXHRcdFx0XHRcdGlmICghKGZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpKSB7XHJcblx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgcGx1Z2luLmFwcC52YXVsdC5jcmVhdGVGb2xkZXIodGFyZ2V0Rm9sZGVyKTtcclxuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XHJcblx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvIGNyZWF0ZSBmb2xkZXI6ICR7ZXJyb3JNZXNzYWdlfWApO1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0Ly8gQ3JlYXRlIGEgdGVtcG9yYXJ5IGZpbGUgaW4gdGhlIHRhcmdldCBmb2xkZXJcclxuXHRcdFx0XHRjb25zdCB0ZW1wRmlsZU5hbWUgPSBcIlVudGl0bGVkLm1kXCI7XHJcblx0XHRcdFx0Y29uc3QgZmlsZVBhdGggPSB0YXJnZXRGb2xkZXIgPyBgJHt0YXJnZXRGb2xkZXJ9LyR7dGVtcEZpbGVOYW1lfWAgOiB0ZW1wRmlsZU5hbWU7XHJcblxyXG5cdFx0XHRcdC8vIENoZWNrIGlmIGZpbGUgYWxyZWFkeSBleGlzdHMgKHVubGlrZWx5IGJ1dCBwb3NzaWJsZSlcclxuXHRcdFx0XHRjb25zdCBleGlzdGluZ0ZpbGUgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XHJcblx0XHRcdFx0aWYgKGV4aXN0aW5nRmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRcdFx0XHQvLyBJZiBmaWxlIGV4aXN0cywgdXNlIGl0IGRpcmVjdGx5XHJcblx0XHRcdFx0XHRuZXcgVGl0bGVNb2RhbChwbHVnaW4uYXBwLCBleGlzdGluZ0ZpbGUsIHBsdWdpbkludGVyZmFjZSwgY29udGVudFR5cGUuaWQsIGZhbHNlLCB0cnVlKS5vcGVuKCk7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvLyBNYXJrIHRoYXQgdGhpcyBmaWxlIHdpbGwgYmUgY3JlYXRlZCBieSB0aGUgcGx1Z2luXHJcblx0XHRcdFx0Ly8gVGhpcyBwcmV2ZW50cyB0aGUgY3JlYXRlIGV2ZW50IGZyb20gdHJpZ2dlcmluZyBhbm90aGVyIG1vZGFsXHJcblx0XHRcdFx0aWYgKHBsdWdpbkludGVyZmFjZSAmJiAncGx1Z2luQ3JlYXRlZEZpbGVzJyBpbiBwbHVnaW5JbnRlcmZhY2UpIHtcclxuXHRcdFx0XHRcdHBsdWdpbkludGVyZmFjZS5wbHVnaW5DcmVhdGVkRmlsZXMuc2V0KGZpbGVQYXRoLCBEYXRlLm5vdygpKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHQvLyBDcmVhdGUgdGhlIHRlbXBvcmFyeSBmaWxlXHJcblx0XHRcdFx0XHRjb25zdCB0ZW1wRmlsZSA9IGF3YWl0IHBsdWdpbi5hcHAudmF1bHQuY3JlYXRlKGZpbGVQYXRoLCBcIlwiKTtcclxuXHJcblx0XHRcdFx0XHQvLyBPcGVuIHRoZSBUaXRsZU1vZGFsIHdpdGggdGhlIGZpbGUsIGNvbnRlbnQgdHlwZSBJRCwgYW5kIGlzTmV3Tm90ZSBmbGFnXHJcblx0XHRcdFx0XHRuZXcgVGl0bGVNb2RhbChwbHVnaW4uYXBwLCB0ZW1wRmlsZSwgcGx1Z2luSW50ZXJmYWNlLCBjb250ZW50VHlwZS5pZCwgZmFsc2UsIHRydWUpLm9wZW4oKTtcclxuXHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xyXG5cdFx0XHRcdFx0Y29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xyXG5cdFx0XHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvIGNyZWF0ZSBmaWxlOiAke2Vycm9yTWVzc2FnZX1gKTtcclxuXHJcblx0XHRcdFx0XHQvLyBDbGVhbiB1cCB0aGUgdHJhY2tpbmcgaWYgZmlsZSBjcmVhdGlvbiBmYWlsZWRcclxuXHRcdFx0XHRcdGlmIChwbHVnaW5JbnRlcmZhY2UgJiYgJ3BsdWdpbkNyZWF0ZWRGaWxlcycgaW4gcGx1Z2luSW50ZXJmYWNlKSB7XHJcblx0XHRcdFx0XHRcdHBsdWdpbkludGVyZmFjZS5wbHVnaW5DcmVhdGVkRmlsZXMuZGVsZXRlKGZpbGVQYXRoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHR9KTtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZWJ1ZyBsb2dnZXIgZm9yIHRlcm1pbmFsIGNvbW1hbmRzXHJcbiAqL1xyXG5jb25zdCB0ZXJtaW5hbExvZ2dlciA9IHtcclxuXHRlbmFibGVkOiBmYWxzZSxcclxuXHRzZXRFbmFibGVkKHZhbHVlOiBib29sZWFuKSB7XHJcblx0XHR0aGlzLmVuYWJsZWQgPSB2YWx1ZTtcclxuXHR9LFxyXG5cdGxvZyguLi5hcmdzOiB1bmtub3duW10pIHtcclxuXHRcdGlmICh0aGlzLmVuYWJsZWQpIHtcclxuXHRcdFx0Y29uc29sZS5kZWJ1ZyhcIlthc3Ryby1jb21wb3Nlcjp0ZXJtaW5hbF1cIiwgLi4uYXJncyk7XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEdldCBkZWZhdWx0IHRlcm1pbmFsIGFwcGxpY2F0aW9uIG5hbWUgYmFzZWQgb24gcGxhdGZvcm1cclxuICovXHJcbmZ1bmN0aW9uIGdldERlZmF1bHRUZXJtaW5hbEFwcCgpOiBzdHJpbmcge1xyXG5cdGlmICghUGxhdGZvcm0uaXNEZXNrdG9wQXBwKSB7XHJcblx0XHRyZXR1cm4gXCJcIjtcclxuXHR9XHJcblx0aWYgKFBsYXRmb3JtLmlzTWFjT1MpIHtcclxuXHRcdHJldHVybiBcIlRlcm1pbmFsXCI7XHJcblx0fVxyXG5cdGlmIChQbGF0Zm9ybS5pc1dpbikge1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby1ub2RlanMtbW9kdWxlcywgQHR5cGVzY3JpcHQtZXNsaW50L25vLXJlcXVpcmUtaW1wb3J0cywgbm8tdW5kZWYgLS0gUmVxdWlyZWQgZm9yIE9TIHJlbGVhc2UgZGV0ZWN0aW9uIG9uIGRlc2t0b3BcclxuXHRcdFx0Y29uc3Qgb3MgPSByZXF1aXJlKCdvcycpIGFzIHsgcmVsZWFzZTogKCkgPT4gc3RyaW5nIH07XHJcblx0XHRcdGNvbnN0IHJlbGVhc2UgPSBvcy5yZWxlYXNlKCk7XHJcblx0XHRcdC8vIFdpbmRvd3MgMTEgYnVpbGQgbnVtYmVycyBzdGFydCBhdCAyMjAwMFxyXG5cdFx0XHRjb25zdCBtYWpvclZlcnNpb24gPSBwYXJzZUludChyZWxlYXNlLnNwbGl0KCcuJylbMF0pO1xyXG5cdFx0XHRjb25zdCBidWlsZE51bWJlciA9IHBhcnNlSW50KHJlbGVhc2Uuc3BsaXQoJy4nKVsyXSk7XHJcblxyXG5cdFx0XHRpZiAobWFqb3JWZXJzaW9uID4gMTAgfHwgKG1ham9yVmVyc2lvbiA9PT0gMTAgJiYgYnVpbGROdW1iZXIgPj0gMjIwMDApKSB7XHJcblx0XHRcdFx0cmV0dXJuIFwid3QuZXhlXCI7XHJcblx0XHRcdH1cclxuXHRcdH0gY2F0Y2gge1xyXG5cdFx0XHQvLyBGYWxsYmFjayB0byBjbWQuZXhlIGlmIE9TIGRldGVjdGlvbiBmYWlsc1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIFwiY21kLmV4ZVwiO1xyXG5cdH1cclxuXHRpZiAoUGxhdGZvcm0uaXNMaW51eCkge1xyXG5cdFx0cmV0dXJuIFwiZ25vbWUtdGVybWluYWxcIjtcclxuXHR9XHJcblx0cmV0dXJuIFwiXCI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTYW5pdGl6ZSB0ZXJtaW5hbCBhcHBsaWNhdGlvbiBuYW1lICh0cmltIHdoaXRlc3BhY2UpXHJcbiAqL1xyXG5mdW5jdGlvbiBzYW5pdGl6ZVRlcm1pbmFsQXBwKHZhbHVlOiBzdHJpbmcpOiBzdHJpbmcge1xyXG5cdHJldHVybiB2YWx1ZS50cmltKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFc2NhcGUgZG91YmxlIHF1b3RlcyBpbiBhIHN0cmluZ1xyXG4gKi9cclxuZnVuY3Rpb24gZXNjYXBlRG91YmxlUXVvdGVzKHZhbHVlOiBzdHJpbmcpOiBzdHJpbmcge1xyXG5cdHJldHVybiB2YWx1ZS5yZXBsYWNlKC9cIi9nLCAnXFxcXFwiJyk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPcGVuIHRlcm1pbmFsIGluIHByb2plY3Qgcm9vdCBkaXJlY3RvcnlcclxuICogRXhwb3J0ZWQgZm9yIHVzZSBieSByaWJib24gaWNvbnNcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBvcGVuVGVybWluYWxJblByb2plY3RSb290KGFwcDogQXBwLCBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzKTogdm9pZCB7XHJcblx0Ly8gVXBkYXRlIGxvZ2dlciBzdGF0ZVxyXG5cdHRlcm1pbmFsTG9nZ2VyLnNldEVuYWJsZWQoc2V0dGluZ3MuZW5hYmxlVGVybWluYWxEZWJ1Z0xvZ2dpbmcpO1xyXG5cclxuXHR0cnkge1xyXG5cdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby1ub2RlanMtbW9kdWxlcywgQHR5cGVzY3JpcHQtZXNsaW50L25vLXJlcXVpcmUtaW1wb3J0cywgbm8tdW5kZWYgLS0gY2hpbGRfcHJvY2VzcyBpcyByZXF1aXJlZCBmb3IgdGVybWluYWwgY29tbWFuZHMgb24gZGVza3RvcFxyXG5cdFx0Y29uc3QgeyBleGVjIH0gPSByZXF1aXJlKCdjaGlsZF9wcm9jZXNzJykgYXMgeyBleGVjOiAoY29tbWFuZDogc3RyaW5nLCBjYWxsYmFjazogKGVycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHZvaWQpID0+IHZvaWQgfTtcclxuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tbm9kZWpzLW1vZHVsZXMsIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHMsIG5vLXVuZGVmIC0tIHBhdGggaXMgcmVxdWlyZWQgZm9yIHJlc29sdmluZyBwYXRocyBvbiBkZXNrdG9wXHJcblx0XHRjb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpIGFzIHsgcmVzb2x2ZTogKC4uLmFyZ3M6IHN0cmluZ1tdKSA9PiBzdHJpbmcgfTtcclxuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tbm9kZWpzLW1vZHVsZXMsIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHMsIG5vLXVuZGVmIC0tIGZzIGlzIHJlcXVpcmVkIGZvciB2ZXJpZnlpbmcgcGF0aHMgb24gZGVza3RvcFxyXG5cdFx0Y29uc3QgZnMgPSByZXF1aXJlKCdmcycpIGFzIHsgZXhpc3RzU3luYzogKHBhdGg6IHN0cmluZykgPT4gYm9vbGVhbiB9O1xyXG5cclxuXHRcdC8vIEdldCB0aGUgYWN0dWFsIHZhdWx0IHBhdGggc3RyaW5nIGZyb20gdGhlIGFkYXB0ZXJcclxuXHRcdGNvbnN0IGFkYXB0ZXIgPSBhcHAudmF1bHQuYWRhcHRlciBhcyB1bmtub3duIGFzIHsgYmFzZVBhdGg/OiBzdHJpbmc7IHBhdGg/OiBzdHJpbmcgfTtcclxuXHRcdGNvbnN0IHZhdWx0UGF0aCA9IGFkYXB0ZXIuYmFzZVBhdGggfHwgYWRhcHRlci5wYXRoO1xyXG5cdFx0Y29uc3QgdmF1bHRQYXRoU3RyaW5nID0gdHlwZW9mIHZhdWx0UGF0aCA9PT0gJ3N0cmluZycgPyB2YXVsdFBhdGggOiBTdHJpbmcodmF1bHRQYXRoKTtcclxuXHJcblx0XHQvLyBSZXNvbHZlIHByb2plY3Qgcm9vdCBwYXRoXHJcblx0XHRsZXQgcHJvamVjdFBhdGg6IHN0cmluZztcclxuXHRcdGlmIChzZXR0aW5ncy50ZXJtaW5hbFByb2plY3RSb290UGF0aCAmJiBzZXR0aW5ncy50ZXJtaW5hbFByb2plY3RSb290UGF0aC50cmltKCkpIHtcclxuXHRcdFx0Ly8gVXNlIGN1c3RvbSBwYXRoIHJlbGF0aXZlIHRvIHZhdWx0XHJcblx0XHRcdHByb2plY3RQYXRoID0gcGF0aC5yZXNvbHZlKHZhdWx0UGF0aFN0cmluZywgc2V0dGluZ3MudGVybWluYWxQcm9qZWN0Um9vdFBhdGgpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Ly8gRGVmYXVsdDogdmF1bHQgZm9sZGVyIGl0c2VsZlxyXG5cdFx0XHRwcm9qZWN0UGF0aCA9IHZhdWx0UGF0aFN0cmluZztcclxuXHRcdH1cclxuXHJcblx0XHQvLyBWZXJpZnkgdGhlIHBhdGggZXhpc3RzXHJcblx0XHRpZiAoIWZzLmV4aXN0c1N5bmMocHJvamVjdFBhdGgpKSB7XHJcblx0XHRcdG5ldyBOb3RpY2UoYFByb2plY3Qgcm9vdCBkaXJlY3Rvcnkgbm90IGZvdW5kIGF0OiAke3Byb2plY3RQYXRofWApO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gR2V0IHRlcm1pbmFsIGFwcGxpY2F0aW9uIG5hbWUgKHVzZSBjb25maWd1cmVkIG9yIGRlZmF1bHQpXHJcblx0XHRjb25zdCBjb25maWd1cmVkQXBwID0gc2FuaXRpemVUZXJtaW5hbEFwcChzZXR0aW5ncy50ZXJtaW5hbEFwcGxpY2F0aW9uTmFtZSB8fCBcIlwiKTtcclxuXHRcdGNvbnN0IHRlcm1pbmFsQXBwID0gY29uZmlndXJlZEFwcCB8fCBnZXREZWZhdWx0VGVybWluYWxBcHAoKTtcclxuXHJcblx0XHQvLyBXYXJuIGlmIHRlcm1pbmFsIGFwcCBuYW1lIGlzIGVtcHR5IChidXQgc3RpbGwgdHJ5IHRvIHVzZSBkZWZhdWx0cylcclxuXHRcdGlmICghY29uZmlndXJlZEFwcCAmJiAhdGVybWluYWxBcHApIHtcclxuXHRcdFx0bmV3IE5vdGljZShcIlRlcm1pbmFsIGFwcGxpY2F0aW9uIG5hbWUgaXMgZW1wdHkuIFBsZWFzZSBjb25maWd1cmUgaXQgaW4gc2V0dGluZ3MuXCIpO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmIC0tIHByb2Nlc3MgaXMgYSBnbG9iYWwgaW4gdGhlIEVsZWN0cm9uIHJlbmRlcmVyIHByb2Nlc3NcclxuXHRcdGNvbnN0IHBsYXRmb3JtID0gcHJvY2Vzcy5wbGF0Zm9ybTtcclxuXHRcdHRlcm1pbmFsTG9nZ2VyLmxvZyhcIk9wZW5pbmcgdGVybWluYWxcIiwgeyBwbGF0Zm9ybSwgdGVybWluYWxBcHAsIHByb2plY3RQYXRoIH0pO1xyXG5cclxuXHRcdGlmIChwbGF0Zm9ybSA9PT0gJ3dpbjMyJykge1xyXG5cdFx0XHQvLyBXaW5kb3dzOiBVc2Ugc3RhcnQgY29tbWFuZCB3aXRoIGNvbmZpZ3VyYWJsZSB0ZXJtaW5hbFxyXG5cdFx0XHRjb25zdCBlc2NhcGVkUGF0aCA9IHByb2plY3RQYXRoLnJlcGxhY2UoL1wiL2csICdcIicpO1xyXG5cdFx0XHRjb25zdCBsb3dlckFwcCA9IHRlcm1pbmFsQXBwLnRvTG93ZXJDYXNlKCk7XHJcblxyXG5cdFx0XHRpZiAobG93ZXJBcHAgPT09IFwid3QuZXhlXCIgfHwgbG93ZXJBcHAgPT09IFwid3RcIiB8fCBsb3dlckFwcCA9PT0gXCJ3aW5kb3dzIHRlcm1pbmFsXCIpIHtcclxuXHRcdFx0XHQvLyBXaW5kb3dzIFRlcm1pbmFsXHJcblx0XHRcdFx0ZXhlYygnd2hlcmUgd3QnLCAoZXJyb3I6IHsgbWVzc2FnZT86IHN0cmluZyB9IHwgbnVsbCkgPT4ge1xyXG5cdFx0XHRcdFx0aWYgKCFlcnJvcikge1xyXG5cdFx0XHRcdFx0XHRjb25zdCBjb21tYW5kID0gYHN0YXJ0IFwiXCIgd3QuZXhlIC1kIFwiJHtlc2NhcGVkUGF0aH1cImA7XHJcblx0XHRcdFx0XHRcdHRlcm1pbmFsTG9nZ2VyLmxvZyhcIldpbmRvd3MgbGF1bmNoICh3dClcIiwgeyBjb21tYW5kLCBwcm9qZWN0UGF0aCB9KTtcclxuXHRcdFx0XHRcdFx0ZXhlYyhjb21tYW5kLCAoZXhlY0Vycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRpZiAoZXhlY0Vycm9yKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR0ZXJtaW5hbExvZ2dlci5sb2coXCJXaW5kb3dzIFRlcm1pbmFsIGZhaWxlZCwgZmFsbGluZyBiYWNrIHRvIGNtZFwiLCB7IGVycm9yOiBleGVjRXJyb3IubWVzc2FnZSB9KTtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIEZhbGxiYWNrIHRvIGNtZFxyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgZmFsbGJhY2tDb21tYW5kID0gYHN0YXJ0IFwiXCIgY21kLmV4ZSAvSyBcImNkIC9kIFwiJHtlc2NhcGVkUGF0aH1cIlwiYDtcclxuXHRcdFx0XHRcdFx0XHRcdGV4ZWMoZmFsbGJhY2tDb21tYW5kLCAoY21kRXJyb3I6IHsgbWVzc2FnZT86IHN0cmluZyB9IHwgbnVsbCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoY21kRXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRuZXcgTm90aWNlKGBFcnJvciBvcGVuaW5nIHRlcm1pbmFsOiAke2NtZEVycm9yLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InfWApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0Ly8gV2luZG93cyBUZXJtaW5hbCBub3QgZm91bmQsIGZhbGxiYWNrIHRvIGNtZFxyXG5cdFx0XHRcdFx0XHR0ZXJtaW5hbExvZ2dlci5sb2coXCJXaW5kb3dzIFRlcm1pbmFsIG5vdCBmb3VuZCwgdXNpbmcgY21kXCIsIHt9KTtcclxuXHRcdFx0XHRcdFx0Y29uc3QgZmFsbGJhY2tDb21tYW5kID0gYHN0YXJ0IFwiXCIgY21kLmV4ZSAvSyBcImNkIC9kIFwiJHtlc2NhcGVkUGF0aH1cIlwiYDtcclxuXHRcdFx0XHRcdFx0ZXhlYyhmYWxsYmFja0NvbW1hbmQsIChjbWRFcnJvcjogeyBtZXNzYWdlPzogc3RyaW5nIH0gfCBudWxsKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKGNtZEVycm9yKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRuZXcgTm90aWNlKGBFcnJvciBvcGVuaW5nIHRlcm1pbmFsOiAke2NtZEVycm9yLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InfWApO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0gZWxzZSBpZiAobG93ZXJBcHAgPT09IFwicG93ZXJzaGVsbFwiIHx8IGxvd2VyQXBwID09PSBcInBvd2Vyc2hlbGwuZXhlXCIpIHtcclxuXHRcdFx0XHQvLyBQb3dlclNoZWxsXHJcblx0XHRcdFx0Y29uc3QgZXNjYXBlZFBhdGhGb3JQUyA9IHByb2plY3RQYXRoLnJlcGxhY2UoLycvZywgXCInJ1wiKTtcclxuXHRcdFx0XHRjb25zdCBjb21tYW5kID0gYHN0YXJ0IFwiXCIgcG93ZXJzaGVsbCAtTm9FeGl0IC1Db21tYW5kIFwiU2V0LUxvY2F0aW9uICcke2VzY2FwZWRQYXRoRm9yUFN9JztcImA7XHJcblx0XHRcdFx0dGVybWluYWxMb2dnZXIubG9nKFwiV2luZG93cyBsYXVuY2ggKHBvd2Vyc2hlbGwpXCIsIHsgY29tbWFuZCwgcHJvamVjdFBhdGggfSk7XHJcblx0XHRcdFx0ZXhlYyhjb21tYW5kLCAoZXJyb3I6IHsgbWVzc2FnZT86IHN0cmluZyB9IHwgbnVsbCkgPT4ge1xyXG5cdFx0XHRcdFx0aWYgKGVycm9yKSB7XHJcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoYEVycm9yIG9wZW5pbmcgdGVybWluYWw6ICR7ZXJyb3IubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcid9YCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0gZWxzZSBpZiAobG93ZXJBcHAgPT09IFwiY21kLmV4ZVwiIHx8IGxvd2VyQXBwID09PSBcImNtZFwiKSB7XHJcblx0XHRcdFx0Ly8gQ29tbWFuZCBQcm9tcHRcclxuXHRcdFx0XHRjb25zdCBjb21tYW5kID0gYHN0YXJ0IFwiXCIgY21kLmV4ZSAvSyBcImNkIC9kIFwiJHtlc2NhcGVkUGF0aH1cIlwiYDtcclxuXHRcdFx0XHR0ZXJtaW5hbExvZ2dlci5sb2coXCJXaW5kb3dzIGxhdW5jaCAoY21kKVwiLCB7IGNvbW1hbmQsIHByb2plY3RQYXRoIH0pO1xyXG5cdFx0XHRcdGV4ZWMoY29tbWFuZCwgKGVycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHtcclxuXHRcdFx0XHRcdGlmIChlcnJvcikge1xyXG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlKGBFcnJvciBvcGVuaW5nIHRlcm1pbmFsOiAke2Vycm9yLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InfWApO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdC8vIEdlbmVyaWMgdGVybWluYWwgLSB0cnkgdG8gbGF1bmNoIGl0IGRpcmVjdGx5XHJcblx0XHRcdFx0Y29uc3QgY29tbWFuZCA9IGBzdGFydCBcIlwiIFwiJHt0ZXJtaW5hbEFwcH1cImA7XHJcblx0XHRcdFx0dGVybWluYWxMb2dnZXIubG9nKFwiV2luZG93cyBsYXVuY2ggKGdlbmVyaWMpXCIsIHsgY29tbWFuZCwgdGVybWluYWxBcHAsIHByb2plY3RQYXRoIH0pO1xyXG5cdFx0XHRcdGV4ZWMoY29tbWFuZCwgKGVycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHtcclxuXHRcdFx0XHRcdGlmIChlcnJvcikge1xyXG5cdFx0XHRcdFx0XHQvLyBGYWxsYmFjayB0byBjbWQgaWYgZ2VuZXJpYyBsYXVuY2ggZmFpbHNcclxuXHRcdFx0XHRcdFx0dGVybWluYWxMb2dnZXIubG9nKFwiR2VuZXJpYyB0ZXJtaW5hbCBmYWlsZWQsIGZhbGxpbmcgYmFjayB0byBjbWRcIiwgeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuXHRcdFx0XHRcdFx0Y29uc3QgZmFsbGJhY2tDb21tYW5kID0gYHN0YXJ0IFwiXCIgY21kLmV4ZSAvSyBcImNkIC9kIFwiJHtlc2NhcGVkUGF0aH1cIlwiYDtcclxuXHRcdFx0XHRcdFx0ZXhlYyhmYWxsYmFja0NvbW1hbmQsIChjbWRFcnJvcjogeyBtZXNzYWdlPzogc3RyaW5nIH0gfCBudWxsKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKGNtZEVycm9yKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRuZXcgTm90aWNlKGBFcnJvciBvcGVuaW5nIHRlcm1pbmFsOiAke2NtZEVycm9yLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InfWApO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSBpZiAocGxhdGZvcm0gPT09ICdkYXJ3aW4nKSB7XHJcblx0XHRcdC8vIG1hY09TOiBVc2Ugb3BlbiAtYSAoc2ltcGxlciB0aGFuIG9zYXNjcmlwdClcclxuXHRcdFx0Y29uc3QgZXNjYXBlZEFwcCA9IGVzY2FwZURvdWJsZVF1b3Rlcyh0ZXJtaW5hbEFwcCk7XHJcblx0XHRcdGNvbnN0IGVzY2FwZWRQYXRoID0gZXNjYXBlRG91YmxlUXVvdGVzKHByb2plY3RQYXRoKTtcclxuXHRcdFx0Y29uc3QgY29tbWFuZCA9IGBvcGVuIC1uYSBcIiR7ZXNjYXBlZEFwcH1cIiBcIiR7ZXNjYXBlZFBhdGh9XCJgO1xyXG5cdFx0XHR0ZXJtaW5hbExvZ2dlci5sb2coXCJtYWNPUyBsYXVuY2hcIiwgeyBjb21tYW5kLCB0ZXJtaW5hbEFwcCwgcHJvamVjdFBhdGggfSk7XHJcblx0XHRcdGV4ZWMoY29tbWFuZCwgKGVycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHtcclxuXHRcdFx0XHRpZiAoZXJyb3IpIHtcclxuXHRcdFx0XHRcdG5ldyBOb3RpY2UoYEVycm9yIG9wZW5pbmcgdGVybWluYWw6ICR7ZXJyb3IubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcid9YCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIExpbnV4OiBUcnkgY29uZmlndXJhYmxlIHRlcm1pbmFsIHdpdGggZmFsbGJhY2sgY2hhaW5cclxuXHRcdFx0Y29uc3QgdGVybWluYWxzID0gdGVybWluYWxBcHAgPyBbdGVybWluYWxBcHBdIDogW1wiZ25vbWUtdGVybWluYWxcIiwgXCJrb25zb2xlXCIsIFwieHRlcm1cIl07XHJcblx0XHRcdGNvbnN0IHByb2plY3RQYXRoRXNjYXBlZCA9IHByb2plY3RQYXRoLnJlcGxhY2UoL1wiL2csICdcXFxcXCInKTtcclxuXHJcblx0XHRcdC8vIFRyeSBlYWNoIHRlcm1pbmFsIHVudGlsIG9uZSB3b3Jrc1xyXG5cdFx0XHRjb25zdCB0cnlUZXJtaW5hbCA9IChpbmRleDogbnVtYmVyKSA9PiB7XHJcblx0XHRcdFx0aWYgKGluZGV4ID49IHRlcm1pbmFscy5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdG5ldyBOb3RpY2UoJ05vIHN1cHBvcnRlZCB0ZXJtaW5hbCBmb3VuZC4gUGxlYXNlIGluc3RhbGwgYSB0ZXJtaW5hbCBhcHBsaWNhdGlvbiBvciBjb25maWd1cmUgb25lIGluIHNldHRpbmdzLicpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0Y29uc3QgY3VycmVudFRlcm1pbmFsID0gdGVybWluYWxzW2luZGV4XTtcclxuXHRcdFx0XHRjb25zdCB0ZXJtaW5hbE5hbWUgPSBjdXJyZW50VGVybWluYWwuc3BsaXQoJyAnKVswXTtcclxuXHJcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgdGVybWluYWwgZXhpc3RzXHJcblx0XHRcdFx0ZXhlYyhgd2hpY2ggJHt0ZXJtaW5hbE5hbWV9YCwgKGVycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHtcclxuXHRcdFx0XHRcdGlmICghZXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0Ly8gVGVybWluYWwgZm91bmQsIHRyeSB0byBsYXVuY2ggaXRcclxuXHRcdFx0XHRcdFx0bGV0IGNvbW1hbmQ6IHN0cmluZztcclxuXHRcdFx0XHRcdFx0aWYgKGN1cnJlbnRUZXJtaW5hbC5pbmNsdWRlcyhcImdub21lLXRlcm1pbmFsXCIpKSB7XHJcblx0XHRcdFx0XHRcdFx0Y29tbWFuZCA9IGBnbm9tZS10ZXJtaW5hbCAtLXdvcmtpbmctZGlyZWN0b3J5PVwiJHtwcm9qZWN0UGF0aEVzY2FwZWR9XCJgO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGN1cnJlbnRUZXJtaW5hbC5pbmNsdWRlcyhcImtvbnNvbGVcIikpIHtcclxuXHRcdFx0XHRcdFx0XHRjb21tYW5kID0gYGtvbnNvbGUgLS13b3JrZGlyIFwiJHtwcm9qZWN0UGF0aEVzY2FwZWR9XCJgO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdC8vIEdlbmVyaWMgdGVybWluYWxcclxuXHRcdFx0XHRcdFx0XHRjb21tYW5kID0gYCR7Y3VycmVudFRlcm1pbmFsfSAtZSBcImNkIFxcXFxcIiR7cHJvamVjdFBhdGhFc2NhcGVkfVxcXFxcIiAmJiBiYXNoXCJgO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHRlcm1pbmFsTG9nZ2VyLmxvZyhcIkxpbnV4IGxhdW5jaFwiLCB7IGNvbW1hbmQsIHRlcm1pbmFsOiBjdXJyZW50VGVybWluYWwsIHByb2plY3RQYXRoIH0pO1xyXG5cdFx0XHRcdFx0XHRleGVjKGNvbW1hbmQsIChleGVjRXJyb3I6IHsgbWVzc2FnZT86IHN0cmluZyB9IHwgbnVsbCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGlmIChleGVjRXJyb3IgJiYgaW5kZXggPCB0ZXJtaW5hbHMubGVuZ3RoIC0gMSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0dGVybWluYWxMb2dnZXIubG9nKFwiVGVybWluYWwgbGF1bmNoIGZhaWxlZCwgdHJ5aW5nIG5leHRcIiwgeyB0ZXJtaW5hbDogY3VycmVudFRlcm1pbmFsLCBlcnJvcjogZXhlY0Vycm9yLm1lc3NhZ2UgfSk7XHJcblx0XHRcdFx0XHRcdFx0XHR0cnlUZXJtaW5hbChpbmRleCArIDEpO1xyXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZXhlY0Vycm9yKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRuZXcgTm90aWNlKGBFcnJvciBvcGVuaW5nIHRlcm1pbmFsOiAke2V4ZWNFcnJvci5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJ31gKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0Ly8gVGVybWluYWwgbm90IGZvdW5kLCB0cnkgbmV4dFxyXG5cdFx0XHRcdFx0XHR0ZXJtaW5hbExvZ2dlci5sb2coXCJUZXJtaW5hbCBub3QgZm91bmQsIHRyeWluZyBuZXh0XCIsIHsgdGVybWluYWw6IGN1cnJlbnRUZXJtaW5hbCB9KTtcclxuXHRcdFx0XHRcdFx0dHJ5VGVybWluYWwoaW5kZXggKyAxKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fTtcclxuXHJcblx0XHRcdHRyeVRlcm1pbmFsKDApO1xyXG5cdFx0fVxyXG5cdH0gY2F0Y2ggKGVycm9yKSB7XHJcblx0XHR0ZXJtaW5hbExvZ2dlci5sb2coXCJVbmV4cGVjdGVkIGVycm9yXCIsIHsgZXJyb3IgfSk7XHJcblx0XHRuZXcgTm90aWNlKGBFcnJvciBvcGVuaW5nIHRlcm1pbmFsOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKX1gKTtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPcGVuIGNvbmZpZyBmaWxlIGluIGRlZmF1bHQgZWRpdG9yXHJcbiAqIEV4cG9ydGVkIGZvciB1c2UgYnkgcmliYm9uIGljb25zXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb3BlbkNvbmZpZ0ZpbGUoYXBwOiBBcHAsIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpOiBQcm9taXNlPHZvaWQ+IHtcclxuXHR0cnkge1xyXG5cdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby1ub2RlanMtbW9kdWxlcywgQHR5cGVzY3JpcHQtZXNsaW50L25vLXJlcXVpcmUtaW1wb3J0cywgbm8tdW5kZWYgLS0gZnMgaXMgcmVxdWlyZWQgZm9yIHZlcmlmeWluZyBjb25maWcgZmlsZSBleGlzdHMgb24gZGVza3RvcFxyXG5cdFx0Y29uc3QgZnMgPSByZXF1aXJlKCdmcycpIGFzIHsgZXhpc3RzU3luYzogKHBhdGg6IHN0cmluZykgPT4gYm9vbGVhbiB9O1xyXG5cdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby1ub2RlanMtbW9kdWxlcywgQHR5cGVzY3JpcHQtZXNsaW50L25vLXJlcXVpcmUtaW1wb3J0cywgbm8tdW5kZWYgLS0gcGF0aCBpcyByZXF1aXJlZCBmb3IgcmVzb2x2aW5nIHBhdGhzIG9uIGRlc2t0b3BcclxuXHRcdGNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJykgYXMgeyByZXNvbHZlOiAoLi4uYXJnczogc3RyaW5nW10pID0+IHN0cmluZyB9O1xyXG5cdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHMsIG5vLXVuZGVmIC0tIGVsZWN0cm9uIHNoZWxsIGlzIHJlcXVpcmVkIHRvIG9wZW4gZmlsZXMgaW4gZGVmYXVsdCBlZGl0b3JcclxuXHRcdGNvbnN0IHsgc2hlbGwgfSA9IHJlcXVpcmUoJ2VsZWN0cm9uJykgYXMgeyBzaGVsbDogeyBvcGVuUGF0aDogKHBhdGg6IHN0cmluZykgPT4gUHJvbWlzZTxzdHJpbmc+IH0gfTtcclxuXHJcblx0XHQvLyBHZXQgdGhlIGFjdHVhbCB2YXVsdCBwYXRoIHN0cmluZyBmcm9tIHRoZSBhZGFwdGVyXHJcblx0XHRjb25zdCBhZGFwdGVyID0gYXBwLnZhdWx0LmFkYXB0ZXIgYXMgdW5rbm93biBhcyB7IGJhc2VQYXRoPzogc3RyaW5nOyBwYXRoPzogc3RyaW5nIH07XHJcblx0XHRjb25zdCB2YXVsdFBhdGggPSBhZGFwdGVyLmJhc2VQYXRoIHx8IGFkYXB0ZXIucGF0aDtcclxuXHRcdGNvbnN0IHZhdWx0UGF0aFN0cmluZyA9IHR5cGVvZiB2YXVsdFBhdGggPT09ICdzdHJpbmcnID8gdmF1bHRQYXRoIDogU3RyaW5nKHZhdWx0UGF0aCk7XHJcblxyXG5cdFx0Ly8gUmVzb2x2ZSBjb25maWcgZmlsZSBwYXRoXHJcblx0XHRpZiAoIXNldHRpbmdzLmNvbmZpZ0ZpbGVQYXRoIHx8ICFzZXR0aW5ncy5jb25maWdGaWxlUGF0aC50cmltKCkpIHtcclxuXHRcdFx0bmV3IE5vdGljZShcIlBsZWFzZSBzcGVjaWZ5IGEgY29uZmlnIGZpbGUgcGF0aCBpbiBzZXR0aW5ncy5cIik7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBVc2UgY3VzdG9tIHBhdGggcmVsYXRpdmUgdG8gdmF1bHRcclxuXHRcdGNvbnN0IGNvbmZpZ1BhdGggPSBwYXRoLnJlc29sdmUodmF1bHRQYXRoU3RyaW5nLCBzZXR0aW5ncy5jb25maWdGaWxlUGF0aCk7XHJcblxyXG5cdFx0Ly8gQ2hlY2sgaWYgZmlsZSBleGlzdHNcclxuXHRcdGlmICghZnMuZXhpc3RzU3luYyhjb25maWdQYXRoKSkge1xyXG5cdFx0XHRuZXcgTm90aWNlKGBDb25maWcgZmlsZSBub3QgZm91bmQgYXQ6ICR7Y29uZmlnUGF0aH1gKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFVzZSBFbGVjdHJvbidzIHNoZWxsIHRvIG9wZW4gdGhlIGZpbGUgd2l0aCB0aGUgZGVmYXVsdCBlZGl0b3JcclxuXHRcdGF3YWl0IHNoZWxsLm9wZW5QYXRoKGNvbmZpZ1BhdGgpO1xyXG5cdH0gY2F0Y2ggKGVycm9yKSB7XHJcblx0XHRuZXcgTm90aWNlKGBFcnJvciBvcGVuaW5nIGNvbmZpZyBmaWxlOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKX1gKTtcclxuXHR9XHJcbn0iLCAiaW1wb3J0IHsgQXBwLCBURmlsZSwgVEZvbGRlciwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MsIEZpbGVDcmVhdGlvbk9wdGlvbnMsIFJlbmFtZU9wdGlvbnMsIENvbnRlbnRUeXBlLCBDb250ZW50VHlwZUlkLCBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlIH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5pbXBvcnQgeyBtYXRjaGVzRm9sZGVyUGF0dGVybiwgc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5IH0gZnJvbSBcIi4vcGF0aC1tYXRjaGluZ1wiO1xuaW1wb3J0IHsgdG9LZWJhYkNhc2UgfSBmcm9tIFwiLi9zdHJpbmctdXRpbHNcIjtcblxuZXhwb3J0IGNsYXNzIEZpbGVPcGVyYXRpb25zIHtcblx0Y29uc3RydWN0b3IocHJpdmF0ZSBhcHA6IEFwcCwgcHJpdmF0ZSBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzLCBwcml2YXRlIHBsdWdpbj86IEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UpIHsgfVxuXG5cdC8vIEdldCBmcmVzaCBzZXR0aW5ncyBmcm9tIHBsdWdpbiBpZiBhdmFpbGFibGUsIG90aGVyd2lzZSB1c2Ugc3RvcmVkIHNldHRpbmdzXG5cdHByaXZhdGUgZ2V0U2V0dGluZ3MoKTogQXN0cm9Db21wb3NlclNldHRpbmdzIHtcblx0XHQvLyBBbHdheXMgcHJlZmVyIHBsdWdpbiBzZXR0aW5ncyAodGhleSdyZSBrZXB0IHVwIHRvIGRhdGUpXG5cdFx0aWYgKHRoaXMucGx1Z2luPy5zZXR0aW5ncykge1xuXHRcdFx0cmV0dXJuIHRoaXMucGx1Z2luLnNldHRpbmdzO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5zZXR0aW5ncztcblx0fVxuXG5cdGdlbmVyYXRlRmlsZW5hbWUodGl0bGU6IHN0cmluZywgZW5hYmxlVW5kZXJzY29yZVByZWZpeDogYm9vbGVhbiA9IGZhbHNlKTogc3RyaW5nIHtcblx0XHRjb25zdCBrZWJhYlRpdGxlID0gdG9LZWJhYkNhc2UodGl0bGUpO1xuXHRcdC8vIElmIGtlYmFiIGNhc2UgcmVzdWx0cyBpbiBlbXB0eSBzdHJpbmcsIHVzZSBhIGZhbGxiYWNrXG5cdFx0Y29uc3Qgc2FmZUtlYmFiVGl0bGUgPSBrZWJhYlRpdGxlIHx8IFwidW50aXRsZWRcIjtcblx0XHRjb25zdCBwcmVmaXggPSBlbmFibGVVbmRlcnNjb3JlUHJlZml4ID8gXCJfXCIgOiBcIlwiO1xuXHRcdHJldHVybiBgJHtwcmVmaXh9JHtzYWZlS2ViYWJUaXRsZX1gO1xuXHR9XG5cblx0ZGV0ZXJtaW5lVHlwZShmaWxlOiBURmlsZSk6IENvbnRlbnRUeXBlSWQge1xuXHRcdGNvbnN0IGZpbGVQYXRoID0gZmlsZS5wYXRoO1xuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5nZXRTZXR0aW5ncygpO1xuXG5cdFx0Ly8gQ2hlY2sgYWxsIGNvbnRlbnQgdHlwZXMsIHNvcnRlZCBieSBwYXR0ZXJuIHNwZWNpZmljaXR5IChtb3JlIHNwZWNpZmljIGZpcnN0KVxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcblx0XHRjb25zdCBzb3J0ZWRUeXBlcyA9IHNvcnRCeVBhdHRlcm5TcGVjaWZpY2l0eShjb250ZW50VHlwZXMpO1xuXG5cdFx0Zm9yIChjb25zdCBjb250ZW50VHlwZSBvZiBzb3J0ZWRUeXBlcykge1xuXHRcdFx0aWYgKCFjb250ZW50VHlwZS5lbmFibGVkKSBjb250aW51ZTtcblxuXHRcdFx0Ly8gSGFuZGxlIGJsYW5rIGZvbGRlciAocm9vdCkgLSBtYXRjaGVzIGZpbGVzIGluIHZhdWx0IHJvb3Qgb25seVxuXHRcdFx0aWYgKCFjb250ZW50VHlwZS5mb2xkZXIgfHwgY29udGVudFR5cGUuZm9sZGVyLnRyaW0oKSA9PT0gXCJcIikge1xuXHRcdFx0XHRpZiAoIWZpbGVQYXRoLmluY2x1ZGVzKFwiL1wiKSB8fCBmaWxlUGF0aC5zcGxpdChcIi9cIikubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGNvbnRlbnRUeXBlLmlkO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKG1hdGNoZXNGb2xkZXJQYXR0ZXJuKGZpbGVQYXRoLCBjb250ZW50VHlwZS5mb2xkZXIpKSB7XG5cdFx0XHRcdC8vIENoZWNrIGlnbm9yZVN1YmZvbGRlcnMgaWYgZm9sZGVyIGlzIHNwZWNpZmllZFxuXHRcdFx0XHRpZiAoY29udGVudFR5cGUuaWdub3JlU3ViZm9sZGVycykge1xuXHRcdFx0XHRcdGNvbnN0IHBhdGhTZWdtZW50cyA9IGZpbGVQYXRoLnNwbGl0KFwiL1wiKTtcblx0XHRcdFx0XHRjb25zdCBwYXRoRGVwdGggPSBwYXRoU2VnbWVudHMubGVuZ3RoO1xuXHRcdFx0XHRcdGNvbnN0IHBhdHRlcm5TZWdtZW50cyA9IGNvbnRlbnRUeXBlLmZvbGRlci5zcGxpdChcIi9cIik7XG5cdFx0XHRcdFx0Y29uc3QgZXhwZWN0ZWREZXB0aCA9IHBhdHRlcm5TZWdtZW50cy5sZW5ndGg7XG5cblx0XHRcdFx0XHRpZiAoY29udGVudFR5cGUuY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKSB7XG5cdFx0XHRcdFx0XHQvLyBGb3IgZm9sZGVyLWJhc2VkIGNyZWF0aW9uLCBmaWxlcyBhcmUgb25lIGxldmVsIGRlZXBlciAoZS5nLiwgdGVzdC9teS1maWxlL2luZGV4Lm1kKVxuXHRcdFx0XHRcdFx0Ly8gU28gd2UgbmVlZCB0byBhbGxvdyBvbmUgZXh0cmEgbGV2ZWwgYmV5b25kIHRoZSBwYXR0ZXJuIGRlcHRoXG5cdFx0XHRcdFx0XHRjb25zdCBmb2xkZXJEZXB0aCA9IHBhdGhEZXB0aCAtIDE7IC8vIFN1YnRyYWN0IDEgZm9yIHRoZSBpbmRleC5tZCBmaWxlXG5cdFx0XHRcdFx0XHRpZiAoZm9sZGVyRGVwdGggPT09IGV4cGVjdGVkRGVwdGggfHwgZm9sZGVyRGVwdGggPT09IGV4cGVjdGVkRGVwdGggKyAxKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBjb250ZW50VHlwZS5pZDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Ly8gRm9yIGZpbGUtYmFzZWQgY3JlYXRpb24sIGZpbGVzIGFyZSBhdCB0aGUgc2FtZSBkZXB0aCBhcyB0aGUgcGF0dGVyblxuXHRcdFx0XHRcdFx0aWYgKHBhdGhEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gY29udGVudFR5cGUuaWQ7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJldHVybiBjb250ZW50VHlwZS5pZDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIElmIG5vIGNvbnRlbnQgdHlwZSBtYXRjaGVzLCByZXR1cm4gXCJub3RlXCIgYXMgZmFsbGJhY2tcblx0XHRyZXR1cm4gXCJub3RlXCI7XG5cdH1cblxuXHRnZXRDb250ZW50VHlwZSh0eXBlSWQ6IENvbnRlbnRUeXBlSWQpOiBDb250ZW50VHlwZSB8IG51bGwge1xuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5nZXRTZXR0aW5ncygpO1xuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcblx0XHRyZXR1cm4gY29udGVudFR5cGVzLmZpbmQoY3QgPT4gY3QuaWQgPT09IHR5cGVJZCkgfHwgbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBIZWxwZXIgdG8gZ2V0IGNvbnRlbnQgdHlwZSBmb3IgYSBnaXZlbiBmaWxlIHBhdGhcblx0ICovXG5cdGdldENvbnRlbnRUeXBlQnlQYXRoKGZpbGVQYXRoOiBzdHJpbmcpOiBDb250ZW50VHlwZSB8IG51bGwge1xuXHRcdC8vIENyZWF0ZSBhIGR1bW15IFRGaWxlIGZvciBkZXRlcm1pbmVUeXBlXG5cdFx0Y29uc3QgZHVtbXlGaWxlID0geyBwYXRoOiBmaWxlUGF0aCB9IGFzIFRGaWxlO1xuXHRcdGNvbnN0IHR5cGVJZCA9IHRoaXMuZGV0ZXJtaW5lVHlwZShkdW1teUZpbGUpO1xuXHRcdGlmICh0eXBlSWQgPT09IFwibm90ZVwiKSByZXR1cm4gbnVsbDtcblx0XHRyZXR1cm4gdGhpcy5nZXRDb250ZW50VHlwZSh0eXBlSWQpO1xuXHR9XG5cblx0Z2V0VGl0bGVLZXkodHlwZTogQ29udGVudFR5cGVJZCk6IHN0cmluZyB7XG5cdFx0Ly8gRm9yIGdlbmVyaWMgbm90ZXMsIGFsd2F5cyB1c2UgXCJ0aXRsZVwiXG5cdFx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSByZXR1cm4gXCJ0aXRsZVwiO1xuXG5cdFx0Y29uc3QgY29udGVudFR5cGUgPSB0aGlzLmdldENvbnRlbnRUeXBlKHR5cGUpO1xuXHRcdGlmICghY29udGVudFR5cGUpIHJldHVybiBcInRpdGxlXCI7XG5cblx0XHRjb25zdCB0ZW1wbGF0ZSA9IGNvbnRlbnRUeXBlLnRlbXBsYXRlO1xuXHRcdGNvbnN0IGxpbmVzID0gdGVtcGxhdGUuc3BsaXQoXCJcXG5cIik7XG5cdFx0bGV0IGluUHJvcGVydGllcyA9IGZhbHNlO1xuXHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuXHRcdFx0Y29uc3QgdHJpbW1lZCA9IGxpbmUudHJpbSgpO1xuXHRcdFx0aWYgKHRyaW1tZWQgPT09IFwiLS0tXCIpIHtcblx0XHRcdFx0aW5Qcm9wZXJ0aWVzID0gIWluUHJvcGVydGllcztcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cdFx0XHRpZiAoaW5Qcm9wZXJ0aWVzKSB7XG5cdFx0XHRcdGNvbnN0IG1hdGNoID0gdHJpbW1lZC5tYXRjaCgvXihcXHcrKTpcXHMqKC4rKSQvKTtcblx0XHRcdFx0aWYgKG1hdGNoKSB7XG5cdFx0XHRcdFx0Y29uc3Qga2V5ID0gbWF0Y2hbMV07XG5cdFx0XHRcdFx0Y29uc3QgdmFsdWUgPSBtYXRjaFsyXTtcblx0XHRcdFx0XHRpZiAodmFsdWUuaW5jbHVkZXMoXCJ7e3RpdGxlfX1cIikpIHtcblx0XHRcdFx0XHRcdHJldHVybiBrZXk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBcInRpdGxlXCI7XG5cdH1cblxuXHRhc3luYyBjcmVhdGVGaWxlKG9wdGlvbnM6IEZpbGVDcmVhdGlvbk9wdGlvbnMpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuXHRcdGNvbnN0IHsgZmlsZSwgdGl0bGUsIHR5cGUgfSA9IG9wdGlvbnM7XG5cblx0XHRpZiAoIXRpdGxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBUaXRsZSBpcyByZXF1aXJlZCB0byBjcmVhdGUgYSAke3R5cGV9LmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Ly8gR2V0IGNvbnRlbnQgdHlwZSBzZXR0aW5nc1xuXHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gdGhpcy5nZXRDb250ZW50VHlwZSh0eXBlKTtcblx0XHRpZiAoIWNvbnRlbnRUeXBlICYmIHR5cGUgIT09IFwibm90ZVwiKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBDb250ZW50IHR5cGUgJHt0eXBlfSBub3QgZm91bmQuYCk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHRjb25zdCBrZWJhYlRpdGxlID0gdG9LZWJhYkNhc2UodGl0bGUpO1xuXHRcdGNvbnN0IGVuYWJsZVVuZGVyc2NvcmVQcmVmaXggPSBjb250ZW50VHlwZT8uZW5hYmxlVW5kZXJzY29yZVByZWZpeCB8fCBmYWxzZTtcblx0XHRjb25zdCBwcmVmaXggPSBlbmFibGVVbmRlcnNjb3JlUHJlZml4ID8gXCJfXCIgOiBcIlwiO1xuXG5cdFx0bGV0IHRhcmdldEZvbGRlciA9IFwiXCI7XG5cdFx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSB7XG5cdFx0XHQvLyBGb3IgZ2VuZXJpYyBub3Rlcywga2VlcCB0aGVtIGluIHRoZWlyIGN1cnJlbnQgbG9jYXRpb25cblx0XHRcdHRhcmdldEZvbGRlciA9IFwiXCI7XG5cdFx0fSBlbHNlIGlmIChjb250ZW50VHlwZSkge1xuXHRcdFx0Ly8gR2V0IHRoZSBkaXJlY3Rvcnkgd2hlcmUgdGhlIHVzZXIgY3JlYXRlZCB0aGUgZmlsZVxuXHRcdFx0Y29uc3Qgb3JpZ2luYWxEaXIgPSBmaWxlLnBhcmVudD8ucGF0aCB8fCBcIlwiO1xuXG5cdFx0XHQvLyBSZXNwZWN0IHRoZSB1c2VyJ3MgY2hvc2VuIGxvY2F0aW9uIChzdWJmb2xkZXIpXG5cdFx0XHQvLyBPbmx5IHVzZSB0aGUgY29uZmlndXJlZCBmb2xkZXIgaWYgdGhlIHVzZXIgY3JlYXRlZCB0aGUgZmlsZSBpbiB0aGUgdmF1bHQgcm9vdFxuXHRcdFx0aWYgKG9yaWdpbmFsRGlyID09PSBcIlwiIHx8IG9yaWdpbmFsRGlyID09PSBcIi9cIikge1xuXHRcdFx0XHR0YXJnZXRGb2xkZXIgPSBjb250ZW50VHlwZS5mb2xkZXIgfHwgXCJcIjtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRhcmdldEZvbGRlciA9IG9yaWdpbmFsRGlyO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmICh0YXJnZXRGb2xkZXIpIHtcblx0XHRcdGNvbnN0IGZvbGRlciA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh0YXJnZXRGb2xkZXIpO1xuXHRcdFx0aWYgKCEoZm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlRm9sZGVyKHRhcmdldEZvbGRlcik7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Y29uc3QgY3JlYXRpb25Nb2RlID0gY29udGVudFR5cGU/LmNyZWF0aW9uTW9kZSB8fCBcImZpbGVcIjtcblx0XHRpZiAoY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jcmVhdGVGb2xkZXJTdHJ1Y3R1cmUoZmlsZSwga2ViYWJUaXRsZSwgcHJlZml4LCB0YXJnZXRGb2xkZXIsIHR5cGUsIGNvbnRlbnRUeXBlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlRmlsZVN0cnVjdHVyZShmaWxlLCBrZWJhYlRpdGxlLCBwcmVmaXgsIHRhcmdldEZvbGRlciwgY29udGVudFR5cGUpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgY3JlYXRlRm9sZGVyU3RydWN0dXJlKGZpbGU6IFRGaWxlLCBrZWJhYlRpdGxlOiBzdHJpbmcsIHByZWZpeDogc3RyaW5nLCB0YXJnZXRGb2xkZXI6IHN0cmluZywgdHlwZTogQ29udGVudFR5cGVJZCwgY29udGVudFR5cGU6IENvbnRlbnRUeXBlIHwgbnVsbCk6IFByb21pc2U8VEZpbGUgfCBudWxsPiB7XG5cdFx0Y29uc3QgZm9sZGVyTmFtZSA9IGAke3ByZWZpeH0ke2tlYmFiVGl0bGV9YDtcblx0XHRsZXQgZm9sZGVyUGF0aDogc3RyaW5nO1xuXG5cdFx0aWYgKHRhcmdldEZvbGRlcikge1xuXHRcdFx0Ly8gTW92ZSB0byB0YXJnZXQgZm9sZGVyXG5cdFx0XHRmb2xkZXJQYXRoID0gYCR7dGFyZ2V0Rm9sZGVyfS8ke2ZvbGRlck5hbWV9YDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gS2VlcCBpbiBjdXJyZW50IGxvY2F0aW9uXG5cdFx0XHRjb25zdCBjdXJyZW50RGlyID0gZmlsZS5wYXJlbnQgPyBmaWxlLnBhcmVudC5wYXRoIDogXCJcIjtcblx0XHRcdGlmIChjdXJyZW50RGlyICYmIGN1cnJlbnREaXIgIT09IFwiL1wiKSB7XG5cdFx0XHRcdGZvbGRlclBhdGggPSBgJHtjdXJyZW50RGlyfS8ke2ZvbGRlck5hbWV9YDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZpbGUgaXMgaW4gdmF1bHQgcm9vdCwganVzdCB1c2UgZm9sZGVyIG5hbWVcblx0XHRcdFx0Zm9sZGVyUGF0aCA9IGZvbGRlck5hbWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGZvbGRlciA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmb2xkZXJQYXRoKTtcblx0XHRcdGlmICghKGZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcihmb2xkZXJQYXRoKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIHtcblx0XHRcdC8vIEZvbGRlciBtaWdodCBhbHJlYWR5IGV4aXN0LCBwcm9jZWVkXG5cdFx0fVxuXG5cdFx0Y29uc3QgaW5kZXhGaWxlTmFtZSA9IGNvbnRlbnRUeXBlPy5pbmRleEZpbGVOYW1lIHx8IFwiaW5kZXhcIjtcblx0XHRjb25zdCBleHRlbnNpb24gPSBjb250ZW50VHlwZT8udXNlTWR4RXh0ZW5zaW9uID8gXCIubWR4XCIgOiBcIi5tZFwiO1xuXHRcdGNvbnN0IGZpbGVOYW1lID0gYCR7aW5kZXhGaWxlTmFtZX0ke2V4dGVuc2lvbn1gO1xuXHRcdGNvbnN0IG5ld1BhdGggPSBgJHtmb2xkZXJQYXRofS8ke2ZpbGVOYW1lfWA7XG5cblx0XHRjb25zdCBleGlzdGluZ0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmV3UGF0aCk7XG5cdFx0aWYgKGV4aXN0aW5nRmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBGaWxlIGFscmVhZHkgZXhpc3RzIGF0ICR7bmV3UGF0aH0uYCk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHQvLyBUcmFjayB0aGF0IHRoaXMgZmlsZSB3aWxsIGJlIGNyZWF0ZWQgYnkgdGhlIHBsdWdpbiBCRUZPUkUgcmVuYW1pbmdcblx0XHQvLyBUaGlzIHByZXZlbnRzIHRoZSBjcmVhdGUgZXZlbnQgZnJvbSB0cmlnZ2VyaW5nIGFub3RoZXIgbW9kYWxcblx0XHRpZiAodGhpcy5wbHVnaW4pIHtcblx0XHRcdHRoaXMucGx1Z2luLnBsdWdpbkNyZWF0ZWRGaWxlcy5zZXQobmV3UGF0aCwgRGF0ZS5ub3coKSk7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoZmlsZSwgbmV3UGF0aCk7XG5cdFx0XHRjb25zdCBuZXdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld1BhdGgpO1xuXHRcdFx0aWYgKCEobmV3RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGZpbGVFeHBsb3JlciA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoXCJmaWxlLWV4cGxvcmVyXCIpWzBdO1xuXHRcdFx0XHRpZiAoZmlsZUV4cGxvcmVyICYmIGZpbGVFeHBsb3Jlci52aWV3KSB7XG5cdFx0XHRcdFx0Y29uc3QgdmlldyA9IGZpbGVFeHBsb3Jlci52aWV3O1xuXHRcdFx0XHRcdGlmICh2aWV3ICYmIHR5cGVvZiB2aWV3ID09PSAnb2JqZWN0JyAmJiAndHJlZScgaW4gdmlldykge1xuXHRcdFx0XHRcdFx0Y29uc3QgZmlsZVRyZWUgPSAodmlldyBhcyB7IHRyZWU/OiB7IHJldmVhbEZpbGU/OiAoZmlsZTogVEZpbGUpID0+IHZvaWQgfSB9KS50cmVlO1xuXHRcdFx0XHRcdFx0aWYgKGZpbGVUcmVlICYmIG5ld0ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiB0eXBlb2YgZmlsZVRyZWUucmV2ZWFsRmlsZSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0XHRcdFx0XHRmaWxlVHJlZS5yZXZlYWxGaWxlKG5ld0ZpbGUpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSwgMjAwKTtcblxuXHRcdFx0Y29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKGZhbHNlKTtcblx0XHRcdGF3YWl0IGxlYWYub3BlbkZpbGUobmV3RmlsZSk7XG5cblx0XHRcdC8vIFBvc2l0aW9uIGN1cnNvciBhdCB0aGUgZW5kIG9mIGNvbnRlbnQgYWZ0ZXIgZWRpdG9yIGlzIHJlYWR5XG5cdFx0XHRjb25zdCBwb3NpdGlvbkN1cnNvciA9ICgpID0+IHtcblx0XHRcdFx0Y29uc3QgdmlldyA9IGxlYWYudmlldztcblx0XHRcdFx0aWYgKHZpZXcgJiYgJ2VkaXRvcicgaW4gdmlldykge1xuXHRcdFx0XHRcdGNvbnN0IGVkaXRvciA9ICh2aWV3IGFzIHsgZWRpdG9yPzogeyBzZXRDdXJzb3I6IChwb3M6IHsgbGluZTogbnVtYmVyOyBjaDogbnVtYmVyIH0pID0+IHZvaWQ7IGdldFZhbHVlOiAoKSA9PiBzdHJpbmc7IGZvY3VzOiAoKSA9PiB2b2lkIH0gfSkuZWRpdG9yO1xuXHRcdFx0XHRcdGlmIChlZGl0b3IpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcblx0XHRcdFx0XHRcdGlmIChjb250ZW50KSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGxhc3RMaW5lID0gbGluZXMubGVuZ3RoIC0gMTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgbGFzdExpbmVMZW5ndGggPSBsaW5lc1tsYXN0TGluZV0/Lmxlbmd0aCB8fCAwO1xuXHRcdFx0XHRcdFx0XHRlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogbGFzdExpbmUsIGNoOiBsYXN0TGluZUxlbmd0aCB9KTtcblx0XHRcdFx0XHRcdFx0ZWRpdG9yLmZvY3VzKCk7XG5cdFx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9O1xuXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0aWYgKCFwb3NpdGlvbkN1cnNvcigpKSB7XG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHRwb3NpdGlvbkN1cnNvcigpO1xuXHRcdFx0XHRcdH0sIDIwMCk7XG5cdFx0XHRcdH1cblx0XHRcdH0sIDEwMCk7XG5cblx0XHRcdHJldHVybiBuZXdGaWxlO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XG5cdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gY3JlYXRlIGZvbGRlciBzdHJ1Y3R1cmU6ICR7ZXJyb3JNZXNzYWdlfS5gKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgY3JlYXRlRmlsZVN0cnVjdHVyZShmaWxlOiBURmlsZSwga2ViYWJUaXRsZTogc3RyaW5nLCBwcmVmaXg6IHN0cmluZywgdGFyZ2V0Rm9sZGVyOiBzdHJpbmcsIGNvbnRlbnRUeXBlOiBDb250ZW50VHlwZSB8IG51bGwpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuXHRcdGNvbnN0IGV4dGVuc2lvbiA9IGNvbnRlbnRUeXBlPy51c2VNZHhFeHRlbnNpb24gPyBcIi5tZHhcIiA6IFwiLm1kXCI7XG5cdFx0Y29uc3QgbmV3TmFtZSA9IGAke3ByZWZpeH0ke2tlYmFiVGl0bGV9JHtleHRlbnNpb259YDtcblx0XHRsZXQgbmV3UGF0aDogc3RyaW5nO1xuXG5cdFx0aWYgKHRhcmdldEZvbGRlcikge1xuXHRcdFx0Ly8gTW92ZSB0byB0YXJnZXQgZm9sZGVyXG5cdFx0XHRuZXdQYXRoID0gYCR7dGFyZ2V0Rm9sZGVyfS8ke25ld05hbWV9YDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gS2VlcCBpbiBjdXJyZW50IGxvY2F0aW9uLCBqdXN0IHJlbmFtZSB0aGUgZmlsZVxuXHRcdFx0Y29uc3QgY3VycmVudERpciA9IGZpbGUucGFyZW50ID8gZmlsZS5wYXJlbnQucGF0aCA6IFwiXCI7XG5cdFx0XHRpZiAoY3VycmVudERpciAmJiBjdXJyZW50RGlyICE9PSBcIi9cIikge1xuXHRcdFx0XHRuZXdQYXRoID0gYCR7Y3VycmVudERpcn0vJHtuZXdOYW1lfWA7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBGaWxlIGlzIGluIHZhdWx0IHJvb3QsIGp1c3QgdXNlIG5ldyBuYW1lXG5cdFx0XHRcdG5ld1BhdGggPSBuZXdOYW1lO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGNvbnN0IGV4aXN0aW5nRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdQYXRoKTtcblx0XHRpZiAoZXhpc3RpbmdGaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZXhpc3RpbmdGaWxlICE9PSBmaWxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBGaWxlIHdpdGggbmFtZSBcIiR7bmV3TmFtZX1cIiBhbHJlYWR5IGV4aXN0cy5gKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblxuXHRcdC8vIFRyYWNrIHRoYXQgdGhpcyBmaWxlIHdpbGwgYmUgY3JlYXRlZCBieSB0aGUgcGx1Z2luIEJFRk9SRSByZW5hbWluZ1xuXHRcdC8vIFRoaXMgcHJldmVudHMgdGhlIGNyZWF0ZSBldmVudCBmcm9tIHRyaWdnZXJpbmcgYW5vdGhlciBtb2RhbFxuXHRcdGlmICh0aGlzLnBsdWdpbikge1xuXHRcdFx0dGhpcy5wbHVnaW4ucGx1Z2luQ3JlYXRlZEZpbGVzLnNldChuZXdQYXRoLCBEYXRlLm5vdygpKTtcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0Ly8gVXNlIGZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoKSB3aGljaCByZXNwZWN0cyB1c2VyIHNldHRpbmdzIGFuZCBoYW5kbGVzIGFsbCBsaW5rIGZvcm1hdHNcblx0XHRcdGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoZmlsZSwgbmV3UGF0aCk7XG5cblx0XHRcdGNvbnN0IG5ld0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmV3UGF0aCk7XG5cdFx0XHRpZiAoIShuZXdGaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJGYWlsZWQgdG8gbG9jYXRlIHJlbmFtZWQgZmlsZS5cIik7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoZmFsc2UpO1xuXHRcdFx0YXdhaXQgbGVhZi5vcGVuRmlsZShuZXdGaWxlKTtcblxuXHRcdFx0Ly8gUG9zaXRpb24gY3Vyc29yIGF0IHRoZSBlbmQgb2YgY29udGVudCBhZnRlciBlZGl0b3IgaXMgcmVhZHlcblx0XHRcdGNvbnN0IHBvc2l0aW9uQ3Vyc29yID0gKCkgPT4ge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gbGVhZi52aWV3O1xuXHRcdFx0XHRpZiAodmlldyAmJiAnZWRpdG9yJyBpbiB2aWV3KSB7XG5cdFx0XHRcdFx0Y29uc3QgZWRpdG9yID0gKHZpZXcgYXMgeyBlZGl0b3I/OiB7IHNldEN1cnNvcjogKHBvczogeyBsaW5lOiBudW1iZXI7IGNoOiBudW1iZXIgfSkgPT4gdm9pZDsgZ2V0VmFsdWU6ICgpID0+IHN0cmluZzsgZm9jdXM6ICgpID0+IHZvaWQgfSB9KS5lZGl0b3I7XG5cdFx0XHRcdFx0aWYgKGVkaXRvcikge1xuXHRcdFx0XHRcdFx0Y29uc3QgY29udGVudCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xuXHRcdFx0XHRcdFx0aWYgKGNvbnRlbnQpIHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgbGFzdExpbmUgPSBsaW5lcy5sZW5ndGggLSAxO1xuXHRcdFx0XHRcdFx0XHRjb25zdCBsYXN0TGluZUxlbmd0aCA9IGxpbmVzW2xhc3RMaW5lXT8ubGVuZ3RoIHx8IDA7XG5cdFx0XHRcdFx0XHRcdGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiBsYXN0TGluZSwgY2g6IGxhc3RMaW5lTGVuZ3RoIH0pO1xuXHRcdFx0XHRcdFx0XHRlZGl0b3IuZm9jdXMoKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH07XG5cblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRpZiAoIXBvc2l0aW9uQ3Vyc29yKCkpIHtcblx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRcdHBvc2l0aW9uQ3Vyc29yKCk7XG5cdFx0XHRcdFx0fSwgMjAwKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgMTAwKTtcblxuXHRcdFx0cmV0dXJuIG5ld0ZpbGU7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKTtcblx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byByZW5hbWUgZmlsZTogJHtlcnJvck1lc3NhZ2V9LmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHR9XG5cblxuXHRhc3luYyByZW5hbWVGaWxlKG9wdGlvbnM6IFJlbmFtZU9wdGlvbnMpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuXHRcdGNvbnN0IHsgZmlsZSwgdGl0bGUsIHR5cGUgfSA9IG9wdGlvbnM7XG5cblx0XHRpZiAoIXRpdGxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBUaXRsZSBpcyByZXF1aXJlZCB0byByZW5hbWUgdGhlIGNvbnRlbnQuYCk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMuZ2V0Q29udGVudFR5cGUodHlwZSk7XG5cdFx0aWYgKCFjb250ZW50VHlwZSAmJiB0eXBlICE9PSBcIm5vdGVcIikge1xuXHRcdFx0bmV3IE5vdGljZShgQ29udGVudCB0eXBlICR7dHlwZX0gbm90IGZvdW5kLmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Y29uc3Qga2ViYWJUaXRsZSA9IHRvS2ViYWJDYXNlKHRpdGxlKTtcblx0XHRjb25zdCBwcmVmaXggPSBcIlwiO1xuXG5cdFx0Y29uc3QgY3JlYXRpb25Nb2RlID0gY29udGVudFR5cGU/LmNyZWF0aW9uTW9kZSB8fCBcImZpbGVcIjtcblx0XHRpZiAoY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5yZW5hbWVGb2xkZXJTdHJ1Y3R1cmUoZmlsZSwga2ViYWJUaXRsZSwgcHJlZml4LCB0eXBlLCBjb250ZW50VHlwZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiB0aGlzLnJlbmFtZUZpbGVTdHJ1Y3R1cmUoZmlsZSwga2ViYWJUaXRsZSwgcHJlZml4LCBjb250ZW50VHlwZSk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyByZW5hbWVGb2xkZXJTdHJ1Y3R1cmUoZmlsZTogVEZpbGUsIGtlYmFiVGl0bGU6IHN0cmluZywgcHJlZml4OiBzdHJpbmcsIHR5cGU6IENvbnRlbnRUeXBlSWQsIGNvbnRlbnRUeXBlOiBDb250ZW50VHlwZSB8IG51bGwpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuXHRcdC8vIFNtYXJ0IGRldGVjdGlvbjogdHJlYXQgYXMgaW5kZXggaWYgZmlsZW5hbWUgbWF0Y2hlcyB0aGUgaW5kZXggZmlsZSBuYW1lXG5cdFx0Ly8gRGVmYXVsdCB0byBcImluZGV4XCIgd2hlbiBpbmRleEZpbGVOYW1lIGlzIGJsYW5rXG5cdFx0Y29uc3QgaW5kZXhGaWxlTmFtZSA9IGNvbnRlbnRUeXBlPy5pbmRleEZpbGVOYW1lIHx8IFwiaW5kZXhcIjtcblx0XHRjb25zdCBpc0luZGV4ID0gZmlsZS5iYXNlbmFtZSA9PT0gaW5kZXhGaWxlTmFtZTtcblx0XHRpZiAoaXNJbmRleCkge1xuXHRcdFx0aWYgKCFmaWxlLnBhcmVudCkge1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiQ2Fubm90IHJlbmFtZTogZmlsZSBoYXMgbm8gcGFyZW50IGZvbGRlci5cIik7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXHRcdFx0cHJlZml4ID0gZmlsZS5wYXJlbnQubmFtZS5zdGFydHNXaXRoKFwiX1wiKSA/IFwiX1wiIDogXCJcIjtcblx0XHRcdGNvbnN0IG5ld0ZvbGRlck5hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfWA7XG5cdFx0XHRjb25zdCBwYXJlbnRGb2xkZXIgPSBmaWxlLnBhcmVudC5wYXJlbnQ7XG5cdFx0XHRpZiAoIXBhcmVudEZvbGRlcikge1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiQ2Fubm90IHJlbmFtZTogcGFyZW50IGZvbGRlciBoYXMgbm8gcGFyZW50LlwiKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cdFx0XHQvLyBGaXggcGF0aCBjb25zdHJ1Y3Rpb24gdG8gYXZvaWQgZG91YmxlIHNsYXNoZXNcblx0XHRcdGxldCBuZXdGb2xkZXJQYXRoOiBzdHJpbmc7XG5cdFx0XHRpZiAocGFyZW50Rm9sZGVyLnBhdGggPT09IFwiXCIgfHwgcGFyZW50Rm9sZGVyLnBhdGggPT09IFwiL1wiKSB7XG5cdFx0XHRcdC8vIFBhcmVudCBpcyB2YXVsdCByb290XG5cdFx0XHRcdG5ld0ZvbGRlclBhdGggPSBuZXdGb2xkZXJOYW1lO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gUGFyZW50IGlzIGluIGEgc3ViZm9sZGVyXG5cdFx0XHRcdG5ld0ZvbGRlclBhdGggPSBgJHtwYXJlbnRGb2xkZXIucGF0aH0vJHtuZXdGb2xkZXJOYW1lfWA7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGV4aXN0aW5nRm9sZGVyID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld0ZvbGRlclBhdGgpO1xuXHRcdFx0aWYgKGV4aXN0aW5nRm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGb2xkZXIgYWxyZWFkeSBleGlzdHMgYXQgJHtuZXdGb2xkZXJQYXRofS5gKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoZmlsZS5wYXJlbnQsIG5ld0ZvbGRlclBhdGgpO1xuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0Y29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gcmVuYW1lIGZvbGRlcjogJHtlcnJvck1lc3NhZ2V9LmApO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgbmV3RmlsZVBhdGggPSBgJHtuZXdGb2xkZXJQYXRofS8ke2ZpbGUubmFtZX1gO1xuXHRcdFx0Y29uc3QgbmV3RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdGaWxlUGF0aCk7XG5cdFx0XHRpZiAoIShuZXdGaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJGYWlsZWQgdG8gbG9jYXRlIHJlbmFtZWQgZmlsZS5cIik7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cblx0XHRcdHJldHVybiBuZXdGaWxlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoIWZpbGUucGFyZW50KSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJDYW5ub3QgcmVuYW1lOiBmaWxlIGhhcyBubyBwYXJlbnQgZm9sZGVyLlwiKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cdFx0XHRwcmVmaXggPSBmaWxlLmJhc2VuYW1lLnN0YXJ0c1dpdGgoXCJfXCIpID8gXCJfXCIgOiBcIlwiO1xuXHRcdFx0Ly8gUHJlc2VydmUgdGhlIG9yaWdpbmFsIGZpbGUgZXh0ZW5zaW9uXG5cdFx0XHRjb25zdCBleHRlbnNpb24gPSBmaWxlLmV4dGVuc2lvbjtcblx0XHRcdGNvbnN0IG5ld05hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfS4ke2V4dGVuc2lvbn1gO1xuXHRcdFx0Y29uc3QgbmV3UGF0aCA9IGAke2ZpbGUucGFyZW50LnBhdGh9LyR7bmV3TmFtZX1gO1xuXG5cdFx0XHRjb25zdCBleGlzdGluZ0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmV3UGF0aCk7XG5cdFx0XHRpZiAoZXhpc3RpbmdGaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZXhpc3RpbmdGaWxlICE9PSBmaWxlKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZpbGUgYWxyZWFkeSBleGlzdHMgYXQgJHtuZXdQYXRofS5gKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFVzZSBmaWxlTWFuYWdlci5yZW5hbWVGaWxlKCkgd2hpY2ggYXV0b21hdGljYWxseSB1cGRhdGVzIGxpbmtzXG5cdFx0XHRhd2FpdCB0aGlzLmFwcC5maWxlTWFuYWdlci5yZW5hbWVGaWxlKGZpbGUsIG5ld1BhdGgpO1xuXHRcdFx0Y29uc3QgbmV3RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdQYXRoKTtcblx0XHRcdGlmICghKG5ld0ZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdFx0bmV3IE5vdGljZShcIkZhaWxlZCB0byBsb2NhdGUgcmVuYW1lZCBmaWxlLlwiKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblxuXHRcdFx0cmV0dXJuIG5ld0ZpbGU7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyByZW5hbWVGaWxlU3RydWN0dXJlKGZpbGU6IFRGaWxlLCBrZWJhYlRpdGxlOiBzdHJpbmcsIHByZWZpeDogc3RyaW5nLCBjb250ZW50VHlwZTogQ29udGVudFR5cGUgfCBudWxsKTogUHJvbWlzZTxURmlsZSB8IG51bGw+IHtcblx0XHRpZiAoIWZpbGUucGFyZW50KSB7XG5cdFx0XHRuZXcgTm90aWNlKFwiQ2Fubm90IHJlbmFtZTogZmlsZSBoYXMgbm8gcGFyZW50IGZvbGRlci5cIik7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHQvLyBDaGVjayBpZiB0aGlzIGlzIGFuIGluZGV4IGZpbGUgLSBpZiBzbywgcmVuYW1lIHRoZSBwYXJlbnQgZm9sZGVyIGluc3RlYWRcblx0XHQvLyBTbWFydCBkZXRlY3Rpb246IG9ubHkgdHJlYXQgYXMgaW5kZXggaWYgaW5kZXhGaWxlTmFtZSBpcyBzcGVjaWZpZWQgYW5kIG1hdGNoZXNcblx0XHRjb25zdCBpbmRleEZpbGVOYW1lID0gY29udGVudFR5cGU/LmluZGV4RmlsZU5hbWUgfHwgXCJcIjtcblx0XHRjb25zdCBpc0luZGV4ID0gaW5kZXhGaWxlTmFtZSAmJlxuXHRcdFx0aW5kZXhGaWxlTmFtZS50cmltKCkgIT09IFwiXCIgJiZcblx0XHRcdGZpbGUuYmFzZW5hbWUgPT09IGluZGV4RmlsZU5hbWU7XG5cblx0XHRpZiAoaXNJbmRleCkge1xuXHRcdFx0cHJlZml4ID0gZmlsZS5wYXJlbnQubmFtZS5zdGFydHNXaXRoKFwiX1wiKSA/IFwiX1wiIDogXCJcIjtcblx0XHRcdGNvbnN0IG5ld0ZvbGRlck5hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfWA7XG5cdFx0XHRjb25zdCBwYXJlbnRGb2xkZXIgPSBmaWxlLnBhcmVudC5wYXJlbnQ7XG5cdFx0XHRpZiAoIXBhcmVudEZvbGRlcikge1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiQ2Fubm90IHJlbmFtZTogcGFyZW50IGZvbGRlciBoYXMgbm8gcGFyZW50LlwiKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cdFx0XHQvLyBGaXggcGF0aCBjb25zdHJ1Y3Rpb24gdG8gYXZvaWQgZG91YmxlIHNsYXNoZXNcblx0XHRcdGxldCBuZXdGb2xkZXJQYXRoOiBzdHJpbmc7XG5cdFx0XHRpZiAocGFyZW50Rm9sZGVyLnBhdGggPT09IFwiXCIgfHwgcGFyZW50Rm9sZGVyLnBhdGggPT09IFwiL1wiKSB7XG5cdFx0XHRcdC8vIFBhcmVudCBpcyB2YXVsdCByb290XG5cdFx0XHRcdG5ld0ZvbGRlclBhdGggPSBuZXdGb2xkZXJOYW1lO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gUGFyZW50IGlzIGluIGEgc3ViZm9sZGVyXG5cdFx0XHRcdG5ld0ZvbGRlclBhdGggPSBgJHtwYXJlbnRGb2xkZXIucGF0aH0vJHtuZXdGb2xkZXJOYW1lfWA7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGV4aXN0aW5nRm9sZGVyID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld0ZvbGRlclBhdGgpO1xuXHRcdFx0aWYgKGV4aXN0aW5nRm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGb2xkZXIgYWxyZWFkeSBleGlzdHMgYXQgJHtuZXdGb2xkZXJQYXRofS5gKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENhbGN1bGF0ZSB0aGUgbmV3IGZpbGUgcGF0aCBiZWZvcmUgcmVuYW1pbmdcblx0XHRcdGNvbnN0IG5ld0ZpbGVQYXRoID0gYCR7bmV3Rm9sZGVyUGF0aH0vJHtmaWxlLm5hbWV9YDtcblxuXHRcdFx0Ly8gVHJhY2sgdGhhdCB0aGlzIGZpbGUgd2lsbCBiZSBjcmVhdGVkIGJ5IHRoZSBwbHVnaW4gQkVGT1JFIHJlbmFtaW5nXG5cdFx0XHQvLyBUaGlzIHByZXZlbnRzIHRoZSBjcmVhdGUgZXZlbnQgZnJvbSB0cmlnZ2VyaW5nIGFub3RoZXIgbW9kYWxcblx0XHRcdGlmICh0aGlzLnBsdWdpbikge1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5wbHVnaW5DcmVhdGVkRmlsZXMuc2V0KG5ld0ZpbGVQYXRoLCBEYXRlLm5vdygpKTtcblx0XHRcdH1cblxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0YXdhaXQgdGhpcy5hcHAuZmlsZU1hbmFnZXIucmVuYW1lRmlsZShmaWxlLnBhcmVudCwgbmV3Rm9sZGVyUGF0aCk7XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCdGaWxlT3BlcmF0aW9uczogRm9sZGVyIHJlbmFtZSBmYWlsZWQ6JywgZXJyb3IpO1xuXHRcdFx0XHRjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byByZW5hbWUgZm9sZGVyOiAke2Vycm9yTWVzc2FnZX0uYCk7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBuZXdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld0ZpbGVQYXRoKTtcblx0XHRcdGlmICghKG5ld0ZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdFx0bmV3IE5vdGljZShcIkZhaWxlZCB0byBsb2NhdGUgcmVuYW1lZCBmaWxlLlwiKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBuZXdGaWxlO1xuXHRcdH1cblxuXHRcdC8vIEZvciBub24taW5kZXggZmlsZXMsIHJlbmFtZSB0aGUgZmlsZSBpdHNlbGZcblx0XHRwcmVmaXggPSBmaWxlLmJhc2VuYW1lLnN0YXJ0c1dpdGgoXCJfXCIpID8gXCJfXCIgOiBcIlwiO1xuXHRcdC8vIFByZXNlcnZlIHRoZSBvcmlnaW5hbCBmaWxlIGV4dGVuc2lvblxuXHRcdGNvbnN0IGV4dGVuc2lvbiA9IGZpbGUuZXh0ZW5zaW9uO1xuXHRcdGNvbnN0IG5ld05hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfS4ke2V4dGVuc2lvbn1gO1xuXG5cdFx0Ly8gRml4IHBhdGggY29uc3RydWN0aW9uIHRvIGF2b2lkIGRvdWJsZSBzbGFzaGVzXG5cdFx0bGV0IG5ld1BhdGg6IHN0cmluZztcblx0XHRpZiAoZmlsZS5wYXJlbnQucGF0aCA9PT0gXCJcIiB8fCBmaWxlLnBhcmVudC5wYXRoID09PSBcIi9cIikge1xuXHRcdFx0Ly8gRmlsZSBpcyBpbiB2YXVsdCByb290XG5cdFx0XHRuZXdQYXRoID0gbmV3TmFtZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gRmlsZSBpcyBpbiBhIHN1YmZvbGRlclxuXHRcdFx0bmV3UGF0aCA9IGAke2ZpbGUucGFyZW50LnBhdGh9LyR7bmV3TmFtZX1gO1xuXHRcdH1cblxuXHRcdGNvbnN0IGV4aXN0aW5nRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdQYXRoKTtcblx0XHRpZiAoZXhpc3RpbmdGaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZXhpc3RpbmdGaWxlICE9PSBmaWxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBGaWxlIGFscmVhZHkgZXhpc3RzIGF0ICR7bmV3UGF0aH0uYCk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHQvLyBUcmFjayB0aGF0IHRoaXMgZmlsZSB3aWxsIGJlIGNyZWF0ZWQgYnkgdGhlIHBsdWdpbiBCRUZPUkUgcmVuYW1pbmdcblx0XHQvLyBUaGlzIHByZXZlbnRzIHRoZSBjcmVhdGUgZXZlbnQgZnJvbSB0cmlnZ2VyaW5nIGFub3RoZXIgbW9kYWxcblx0XHRpZiAodGhpcy5wbHVnaW4pIHtcblx0XHRcdHRoaXMucGx1Z2luLnBsdWdpbkNyZWF0ZWRGaWxlcy5zZXQobmV3UGF0aCwgRGF0ZS5ub3coKSk7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoZmlsZSwgbmV3UGF0aCk7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0ZpbGVPcGVyYXRpb25zOiBGaWxlIHJlbmFtZSBmYWlsZWQ6JywgZXJyb3IpO1xuXHRcdFx0Y29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xuXHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvIHJlbmFtZSBmaWxlOiAke2Vycm9yTWVzc2FnZX0uYCk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHRjb25zdCBuZXdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld1BhdGgpO1xuXHRcdGlmICghKG5ld0ZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdG5ldyBOb3RpY2UoXCJGYWlsZWQgdG8gbG9jYXRlIHJlbmFtZWQgZmlsZS5cIik7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHRyZXR1cm4gbmV3RmlsZTtcblx0fVxufVxuIiwgIi8qKlxyXG4gKiBVdGlsaXR5IGZ1bmN0aW9ucyBmb3IgbWF0Y2hpbmcgZmlsZSBwYXRocyBhZ2FpbnN0IGZvbGRlciBwYXR0ZXJucyB3aXRoIHdpbGRjYXJkIHN1cHBvcnQuXHJcbiAqIFxyXG4gKiBXaWxkY2FyZCBwYXR0ZXJuczpcclxuICogLSBgZG9jc2AgbWF0Y2hlcyBgZG9jcy9gIGFuZCBhbnl0aGluZyB1bmRlciBpdFxyXG4gKiAtIGBkb2NzL3thc3Rlcmlza31gIG1hdGNoZXMgYGRvY3MvYW55dGhpbmcvYCBhbmQgYW55dGhpbmcgdW5kZXIgaXQgKG9uZSBsZXZlbCBkZWVwKVxyXG4gKiAtIGBkb2NzL3thc3Rlcmlza30ve2FzdGVyaXNrfWAgbWF0Y2hlcyBgZG9jcy9hbnl0aGluZy9hbnl0aGluZy9gIGFuZCBhbnl0aGluZyB1bmRlciBpdCAodHdvIGxldmVscyBkZWVwKVxyXG4gKiAtIGV0Yy5cclxuICogXHJcbiAqIE5vdGU6IHthc3Rlcmlza30gcmVwcmVzZW50cyB0aGUgd2lsZGNhcmQgY2hhcmFjdGVyICpcclxuICovXHJcblxyXG4vKipcclxuICogQ2hlY2tzIGlmIGEgZmlsZSBwYXRoIG1hdGNoZXMgYSBmb2xkZXIgcGF0dGVybiAoc3VwcG9ydHMgd2lsZGNhcmRzKVxyXG4gKiBAcGFyYW0gZmlsZVBhdGggVGhlIGZpbGUgcGF0aCB0byBjaGVjayAoZS5nLiwgXCJkb2NzL2V4YW1wbGUtYS9nZXR0aW5nLXN0YXJ0ZWQubWRcIilcclxuICogQHBhcmFtIGZvbGRlclBhdHRlcm4gVGhlIGZvbGRlciBwYXR0ZXJuIC0gdXNlIGFzdGVyaXNrIGZvciB3aWxkY2FyZHMgKGUuZy4sIFwiZG9jc1wiLCBcImRvY3MvYXN0ZXJpc2tcIiwgXCJkb2NzL2FzdGVyaXNrL2FzdGVyaXNrXCIpXHJcbiAqIEByZXR1cm5zIHRydWUgaWYgdGhlIGZpbGUgcGF0aCBtYXRjaGVzIHRoZSBwYXR0ZXJuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbWF0Y2hlc0ZvbGRlclBhdHRlcm4oZmlsZVBhdGg6IHN0cmluZywgZm9sZGVyUGF0dGVybjogc3RyaW5nKTogYm9vbGVhbiB7XHJcblx0Ly8gTm9ybWFsaXplIGZvciBjYXNlLWluc2Vuc2l0aXZlIG1hdGNoaW5nXHJcblx0Y29uc3Qgbm9ybWFsaXplZEZpbGVQYXRoID0gZmlsZVBhdGgudG9Mb3dlckNhc2UoKTtcclxuXHRjb25zdCBub3JtYWxpemVkUGF0dGVybiA9IGZvbGRlclBhdHRlcm4udG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9eXFwvfFxcLyQvZywgXCJcIik7XHJcblxyXG5cdC8vIEhhbmRsZSBlbXB0eSBmb2xkZXIgcGF0dGVybiAocm9vdCBmb2xkZXIpIC0gbWF0Y2hlcyBmaWxlcyBpbiB2YXVsdCByb290IG9ubHlcclxuXHRpZiAoIW5vcm1hbGl6ZWRQYXR0ZXJuIHx8IG5vcm1hbGl6ZWRQYXR0ZXJuLnRyaW0oKSA9PT0gXCJcIikge1xyXG5cdFx0cmV0dXJuICFub3JtYWxpemVkRmlsZVBhdGguaW5jbHVkZXMoXCIvXCIpIHx8IChub3JtYWxpemVkRmlsZVBhdGguc3BsaXQoXCIvXCIpLmxlbmd0aCA9PT0gMSk7XHJcblx0fVxyXG5cclxuXHQvLyBJZiBwYXR0ZXJuIGRvZXNuJ3QgY29udGFpbiB3aWxkY2FyZHMsIHVzZSBzaW1wbGUgcHJlZml4IG1hdGNoaW5nXHJcblx0aWYgKCFub3JtYWxpemVkUGF0dGVybi5pbmNsdWRlcyhcIipcIikpIHtcclxuXHRcdHJldHVybiBub3JtYWxpemVkRmlsZVBhdGggPT09IG5vcm1hbGl6ZWRQYXR0ZXJuIHx8IG5vcm1hbGl6ZWRGaWxlUGF0aC5zdGFydHNXaXRoKG5vcm1hbGl6ZWRQYXR0ZXJuICsgXCIvXCIpO1xyXG5cdH1cclxuXHJcblx0Ly8gQ29udmVydCB3aWxkY2FyZCBwYXR0ZXJuIHRvIHJlZ2V4XHJcblx0Ly8gRXNjYXBlIHNwZWNpYWwgcmVnZXggY2hhcmFjdGVycyBleGNlcHQgKlxyXG5cdGNvbnN0IGVzY2FwZWRQYXR0ZXJuID0gbm9ybWFsaXplZFBhdHRlcm5cclxuXHRcdC5yZXBsYWNlKC9bLis/XiR7fSgpfFtcXF1cXFxcXS9nLCBcIlxcXFwkJlwiKVxyXG5cdFx0LnJlcGxhY2UoL1xcKi9nLCBcIlteL10rXCIpOyAvLyBXaWxkY2FyZCBtYXRjaGVzIGFueSBwYXRoIHNlZ21lbnQgKG5vbi1zbGFzaCBjaGFyYWN0ZXJzKVxyXG5cclxuXHQvLyBDcmVhdGUgcmVnZXggdGhhdCBtYXRjaGVzIHRoZSBwYXR0ZXJuIGFuZCBhbnl0aGluZyBhZnRlciBpdFxyXG5cdGNvbnN0IHJlZ2V4UGF0dGVybiA9IGBeJHtlc2NhcGVkUGF0dGVybn0oPzovfCQpYDtcclxuXHRjb25zdCByZWdleCA9IG5ldyBSZWdFeHAocmVnZXhQYXR0ZXJuKTtcclxuXHRyZXR1cm4gcmVnZXgudGVzdChub3JtYWxpemVkRmlsZVBhdGgpO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0cyB0aGUgZGVwdGggb2YgYSBmb2xkZXIgcGF0dGVybiAobnVtYmVyIG9mIHNlZ21lbnRzKVxyXG4gKiBVc2VkIGZvciBwcmlvcml0aXppbmcgbW9yZSBzcGVjaWZpYyBwYXR0ZXJuc1xyXG4gKiBCbGFuay9yb290IGZvbGRlciBoYXMgZGVwdGggMCAobGVhc3Qgc3BlY2lmaWMpXHJcbiAqIEBwYXJhbSBmb2xkZXJQYXR0ZXJuIFRoZSBmb2xkZXIgcGF0dGVyblxyXG4gKiBAcmV0dXJucyBUaGUgbnVtYmVyIG9mIHBhdGggc2VnbWVudHMgaW4gdGhlIHBhdHRlcm4gKDAgZm9yIHJvb3QvYmxhbmspXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGF0dGVybkRlcHRoKGZvbGRlclBhdHRlcm46IHN0cmluZyk6IG51bWJlciB7XHJcblx0aWYgKCFmb2xkZXJQYXR0ZXJuIHx8IGZvbGRlclBhdHRlcm4udHJpbSgpID09PSBcIlwiKSByZXR1cm4gMDtcclxuXHRyZXR1cm4gZm9sZGVyUGF0dGVybi5zcGxpdChcIi9cIikubGVuZ3RoO1xyXG59XHJcblxyXG4vKipcclxuICogU29ydHMgY29udGVudCB0eXBlcyBieSBwYXR0ZXJuIHNwZWNpZmljaXR5IChtb3JlIHNwZWNpZmljIHBhdHRlcm5zIGZpcnN0KVxyXG4gKiBUaGlzIGVuc3VyZXMgdGhhdCBtb3JlIHNwZWNpZmljIHBhdHRlcm5zIGFyZSBjaGVja2VkIGJlZm9yZSBsZXNzIHNwZWNpZmljIG9uZXNcclxuICogQmxhbmsvcm9vdCBmb2xkZXIgcGF0dGVybnMgKGRlcHRoIDApIGFyZSBzb3J0ZWQgbGFzdCAobGVhc3Qgc3BlY2lmaWMpXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5PFQgZXh0ZW5kcyB7IGZvbGRlcjogc3RyaW5nIH0+KHR5cGVzOiBUW10pOiBUW10ge1xyXG5cdHJldHVybiBbLi4udHlwZXNdLnNvcnQoKGEsIGIpID0+IHtcclxuXHRcdGNvbnN0IGRlcHRoQSA9IGdldFBhdHRlcm5EZXB0aChhLmZvbGRlcik7XHJcblx0XHRjb25zdCBkZXB0aEIgPSBnZXRQYXR0ZXJuRGVwdGgoYi5mb2xkZXIpO1xyXG5cdFx0Ly8gTW9yZSBzcGVjaWZpYyAoZGVlcGVyKSBwYXR0ZXJucyBmaXJzdFxyXG5cdFx0Ly8gQmxhbmsgcGF0dGVybnMgKGRlcHRoIDApIHdpbGwgYmUgc29ydGVkIGxhc3RcclxuXHRcdHJldHVybiBkZXB0aEIgLSBkZXB0aEE7XHJcblx0fSk7XHJcbn1cclxuXHJcbiIsICIvKipcclxuICogQ29udmVydHMgYSBzdHJpbmcgdG8ga2ViYWItY2FzZS5cclxuICogQHBhcmFtIHN0ciBUaGUgc3RyaW5nIHRvIGNvbnZlcnRcclxuICogQHJldHVybnMgS2ViYWItY2FzZSBzdHJpbmdcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB0b0tlYmFiQ2FzZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gc3RyXHJcbiAgICAgICAgLnJlcGxhY2UoLyhbYS16MC05XSkoW0EtWl0pL2csICckMS0kMicpXHJcbiAgICAgICAgLnJlcGxhY2UoLyhbQS1aXSkoW0EtWl1bYS16XSkvZywgJyQxLSQyJDMnKVxyXG4gICAgICAgIC50b0xvd2VyQ2FzZSgpXHJcbiAgICAgICAgLnJlcGxhY2UoL1teYS16MC05XFxzLV0vZywgXCJcIilcclxuICAgICAgICAudHJpbSgpXHJcbiAgICAgICAgLnJlcGxhY2UoL1xccysvZywgXCItXCIpXHJcbiAgICAgICAgLnJlcGxhY2UoLy0rL2csIFwiLVwiKVxyXG4gICAgICAgIC5yZXBsYWNlKC9eLXwtJC9nLCBcIlwiKTtcclxufVxyXG4iLCAiaW1wb3J0IHsgQXBwLCBURmlsZSwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IEFzdHJvQ29tcG9zZXJTZXR0aW5ncywgUGFyc2VkRnJvbnRtYXR0ZXIsIFRlbXBsYXRlVmFsdWVzLCBLTk9XTl9BUlJBWV9LRVlTLCBDb250ZW50VHlwZUlkIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgVGVtcGxhdGVQYXJzZXIge1xyXG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgYXBwOiBBcHAsIHByaXZhdGUgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncykge31cclxuXHJcblx0LyoqXHJcblx0ICogQ29udmVydCBhIHN0cmluZyB0byBrZWJhYi1jYXNlIGZvciBzbHVnIGdlbmVyYXRpb25cclxuXHQgKi9cclxuXHRwcml2YXRlIHRvS2ViYWJDYXNlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBzdHJcclxuXHRcdFx0LnRvTG93ZXJDYXNlKClcclxuXHRcdFx0LnJlcGxhY2UoL1teYS16MC05XFxzLV0vZywgXCJcIilcclxuXHRcdFx0LnRyaW0oKVxyXG5cdFx0XHQucmVwbGFjZSgvXFxzKy9nLCBcIi1cIilcclxuXHRcdFx0LnJlcGxhY2UoLy0rL2csIFwiLVwiKVxyXG5cdFx0XHQucmVwbGFjZSgvXi18LSQvZywgXCJcIik7XHJcblx0fVxyXG5cclxuXHRwYXJzZUZyb250bWF0dGVyKGNvbnRlbnQ6IHN0cmluZyk6IFBhcnNlZEZyb250bWF0dGVyIHtcclxuXHRcdGxldCBwcm9wZXJ0aWVzRW5kID0gMDtcclxuXHRcdGxldCBwcm9wZXJ0aWVzVGV4dCA9IFwiXCI7XHJcblx0XHRjb25zdCBleGlzdGluZ1Byb3BlcnRpZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHt9O1xyXG5cclxuXHRcdC8vIFBhcnNlIGV4aXN0aW5nIHByb3BlcnRpZXMgd2l0aCBmYWxsYmFjayBmb3IgbWlzc2luZyBzZWNvbmQgLS0tXHJcblx0XHRpZiAoY29udGVudC5zdGFydHNXaXRoKFwiLS0tXCIpKSB7XHJcblx0XHRcdHByb3BlcnRpZXNFbmQgPSBjb250ZW50LmluZGV4T2YoXCJcXG4tLS1cIiwgMyk7XHJcblx0XHRcdGlmIChwcm9wZXJ0aWVzRW5kID09PSAtMSkge1xyXG5cdFx0XHRcdHByb3BlcnRpZXNFbmQgPSBjb250ZW50Lmxlbmd0aDsgLy8gVHJlYXQgZW50aXJlIGNvbnRlbnQgYXMgcHJvcGVydGllcyBpZiBubyBzZWNvbmQgLS0tXHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cHJvcGVydGllc0VuZCArPSA0OyAvLyBNb3ZlIHBhc3QgdGhlIHNlY29uZCAtLS1cclxuXHRcdFx0fVxyXG5cdFx0XHRwcm9wZXJ0aWVzVGV4dCA9IGNvbnRlbnQuc2xpY2UoNCwgcHJvcGVydGllc0VuZCAtIDQpLnRyaW0oKTtcclxuXHRcdFx0XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0bGV0IGN1cnJlbnRLZXk6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG5cdFx0XHRcdGNvbnN0IGFycmF5S2V5cyA9IG5ldyBTZXQ8c3RyaW5nPigpOyAvLyBUcmFjayB3aGljaCBrZXlzIGFyZSBhcnJheXNcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRwcm9wZXJ0aWVzVGV4dC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lKSA9PiB7XHJcblx0XHRcdFx0XHRjb25zdCB0cmltbWVkTGluZSA9IGxpbmUudHJpbSgpO1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHQvLyBNYXRjaCBwcm9wZXJ0eSBsaW5lcyAtIG1vcmUgZmxleGlibGUgcmVnZXggdG8gaGFuZGxlIHZhcmlvdXMgcHJvcGVydHkgbmFtZXNcclxuXHRcdFx0XHRcdGNvbnN0IG1hdGNoID0gdHJpbW1lZExpbmUubWF0Y2goL14oW2EtekEtWl9dW2EtekEtWjAtOV8tXSopOlxccyooLiopJC8pO1xyXG5cdFx0XHRcdFx0aWYgKG1hdGNoKSB7XHJcblx0XHRcdFx0XHRcdGNvbnN0IFssIGtleSwgdmFsdWVdID0gbWF0Y2g7XHJcblx0XHRcdFx0XHRcdGN1cnJlbnRLZXkgPSBrZXk7XHJcblx0XHRcdFx0XHRcdGNvbnN0IHRyaW1tZWRWYWx1ZSA9IHZhbHVlID8gdmFsdWUudHJpbSgpIDogXCJcIjtcclxuXHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdC8vIENoZWNrIGZvciBicmFja2V0LXN5bnRheCBhcnJheXM6IFtpdGVtXSBvciBbXCJpdGVtMVwiLCBcIml0ZW0yXCJdIG9yIFtpdGVtMSwgaXRlbTJdXHJcblx0XHRcdFx0XHRcdGNvbnN0IGJyYWNrZXRBcnJheU1hdGNoID0gdHJpbW1lZFZhbHVlLm1hdGNoKC9eXFxbKC4qKVxcXSQvKTtcclxuXHRcdFx0XHRcdFx0aWYgKGJyYWNrZXRBcnJheU1hdGNoKSB7XHJcblx0XHRcdFx0XHRcdFx0Ly8gVGhpcyBpcyBhIGJyYWNrZXQtZm9ybWF0IGFycmF5XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgYXJyYXlDb250ZW50ID0gYnJhY2tldEFycmF5TWF0Y2hbMV0udHJpbSgpO1xyXG5cdFx0XHRcdFx0XHRcdGV4aXN0aW5nUHJvcGVydGllc1trZXldID0gW107XHJcblx0XHRcdFx0XHRcdFx0YXJyYXlLZXlzLmFkZChrZXkpOyAvLyBNYXJrIHRoaXMga2V5IGFzIGFuIGFycmF5XHJcblx0XHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdFx0aWYgKGFycmF5Q29udGVudCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gUGFyc2UgYXJyYXkgaXRlbXMgLSBoYW5kbGUgYm90aCBxdW90ZWQgYW5kIHVucXVvdGVkIHZhbHVlc1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gU3BsaXQgYnkgY29tbWEsIGJ1dCByZXNwZWN0IHF1b3Rlc1xyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgaXRlbXM6IHN0cmluZ1tdID0gW107XHJcblx0XHRcdFx0XHRcdFx0XHRsZXQgY3VycmVudEl0ZW0gPSBcIlwiO1xyXG5cdFx0XHRcdFx0XHRcdFx0bGV0IGluUXVvdGVzID0gZmFsc2U7XHJcblx0XHRcdFx0XHRcdFx0XHRsZXQgcXVvdGVDaGFyID0gJyc7XHJcblx0XHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXlDb250ZW50Lmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IGNoYXIgPSBhcnJheUNvbnRlbnRbaV07XHJcblx0XHRcdFx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoIWluUXVvdGVzICYmIChjaGFyID09PSAnXCInIHx8IGNoYXIgPT09IFwiJ1wiKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGluUXVvdGVzID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRxdW90ZUNoYXIgPSBjaGFyO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGluUXVvdGVzICYmIGNoYXIgPT09IHF1b3RlQ2hhcikge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIENoZWNrIGlmIGl0J3MgZXNjYXBlZFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChpID4gMCAmJiBhcnJheUNvbnRlbnRbaSAtIDFdID09PSAnXFxcXCcpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGN1cnJlbnRJdGVtICs9IGNoYXI7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGluUXVvdGVzID0gZmFsc2U7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRxdW90ZUNoYXIgPSAnJztcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoIWluUXVvdGVzICYmIGNoYXIgPT09ICcsJykge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEVuZCBvZiBjdXJyZW50IGl0ZW1cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjb25zdCB0cmltbWVkSXRlbSA9IGN1cnJlbnRJdGVtLnRyaW0oKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodHJpbW1lZEl0ZW0pIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFJlbW92ZSBzdXJyb3VuZGluZyBxdW90ZXMgaWYgcHJlc2VudFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgdW5xdW90ZWQgPSB0cmltbWVkSXRlbS5yZXBsYWNlKC9eW1wiJ118W1wiJ10kL2csICcnKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGl0ZW1zLnB1c2godW5xdW90ZWQpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjdXJyZW50SXRlbSA9IFwiXCI7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y3VycmVudEl0ZW0gKz0gY2hhcjtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBBZGQgdGhlIGxhc3QgaXRlbVxyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGN1cnJlbnRJdGVtLnRyaW0oKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zdCB0cmltbWVkSXRlbSA9IGN1cnJlbnRJdGVtLnRyaW0oKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgdW5xdW90ZWQgPSB0cmltbWVkSXRlbS5yZXBsYWNlKC9eW1wiJ118W1wiJ10kL2csICcnKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aXRlbXMucHVzaCh1bnF1b3RlZCk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHRcdGV4aXN0aW5nUHJvcGVydGllc1trZXldID0gaXRlbXM7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdC8vIE5vdCBhIGJyYWNrZXQgYXJyYXksIGNoZWNrIGZvciBvdGhlciBhcnJheSBmb3JtYXRzXHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgaXNLbm93bkFycmF5S2V5ID0gS05PV05fQVJSQVlfS0VZUy5pbmNsdWRlcyhrZXkgYXMgdHlwZW9mIEtOT1dOX0FSUkFZX0tFWVNbbnVtYmVyXSk7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgaXNFbXB0eUFycmF5ID0gIXRyaW1tZWRWYWx1ZSB8fCB0cmltbWVkVmFsdWUgPT09IFwiXCI7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgaXNBcnJheVByb3BlcnR5ID0gaXNLbm93bkFycmF5S2V5IHx8IGlzRW1wdHlBcnJheTtcclxuXHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHRpZiAoaXNBcnJheVByb3BlcnR5KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRleGlzdGluZ1Byb3BlcnRpZXNba2V5XSA9IFtdO1xyXG5cdFx0XHRcdFx0XHRcdFx0YXJyYXlLZXlzLmFkZChrZXkpOyAvLyBNYXJrIHRoaXMga2V5IGFzIGFuIGFycmF5XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIFN0cmlwIHN1cnJvdW5kaW5nIHF1b3RlcyBmcm9tIHN0cmluZyB2YWx1ZXNcclxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IHVucXVvdGVkVmFsdWUgPSB0cmltbWVkVmFsdWUucmVwbGFjZSgvXltcIiddfFtcIiddJC9nLCAnJyk7XHJcblx0XHRcdFx0XHRcdFx0XHRleGlzdGluZ1Byb3BlcnRpZXNba2V5XSA9IFt1bnF1b3RlZFZhbHVlXTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoY3VycmVudEtleSAmJiB0cmltbWVkTGluZS5zdGFydHNXaXRoKFwiLSBcIikpIHtcclxuXHRcdFx0XHRcdFx0Ly8gQ2hlY2sgaWYgY3VycmVudCBrZXkgaXMgYW4gYXJyYXkgcHJvcGVydHlcclxuXHRcdFx0XHRcdFx0Y29uc3QgaXNBcnJheVByb3BlcnR5ID0gYXJyYXlLZXlzLmhhcyhjdXJyZW50S2V5KTtcclxuXHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdGlmIChpc0FycmF5UHJvcGVydHkpIHtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBpdGVtID0gdHJpbW1lZExpbmUucmVwbGFjZSgvXi1cXHMqLywgXCJcIik7XHJcblx0XHRcdFx0XHRcdFx0aWYgKGl0ZW0pIGV4aXN0aW5nUHJvcGVydGllc1tjdXJyZW50S2V5XS5wdXNoKGl0ZW0pO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKHRyaW1tZWRMaW5lICYmICF0cmltbWVkTGluZS5zdGFydHNXaXRoKFwiLSBcIikgJiYgIXRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoXCIjXCIpKSB7XHJcblx0XHRcdFx0XHRcdC8vIEhhbmRsZSB1bnJlY29nbml6ZWQgcHJvcGVydGllcyB0aGF0IGRvbid0IG1hdGNoIHRoZSBzdGFuZGFyZCBmb3JtYXRcclxuXHRcdFx0XHRcdFx0Ly8gVGhpcyBpcyBhIGZhbGxiYWNrIHRvIHByZXNlcnZlIHByb3BlcnRpZXMgdGhhdCBtaWdodCBoYXZlIHNwZWNpYWwgZm9ybWF0dGluZ1xyXG5cdFx0XHRcdFx0XHRjb25zdCBrZXlNYXRjaCA9IHRyaW1tZWRMaW5lLm1hdGNoKC9eKFteOl0rKTpcXHMqKC4qKSQvKTtcclxuXHRcdFx0XHRcdFx0aWYgKGtleU1hdGNoKSB7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgWywga2V5LCB2YWx1ZV0gPSBrZXlNYXRjaDtcclxuXHRcdFx0XHRcdFx0XHRpZiAoIWV4aXN0aW5nUHJvcGVydGllc1trZXldKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRleGlzdGluZ1Byb3BlcnRpZXNba2V5XSA9IFt2YWx1ZSA/IHZhbHVlLnRyaW0oKSA6IFwiXCJdO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdC8vIFByZXNlcnZlIGFycmF5IGtleXMgaWYgdGhleSBleGlzdCB3aXRob3V0IHZhbHVlc1xyXG5cdFx0XHRcdEtOT1dOX0FSUkFZX0tFWVMuZm9yRWFjaChrZXkgPT4ge1xyXG5cdFx0XHRcdFx0aWYgKHByb3BlcnRpZXNUZXh0LmluY2x1ZGVzKGtleSArICc6JykgJiYgIWV4aXN0aW5nUHJvcGVydGllc1trZXldKSB7XHJcblx0XHRcdFx0XHRcdGV4aXN0aW5nUHJvcGVydGllc1trZXldID0gW107XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0gY2F0Y2gge1xyXG5cdFx0XHRcdC8vIEZhbGxiYWNrIHRvIHRlbXBsYXRlIGlmIHBhcnNpbmcgZmFpbHNcclxuXHRcdFx0XHRuZXcgTm90aWNlKFwiRmFsbGluZyBiYWNrIHRvIHRlbXBsYXRlIGR1ZSB0byBwYXJzaW5nIGVycm9yLlwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IGJvZHlDb250ZW50ID0gY29udGVudC5zbGljZShwcm9wZXJ0aWVzRW5kKTtcclxuXHRcdHJldHVybiB7XHJcblx0XHRcdHByb3BlcnRpZXM6IGV4aXN0aW5nUHJvcGVydGllcyxcclxuXHRcdFx0cHJvcGVydGllc1RleHQsXHJcblx0XHRcdHByb3BlcnRpZXNFbmQsXHJcblx0XHRcdGJvZHlDb250ZW50XHJcblx0XHR9O1xyXG5cdH1cclxuXHJcblx0cGFyc2VUZW1wbGF0ZSh0ZW1wbGF0ZVN0cmluZzogc3RyaW5nLCB0aXRsZTogc3RyaW5nKTogeyB0ZW1wbGF0ZVByb3BzOiBzdHJpbmdbXTsgdGVtcGxhdGVWYWx1ZXM6IFRlbXBsYXRlVmFsdWVzIH0ge1xyXG5cdFx0Y29uc3QgdGVtcGxhdGVMaW5lcyA9IHRlbXBsYXRlU3RyaW5nLnNwbGl0KFwiXFxuXCIpO1xyXG5cdFx0Y29uc3QgdGVtcGxhdGVQcm9wczogc3RyaW5nW10gPSBbXTtcclxuXHRcdGNvbnN0IHRlbXBsYXRlVmFsdWVzOiBUZW1wbGF0ZVZhbHVlcyA9IHt9O1xyXG5cdFx0bGV0IGluUHJvcGVydGllcyA9IGZhbHNlO1xyXG5cclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGVtcGxhdGVMaW5lcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRjb25zdCBsaW5lID0gdGVtcGxhdGVMaW5lc1tpXS50cmltKCk7XHJcblx0XHRcdGlmIChsaW5lID09PSBcIi0tLVwiKSB7XHJcblx0XHRcdFx0aW5Qcm9wZXJ0aWVzID0gIWluUHJvcGVydGllcztcclxuXHRcdFx0XHRpZiAoIWluUHJvcGVydGllcykge1xyXG5cdFx0XHRcdFx0YnJlYWs7IC8vIFN0b3AgYXQgc2Vjb25kIC0tLSB0byBleGNsdWRlIHBvc3QtcHJvcGVydHkgY29udGVudFxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoaW5Qcm9wZXJ0aWVzKSB7XHJcblx0XHRcdFx0Y29uc3QgbWF0Y2ggPSBsaW5lLm1hdGNoKC9eKFxcdyspOlxccyooLiopJC8pO1xyXG5cdFx0XHRcdGlmIChtYXRjaCkge1xyXG5cdFx0XHRcdFx0Y29uc3QgWywga2V5LCB2YWx1ZV0gPSBtYXRjaDtcclxuXHRcdFx0XHRcdHRlbXBsYXRlUHJvcHMucHVzaChrZXkpO1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHQvLyBDaGVjayBpZiB0aGlzIGlzIGFuIGFycmF5IHByb3BlcnR5IChrbm93biBhcnJheSBrZXlzIG9yIFlBTUwgbGlzdCBmb3JtYXQpXHJcblx0XHRcdFx0XHRjb25zdCBpc0tub3duQXJyYXlLZXkgPSBLTk9XTl9BUlJBWV9LRVlTLmluY2x1ZGVzKGtleSBhcyB0eXBlb2YgS05PV05fQVJSQVlfS0VZU1tudW1iZXJdKTtcclxuXHRcdFx0XHRcdC8vIENoZWNrIGlmIGl0J3MgYSBZQU1MIGxpc3QgZm9ybWF0IChubyB2YWx1ZSBhZnRlciBjb2xvbiwgZW1wdHkgYnJhY2tldHMsIG9yIGVtcHR5IHZhbHVlIG1lYW5zIGl0J3MgYW4gYXJyYXkpXHJcblx0XHRcdFx0XHRjb25zdCBpc0VtcHR5QXJyYXkgPSAhdmFsdWUgfHwgdmFsdWUudHJpbSgpID09PSBcIlwiIHx8IHZhbHVlLnRyaW0oKSA9PT0gXCJbXVwiO1xyXG5cdFx0XHRcdFx0Y29uc3QgaXNBcnJheVByb3BlcnR5ID0gaXNLbm93bkFycmF5S2V5IHx8IGlzRW1wdHlBcnJheTtcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0aWYgKGlzQXJyYXlQcm9wZXJ0eSkge1xyXG5cdFx0XHRcdFx0XHQvLyBIYW5kbGUgYXJyYXkgcHJvcGVydGllc1xyXG5cdFx0XHRcdFx0XHRpZiAodmFsdWUgJiYgdmFsdWUuc3RhcnRzV2l0aChcIltcIikpIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBIYW5kbGUgYnJhY2tldCBmb3JtYXQ6IFtcIml0ZW0xXCIsIFwiaXRlbTJcIl1cclxuXHRcdFx0XHRcdFx0XHRjb25zdCBpdGVtcyA9IHZhbHVlXHJcblx0XHRcdFx0XHRcdFx0XHQucmVwbGFjZSgvW1tcXF1dL2csIFwiXCIpXHJcblx0XHRcdFx0XHRcdFx0XHQuc3BsaXQoXCIsXCIpXHJcblx0XHRcdFx0XHRcdFx0XHQubWFwKHQgPT4gdC50cmltKCkpXHJcblx0XHRcdFx0XHRcdFx0XHQuZmlsdGVyKHQgPT4gdCk7XHJcblx0XHRcdFx0XHRcdFx0dGVtcGxhdGVWYWx1ZXNba2V5XSA9IGl0ZW1zO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdC8vIEhhbmRsZSBZQU1MIGxpc3QgZm9ybWF0OiBlbXB0eSBvciB3aXRoIC0gaXRlbXNcclxuXHRcdFx0XHRcdFx0XHR0ZW1wbGF0ZVZhbHVlc1trZXldID0gW107XHJcblx0XHRcdFx0XHRcdFx0Ly8gTG9vayBhaGVhZCBmb3IgaXRlbSBsaXN0XHJcblx0XHRcdFx0XHRcdFx0Zm9yIChsZXQgaiA9IGkgKyAxOyBqIDwgdGVtcGxhdGVMaW5lcy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgbmV4dExpbmUgPSB0ZW1wbGF0ZUxpbmVzW2pdLnRyaW0oKTtcclxuXHRcdFx0XHRcdFx0XHRcdGlmIChuZXh0TGluZS5zdGFydHNXaXRoKFwiLSBcIikpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgaXRlbSA9IG5leHRMaW5lLnJlcGxhY2UoL14tXFxzKi8sIFwiXCIpLnRyaW0oKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGl0ZW0pIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjb25zdCBhcnJheVZhbHVlID0gdGVtcGxhdGVWYWx1ZXNba2V5XTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoQXJyYXkuaXNBcnJheShhcnJheVZhbHVlKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0YXJyYXlWYWx1ZS5wdXNoKGl0ZW0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChuZXh0TGluZSA9PT0gXCItLS1cIiB8fCAobmV4dExpbmUgJiYgIW5leHRMaW5lLnN0YXJ0c1dpdGgoXCItIFwiKSAmJiBuZXh0TGluZS5pbmNsdWRlcyhcIjpcIikpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFN0b3AgYXQgbmV4dCBwcm9wZXJ0eSBvciBlbmQgb2YgcHJvcGVydGllcyBzZWN0aW9uXHJcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0Ly8gVGhpcyBpcyBhIHN0cmluZyBwcm9wZXJ0eSwgbm90IGFuIGFycmF5XHJcblx0XHRcdFx0XHRcdGNvbnN0IHNsdWcgPSB0aGlzLnRvS2ViYWJDYXNlKHRpdGxlKTtcclxuXHRcdFx0XHRcdFx0Y29uc3Qgc3RyaW5nVmFsdWUgPSAodmFsdWUgfHwgXCJcIilcclxuXHRcdFx0XHRcdFx0XHQucmVwbGFjZSgvXFx7XFx7dGl0bGVcXH1cXH0vZywgdGl0bGUpXHJcblx0XHRcdFx0XHRcdFx0LnJlcGxhY2UoL1xce1xce2RhdGVcXH1cXH0vZywgd2luZG93Lm1vbWVudChuZXcgRGF0ZSgpKS5mb3JtYXQodGhpcy5zZXR0aW5ncy5kYXRlRm9ybWF0KSlcclxuXHRcdFx0XHRcdFx0XHQucmVwbGFjZSgvXFx7XFx7c2x1Z1xcfVxcfS9nLCBzbHVnKTtcclxuXHRcdFx0XHRcdFx0Ly8gU3RvcmUgYXMgYSBzaW5nbGUgc3RyaW5nIHZhbHVlLCBub3QgaW4gYW4gYXJyYXlcclxuXHRcdFx0XHRcdFx0dGVtcGxhdGVWYWx1ZXNba2V5XSA9IHN0cmluZ1ZhbHVlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB7IHRlbXBsYXRlUHJvcHMsIHRlbXBsYXRlVmFsdWVzIH07XHJcblx0fVxyXG5cclxuXHRidWlsZEZyb250bWF0dGVyQ29udGVudChmaW5hbFByb3BzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4sIGFycmF5S2V5cz86IFNldDxzdHJpbmc+KTogc3RyaW5nIHtcclxuXHRcdGxldCBuZXdDb250ZW50ID0gXCItLS1cXG5cIjtcclxuXHRcdGZvciAoY29uc3Qga2V5IGluIGZpbmFsUHJvcHMpIHtcclxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhpcyBpcyBhbiBhcnJheSBwcm9wZXJ0eVxyXG5cdFx0XHRjb25zdCBpc0FycmF5UHJvcGVydHkgPSBLTk9XTl9BUlJBWV9LRVlTLmluY2x1ZGVzKGtleSBhcyB0eXBlb2YgS05PV05fQVJSQVlfS0VZU1tudW1iZXJdKSB8fCBcclxuXHRcdFx0XHQoYXJyYXlLZXlzICYmIGFycmF5S2V5cy5oYXMoa2V5KSk7XHJcblx0XHRcdFxyXG5cdFx0XHRpZiAoaXNBcnJheVByb3BlcnR5KSB7XHJcblx0XHRcdFx0bmV3Q29udGVudCArPSBgJHtrZXl9OlxcbmA7XHJcblx0XHRcdFx0aWYgKGZpbmFsUHJvcHNba2V5XS5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHRmaW5hbFByb3BzW2tleV0uZm9yRWFjaChpdGVtID0+IHtcclxuXHRcdFx0XHRcdFx0bmV3Q29udGVudCArPSBgICAtICR7aXRlbX1cXG5gO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdG5ld0NvbnRlbnQgKz0gYCR7a2V5fTogJHtmaW5hbFByb3BzW2tleV1bMF0gfHwgXCJcIn1cXG5gO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRuZXdDb250ZW50ICs9IFwiLS0tXCI7XHJcblx0XHRyZXR1cm4gbmV3Q29udGVudDtcclxuXHR9XHJcblxyXG5cdGFzeW5jIHVwZGF0ZVRpdGxlSW5Gcm9udG1hdHRlcihmaWxlOiBURmlsZSwgbmV3VGl0bGU6IHN0cmluZywgdHlwZTogQ29udGVudFR5cGVJZCk6IFByb21pc2U8dm9pZD4ge1xyXG5cdFx0Ly8gQ2hlY2sgaWYgdGVtcGxhdGUgaGFzIHt7dGl0bGV9fSAtIGlmIG5vdCwgZG9uJ3QgdXBkYXRlIGZyb250bWF0dGVyIGF0IGFsbFxyXG5cdFx0Y29uc3QgdGl0bGVLZXkgPSB0aGlzLmdldFRpdGxlS2V5KHR5cGUpO1xyXG5cdFx0Y29uc3QgaGFzVGl0bGVJblRlbXBsYXRlID0gdGhpcy50ZW1wbGF0ZUhhc1RpdGxlKHR5cGUpO1xyXG5cdFx0XHJcblx0XHQvLyBJZiB0ZW1wbGF0ZSBkb2Vzbid0IGhhdmUge3t0aXRsZX19LCBkb24ndCBtb2RpZnkgZnJvbnRtYXR0ZXJcclxuXHRcdGlmICghaGFzVGl0bGVJblRlbXBsYXRlKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Y29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XHJcblx0XHRsZXQgcHJvcGVydGllc0VuZCA9IDA7XHJcblx0XHRsZXQgcHJvcGVydGllc1RleHQgPSBcIlwiO1xyXG5cdFx0bGV0IGhhc0Zyb250bWF0dGVyID0gZmFsc2U7XHJcblxyXG5cdFx0aWYgKGNvbnRlbnQuc3RhcnRzV2l0aChcIi0tLVwiKSkge1xyXG5cdFx0XHRoYXNGcm9udG1hdHRlciA9IHRydWU7XHJcblx0XHRcdHByb3BlcnRpZXNFbmQgPSBjb250ZW50LmluZGV4T2YoXCJcXG4tLS1cIiwgMyk7XHJcblx0XHRcdGlmIChwcm9wZXJ0aWVzRW5kID09PSAtMSkge1xyXG5cdFx0XHRcdHByb3BlcnRpZXNFbmQgPSBjb250ZW50Lmxlbmd0aDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRwcm9wZXJ0aWVzRW5kICs9IDQ7XHJcblx0XHRcdH1cclxuXHRcdFx0cHJvcGVydGllc1RleHQgPSBjb250ZW50LnNsaWNlKDQsIHByb3BlcnRpZXNFbmQgLSA0KS50cmltKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3QgcHJvcE9yZGVyOiBzdHJpbmdbXSA9IFtdO1xyXG5cdFx0Y29uc3QgZXhpc3Rpbmc6IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IHN0cmluZ1tdPiA9IHt9O1xyXG5cdFx0bGV0IGN1cnJlbnRLZXk6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG5cdFx0bGV0IHRpdGxlS2V5UG9zaXRpb24gPSAtMTsgLy8gVHJhY2sgdGhlIG9yaWdpbmFsIHBvc2l0aW9uIG9mIHRoZSB0aXRsZSBrZXlcclxuXHJcblx0XHRjb25zdCBhcnJheUtleXMgPSBuZXcgU2V0PHN0cmluZz4oKTsgLy8gVHJhY2sgd2hpY2gga2V5cyBhcmUgYXJyYXlzXHJcblx0XHRcclxuXHRcdHByb3BlcnRpZXNUZXh0LnNwbGl0KFwiXFxuXCIpLmZvckVhY2goKGxpbmUsIGluZGV4KSA9PiB7XHJcblx0XHRcdGNvbnN0IHRyaW1tZWRMaW5lID0gbGluZS50cmltKCk7XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBNYXRjaCBwcm9wZXJ0eSBsaW5lcyAtIG1vcmUgZmxleGlibGUgcmVnZXggdG8gaGFuZGxlIHZhcmlvdXMgcHJvcGVydHkgbmFtZXNcclxuXHRcdFx0Y29uc3QgbWF0Y2ggPSB0cmltbWVkTGluZS5tYXRjaCgvXihbYS16QS1aX11bYS16QS1aMC05Xy1dKik6XFxzKiguKikkLyk7XHJcblx0XHRcdGlmIChtYXRjaCkge1xyXG5cdFx0XHRcdGNvbnN0IFssIGtleSwgdmFsdWVdID0gbWF0Y2g7XHJcblx0XHRcdFx0cHJvcE9yZGVyLnB1c2goa2V5KTtcclxuXHRcdFx0XHRjdXJyZW50S2V5ID0ga2V5O1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdC8vIFRyYWNrIHRoZSBvcmlnaW5hbCBwb3NpdGlvbiBvZiB0aGUgdGl0bGUga2V5XHJcblx0XHRcdFx0aWYgKGtleSA9PT0gdGl0bGVLZXkpIHtcclxuXHRcdFx0XHRcdHRpdGxlS2V5UG9zaXRpb24gPSBpbmRleDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0Y29uc3QgaXNLbm93bkFycmF5S2V5ID0gS05PV05fQVJSQVlfS0VZUy5pbmNsdWRlcyhrZXkgYXMgdHlwZW9mIEtOT1dOX0FSUkFZX0tFWVNbbnVtYmVyXSk7XHJcblx0XHRcdFx0Y29uc3QgaXNFbXB0eUFycmF5ID0gIXZhbHVlIHx8IHZhbHVlLnRyaW0oKSA9PT0gXCJcIiB8fCB2YWx1ZS50cmltKCkgPT09IFwiW11cIjtcclxuXHRcdFx0XHRjb25zdCBpc0FycmF5UHJvcGVydHkgPSBpc0tub3duQXJyYXlLZXkgfHwgaXNFbXB0eUFycmF5O1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGlmIChpc0FycmF5UHJvcGVydHkpIHtcclxuXHRcdFx0XHRcdGV4aXN0aW5nW2tleV0gPSBbXTtcclxuXHRcdFx0XHRcdGFycmF5S2V5cy5hZGQoa2V5KTsgLy8gTWFyayB0aGlzIGtleSBhcyBhbiBhcnJheVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRleGlzdGluZ1trZXldID0gdmFsdWUgPyB2YWx1ZS50cmltKCkgOiBcIlwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIGlmIChjdXJyZW50S2V5ICYmIGFycmF5S2V5cy5oYXMoY3VycmVudEtleSkgJiYgdHJpbW1lZExpbmUuc3RhcnRzV2l0aChcIi0gXCIpKSB7XHJcblx0XHRcdFx0Ly8gSGFuZGxlIGFycmF5IGl0ZW1zXHJcblx0XHRcdFx0Y29uc3QgaXRlbSA9IHRyaW1tZWRMaW5lLnJlcGxhY2UoL14tXFxzKi8sIFwiXCIpO1xyXG5cdFx0XHRcdGlmIChpdGVtKSAoZXhpc3RpbmdbY3VycmVudEtleV0gYXMgc3RyaW5nW10pLnB1c2goaXRlbSk7XHJcblx0XHRcdH0gZWxzZSBpZiAodHJpbW1lZExpbmUgJiYgIXRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoXCItIFwiKSAmJiAhdHJpbW1lZExpbmUuc3RhcnRzV2l0aChcIiNcIikpIHtcclxuXHRcdFx0XHQvLyBIYW5kbGUgdW5yZWNvZ25pemVkIHByb3BlcnRpZXMgdGhhdCBkb24ndCBtYXRjaCB0aGUgc3RhbmRhcmQgZm9ybWF0XHJcblx0XHRcdFx0Ly8gVGhpcyBpcyBhIGZhbGxiYWNrIHRvIHByZXNlcnZlIHByb3BlcnRpZXMgdGhhdCBtaWdodCBoYXZlIHNwZWNpYWwgZm9ybWF0dGluZ1xyXG5cdFx0XHRcdGNvbnN0IGtleU1hdGNoID0gdHJpbW1lZExpbmUubWF0Y2goL14oW146XSspOlxccyooLiopJC8pO1xyXG5cdFx0XHRcdGlmIChrZXlNYXRjaCkge1xyXG5cdFx0XHRcdFx0Y29uc3QgWywga2V5LCB2YWx1ZV0gPSBrZXlNYXRjaDtcclxuXHRcdFx0XHRcdGlmICghcHJvcE9yZGVyLmluY2x1ZGVzKGtleSkpIHtcclxuXHRcdFx0XHRcdFx0cHJvcE9yZGVyLnB1c2goa2V5KTtcclxuXHRcdFx0XHRcdFx0ZXhpc3Rpbmdba2V5XSA9IHZhbHVlID8gdmFsdWUudHJpbSgpIDogXCJcIjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIFByb3Blcmx5IGVzY2FwZSBZQU1MIHN0cmluZyB2YWx1ZXNcclxuXHRcdC8vIFlBTUwgc3RyaW5ncyB3aXRoIHF1b3RlcyBuZWVkIHRvIGJlIHdyYXBwZWQgaW4gc2luZ2xlIHF1b3RlcyBvciBlc2NhcGVkIHByb3Blcmx5XHJcblx0XHRsZXQgdGl0bGVWYWw6IHN0cmluZztcclxuXHRcdGlmIChuZXdUaXRsZS5pbmNsdWRlcygnXCInKSB8fCBuZXdUaXRsZS5pbmNsdWRlcyhcIidcIikgfHwgbmV3VGl0bGUuaW5jbHVkZXMoJ1xcbicpIHx8IG5ld1RpdGxlLmluY2x1ZGVzKCdcXFxcJykpIHtcclxuXHRcdFx0Ly8gRm9yIHN0cmluZ3Mgd2l0aCBxdW90ZXMsIG5ld2xpbmVzLCBvciBiYWNrc2xhc2hlcywgdXNlIHNpbmdsZSBxdW90ZXMgYW5kIGVzY2FwZSBzaW5nbGUgcXVvdGVzXHJcblx0XHRcdHRpdGxlVmFsID0gYCcke25ld1RpdGxlLnJlcGxhY2UoLycvZywgXCInJ1wiKX0nYDtcclxuXHRcdH0gZWxzZSBpZiAobmV3VGl0bGUuaW5jbHVkZXMoXCIgXCIpIHx8IG5ld1RpdGxlLmluY2x1ZGVzKFwiOlwiKSB8fCBuZXdUaXRsZS5pbmNsdWRlcyhcIiNcIikgfHwgbmV3VGl0bGUuaW5jbHVkZXMoXCJAXCIpKSB7XHJcblx0XHRcdC8vIEZvciBzdHJpbmdzIHdpdGggc3BhY2VzIG9yIHNwZWNpYWwgWUFNTCBjaGFyYWN0ZXJzLCB3cmFwIGluIGRvdWJsZSBxdW90ZXMgYW5kIGVzY2FwZSBkb3VibGUgcXVvdGVzXHJcblx0XHRcdHRpdGxlVmFsID0gYFwiJHtuZXdUaXRsZS5yZXBsYWNlKC9cIi9nLCAnXFxcXFwiJyl9XCJgO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Ly8gRm9yIHNpbXBsZSBzdHJpbmdzLCBubyBxdW90ZXMgbmVlZGVkXHJcblx0XHRcdHRpdGxlVmFsID0gbmV3VGl0bGU7XHJcblx0XHR9XHJcblx0XHRleGlzdGluZ1t0aXRsZUtleV0gPSB0aXRsZVZhbDtcclxuXHRcdFxyXG5cdFx0Ly8gQWxzbyB1cGRhdGUgc2x1ZyBpZiBpdCBleGlzdHMgaW4gZnJvbnRtYXR0ZXJcclxuXHRcdGlmIChcInNsdWdcIiBpbiBleGlzdGluZykge1xyXG5cdFx0XHRjb25zdCBuZXdTbHVnID0gdGhpcy50b0tlYmFiQ2FzZShuZXdUaXRsZSk7XHJcblx0XHRcdGV4aXN0aW5nW1wic2x1Z1wiXSA9IG5ld1NsdWc7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gSWYgdGl0bGUga2V5IHdhcyBmb3VuZCBpbiBvcmlnaW5hbCBwcm9wZXJ0aWVzLCBwcmVzZXJ2ZSBpdHMgcG9zaXRpb25cclxuXHRcdC8vIE90aGVyd2lzZSwgYWRkIGl0IGF0IHRoZSBlbmRcclxuXHRcdGlmICh0aXRsZUtleVBvc2l0aW9uID09PSAtMSkge1xyXG5cdFx0XHQvLyBUaXRsZSBrZXkgbm90IGZvdW5kIGluIG9yaWdpbmFsIHByb3BlcnRpZXMsIGFkZCBpdCBhdCB0aGUgZW5kXHJcblx0XHRcdHByb3BPcmRlci5wdXNoKHRpdGxlS2V5KTtcclxuXHRcdH1cclxuXHRcdC8vIElmIHRpdGxlS2V5UG9zaXRpb24gPj0gMCwgdGhlIHRpdGxlIGtleSBpcyBhbHJlYWR5IGluIHByb3BPcmRlciBhdCB0aGUgY29ycmVjdCBwb3NpdGlvblxyXG5cclxuXHRcdC8vIE9ubHkgY3JlYXRlL3VwZGF0ZSBmcm9udG1hdHRlciBpZiBpdCBhbHJlYWR5IGV4aXN0c1xyXG5cdFx0Ly8gRG9uJ3QgY3JlYXRlIGZyb250bWF0dGVyIGZyb20gc2NyYXRjaCBpZiBmaWxlIGhhZCBub25lXHJcblx0XHRpZiAoIWhhc0Zyb250bWF0dGVyKSB7XHJcblx0XHRcdC8vIEZpbGUgaGFkIG5vIGZyb250bWF0dGVyIC0gZG9uJ3QgY3JlYXRlIGl0LCBqdXN0IHJldHVyblxyXG5cdFx0XHQvLyBUaGUgcmVuYW1lIGFscmVhZHkgaGFwcGVuZWQsIHdlIGp1c3QgZG9uJ3QgdXBkYXRlIGZyb250bWF0dGVyXHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBCdWlsZCBuZXcgY29udGVudCB3aXRoIGZyb250bWF0dGVyXHJcblx0XHRsZXQgbmV3Q29udGVudCA9IFwiLS0tXFxuXCI7XHJcblx0XHRmb3IgKGNvbnN0IGtleSBvZiBwcm9wT3JkZXIpIHtcclxuXHRcdFx0Y29uc3QgdmFsID0gZXhpc3Rpbmdba2V5XTtcclxuXHRcdFx0aWYgKEFycmF5LmlzQXJyYXkodmFsKSkge1xyXG5cdFx0XHRcdG5ld0NvbnRlbnQgKz0gYCR7a2V5fTpcXG5gO1xyXG5cdFx0XHRcdGlmICh2YWwubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0dmFsLmZvckVhY2goKGl0ZW06IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRuZXdDb250ZW50ICs9IGAgIC0gJHtpdGVtfVxcbmA7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0bmV3Q29udGVudCArPSBgJHtrZXl9OiAke3ZhbCB8fCBcIlwifVxcbmA7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdG5ld0NvbnRlbnQgKz0gXCItLS1cXG5cIjtcclxuXHJcblx0XHQvLyBHZXQgYm9keSBjb250ZW50IChmcm9udG1hdHRlciBhbHJlYWR5IGV4aXN0ZWQsIHNvIHdlIGtub3cgcHJvcGVydGllc0VuZCBpcyBzZXQpXHJcblx0XHRjb25zdCBib2R5Q29udGVudCA9IGNvbnRlbnQuc2xpY2UocHJvcGVydGllc0VuZCk7XHJcblx0XHRuZXdDb250ZW50ICs9IGJvZHlDb250ZW50O1xyXG5cclxuXHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50KTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgZ2V0VGl0bGVLZXkodHlwZTogQ29udGVudFR5cGVJZCk6IHN0cmluZyB7XHJcblx0XHRpZiAodHlwZSA9PT0gXCJub3RlXCIpIHJldHVybiBcInRpdGxlXCI7XHJcblx0XHRcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHRoaXMuc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGUgPSBjb250ZW50VHlwZXMuZmluZChjdCA9PiBjdC5pZCA9PT0gdHlwZSk7XHJcblx0XHRpZiAoIWNvbnRlbnRUeXBlKSByZXR1cm4gXCJ0aXRsZVwiO1xyXG5cdFx0XHJcblx0XHRjb25zdCB0ZW1wbGF0ZSA9IGNvbnRlbnRUeXBlLnRlbXBsYXRlO1xyXG5cdFx0Y29uc3QgbGluZXMgPSB0ZW1wbGF0ZS5zcGxpdChcIlxcblwiKTtcclxuXHRcdGxldCBpblByb3BlcnRpZXMgPSBmYWxzZTtcclxuXHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xyXG5cdFx0XHRjb25zdCB0cmltbWVkID0gbGluZS50cmltKCk7XHJcblx0XHRcdGlmICh0cmltbWVkID09PSBcIi0tLVwiKSB7XHJcblx0XHRcdFx0aW5Qcm9wZXJ0aWVzID0gIWluUHJvcGVydGllcztcclxuXHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoaW5Qcm9wZXJ0aWVzKSB7XHJcblx0XHRcdFx0Y29uc3QgbWF0Y2ggPSB0cmltbWVkLm1hdGNoKC9eKFxcdyspOlxccyooLispJC8pO1xyXG5cdFx0XHRcdGlmIChtYXRjaCkge1xyXG5cdFx0XHRcdFx0Y29uc3Qga2V5ID0gbWF0Y2hbMV07XHJcblx0XHRcdFx0XHRjb25zdCB2YWx1ZSA9IG1hdGNoWzJdO1xyXG5cdFx0XHRcdFx0aWYgKHZhbHVlLmluY2x1ZGVzKFwie3t0aXRsZX19XCIpKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiBrZXk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gXCJ0aXRsZVwiO1xyXG5cdH1cclxuXHRcclxuXHQvLyBDaGVjayBpZiB0aGUgdGVtcGxhdGUgZm9yIHRoaXMgY29udGVudCB0eXBlIGhhcyB7e3RpdGxlfX1cclxuXHRwcml2YXRlIHRlbXBsYXRlSGFzVGl0bGUodHlwZTogQ29udGVudFR5cGVJZCk6IGJvb2xlYW4ge1xyXG5cdFx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSByZXR1cm4gdHJ1ZTsgLy8gTm90ZXMgYWx3YXlzIGhhdmUgdGl0bGVcclxuXHRcdFxyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gdGhpcy5zZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XHJcblx0XHRjb25zdCBjb250ZW50VHlwZSA9IGNvbnRlbnRUeXBlcy5maW5kKGN0ID0+IGN0LmlkID09PSB0eXBlKTtcclxuXHRcdGlmICghY29udGVudFR5cGUpIHJldHVybiB0cnVlOyAvLyBEZWZhdWx0IHRvIHRydWUgZm9yIHNhZmV0eVxyXG5cdFx0XHJcblx0XHRjb25zdCB0ZW1wbGF0ZSA9IGNvbnRlbnRUeXBlLnRlbXBsYXRlO1xyXG5cdFx0cmV0dXJuIHRlbXBsYXRlLmluY2x1ZGVzKFwie3t0aXRsZX19XCIpO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHsgRWRpdG9yLCBURmlsZSwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcblxuaW1wb3J0IHsgbWF0Y2hlc0ZvbGRlclBhdHRlcm4sIHNvcnRCeVBhdHRlcm5TcGVjaWZpY2l0eSB9IGZyb20gXCIuL3BhdGgtbWF0Y2hpbmdcIjtcbmltcG9ydCB7IHRvS2ViYWJDYXNlIH0gZnJvbSBcIi4vc3RyaW5nLXV0aWxzXCI7XG5cbmV4cG9ydCBjbGFzcyBMaW5rQ29udmVydGVyIHtcblx0Y29uc3RydWN0b3IocHJpdmF0ZSBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzLCBwcml2YXRlIHBsdWdpbj86IHsgc2V0dGluZ3M/OiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MgfSkgeyB9XG5cblx0Ly8gR2V0IGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luIGlmIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIHVzZSBzdG9yZWQgc2V0dGluZ3Ncblx0cHJpdmF0ZSBnZXRTZXR0aW5ncygpOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3Mge1xuXHRcdC8vIEFsd2F5cyBwcmVmZXIgcGx1Z2luIHNldHRpbmdzICh0aGV5J3JlIGtlcHQgdXAgdG8gZGF0ZSlcblx0XHRpZiAodGhpcy5wbHVnaW4/LnNldHRpbmdzKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLnNldHRpbmdzO1xuXHR9XG5cblx0Ly8gTG9jYWwgdG9LZWJhYkNhc2UgcmVtb3ZlZCwgdXNpbmcgaW1wb3J0ZWQgb25lIGluc3RlYWRcblxuXHRnZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmsobGluazogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBoYXNoSW5kZXggPSBsaW5rLmluZGV4T2YoJyMnKTtcblx0XHRsZXQgcGF0aCA9IGhhc2hJbmRleCA+PSAwID8gbGluay5zbGljZSgwLCBoYXNoSW5kZXgpIDogbGluaztcblx0XHRjb25zdCBhbmNob3IgPSBoYXNoSW5kZXggPj0gMCA/IGxpbmsuc2xpY2UoaGFzaEluZGV4KSA6ICcnO1xuXG5cdFx0Ly8gVVJMIGRlY29kZSB0aGUgcGF0aCB0byBoYW5kbGUgZW5jb2RlZCBjaGFyYWN0ZXJzIGxpa2UgJTIwXG5cdFx0cGF0aCA9IGRlY29kZVVSSUNvbXBvbmVudChwYXRoKTtcblx0XHRwYXRoID0gcGF0aC5yZXBsYWNlKC9cXC4obWR8bWR4KSQvLCBcIlwiKTtcblxuXHRcdC8vIERldGVybWluZSBjb250ZW50IHR5cGUgYW5kIGFwcHJvcHJpYXRlIGJhc2UgcGF0aCB1c2luZyBwYXR0ZXJuIHNwZWNpZmljaXR5XG5cdFx0Ly8gU3VwcG9ydCBib3RoIC5tZCBhbmQgLm1keCBleHRlbnNpb25zXG5cdFx0Y29uc3QgZmlsZUV4dGVuc2lvbiA9IGxpbmsuZW5kc1dpdGgoJy5tZHgnKSA/ICcubWR4JyA6ICcubWQnO1xuXHRcdGNvbnN0IGNvbnRlbnRUeXBlSW5mbyA9IHRoaXMuZ2V0Q29udGVudFR5cGVGb3JQYXRoKHBhdGggKyBmaWxlRXh0ZW5zaW9uKTtcblx0XHRsZXQgYmFzZVBhdGggPSBjb250ZW50VHlwZUluZm8uYmFzZVBhdGggfHwgXCJcIjtcblx0XHRsZXQgY29udGVudEZvbGRlciA9IGNvbnRlbnRUeXBlSW5mby5jb250ZW50Rm9sZGVyIHx8IFwiXCI7XG5cdFx0bGV0IGluZGV4RmlsZU5hbWUgPSBjb250ZW50VHlwZUluZm8uaW5kZXhGaWxlTmFtZSB8fCBcIlwiO1xuXG5cblx0XHQvLyBTdHJpcCBjb250ZW50IGZvbGRlciBpZiBwcmVzZW50XG5cdFx0aWYgKGNvbnRlbnRGb2xkZXIpIHtcblx0XHRcdHBhdGggPSBwYXRoLnNsaWNlKGNvbnRlbnRGb2xkZXIubGVuZ3RoICsgMSk7XG5cdFx0fVxuXG5cdFx0bGV0IGFkZFRyYWlsaW5nU2xhc2ggPSBmYWxzZTtcblxuXHRcdC8vIFNtYXJ0IGRldGVjdGlvbjogaWYgdGhlIGZpbGVuYW1lIG1hdGNoZXMgdGhlIGluZGV4IGZpbGUgbmFtZSAocmVnYXJkbGVzcyBvZiBjcmVhdGlvbiBtb2RlKSxcblx0XHQvLyB0cmVhdCBpdCBhcyBmb2xkZXItYmFzZWQgbG9naWNcblx0XHQvLyBOb3RlOiBXZSBvbmx5IHNldCBhZGRUcmFpbGluZ1NsYXNoIGhlcmU7IHRoZSBmaW5hbCBjaGVjayB3aWxsIHByZXZlbnQgaXQgaWYgdGhlcmUncyBhbiBhbmNob3Jcblx0XHRjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcblx0XHRjb25zdCBsYXN0UGFydCA9IHBhcnRzW3BhcnRzLmxlbmd0aCAtIDFdO1xuXG5cdFx0Ly8gQ2hlY2sgaWYgdGhlIGxhc3QgcGFydCBtYXRjaGVzIHRoZSBzcGVjaWZpZWQgaW5kZXggZmlsZSBuYW1lXG5cdFx0aWYgKGluZGV4RmlsZU5hbWUgJiYgaW5kZXhGaWxlTmFtZS50cmltKCkgIT09IFwiXCIgJiYgbGFzdFBhcnQgPT09IGluZGV4RmlsZU5hbWUpIHtcblx0XHRcdHBhcnRzLnBvcCgpO1xuXHRcdFx0cGF0aCA9IHBhcnRzLmpvaW4oJy8nKTtcblx0XHRcdGFkZFRyYWlsaW5nU2xhc2ggPSB0cnVlO1xuXHRcdH1cblx0XHQvLyBDaGVjayBpZiB0aGUgbGFzdCBwYXJ0IG1hdGNoZXMgdGhlIGRlZmF1bHQgXCJpbmRleFwiICh3aGVuIG5vIGluZGV4RmlsZU5hbWUgaXMgc3BlY2lmaWVkKVxuXHRcdGVsc2UgaWYgKCghaW5kZXhGaWxlTmFtZSB8fCBpbmRleEZpbGVOYW1lLnRyaW0oKSA9PT0gXCJcIikgJiYgbGFzdFBhcnQgPT09IFwiaW5kZXhcIikge1xuXHRcdFx0cGFydHMucG9wKCk7XG5cdFx0XHRwYXRoID0gcGFydHMuam9pbignLycpO1xuXHRcdFx0YWRkVHJhaWxpbmdTbGFzaCA9IHRydWU7XG5cdFx0fVxuXG5cdFx0Y29uc3Qgc2x1Z1BhcnRzID0gcGF0aC5zcGxpdCgnLycpLm1hcChwYXJ0ID0+IHRvS2ViYWJDYXNlKHBhcnQpKTtcblx0XHRjb25zdCBzbHVnID0gc2x1Z1BhcnRzLmpvaW4oJy8nKTtcblxuXHRcdC8vIEZvcm1hdCBiYXNlIHBhdGhcblx0XHRpZiAoYmFzZVBhdGgpIHtcblx0XHRcdC8vIEFkZCBsZWFkaW5nIHNsYXNoIGlmIG5vdCBwcmVzZW50IHRvIG1ha2UgaXQgYWJzb2x1dGUgZnJvbSByb290XG5cdFx0XHRpZiAoIWJhc2VQYXRoLnN0YXJ0c1dpdGgoXCIvXCIpKSB7XG5cdFx0XHRcdGJhc2VQYXRoID0gXCIvXCIgKyBiYXNlUGF0aDtcblx0XHRcdH1cblx0XHRcdC8vIEFkZCB0cmFpbGluZyBzbGFzaCBpZiBub3QgcHJlc2VudFxuXHRcdFx0aWYgKCFiYXNlUGF0aC5lbmRzV2l0aChcIi9cIikpIHtcblx0XHRcdFx0YmFzZVBhdGggKz0gXCIvXCI7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIFdoZW4gbm8gYmFzZSBwYXRoIGlzIHNwZWNpZmllZCwgYWRkIGxlYWRpbmcgc2xhc2ggdG8gbWFrZSBpdCBhYnNvbHV0ZSBmcm9tIHJvb3Rcblx0XHRcdGJhc2VQYXRoID0gXCIvXCI7XG5cdFx0fVxuXG5cdFx0Ly8gRGV0ZXJtaW5lIGlmIHdlIHNob3VsZCBhZGQgdHJhaWxpbmcgc2xhc2hcblx0XHQvLyBDUklUSUNBTDogTmV2ZXIgYWRkIHRyYWlsaW5nIHNsYXNoIGJlZm9yZSBhbiBhbmNob3IgKGUuZy4sIC9hYm91dCNoZWFkaW5nIG5vdCAvYWJvdXQvI2hlYWRpbmcpXG5cdFx0Ly8gVGhpcyBpcyBlc3BlY2lhbGx5IGltcG9ydGFudCBmb3IgYW5jaG9yIGxpbmtzIGZyb20gY29weSBoZWFkaW5nIFVSTCBmdW5jdGlvbmFsaXR5XG5cdFx0Ly8gQW5jaG9yIGxpbmtzIHNob3VsZCBORVZFUiBoYXZlIHRyYWlsaW5nIHNsYXNoZXMsIHJlZ2FyZGxlc3Mgb2Ygc2V0dGluZ3Ncblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMuZ2V0U2V0dGluZ3MoKTtcblx0XHRjb25zdCBzaG91bGRBZGRUcmFpbGluZ1NsYXNoID0gKHNldHRpbmdzLmFkZFRyYWlsaW5nU2xhc2hUb0xpbmtzIHx8IGFkZFRyYWlsaW5nU2xhc2gpICYmICFhbmNob3I7XG5cblx0XHRyZXR1cm4gYCR7YmFzZVBhdGh9JHtzbHVnfSR7c2hvdWxkQWRkVHJhaWxpbmdTbGFzaCA/ICcvJyA6ICcnfSR7YW5jaG9yfWA7XG5cdH1cblxuXHRwcml2YXRlIGdldEFzdHJvVXJsRnJvbUludGVybmFsTGlua1dpdGhDb250ZXh0KGxpbms6IHN0cmluZywgY3VycmVudEZpbGVQYXRoOiBzdHJpbmcsIGN1cnJlbnRGaWxlQ29udGVudFR5cGU6IHsgYmFzZVBhdGg6IHN0cmluZzsgY3JlYXRpb25Nb2RlOiBcImZpbGVcIiB8IFwiZm9sZGVyXCI7IGluZGV4RmlsZU5hbWU6IHN0cmluZzsgY29udGVudEZvbGRlcjogc3RyaW5nIH0pOiBzdHJpbmcge1xuXG5cdFx0Y29uc3QgaGFzaEluZGV4ID0gbGluay5pbmRleE9mKCcjJyk7XG5cdFx0bGV0IHBhdGggPSBoYXNoSW5kZXggPj0gMCA/IGxpbmsuc2xpY2UoMCwgaGFzaEluZGV4KSA6IGxpbms7XG5cdFx0Y29uc3QgYW5jaG9yID0gaGFzaEluZGV4ID49IDAgPyBsaW5rLnNsaWNlKGhhc2hJbmRleCkgOiAnJztcblxuXHRcdC8vIFVSTCBkZWNvZGUgdGhlIHBhdGggdG8gaGFuZGxlIGVuY29kZWQgY2hhcmFjdGVycyBsaWtlICUyMFxuXHRcdHBhdGggPSBkZWNvZGVVUklDb21wb25lbnQocGF0aCk7XG5cdFx0cGF0aCA9IHBhdGgucmVwbGFjZSgvXFwuKG1kfG1keCkkLywgXCJcIik7XG5cblxuXHRcdC8vIERldGVybWluZSBjb250ZW50IHR5cGUgYW5kIGFwcHJvcHJpYXRlIGJhc2UgcGF0aFxuXHRcdGxldCBiYXNlUGF0aCA9IFwiXCI7XG5cdFx0bGV0IGNvbnRlbnRGb2xkZXIgPSBcIlwiO1xuXHRcdGxldCBpbmRleEZpbGVOYW1lID0gXCJcIjtcblxuXHRcdC8vIFVzZSB0aGUgc2FtZSBsb2dpYyBhcyBnZXRDb250ZW50VHlwZUZvclBhdGggYnV0IGZvciB0aGUgdGFyZ2V0IGxpbmtcblx0XHQvLyBTdXBwb3J0IGJvdGggLm1kIGFuZCAubWR4IGV4dGVuc2lvbnMgLSB0cnkgLm1keCBmaXJzdCBpZiBsaW5rIHN1Z2dlc3RzIGl0XG5cdFx0Y29uc3QgZmlsZUV4dGVuc2lvbiA9IGxpbmsuZW5kc1dpdGgoJy5tZHgnKSA/ICcubWR4JyA6ICcubWQnO1xuXHRcdGNvbnN0IHRhcmdldENvbnRlbnRUeXBlID0gdGhpcy5nZXRDb250ZW50VHlwZUZvclBhdGgocGF0aCArIGZpbGVFeHRlbnNpb24pO1xuXG5cdFx0Ly8gSWYgdGFyZ2V0IGxpbmsgZG9lc24ndCBoYXZlIGEgY2xlYXIgY29udGVudCB0eXBlIChubyBmb2xkZXIgcGF0aCksIHVzZSBjdXJyZW50IGZpbGUncyBjb250ZW50IHR5cGVcblx0XHRpZiAoIXRhcmdldENvbnRlbnRUeXBlLmJhc2VQYXRoICYmIGN1cnJlbnRGaWxlQ29udGVudFR5cGUuYmFzZVBhdGgpIHtcblx0XHRcdGJhc2VQYXRoID0gY3VycmVudEZpbGVDb250ZW50VHlwZS5iYXNlUGF0aDtcblx0XHRcdGluZGV4RmlsZU5hbWUgPSBjdXJyZW50RmlsZUNvbnRlbnRUeXBlLmluZGV4RmlsZU5hbWU7XG5cdFx0XHRjb250ZW50Rm9sZGVyID0gY3VycmVudEZpbGVDb250ZW50VHlwZS5jb250ZW50Rm9sZGVyO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRiYXNlUGF0aCA9IHRhcmdldENvbnRlbnRUeXBlLmJhc2VQYXRoO1xuXHRcdFx0aW5kZXhGaWxlTmFtZSA9IHRhcmdldENvbnRlbnRUeXBlLmluZGV4RmlsZU5hbWU7XG5cdFx0XHRjb250ZW50Rm9sZGVyID0gdGFyZ2V0Q29udGVudFR5cGUuY29udGVudEZvbGRlcjtcblx0XHR9XG5cblx0XHQvLyBTdHJpcCBjb250ZW50IGZvbGRlciBpZiBwcmVzZW50XG5cdFx0aWYgKGNvbnRlbnRGb2xkZXIpIHtcblx0XHRcdHBhdGggPSBwYXRoLnNsaWNlKGNvbnRlbnRGb2xkZXIubGVuZ3RoICsgMSk7XG5cdFx0fVxuXG5cdFx0bGV0IGFkZFRyYWlsaW5nU2xhc2ggPSBmYWxzZTtcblxuXHRcdC8vIFNtYXJ0IGRldGVjdGlvbjogaWYgdGhlIGZpbGVuYW1lIG1hdGNoZXMgdGhlIGluZGV4IGZpbGUgbmFtZSAocmVnYXJkbGVzcyBvZiBjcmVhdGlvbiBtb2RlKSxcblx0XHQvLyB0cmVhdCBpdCBhcyBmb2xkZXItYmFzZWQgbG9naWNcblx0XHQvLyBOb3RlOiBXZSBvbmx5IHNldCBhZGRUcmFpbGluZ1NsYXNoIGhlcmU7IHRoZSBmaW5hbCBjaGVjayB3aWxsIHByZXZlbnQgaXQgaWYgdGhlcmUncyBhbiBhbmNob3Jcblx0XHRjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcblx0XHRjb25zdCBsYXN0UGFydCA9IHBhcnRzW3BhcnRzLmxlbmd0aCAtIDFdO1xuXG5cdFx0Ly8gQ2hlY2sgaWYgdGhlIGxhc3QgcGFydCBtYXRjaGVzIHRoZSBzcGVjaWZpZWQgaW5kZXggZmlsZSBuYW1lXG5cdFx0aWYgKGluZGV4RmlsZU5hbWUgJiYgaW5kZXhGaWxlTmFtZS50cmltKCkgIT09IFwiXCIgJiYgbGFzdFBhcnQgPT09IGluZGV4RmlsZU5hbWUpIHtcblx0XHRcdHBhcnRzLnBvcCgpO1xuXHRcdFx0cGF0aCA9IHBhcnRzLmpvaW4oJy8nKTtcblx0XHRcdGFkZFRyYWlsaW5nU2xhc2ggPSB0cnVlO1xuXHRcdH1cblx0XHQvLyBDaGVjayBpZiB0aGUgbGFzdCBwYXJ0IG1hdGNoZXMgdGhlIGRlZmF1bHQgXCJpbmRleFwiICh3aGVuIG5vIGluZGV4RmlsZU5hbWUgaXMgc3BlY2lmaWVkKVxuXHRcdGVsc2UgaWYgKCghaW5kZXhGaWxlTmFtZSB8fCBpbmRleEZpbGVOYW1lLnRyaW0oKSA9PT0gXCJcIikgJiYgbGFzdFBhcnQgPT09IFwiaW5kZXhcIikge1xuXHRcdFx0cGFydHMucG9wKCk7XG5cdFx0XHRwYXRoID0gcGFydHMuam9pbignLycpO1xuXHRcdFx0YWRkVHJhaWxpbmdTbGFzaCA9IHRydWU7XG5cdFx0fVxuXG5cdFx0Y29uc3Qgc2x1Z1BhcnRzID0gcGF0aC5zcGxpdCgnLycpLm1hcChwYXJ0ID0+IHRvS2ViYWJDYXNlKHBhcnQpKTtcblx0XHRjb25zdCBzbHVnID0gc2x1Z1BhcnRzLmpvaW4oJy8nKTtcblxuXHRcdC8vIEZvcm1hdCBiYXNlIHBhdGhcblx0XHRpZiAoYmFzZVBhdGgpIHtcblx0XHRcdC8vIEFkZCBsZWFkaW5nIHNsYXNoIGlmIG5vdCBwcmVzZW50IHRvIG1ha2UgaXQgYWJzb2x1dGUgZnJvbSByb290XG5cdFx0XHRpZiAoIWJhc2VQYXRoLnN0YXJ0c1dpdGgoXCIvXCIpKSB7XG5cdFx0XHRcdGJhc2VQYXRoID0gXCIvXCIgKyBiYXNlUGF0aDtcblx0XHRcdH1cblx0XHRcdC8vIEFkZCB0cmFpbGluZyBzbGFzaCBpZiBub3QgcHJlc2VudFxuXHRcdFx0aWYgKCFiYXNlUGF0aC5lbmRzV2l0aChcIi9cIikpIHtcblx0XHRcdFx0YmFzZVBhdGggKz0gXCIvXCI7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIFdoZW4gbm8gYmFzZSBwYXRoIGlzIHNwZWNpZmllZCwgYWRkIGxlYWRpbmcgc2xhc2ggdG8gbWFrZSBpdCBhYnNvbHV0ZSBmcm9tIHJvb3Rcblx0XHRcdGJhc2VQYXRoID0gXCIvXCI7XG5cdFx0fVxuXG5cdFx0Ly8gRGV0ZXJtaW5lIGlmIHdlIHNob3VsZCBhZGQgdHJhaWxpbmcgc2xhc2hcblx0XHQvLyBDUklUSUNBTDogTmV2ZXIgYWRkIHRyYWlsaW5nIHNsYXNoIGJlZm9yZSBhbiBhbmNob3IgKGUuZy4sIC9hYm91dCNoZWFkaW5nIG5vdCAvYWJvdXQvI2hlYWRpbmcpXG5cdFx0Ly8gVGhpcyBpcyBlc3BlY2lhbGx5IGltcG9ydGFudCBmb3IgYW5jaG9yIGxpbmtzIGZyb20gY29weSBoZWFkaW5nIFVSTCBmdW5jdGlvbmFsaXR5XG5cdFx0Ly8gQW5jaG9yIGxpbmtzIHNob3VsZCBORVZFUiBoYXZlIHRyYWlsaW5nIHNsYXNoZXMsIHJlZ2FyZGxlc3Mgb2Ygc2V0dGluZ3Ncblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMuZ2V0U2V0dGluZ3MoKTtcblx0XHRjb25zdCBzaG91bGRBZGRUcmFpbGluZ1NsYXNoID0gKHNldHRpbmdzLmFkZFRyYWlsaW5nU2xhc2hUb0xpbmtzIHx8IGFkZFRyYWlsaW5nU2xhc2gpICYmICFhbmNob3I7XG5cblx0XHRyZXR1cm4gYCR7YmFzZVBhdGh9JHtzbHVnfSR7c2hvdWxkQWRkVHJhaWxpbmdTbGFzaCA/ICcvJyA6ICcnfSR7YW5jaG9yfWA7XG5cdH1cblxuXHRwcml2YXRlIGlzSW5Db25maWd1cmVkQ29udGVudERpcmVjdG9yeShmaWxlUGF0aDogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0Ly8gQ2hlY2sgYWxsIGNvbnRlbnQgdHlwZXMsIHNvcnRlZCBieSBwYXR0ZXJuIHNwZWNpZmljaXR5IChtb3JlIHNwZWNpZmljIGZpcnN0KVxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5nZXRTZXR0aW5ncygpO1xuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcblx0XHRjb25zdCBzb3J0ZWRUeXBlcyA9IHNvcnRCeVBhdHRlcm5TcGVjaWZpY2l0eShjb250ZW50VHlwZXMpO1xuXG5cdFx0Zm9yIChjb25zdCBjb250ZW50VHlwZSBvZiBzb3J0ZWRUeXBlcykge1xuXHRcdFx0aWYgKCFjb250ZW50VHlwZS5lbmFibGVkKSBjb250aW51ZTtcblxuXHRcdFx0Ly8gSGFuZGxlIGJsYW5rIGZvbGRlciAocm9vdCkgLSBtYXRjaGVzIGZpbGVzIGluIHZhdWx0IHJvb3Qgb25seVxuXHRcdFx0aWYgKCFjb250ZW50VHlwZS5mb2xkZXIgfHwgY29udGVudFR5cGUuZm9sZGVyLnRyaW0oKSA9PT0gXCJcIikge1xuXHRcdFx0XHRpZiAoIWZpbGVQYXRoLmluY2x1ZGVzKFwiL1wiKSB8fCBmaWxlUGF0aC5zcGxpdChcIi9cIikubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAobWF0Y2hlc0ZvbGRlclBhdHRlcm4oZmlsZVBhdGgsIGNvbnRlbnRUeXBlLmZvbGRlcikpIHtcblx0XHRcdFx0Ly8gQ2hlY2sgaWdub3JlU3ViZm9sZGVycyBpZiBmb2xkZXIgaXMgc3BlY2lmaWVkXG5cdFx0XHRcdGlmIChjb250ZW50VHlwZS5pZ25vcmVTdWJmb2xkZXJzKSB7XG5cdFx0XHRcdFx0Y29uc3QgcGF0aFNlZ21lbnRzID0gZmlsZVBhdGguc3BsaXQoXCIvXCIpO1xuXHRcdFx0XHRcdGNvbnN0IHBhdGhEZXB0aCA9IHBhdGhTZWdtZW50cy5sZW5ndGg7XG5cdFx0XHRcdFx0Y29uc3QgcGF0dGVyblNlZ21lbnRzID0gY29udGVudFR5cGUuZm9sZGVyLnNwbGl0KFwiL1wiKTtcblx0XHRcdFx0XHRjb25zdCBleHBlY3RlZERlcHRoID0gcGF0dGVyblNlZ21lbnRzLmxlbmd0aDtcblxuXHRcdFx0XHRcdGlmIChjb250ZW50VHlwZS5jcmVhdGlvbk1vZGUgPT09IFwiZm9sZGVyXCIpIHtcblx0XHRcdFx0XHRcdC8vIEZvciBmb2xkZXItYmFzZWQgY3JlYXRpb24sIGZpbGVzIGFyZSBvbmUgbGV2ZWwgZGVlcGVyIChlLmcuLCB0ZXN0L215LWZpbGUvaW5kZXgubWQpXG5cdFx0XHRcdFx0XHQvLyBTbyB3ZSBuZWVkIHRvIGFsbG93IG9uZSBleHRyYSBsZXZlbCBiZXlvbmQgdGhlIHBhdHRlcm4gZGVwdGhcblx0XHRcdFx0XHRcdGNvbnN0IGZvbGRlckRlcHRoID0gcGF0aERlcHRoIC0gMTsgLy8gU3VidHJhY3QgMSBmb3IgdGhlIGluZGV4Lm1kIGZpbGVcblx0XHRcdFx0XHRcdGlmIChmb2xkZXJEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCB8fCBmb2xkZXJEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCArIDEpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIEZvciBmaWxlLWJhc2VkIGNyZWF0aW9uLCBmaWxlcyBhcmUgYXQgdGhlIHNhbWUgZGVwdGggYXMgdGhlIHBhdHRlcm5cblx0XHRcdFx0XHRcdGlmIChwYXRoRGVwdGggPT09IGV4cGVjdGVkRGVwdGgpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRDb250ZW50VHlwZUZvclBhdGgoZmlsZVBhdGg6IHN0cmluZyk6IHsgYmFzZVBhdGg6IHN0cmluZzsgY3JlYXRpb25Nb2RlOiBcImZpbGVcIiB8IFwiZm9sZGVyXCI7IGluZGV4RmlsZU5hbWU6IHN0cmluZzsgY29udGVudEZvbGRlcjogc3RyaW5nIH0ge1xuXHRcdC8vIENoZWNrIGFsbCBjb250ZW50IHR5cGVzLCBzb3J0ZWQgYnkgcGF0dGVybiBzcGVjaWZpY2l0eSAobW9yZSBzcGVjaWZpYyBmaXJzdClcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMuZ2V0U2V0dGluZ3MoKTtcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XG5cdFx0Y29uc3Qgc29ydGVkVHlwZXMgPSBzb3J0QnlQYXR0ZXJuU3BlY2lmaWNpdHkoY29udGVudFR5cGVzKTtcblxuXHRcdGZvciAoY29uc3QgY29udGVudFR5cGUgb2Ygc29ydGVkVHlwZXMpIHtcblx0XHRcdGlmICghY29udGVudFR5cGUuZW5hYmxlZCkgY29udGludWU7XG5cblx0XHRcdC8vIEhhbmRsZSBibGFuayBmb2xkZXIgKHJvb3QpIC0gbWF0Y2hlcyBmaWxlcyBpbiB2YXVsdCByb290IG9ubHlcblx0XHRcdGlmICghY29udGVudFR5cGUuZm9sZGVyIHx8IGNvbnRlbnRUeXBlLmZvbGRlci50cmltKCkgPT09IFwiXCIpIHtcblx0XHRcdFx0aWYgKCFmaWxlUGF0aC5pbmNsdWRlcyhcIi9cIikgfHwgZmlsZVBhdGguc3BsaXQoXCIvXCIpLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRiYXNlUGF0aDogY29udGVudFR5cGUubGlua0Jhc2VQYXRoIHx8IFwiXCIsXG5cdFx0XHRcdFx0XHRjcmVhdGlvbk1vZGU6IGNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZSxcblx0XHRcdFx0XHRcdGluZGV4RmlsZU5hbWU6IGNvbnRlbnRUeXBlLmluZGV4RmlsZU5hbWUgfHwgXCJcIixcblx0XHRcdFx0XHRcdGNvbnRlbnRGb2xkZXI6IFwiXCJcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKG1hdGNoZXNGb2xkZXJQYXR0ZXJuKGZpbGVQYXRoLCBjb250ZW50VHlwZS5mb2xkZXIpKSB7XG5cdFx0XHRcdC8vIENoZWNrIGlnbm9yZVN1YmZvbGRlcnMgaWYgZm9sZGVyIGlzIHNwZWNpZmllZFxuXHRcdFx0XHRpZiAoY29udGVudFR5cGUuaWdub3JlU3ViZm9sZGVycykge1xuXHRcdFx0XHRcdGNvbnN0IHBhdGhTZWdtZW50cyA9IGZpbGVQYXRoLnNwbGl0KFwiL1wiKTtcblx0XHRcdFx0XHRjb25zdCBwYXRoRGVwdGggPSBwYXRoU2VnbWVudHMubGVuZ3RoO1xuXHRcdFx0XHRcdGNvbnN0IHBhdHRlcm5TZWdtZW50cyA9IGNvbnRlbnRUeXBlLmZvbGRlci5zcGxpdChcIi9cIik7XG5cdFx0XHRcdFx0Y29uc3QgZXhwZWN0ZWREZXB0aCA9IHBhdHRlcm5TZWdtZW50cy5sZW5ndGg7XG5cblx0XHRcdFx0XHRpZiAoY29udGVudFR5cGUuY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKSB7XG5cdFx0XHRcdFx0XHQvLyBGb3IgZm9sZGVyLWJhc2VkIGNyZWF0aW9uLCBmaWxlcyBhcmUgb25lIGxldmVsIGRlZXBlciAoZS5nLiwgdGVzdC9teS1maWxlL2luZGV4Lm1kKVxuXHRcdFx0XHRcdFx0Ly8gU28gd2UgbmVlZCB0byBhbGxvdyBvbmUgZXh0cmEgbGV2ZWwgYmV5b25kIHRoZSBwYXR0ZXJuIGRlcHRoXG5cdFx0XHRcdFx0XHRjb25zdCBmb2xkZXJEZXB0aCA9IHBhdGhEZXB0aCAtIDE7IC8vIFN1YnRyYWN0IDEgZm9yIHRoZSBpbmRleC5tZCBmaWxlXG5cdFx0XHRcdFx0XHRpZiAoZm9sZGVyRGVwdGggPT09IGV4cGVjdGVkRGVwdGggfHwgZm9sZGVyRGVwdGggPT09IGV4cGVjdGVkRGVwdGggKyAxKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRcdFx0YmFzZVBhdGg6IGNvbnRlbnRUeXBlLmxpbmtCYXNlUGF0aCB8fCBcIlwiLFxuXHRcdFx0XHRcdFx0XHRcdGNyZWF0aW9uTW9kZTogY29udGVudFR5cGUuY3JlYXRpb25Nb2RlLFxuXHRcdFx0XHRcdFx0XHRcdGluZGV4RmlsZU5hbWU6IGNvbnRlbnRUeXBlLmluZGV4RmlsZU5hbWUgfHwgXCJcIixcblx0XHRcdFx0XHRcdFx0XHRjb250ZW50Rm9sZGVyOiBjb250ZW50VHlwZS5mb2xkZXJcblx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Ly8gRm9yIGZpbGUtYmFzZWQgY3JlYXRpb24sIGZpbGVzIGFyZSBhdCB0aGUgc2FtZSBkZXB0aCBhcyB0aGUgcGF0dGVyblxuXHRcdFx0XHRcdFx0aWYgKHBhdGhEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0XHRcdGJhc2VQYXRoOiBjb250ZW50VHlwZS5saW5rQmFzZVBhdGggfHwgXCJcIixcblx0XHRcdFx0XHRcdFx0XHRjcmVhdGlvbk1vZGU6IGNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZSxcblx0XHRcdFx0XHRcdFx0XHRpbmRleEZpbGVOYW1lOiBjb250ZW50VHlwZS5pbmRleEZpbGVOYW1lIHx8IFwiXCIsXG5cdFx0XHRcdFx0XHRcdFx0Y29udGVudEZvbGRlcjogY29udGVudFR5cGUuZm9sZGVyXG5cdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRiYXNlUGF0aDogY29udGVudFR5cGUubGlua0Jhc2VQYXRoIHx8IFwiXCIsXG5cdFx0XHRcdFx0XHRjcmVhdGlvbk1vZGU6IGNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZSxcblx0XHRcdFx0XHRcdGluZGV4RmlsZU5hbWU6IGNvbnRlbnRUeXBlLmluZGV4RmlsZU5hbWUgfHwgXCJcIixcblx0XHRcdFx0XHRcdGNvbnRlbnRGb2xkZXI6IGNvbnRlbnRUeXBlLmZvbGRlclxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBEZWZhdWx0IGZhbGxiYWNrXG5cdFx0cmV0dXJuIHtcblx0XHRcdGJhc2VQYXRoOiBcIlwiLFxuXHRcdFx0Y3JlYXRpb25Nb2RlOiBcImZpbGVcIixcblx0XHRcdGluZGV4RmlsZU5hbWU6IFwiXCIsXG5cdFx0XHRjb250ZW50Rm9sZGVyOiBcIlwiXG5cdFx0fTtcblx0fVxuXG5cdGNvbnZlcnRXaWtpbGlua3NGb3JBc3RybyhlZGl0b3I6IEVkaXRvciwgZmlsZTogVEZpbGUgfCBudWxsKTogdm9pZCB7XG5cdFx0aWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0bmV3IE5vdGljZShcIk5vIGFjdGl2ZSBmaWxlLlwiKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBQcmVzZXJ2ZSBjdXJzb3IgcG9zaXRpb24gYmVmb3JlIG1vZGlmeWluZyBjb250ZW50XG5cdFx0Y29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuXHRcdGNvbnN0IG9yaWdpbmFsTGluZSA9IGN1cnNvci5saW5lO1xuXHRcdGNvbnN0IG9yaWdpbmFsQ2ggPSBjdXJzb3IuY2g7XG5cdFx0Y29uc3Qgb3JpZ2luYWxDb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG5cdFx0Y29uc3Qgb3JpZ2luYWxMaW5lQ291bnQgPSBvcmlnaW5hbENvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aDtcblx0XHRjb25zdCBvcmlnaW5hbExpbmVMZW5ndGggPSBvcmlnaW5hbENvbnRlbnQuc3BsaXQoJ1xcbicpW29yaWdpbmFsTGluZV0/Lmxlbmd0aCB8fCAwO1xuXG5cdFx0Y29uc3QgY29udGVudCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xuXHRcdGxldCBuZXdDb250ZW50ID0gY29udGVudDtcblx0XHRsZXQgY29udmVydGVkQ291bnQgPSAwO1xuXHRcdGxldCBza2lwcGVkQ291bnQgPSAwO1xuXHRcdGNvbnN0IHNraXBwZWRMaW5rczogc3RyaW5nW10gPSBbXTtcblxuXHRcdC8vIERldGVybWluZSB0aGUgY3VycmVudCBmaWxlJ3MgY29udGVudCB0eXBlIGZvciByZWxhdGl2ZSBsaW5rc1xuXHRcdGNvbnN0IGN1cnJlbnRGaWxlQ29udGVudFR5cGUgPSB0aGlzLmdldENvbnRlbnRUeXBlRm9yUGF0aChmaWxlLnBhdGgpO1xuXG5cdFx0Ly8gRGVmaW5lIGNvbW1vbiBpbWFnZSBleHRlbnNpb25zXG5cdFx0Y29uc3QgaW1hZ2VFeHRlbnNpb25zID0gL1xcLihwbmd8anBnfGpwZWd8Z2lmfHN2ZykkL2k7XG5cblx0XHQvLyBIZWxwZXIgZnVuY3Rpb24gdG8gY2hlY2sgaWYgYSBsaW5rIGNhbiBiZSByZWxpYWJseSBjb252ZXJ0ZWRcblx0XHRjb25zdCBjYW5Db252ZXJ0TGluayA9IChsaW5rVGV4dDogc3RyaW5nKTogYm9vbGVhbiA9PiB7XG5cdFx0XHQvLyBEb24ndCBjb252ZXJ0IGlmIGl0J3MgYW4gaW1hZ2Vcblx0XHRcdGlmIChpbWFnZUV4dGVuc2lvbnMudGVzdChsaW5rVGV4dCkpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBEb24ndCBjb252ZXJ0IGV4dGVybmFsIGxpbmtzXG5cdFx0XHRpZiAobGlua1RleHQubWF0Y2goL15odHRwcz86XFwvXFwvLykpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBEb24ndCBjb252ZXJ0IGlmIGl0J3Mgbm90IGEgLm1kIG9yIC5tZHggZmlsZSBhbmQgZG9lc24ndCBsb29rIGxpa2UgYSB2YWxpZCBpbnRlcm5hbCBsaW5rXG5cdFx0XHRpZiAoIWxpbmtUZXh0LmluY2x1ZGVzKCcubWQnKSAmJiAhbGlua1RleHQuaW5jbHVkZXMoJy5tZHgnKSAmJiAhbGlua1RleHQubWF0Y2goL15bYS16QS1aMC05Xy1dKyhcXC9bYS16QS1aMC05Xy1dKykqJC8pKSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIHRhcmdldCBmaWxlIGlzIGluIGFueSBjb25maWd1cmVkIGNvbnRlbnQgZGlyZWN0b3J5XG5cdFx0XHQvLyBTdXBwb3J0IGJvdGggLm1kIGFuZCAubWR4IGV4dGVuc2lvbnNcblx0XHRcdGxldCB0YXJnZXRQYXRoOiBzdHJpbmc7XG5cdFx0XHRpZiAobGlua1RleHQuZW5kc1dpdGgoJy5tZCcpIHx8IGxpbmtUZXh0LmVuZHNXaXRoKCcubWR4JykpIHtcblx0XHRcdFx0dGFyZ2V0UGF0aCA9IGxpbmtUZXh0O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gRGVmYXVsdCB0byAubWQgaWYgbm8gZXh0ZW5zaW9uIHNwZWNpZmllZFxuXHRcdFx0XHR0YXJnZXRQYXRoID0gbGlua1RleHQgKyAnLm1kJztcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgaXQncyBpbiBhIGNvbmZpZ3VyZWQgY29udGVudCBkaXJlY3Rvcnlcblx0XHRcdGNvbnN0IGlzSW5Db25maWd1cmVkRGlyZWN0b3J5ID0gdGhpcy5pc0luQ29uZmlndXJlZENvbnRlbnREaXJlY3RvcnkodGFyZ2V0UGF0aCk7XG5cblx0XHRcdC8vIEFsc28gY2hlY2sgaWYgaXQncyBhIHNpbXBsZSBmaWxlbmFtZSAobm8gcGF0aCkgYW5kIGN1cnJlbnQgZmlsZSBoYXMgYSBjb250ZW50IHR5cGVcblx0XHRcdGNvbnN0IGlzU2ltcGxlRmlsZW5hbWUgPSAhdGFyZ2V0UGF0aC5pbmNsdWRlcygnLycpO1xuXHRcdFx0Y29uc3QgaGFzQ3VycmVudENvbnRlbnRUeXBlID0gY3VycmVudEZpbGVDb250ZW50VHlwZS5iYXNlUGF0aCAhPT0gXCJcIiB8fCBjdXJyZW50RmlsZUNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZSAhPT0gXCJmaWxlXCIgfHwgY3VycmVudEZpbGVDb250ZW50VHlwZS5pbmRleEZpbGVOYW1lICE9PSBcIlwiO1xuXG5cdFx0XHRyZXR1cm4gaXNJbkNvbmZpZ3VyZWREaXJlY3RvcnkgfHwgKGlzU2ltcGxlRmlsZW5hbWUgJiYgaGFzQ3VycmVudENvbnRlbnRUeXBlKTtcblx0XHR9O1xuXG5cdFx0Ly8gSGFuZGxlIHJlZ3VsYXIgV2lraWxpbmtzIChub24taW1hZ2UpXG5cdFx0bmV3Q29udGVudCA9IG5ld0NvbnRlbnQucmVwbGFjZShcblx0XHRcdC9cXFtcXFsoW15cXF18XSspKFxcfChbXlxcXV0rKSk/XFxdXFxdL2csXG5cdFx0XHQobWF0Y2g6IHN0cmluZywgbGlua1RleHQ6IHN0cmluZywgX3BpcGU6IHN0cmluZyB8IHVuZGVmaW5lZCwgZGlzcGxheVRleHQ6IHN0cmluZyB8IHVuZGVmaW5lZCkgPT4ge1xuXHRcdFx0XHQvLyBDaGVjayBpZiBpdCdzIGFuIGltYWdlIFdpa2lsaW5rXG5cdFx0XHRcdGlmIChpbWFnZUV4dGVuc2lvbnMudGVzdChsaW5rVGV4dCkpIHtcblx0XHRcdFx0XHRza2lwcGVkQ291bnQrKztcblx0XHRcdFx0XHRza2lwcGVkTGlua3MucHVzaChsaW5rVGV4dCk7XG5cdFx0XHRcdFx0cmV0dXJuIG1hdGNoOyAvLyBJZ25vcmUgYW5kIHJldHVybiBvcmlnaW5hbCBpbWFnZSBXaWtpbGlua1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQ2hlY2sgaWYgd2UgY2FuIHJlbGlhYmx5IGNvbnZlcnQgdGhpcyBsaW5rXG5cdFx0XHRcdGlmICghY2FuQ29udmVydExpbmsobGlua1RleHQpKSB7XG5cdFx0XHRcdFx0c2tpcHBlZENvdW50Kys7XG5cdFx0XHRcdFx0c2tpcHBlZExpbmtzLnB1c2gobGlua1RleHQpO1xuXHRcdFx0XHRcdHJldHVybiBtYXRjaDsgLy8gUmV0dXJuIG9yaWdpbmFsIGlmIHdlIGNhbid0IGNvbnZlcnQgcmVsaWFibHlcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbnN0IGRpc3BsYXkgPSBkaXNwbGF5VGV4dCB8fCBsaW5rVGV4dC5yZXBsYWNlKC9cXC4obWR8bWR4KSQvLCBcIlwiKTtcblxuXHRcdFx0XHQvLyBGb3IgcmVsYXRpdmUgbGlua3MgKG5vIGZvbGRlciBwYXRoKSwgdXNlIGN1cnJlbnQgZmlsZSdzIGNvbnRlbnQgdHlwZVxuXHRcdFx0XHRjb25zdCB1cmwgPSB0aGlzLmdldEFzdHJvVXJsRnJvbUludGVybmFsTGlua1dpdGhDb250ZXh0KGxpbmtUZXh0LCBmaWxlLnBhdGgsIGN1cnJlbnRGaWxlQ29udGVudFR5cGUpO1xuXG5cdFx0XHRcdGNvbnZlcnRlZENvdW50Kys7XG5cdFx0XHRcdHJldHVybiBgWyR7ZGlzcGxheX1dKCR7dXJsfSlgO1xuXHRcdFx0fVxuXHRcdCk7XG5cblx0XHQvLyBIYW5kbGUgc3RhbmRhcmQgTWFya2Rvd24gbGlua3MgKG5vbi1pbWFnZSwgbm9uLWV4dGVybmFsKVxuXHRcdC8vIE9ubHkgcHJvY2VzcyBsaW5rcyB0aGF0IGNvbnRhaW4gLm1kIG9yIC5tZHggdG8gYXZvaWQgcHJvY2Vzc2luZyBhbHJlYWR5LWNvbnZlcnRlZCBsaW5rc1xuXHRcdG5ld0NvbnRlbnQgPSBuZXdDb250ZW50LnJlcGxhY2UoXG5cdFx0XHQvXFxbKFteXFxdXSspXFxdXFwoKFteKV0rXFwuKG1kfG1keClbXildKilcXCkvZyxcblx0XHRcdChtYXRjaDogc3RyaW5nLCBkaXNwbGF5VGV4dDogc3RyaW5nLCBsaW5rOiBzdHJpbmcpID0+IHtcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgaXQncyBhbiBpbWFnZSBsaW5rIG9yIGV4dGVybmFsIGxpbmtcblx0XHRcdFx0aWYgKGxpbmsubWF0Y2goL15odHRwcz86XFwvXFwvLykgfHwgaW1hZ2VFeHRlbnNpb25zLnRlc3QobGluaykpIHtcblx0XHRcdFx0XHRza2lwcGVkQ291bnQrKztcblx0XHRcdFx0XHRza2lwcGVkTGlua3MucHVzaChsaW5rKTtcblx0XHRcdFx0XHRyZXR1cm4gbWF0Y2g7IC8vIElnbm9yZSBleHRlcm5hbCBvciBpbWFnZSBsaW5rc1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQ2hlY2sgaWYgd2UgY2FuIHJlbGlhYmx5IGNvbnZlcnQgdGhpcyBsaW5rXG5cdFx0XHRcdGlmICghY2FuQ29udmVydExpbmsobGluaykpIHtcblx0XHRcdFx0XHRza2lwcGVkQ291bnQrKztcblx0XHRcdFx0XHRza2lwcGVkTGlua3MucHVzaChsaW5rKTtcblx0XHRcdFx0XHRyZXR1cm4gbWF0Y2g7IC8vIFJldHVybiBvcmlnaW5hbCBpZiB3ZSBjYW4ndCBjb252ZXJ0IHJlbGlhYmx5XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjb25zdCB1cmwgPSB0aGlzLmdldEFzdHJvVXJsRnJvbUludGVybmFsTGlua1dpdGhDb250ZXh0KGxpbmssIGZpbGUucGF0aCwgY3VycmVudEZpbGVDb250ZW50VHlwZSk7XG5cblx0XHRcdFx0Y29udmVydGVkQ291bnQrKztcblx0XHRcdFx0cmV0dXJuIGBbJHtkaXNwbGF5VGV4dH1dKCR7dXJsfSlgO1xuXHRcdFx0fVxuXHRcdCk7XG5cblx0XHQvLyBIYW5kbGUgaW1hZ2UgbGlua3MgaW4gTWFya2Rvd24gZm9ybWF0IChlLmcuLCAhW0ltYWdlXShtb3VudGFpbnMucG5nKSlcblx0XHRuZXdDb250ZW50ID0gbmV3Q29udGVudC5yZXBsYWNlKFxuXHRcdFx0LyFcXFsoLio/KVxcXVxcKChbXildKylcXCkvZyxcblx0XHRcdChtYXRjaDogc3RyaW5nKSA9PiB7XG5cdFx0XHRcdHNraXBwZWRDb3VudCsrO1xuXHRcdFx0XHRyZXR1cm4gbWF0Y2g7IC8vIElnbm9yZSBhbGwgaW1hZ2UgbGlua3Ncblx0XHRcdH1cblx0XHQpO1xuXG5cdFx0Ly8gSGFuZGxlIHt7ZW1iZWR9fSBzeW50YXhcblx0XHRuZXdDb250ZW50ID0gbmV3Q29udGVudC5yZXBsYWNlKC9cXHtcXHsoW159XSspXFx9XFx9L2csIChtYXRjaDogc3RyaW5nLCBmaWxlTmFtZTogc3RyaW5nKSA9PiB7XG5cdFx0XHRpZiAoaW1hZ2VFeHRlbnNpb25zLnRlc3QoZmlsZU5hbWUpKSB7XG5cdFx0XHRcdHNraXBwZWRDb3VudCsrO1xuXHRcdFx0XHRza2lwcGVkTGlua3MucHVzaChmaWxlTmFtZSk7XG5cdFx0XHRcdHJldHVybiBtYXRjaDsgLy8gSWdub3JlIGVtYmVkZGVkIGltYWdlc1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDaGVjayBpZiB3ZSBjYW4gcmVsaWFibHkgY29udmVydCB0aGlzIGxpbmtcblx0XHRcdGlmICghY2FuQ29udmVydExpbmsoZmlsZU5hbWUpKSB7XG5cdFx0XHRcdHNraXBwZWRDb3VudCsrO1xuXHRcdFx0XHRza2lwcGVkTGlua3MucHVzaChmaWxlTmFtZSk7XG5cdFx0XHRcdHJldHVybiBtYXRjaDsgLy8gUmV0dXJuIG9yaWdpbmFsIGlmIHdlIGNhbid0IGNvbnZlcnQgcmVsaWFibHlcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgdXJsID0gdGhpcy5nZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmtXaXRoQ29udGV4dChmaWxlTmFtZSwgZmlsZS5wYXRoLCBjdXJyZW50RmlsZUNvbnRlbnRUeXBlKTtcblxuXHRcdFx0Y29udmVydGVkQ291bnQrKztcblx0XHRcdHJldHVybiBgW0VtYmVkZGVkOiAke2ZpbGVOYW1lfV0oJHt1cmx9KWA7XG5cdFx0fSk7XG5cblx0XHRlZGl0b3Iuc2V0VmFsdWUobmV3Q29udGVudCk7XG5cblx0XHQvLyBSZXN0b3JlIGN1cnNvciBwb3NpdGlvbiwgYWRqdXN0aW5nIGZvciBjb250ZW50IGNoYW5nZXNcblx0XHRjb25zdCBuZXdMaW5lQ291bnQgPSBuZXdDb250ZW50LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG5cdFx0Y29uc3QgbmV3TGluZUxlbmd0aCA9IG5ld0NvbnRlbnQuc3BsaXQoJ1xcbicpW29yaWdpbmFsTGluZV0/Lmxlbmd0aCB8fCAwO1xuXG5cdFx0Ly8gQ2FsY3VsYXRlIG5ldyBjdXJzb3IgcG9zaXRpb25cblx0XHRsZXQgbmV3TGluZSA9IG9yaWdpbmFsTGluZTtcblx0XHRsZXQgbmV3Q2ggPSBvcmlnaW5hbENoO1xuXG5cdFx0Ly8gSWYgY29udGVudCBsZW5ndGggY2hhbmdlZCwgYWRqdXN0IGN1cnNvciBwb3NpdGlvblxuXHRcdGlmIChuZXdMaW5lQ291bnQgIT09IG9yaWdpbmFsTGluZUNvdW50KSB7XG5cdFx0XHQvLyBJZiBsaW5lcyB3ZXJlIGFkZGVkL3JlbW92ZWQgYmVmb3JlIGN1cnNvciwgYWRqdXN0IGxpbmUgbnVtYmVyXG5cdFx0XHQvLyBGb3Igc2ltcGxpY2l0eSwga2VlcCBzYW1lIGxpbmUgaWYgaXQgc3RpbGwgZXhpc3RzLCBvdGhlcndpc2UgY2xhbXAgdG8gZW5kXG5cdFx0XHRpZiAobmV3TGluZSA+PSBuZXdMaW5lQ291bnQpIHtcblx0XHRcdFx0bmV3TGluZSA9IE1hdGgubWF4KDAsIG5ld0xpbmVDb3VudCAtIDEpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIEFkanVzdCBjb2x1bW4gcG9zaXRpb24gaWYgbGluZSBsZW5ndGggY2hhbmdlZFxuXHRcdGlmIChuZXdMaW5lTGVuZ3RoICE9PSBvcmlnaW5hbExpbmVMZW5ndGgpIHtcblx0XHRcdC8vIElmIGxpbmUgZ290IHNob3J0ZXIsIGNsYW1wIHRvIGVuZCBvZiBsaW5lXG5cdFx0XHRpZiAobmV3Q2ggPiBuZXdMaW5lTGVuZ3RoKSB7XG5cdFx0XHRcdG5ld0NoID0gTWF0aC5tYXgoMCwgbmV3TGluZUxlbmd0aCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gUmVzdG9yZSBjdXJzb3IgcG9zaXRpb25cblx0XHRlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogbmV3TGluZSwgY2g6IG5ld0NoIH0pO1xuXG5cdFx0Ly8gU2hvdyBhcHByb3ByaWF0ZSBub3RpY2UgYmFzZWQgb24gcmVzdWx0c1xuXHRcdGlmIChjb252ZXJ0ZWRDb3VudCA+IDAgJiYgc2tpcHBlZENvdW50ID09PSAwKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBDb252ZXJ0ZWQgJHtjb252ZXJ0ZWRDb3VudH0gaW50ZXJuYWwgbGluayR7Y29udmVydGVkQ291bnQgPiAxID8gJ3MnIDogJyd9IGZvciBBc3Ryby5gKTtcblx0XHR9IGVsc2UgaWYgKGNvbnZlcnRlZENvdW50ID4gMCAmJiBza2lwcGVkQ291bnQgPiAwKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBDb252ZXJ0ZWQgJHtjb252ZXJ0ZWRDb3VudH0gbGluayR7Y29udmVydGVkQ291bnQgPiAxID8gJ3MnIDogJyd9IGZvciBBc3Ryby4gU2tpcHBlZCAke3NraXBwZWRDb3VudH0gbGluayR7c2tpcHBlZENvdW50ID4gMSA/ICdzJyA6ICcnfSBvdXRzaWRlIGNvbmZpZ3VyZWQgY29udGVudCBkaXJlY3Rvcmllcy5gKTtcblx0XHR9IGVsc2UgaWYgKHNraXBwZWRDb3VudCA+IDApIHtcblx0XHRcdG5ldyBOb3RpY2UoYE5vIGxpbmtzIGNvbnZlcnRlZC4gQWxsICR7c2tpcHBlZENvdW50fSBsaW5rJHtza2lwcGVkQ291bnQgPiAxID8gJ3MnIDogJyd9IGFyZSBvdXRzaWRlIGNvbmZpZ3VyZWQgY29udGVudCBkaXJlY3RvcmllcyBvciBhcmUgaW1hZ2VzL2V4dGVybmFsIGxpbmtzLmApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRuZXcgTm90aWNlKFwiTm8gaW50ZXJuYWwgbGlua3MgZm91bmQgdG8gY29udmVydC5cIik7XG5cdFx0fVxuXHR9XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgVEZpbGUsIE5vdGljZSwgUGxhdGZvcm0sIE1hcmtkb3duVmlldyB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSwgQ29udGVudFR5cGVJZCB9IGZyb20gXCIuLi90eXBlc1wiO1xuaW1wb3J0IHsgRmlsZU9wZXJhdGlvbnMgfSBmcm9tIFwiLi4vdXRpbHMvZmlsZS1vcGVyYXRpb25zXCI7XG5pbXBvcnQgeyBUZW1wbGF0ZVBhcnNlciB9IGZyb20gXCIuLi91dGlscy90ZW1wbGF0ZS1wYXJzaW5nXCI7XG5pbXBvcnQgeyB0b0tlYmFiQ2FzZSB9IGZyb20gXCIuLi91dGlscy9zdHJpbmctdXRpbHNcIjtcblxuZXhwb3J0IGNsYXNzIFRpdGxlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cdGZpbGU6IFRGaWxlIHwgbnVsbDtcblx0cGx1Z2luOiBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlO1xuXHR0eXBlOiBDb250ZW50VHlwZUlkO1xuXHRpc1JlbmFtZTogYm9vbGVhbjtcblx0aXNOZXdOb3RlOiBib29sZWFuO1xuXHR0aXRsZUlucHV0ITogSFRNTElucHV0RWxlbWVudDtcblx0cHJpdmF0ZSBmaWxlT3BzOiBGaWxlT3BlcmF0aW9ucztcblx0cHJpdmF0ZSB0ZW1wbGF0ZVBhcnNlcjogVGVtcGxhdGVQYXJzZXI7XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIGZpbGU6IFRGaWxlIHwgbnVsbCwgcGx1Z2luOiBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlLCB0eXBlOiBDb250ZW50VHlwZUlkLCBpc1JlbmFtZSA9IGZhbHNlLCBpc05ld05vdGUgPSBmYWxzZSkge1xuXHRcdHN1cGVyKGFwcCk7XG5cdFx0dGhpcy5maWxlID0gZmlsZTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLnR5cGUgPSB0eXBlO1xuXHRcdHRoaXMuaXNSZW5hbWUgPSBpc1JlbmFtZTtcblx0XHR0aGlzLmlzTmV3Tm90ZSA9IGlzTmV3Tm90ZTtcblxuXHRcdC8vIEluaXRpYWxpemUgdXRpbGl0aWVzIHdpdGggY3VycmVudCBzZXR0aW5nc1xuXHRcdC8vIEZpbGVPcGVyYXRpb25zIHdpbGwgZ2V0IGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luIGR5bmFtaWNhbGx5XG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSBwbHVnaW4uc2V0dGluZ3M7XG5cdFx0dGhpcy5maWxlT3BzID0gbmV3IEZpbGVPcGVyYXRpb25zKGFwcCwgc2V0dGluZ3MsIHBsdWdpbik7XG5cdFx0dGhpcy50ZW1wbGF0ZVBhcnNlciA9IG5ldyBUZW1wbGF0ZVBhcnNlcihhcHAsIHNldHRpbmdzKTtcblx0fVxuXG5cdGFzeW5jIGdldEN1cnJlbnRUaXRsZUFzeW5jKCk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0aWYgKCF0aGlzLmZpbGUpIHtcblx0XHRcdHJldHVybiBcIlwiO1xuXHRcdH1cblxuXHRcdC8vIFJlYWQgdGhlIGZpbGUgY29udGVudCBkaXJlY3RseSB0byBlbnN1cmUgd2UgaGF2ZSB0aGUgbGF0ZXN0IHRpdGxlXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKHRoaXMuZmlsZSk7XG5cdFx0XHRjb25zdCB0aXRsZUtleSA9IHRoaXMuZmlsZU9wcy5nZXRUaXRsZUtleSh0aGlzLnR5cGUpO1xuXHRcdFx0Y29uc3QgeyBwcm9wZXJ0aWVzIH0gPSB0aGlzLnRlbXBsYXRlUGFyc2VyLnBhcnNlRnJvbnRtYXR0ZXIoY29udGVudCk7XG5cblx0XHRcdGlmICh0aXRsZUtleSBpbiBwcm9wZXJ0aWVzKSB7XG5cdFx0XHRcdGNvbnN0IHRpdGxlVmFsdWUgPSBwcm9wZXJ0aWVzW3RpdGxlS2V5XTtcblx0XHRcdFx0aWYgKEFycmF5LmlzQXJyYXkodGl0bGVWYWx1ZSkgJiYgdGl0bGVWYWx1ZS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0cmV0dXJuIFN0cmluZyh0aXRsZVZhbHVlWzBdKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAodGl0bGVWYWx1ZSAhPT0gbnVsbCAmJiB0aXRsZVZhbHVlICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRyZXR1cm4gU3RyaW5nKHRpdGxlVmFsdWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoXCJFcnJvciByZWFkaW5nIGZpbGUgZm9yIHRpdGxlOlwiLCBlcnJvcik7XG5cdFx0fVxuXG5cdFx0Ly8gRmFsbCBiYWNrIHRvIGZpbGVuYW1lLWJhc2VkIHRpdGxlXG5cdFx0cmV0dXJuIHRoaXMuZ2V0RmFsbGJhY2tUaXRsZSgpO1xuXHR9XG5cblx0Z2V0Q3VycmVudFRpdGxlKCk6IHN0cmluZyB7XG5cdFx0aWYgKCF0aGlzLmZpbGUpIHtcblx0XHRcdHJldHVybiBcIlwiO1xuXHRcdH1cblxuXHRcdGNvbnN0IHRpdGxlS2V5ID0gdGhpcy5maWxlT3BzLmdldFRpdGxlS2V5KHRoaXMudHlwZSk7XG5cdFx0Y29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh0aGlzLmZpbGUpO1xuXG5cdFx0aWYgKGNhY2hlPy5mcm9udG1hdHRlciAmJiB0aXRsZUtleSBpbiBjYWNoZS5mcm9udG1hdHRlcikge1xuXHRcdFx0Y29uc3QgdGl0bGVWYWx1ZSA9IGNhY2hlLmZyb250bWF0dGVyW3RpdGxlS2V5XSBhcyB1bmtub3duO1xuXHRcdFx0aWYgKHR5cGVvZiB0aXRsZVZhbHVlID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRyZXR1cm4gdGl0bGVWYWx1ZTtcblx0XHRcdH1cblx0XHRcdGlmIChBcnJheS5pc0FycmF5KHRpdGxlVmFsdWUpICYmIHRpdGxlVmFsdWUubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRjb25zdCBmaXJzdFZhbHVlID0gdGl0bGVWYWx1ZVswXSBhcyB1bmtub3duO1xuXHRcdFx0XHRpZiAodHlwZW9mIGZpcnN0VmFsdWUgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZpcnN0VmFsdWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGZpcnN0VmFsdWUgIT0gbnVsbCkge1xuXHRcdFx0XHRcdGlmICh0eXBlb2YgZmlyc3RWYWx1ZSA9PT0gJ251bWJlcicgfHwgdHlwZW9mIGZpcnN0VmFsdWUgPT09ICdib29sZWFuJykge1xuXHRcdFx0XHRcdFx0cmV0dXJuIFN0cmluZyhmaXJzdFZhbHVlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKHR5cGVvZiBmaXJzdFZhbHVlID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGZpcnN0VmFsdWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRpZiAodGl0bGVWYWx1ZSA9PSBudWxsKSB7XG5cdFx0XHRcdHJldHVybiAnJztcblx0XHRcdH1cblx0XHRcdGlmICh0eXBlb2YgdGl0bGVWYWx1ZSA9PT0gJ251bWJlcicgfHwgdHlwZW9mIHRpdGxlVmFsdWUgPT09ICdib29sZWFuJykge1xuXHRcdFx0XHRyZXR1cm4gU3RyaW5nKHRpdGxlVmFsdWUpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHR5cGVvZiB0aXRsZVZhbHVlID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRyZXR1cm4gdGl0bGVWYWx1ZTtcblx0XHRcdH1cblx0XHRcdHJldHVybiAnJztcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMuZ2V0RmFsbGJhY2tUaXRsZSgpO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRGYWxsYmFja1RpdGxlKCk6IHN0cmluZyB7XG5cdFx0aWYgKCF0aGlzLmZpbGUpIHtcblx0XHRcdHJldHVybiBcIlwiO1xuXHRcdH1cblxuXHRcdGxldCBiYXNlbmFtZSA9IHRoaXMuZmlsZS5iYXNlbmFtZTtcblx0XHRpZiAodGhpcy5maWxlLnBhcmVudCAmJiB0aGlzLnR5cGUgIT09IFwibm90ZVwiKSB7XG5cdFx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMuZmlsZU9wcy5nZXRDb250ZW50VHlwZSh0aGlzLnR5cGUpO1xuXHRcdFx0Y29uc3QgaW5kZXhGaWxlTmFtZSA9IGNvbnRlbnRUeXBlPy5pbmRleEZpbGVOYW1lIHx8IFwiXCI7XG5cdFx0XHRpZiAoaW5kZXhGaWxlTmFtZS50cmltKCkgIT09IFwiXCIgJiYgYmFzZW5hbWUgPT09IGluZGV4RmlsZU5hbWUpIHtcblx0XHRcdFx0YmFzZW5hbWUgPSB0aGlzLmZpbGUucGFyZW50Lm5hbWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmIChiYXNlbmFtZS5zdGFydHNXaXRoKFwiX1wiKSkge1xuXHRcdFx0YmFzZW5hbWUgPSBiYXNlbmFtZS5zbGljZSgxKTtcblx0XHR9XG5cdFx0cmV0dXJuIGJhc2VuYW1lLnJlcGxhY2UoLy0vZywgXCIgXCIpLnNwbGl0KFwiIFwiKS5tYXAod29yZCA9PiB3b3JkLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgd29yZC5zbGljZSgxKSkuam9pbihcIiBcIik7XG5cdH1cblxuXHQvKipcblx0ICogRXh0cmFjdHMgYSBzdWdnZXN0ZWQgdGl0bGUgZnJvbSB0aGUgZmlsZSBiYXNlbmFtZSBmb3IgbmV3bHkgY3JlYXRlZCBmaWxlcy5cblx0ICogVGhpcyBpcyB1c2VkIHdoZW4gYSBmaWxlIGlzIGNyZWF0ZWQgZnJvbSBhIGxpbmsgKGUuZy4sIFtbc0Vmc2xlaWZdXSkuXG5cdCAqIFByZXNlcnZlcyB0aGUgb3JpZ2luYWwgdGV4dCBhcyBtdWNoIGFzIHBvc3NpYmxlLlxuXHQgKi9cblx0Z2V0U3VnZ2VzdGVkVGl0bGVGcm9tQmFzZW5hbWUoKTogc3RyaW5nIHtcblx0XHRpZiAoIXRoaXMuZmlsZSkge1xuXHRcdFx0cmV0dXJuIFwiXCI7XG5cdFx0fVxuXG5cdFx0bGV0IGJhc2VuYW1lID0gdGhpcy5maWxlLmJhc2VuYW1lO1xuXG5cdFx0Ly8gSGFuZGxlIGluZGV4IGZpbGUgbmFtZXMgLSB1c2UgcGFyZW50IGZvbGRlciBuYW1lIGluc3RlYWRcblx0XHRpZiAodGhpcy5maWxlLnBhcmVudCAmJiB0aGlzLnR5cGUgIT09IFwibm90ZVwiKSB7XG5cdFx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMuZmlsZU9wcy5nZXRDb250ZW50VHlwZSh0aGlzLnR5cGUpO1xuXHRcdFx0Y29uc3QgaW5kZXhGaWxlTmFtZSA9IGNvbnRlbnRUeXBlPy5pbmRleEZpbGVOYW1lIHx8IFwiXCI7XG5cdFx0XHRpZiAoaW5kZXhGaWxlTmFtZS50cmltKCkgIT09IFwiXCIgJiYgYmFzZW5hbWUgPT09IGluZGV4RmlsZU5hbWUpIHtcblx0XHRcdFx0YmFzZW5hbWUgPSB0aGlzLmZpbGUucGFyZW50Lm5hbWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gUmVtb3ZlIGxlYWRpbmcgdW5kZXJzY29yZSBpZiBwcmVzZW50XG5cdFx0aWYgKGJhc2VuYW1lLnN0YXJ0c1dpdGgoXCJfXCIpKSB7XG5cdFx0XHRiYXNlbmFtZSA9IGJhc2VuYW1lLnNsaWNlKDEpO1xuXHRcdH1cblxuXHRcdC8vIFJldHVybiB0aGUgYmFzZW5hbWUgYXMtaXMgdG8gcHJlc2VydmUgdXNlcidzIG9yaWdpbmFsIGlucHV0XG5cdFx0Ly8gKGUuZy4sIFwic0Vmc2xlaWZcIiBzdGF5cyBhcyBcInNFZnNsZWlmXCIpXG5cdFx0cmV0dXJuIGJhc2VuYW1lO1xuXHR9XG5cblx0b25PcGVuKCkge1xuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xuXG5cdFx0Ly8gQWRkIG1vYmlsZS1mcmllbmRseSBwb3NpdGlvbmluZyBjbGFzcyAtIGNoZWNrIGJvdGggd2lkdGggYW5kIHBsYXRmb3JtXG5cdFx0Y29uc3QgaXNNb2JpbGUgPSB3aW5kb3cuaW5uZXJXaWR0aCA8PSA3NjggfHwgUGxhdGZvcm0uaXNNb2JpbGU7XG5cdFx0aWYgKGlzTW9iaWxlKSB7XG5cdFx0XHR0aGlzLm1vZGFsRWwuYWRkQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLW1vYmlsZS1tb2RhbCcpO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLmlzUmVuYW1lKSB7XG5cdFx0XHRjb25zdCB0eXBlTmFtZSA9IHRoaXMuZ2V0VHlwZURpc3BsYXlOYW1lKCk7XG5cblx0XHRcdGlmICh0aGlzLnR5cGUgPT09IFwibm90ZVwiKSB7XG5cdFx0XHRcdC8vIEZvciBnZW5lcmljIG5vdGVzIG91dHNpZGUgb2YgYW55IGtub3duIGNvbnRlbnQgdHlwZVxuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiUmVuYW1lIGNvbnRlbnRcIiB9KTtcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IFwiRW50ZXIgYSB0aXRsZSBmb3IgdGhpcyBjb250ZW50OlwiIH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBgUmVuYW1lICR7dHlwZU5hbWV9IGNvbnRlbnRgIH0pO1xuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogYEVudGVyIG5ldyB0aXRsZSBmb3IgeW91ciAke3R5cGVOYW1lfSBjb250ZW50OmAgfSk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMudGl0bGVJbnB1dCA9IGNvbnRlbnRFbC5jcmVhdGVFbChcImlucHV0XCIsIHtcblx0XHRcdFx0dHlwZTogXCJ0ZXh0XCIsXG5cdFx0XHRcdHBsYWNlaG9sZGVyOiBcIk5ldyBUaXRsZVwiLFxuXHRcdFx0XHRjbHM6IFwiYXN0cm8tY29tcG9zZXItdGl0bGUtaW5wdXRcIlxuXHRcdFx0fSk7XG5cblx0XHRcdC8vIEFzeW5jIGxvYWQgdGhlIGN1cnJlbnQgdGl0bGUgZnJvbSBmaWxlXG5cdFx0XHR2b2lkIHRoaXMuZ2V0Q3VycmVudFRpdGxlQXN5bmMoKS50aGVuKHRpdGxlID0+IHtcblx0XHRcdFx0dGhpcy50aXRsZUlucHV0LnZhbHVlID0gdGl0bGU7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2UgaWYgKHRoaXMuaXNOZXdOb3RlKSB7XG5cdFx0XHRjb25zdCB0eXBlTmFtZSA9IHRoaXMuZ2V0VHlwZURpc3BsYXlOYW1lKCk7XG5cblx0XHRcdGlmICh0aGlzLnR5cGUgPT09IFwibm90ZVwiKSB7XG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogXCJOZXcgY29udGVudFwiIH0pO1xuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJFbnRlciBhIHRpdGxlIGZvciB0aGlzIGNvbnRlbnQ6XCIgfSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IGBDcmVhdGUgbmV3ICR7dHlwZU5hbWV9IGNvbnRlbnRgIH0pO1xuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogYEVudGVyIGEgdGl0bGUgZm9yIHlvdXIgbmV3ICR7dHlwZU5hbWV9IGNvbnRlbnQ6YCB9KTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy50aXRsZUlucHV0ID0gY29udGVudEVsLmNyZWF0ZUVsKFwiaW5wdXRcIiwge1xuXHRcdFx0XHR0eXBlOiBcInRleHRcIixcblx0XHRcdFx0cGxhY2Vob2xkZXI6IFwiTmV3IFRpdGxlXCIsXG5cdFx0XHRcdGNsczogXCJhc3Ryby1jb21wb3Nlci10aXRsZS1pbnB1dFwiXG5cdFx0XHR9KTtcblx0XHRcdC8vIExlYXZlIGlucHV0IGVtcHR5IGZvciBuZXcgbm90ZXMgLSB1c2VyIGNhbiB0eXBlIGRpcmVjdGx5XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnN0IHR5cGVOYW1lID0gdGhpcy5nZXRUeXBlRGlzcGxheU5hbWUoKTtcblxuXHRcdFx0aWYgKHRoaXMudHlwZSA9PT0gXCJub3RlXCIpIHtcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBcIk5ldyBjb250ZW50XCIgfSk7XG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiBcIkVudGVyIGEgdGl0bGUgZm9yIHRoaXMgY29udGVudDpcIiB9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogYENyZWF0ZSBuZXcgJHt0eXBlTmFtZX0gY29udGVudGAgfSk7XG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiBgRW50ZXIgYSB0aXRsZSBmb3IgeW91ciBuZXcgJHt0eXBlTmFtZX0gY29udGVudDpgIH0pO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLnRpdGxlSW5wdXQgPSBjb250ZW50RWwuY3JlYXRlRWwoXCJpbnB1dFwiLCB7XG5cdFx0XHRcdHR5cGU6IFwidGV4dFwiLFxuXHRcdFx0XHRwbGFjZWhvbGRlcjogXCJOZXcgVGl0bGVcIixcblx0XHRcdFx0Y2xzOiBcImFzdHJvLWNvbXBvc2VyLXRpdGxlLWlucHV0XCJcblx0XHRcdH0pO1xuXHRcdFx0Ly8gUHJlLXBvcHVsYXRlIHdpdGggc3VnZ2VzdGVkIHRpdGxlIGZyb20gYmFzZW5hbWUgaWYgYXZhaWxhYmxlXG5cdFx0XHQvLyBUaGlzIGhhbmRsZXMgZmlsZXMgY3JlYXRlZCBmcm9tIGxpbmtzIChlLmcuLCBbW3NFZnNsZWlmXV0pXG5cdFx0XHRpZiAodGhpcy5maWxlKSB7XG5cdFx0XHRcdGNvbnN0IHN1Z2dlc3RlZFRpdGxlID0gdGhpcy5nZXRTdWdnZXN0ZWRUaXRsZUZyb21CYXNlbmFtZSgpO1xuXHRcdFx0XHRpZiAoc3VnZ2VzdGVkVGl0bGUpIHtcblx0XHRcdFx0XHR0aGlzLnRpdGxlSW5wdXQudmFsdWUgPSBzdWdnZXN0ZWRUaXRsZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHR0aGlzLnRpdGxlSW5wdXQuZm9jdXMoKTtcblx0XHQvLyBGb3IgbmV3IG5vdGVzLCBlbnN1cmUgY3Vyc29yIGlzIGF0IHRoZSBzdGFydCAocG9zaXRpb24gMClcblx0XHRpZiAodGhpcy5pc05ld05vdGUpIHtcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnRpdGxlSW5wdXQuc2V0U2VsZWN0aW9uUmFuZ2UoMCwgMCk7XG5cdFx0XHR9LCAwKTtcblx0XHR9XG5cblx0XHRjb25zdCBidXR0b25Db250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImFzdHJvLWNvbXBvc2VyLWJ1dHRvbi1jb250YWluZXJcIiB9KTtcblxuXHRcdGNvbnN0IGNhbmNlbEJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IFwiQ2FuY2VsXCIsIGNsczogXCJhc3Ryby1jb21wb3Nlci1jYW5jZWwtYnV0dG9uXCIgfSk7XG5cdFx0Y2FuY2VsQnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB0aGlzLmNsb3NlKCk7XG5cblx0XHRjb25zdCBzdWJtaXRCdXR0b24gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwgeyB0ZXh0OiB0aGlzLmlzUmVuYW1lID8gXCJSZW5hbWVcIiA6IFwiQ3JlYXRlXCIsIGNsczogW1wiYXN0cm8tY29tcG9zZXItY3JlYXRlLWJ1dHRvblwiLCBcIm1vZC1jdGFcIl0gfSk7XG5cdFx0c3VibWl0QnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB0aGlzLnN1Ym1pdCgpO1xuXG5cdFx0dGhpcy50aXRsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlwcmVzc1wiLCAoZSkgPT4ge1xuXHRcdFx0aWYgKGUua2V5ID09PSBcIkVudGVyXCIpIHZvaWQgdGhpcy5zdWJtaXQoKTtcblx0XHR9KTtcblx0fVxuXG5cdGFzeW5jIHN1Ym1pdCgpIHtcblx0XHRjb25zdCB0aXRsZSA9IHRoaXMudGl0bGVJbnB1dC52YWx1ZS50cmltKCk7XG5cblx0XHRpZiAoIXRpdGxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKFwiUGxlYXNlIGVudGVyIGEgdGl0bGUuXCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRsZXQgbmV3RmlsZTogVEZpbGUgfCBudWxsID0gbnVsbDtcblx0XHRcdGlmICh0aGlzLmlzUmVuYW1lKSB7XG5cdFx0XHRcdG5ld0ZpbGUgPSBhd2FpdCB0aGlzLmZpbGVPcHMucmVuYW1lRmlsZSh7IGZpbGU6IHRoaXMuZmlsZSEsIHRpdGxlLCB0eXBlOiB0aGlzLnR5cGUgfSk7XG5cblx0XHRcdFx0aWYgKG5ld0ZpbGUpIHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnRlbXBsYXRlUGFyc2VyLnVwZGF0ZVRpdGxlSW5Gcm9udG1hdHRlcihuZXdGaWxlLCB0aXRsZSwgdGhpcy50eXBlKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyByZW5hbWVGaWxlIGFscmVhZHkgc2hvd2VkIGFuIGVycm9yIG5vdGljZSwgY2xvc2UgbW9kYWwgYW5kIHJldHVyblxuXHRcdFx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAodGhpcy5pc05ld05vdGUpIHtcblx0XHRcdFx0Ly8gUHJvY2VzcyB0aGUgXCJVbnRpdGxlZFwiIGZpbGUgLSByZW5hbWUgaXQgYW5kIGFkZCBwcm9wZXJ0aWVzXG5cdFx0XHRcdC8vIFRoaXMgcmVzcGVjdHMgY3JlYXRpb25Nb2RlIChmb2xkZXIgdnMgZmlsZSkgYW5kIGRvZXNuJ3QgcmVxdWlyZSBkZWxldGlvblxuXHRcdFx0XHRpZiAodGhpcy5maWxlKSB7XG5cdFx0XHRcdFx0bmV3RmlsZSA9IGF3YWl0IHRoaXMuZmlsZU9wcy5jcmVhdGVGaWxlKHsgZmlsZTogdGhpcy5maWxlLCB0aXRsZSwgdHlwZTogdGhpcy50eXBlIH0pO1xuXHRcdFx0XHRcdC8vIEFsd2F5cyBpbnNlcnQgcHJvcGVydGllcyB3aGVuIGF1dG9JbnNlcnRQcm9wZXJ0aWVzIGlzIGVuYWJsZWRcblx0XHRcdFx0XHRjb25zdCBzaG91bGRJbnNlcnRQcm9wZXJ0aWVzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuYXV0b0luc2VydFByb3BlcnRpZXM7XG5cblx0XHRcdFx0XHRpZiAobmV3RmlsZSAmJiBzaG91bGRJbnNlcnRQcm9wZXJ0aWVzKSB7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLmFkZFByb3BlcnRpZXNUb0ZpbGUobmV3RmlsZSwgdGl0bGUsIHRoaXMudHlwZSk7XG5cdFx0XHRcdFx0XHQvLyBQb3NpdGlvbiBjdXJzb3IgYXQgZW5kIGFmdGVyIHByb3BlcnRpZXMgYXJlIGFkZGVkXG5cdFx0XHRcdFx0XHR0aGlzLnBvc2l0aW9uQ3Vyc29yQXRFbmQobmV3RmlsZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMuZmlsZSkge1xuXHRcdFx0XHQvLyBXZSBoYXZlIGFuIGV4aXN0aW5nIGZpbGUsIHByb2Nlc3MgaXRcblx0XHRcdFx0bmV3RmlsZSA9IGF3YWl0IHRoaXMuZmlsZU9wcy5jcmVhdGVGaWxlKHsgZmlsZTogdGhpcy5maWxlLCB0aXRsZSwgdHlwZTogdGhpcy50eXBlIH0pO1xuXHRcdFx0XHQvLyBBbHdheXMgaW5zZXJ0IHByb3BlcnRpZXMgd2hlbiBhdXRvSW5zZXJ0UHJvcGVydGllcyBpcyBlbmFibGVkXG5cdFx0XHRcdGNvbnN0IHNob3VsZEluc2VydFByb3BlcnRpZXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvSW5zZXJ0UHJvcGVydGllcztcblxuXHRcdFx0XHRpZiAobmV3RmlsZSAmJiBzaG91bGRJbnNlcnRQcm9wZXJ0aWVzKSB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5hZGRQcm9wZXJ0aWVzVG9GaWxlKG5ld0ZpbGUsIHRpdGxlLCB0aGlzLnR5cGUpO1xuXHRcdFx0XHRcdC8vIFBvc2l0aW9uIGN1cnNvciBhdCBlbmQgYWZ0ZXIgcHJvcGVydGllcyBhcmUgYWRkZWRcblx0XHRcdFx0XHR0aGlzLnBvc2l0aW9uQ3Vyc29yQXRFbmQobmV3RmlsZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZhbGxiYWNrIC0gY3JlYXRlIG5ldyBmaWxlXG5cdFx0XHRcdG5ld0ZpbGUgPSBhd2FpdCB0aGlzLmNyZWF0ZU5ld0ZpbGUodGl0bGUpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIW5ld0ZpbGUpIHtcblx0XHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvICR7dGhpcy5pc1JlbmFtZSA/IFwicmVuYW1lXCIgOiBcImNyZWF0ZVwifSAke3RoaXMudHlwZX0uYCk7XG5cdFx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKCdUaXRsZU1vZGFsOiBFcnJvciBkdXJpbmcgcHJvY2VzczonLCBlcnJvcik7XG5cdFx0XHRjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XG5cdFx0XHRuZXcgTm90aWNlKGBFcnJvciAke3RoaXMuaXNSZW5hbWUgPyBcInJlbmFtaW5nXCIgOiBcImNyZWF0aW5nXCJ9ICR7dGhpcy50eXBlfTogJHtlcnJvck1lc3NhZ2V9LmApO1xuXHRcdFx0dGhpcy5jbG9zZSgpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMuY2xvc2UoKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0VHlwZURpc3BsYXlOYW1lKCk6IHN0cmluZyB7XG5cdFx0aWYgKHRoaXMudHlwZSA9PT0gXCJub3RlXCIpIHtcblx0XHRcdHJldHVybiBcIkNvbnRlbnRcIjtcblx0XHR9XG5cdFx0Y29uc3QgY29udGVudFR5cGUgPSB0aGlzLmZpbGVPcHMuZ2V0Q29udGVudFR5cGUodGhpcy50eXBlKTtcblx0XHRyZXR1cm4gY29udGVudFR5cGUgPyBjb250ZW50VHlwZS5uYW1lIDogXCJDb250ZW50XCI7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGNyZWF0ZU5ld0ZpbGUodGl0bGU6IHN0cmluZyk6IFByb21pc2U8VEZpbGUgfCBudWxsPiB7XG5cdFx0Ly8gRGV0ZXJtaW5lIHRoZSBhcHByb3ByaWF0ZSBmb2xkZXIgYmFzZWQgb24gd2hlcmUgdGhlIHVzZXIgY3JlYXRlZCB0aGUgZmlsZVxuXHRcdGxldCB0YXJnZXRGb2xkZXI6IHN0cmluZztcblxuXHRcdC8vIEdldCB0aGUgZGlyZWN0b3J5IHdoZXJlIHRoZSB1c2VyIGNyZWF0ZWQgdGhlIGZpbGVcblx0XHRjb25zdCBvcmlnaW5hbERpciA9IHRoaXMuZmlsZT8ucGFyZW50Py5wYXRoIHx8IFwiXCI7XG5cblx0XHRpZiAodGhpcy50eXBlICE9PSBcIm5vdGVcIikge1xuXHRcdFx0Y29uc3QgY29udGVudFR5cGUgPSB0aGlzLmZpbGVPcHMuZ2V0Q29udGVudFR5cGUodGhpcy50eXBlKTtcblx0XHRcdC8vIEZvciBjb250ZW50IHR5cGVzLCByZXNwZWN0IHRoZSB1c2VyJ3MgY2hvc2VuIGxvY2F0aW9uIChzdWJmb2xkZXIpXG5cdFx0XHQvLyBPbmx5IHVzZSB0aGUgY29uZmlndXJlZCBmb2xkZXIgaWYgdGhlIHVzZXIgY3JlYXRlZCB0aGUgZmlsZSBpbiB0aGUgdmF1bHQgcm9vdFxuXHRcdFx0aWYgKG9yaWdpbmFsRGlyID09PSBcIlwiIHx8IG9yaWdpbmFsRGlyID09PSBcIi9cIikge1xuXHRcdFx0XHR0YXJnZXRGb2xkZXIgPSBjb250ZW50VHlwZT8uZm9sZGVyIHx8IFwiXCI7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0YXJnZXRGb2xkZXIgPSBvcmlnaW5hbERpcjtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gRm9yIG5vdGVzLCB1c2UgdGhlIG9yaWdpbmFsIGRpcmVjdG9yeVxuXHRcdFx0dGFyZ2V0Rm9sZGVyID0gb3JpZ2luYWxEaXI7XG5cdFx0fVxuXG5cdFx0Ly8gQ3JlYXRlIHRoZSBmaWxlbmFtZSBmcm9tIHRoZSB0aXRsZVxuXHRcdGNvbnN0IGZpbGVuYW1lID0gdGhpcy5maWxlT3BzLmdlbmVyYXRlRmlsZW5hbWUodGl0bGUpO1xuXHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gdGhpcy5maWxlT3BzLmdldENvbnRlbnRUeXBlKHRoaXMudHlwZSk7XG5cdFx0Y29uc3QgZXh0ZW5zaW9uID0gY29udGVudFR5cGU/LnVzZU1keEV4dGVuc2lvbiA/IFwiLm1keFwiIDogXCIubWRcIjtcblx0XHRjb25zdCBmaWxlUGF0aCA9IHRhcmdldEZvbGRlciA/IGAke3RhcmdldEZvbGRlcn0vJHtmaWxlbmFtZX0ke2V4dGVuc2lvbn1gIDogYCR7ZmlsZW5hbWV9JHtleHRlbnNpb259YDtcblxuXHRcdC8vIFRyYWNrIHRoYXQgdGhpcyBmaWxlIHdpbGwgYmUgY3JlYXRlZCBieSB0aGUgcGx1Z2luIEJFRk9SRSBjcmVhdGluZyBpdFxuXHRcdC8vIFRoaXMgcHJldmVudHMgdGhlIGNyZWF0ZSBldmVudCBmcm9tIHRyaWdnZXJpbmcgYW5vdGhlciBtb2RhbFxuXHRcdGlmICh0aGlzLnBsdWdpbikge1xuXHRcdFx0dGhpcy5wbHVnaW4ucGx1Z2luQ3JlYXRlZEZpbGVzLnNldChmaWxlUGF0aCwgRGF0ZS5ub3coKSk7XG5cdFx0fVxuXG5cdFx0Ly8gQ3JlYXRlIHRoZSBmaWxlIHdpdGggaW5pdGlhbCBjb250ZW50XG5cdFx0bGV0IGluaXRpYWxDb250ZW50ID0gXCJcIjtcblx0XHQvLyBBbHdheXMgaW5zZXJ0IHByb3BlcnRpZXMgd2hlbiBhdXRvSW5zZXJ0UHJvcGVydGllcyBpcyBlbmFibGVkXG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9JbnNlcnRQcm9wZXJ0aWVzKSB7XG5cdFx0XHRpbml0aWFsQ29udGVudCA9IHRoaXMuZ2VuZXJhdGVJbml0aWFsQ29udGVudCh0aXRsZSk7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IG5ld0ZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoZmlsZVBhdGgsIGluaXRpYWxDb250ZW50KTtcblxuXHRcdFx0Ly8gT3BlbiB0aGUgbmV3IGZpbGVcblx0XHRcdGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpO1xuXHRcdFx0YXdhaXQgbGVhZi5vcGVuRmlsZShuZXdGaWxlKTtcblxuXHRcdFx0Ly8gUG9zaXRpb24gY3Vyc29yIGF0IHRoZSBlbmQgb2YgY29udGVudCBhZnRlciBlZGl0b3IgaXMgcmVhZHlcblx0XHRcdC8vIFVzZSBtdWx0aXBsZSBhdHRlbXB0cyB0byBlbnN1cmUgaXQgd29ya3MgZXZlbiBpZiBlZGl0b3IgaXNuJ3QgcmVhZHkgaW1tZWRpYXRlbHlcblx0XHRcdGNvbnN0IHBvc2l0aW9uQ3Vyc29yID0gKCkgPT4ge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gbGVhZi52aWV3O1xuXHRcdFx0XHRpZiAodmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldyAmJiB2aWV3LmVkaXRvcikge1xuXHRcdFx0XHRcdGNvbnN0IGVkaXRvciA9IHZpZXcuZWRpdG9yO1xuXHRcdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcblx0XHRcdFx0XHRpZiAoY29udGVudCkge1xuXHRcdFx0XHRcdFx0Y29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0XHRcdGNvbnN0IGxhc3RMaW5lID0gbGluZXMubGVuZ3RoIC0gMTtcblx0XHRcdFx0XHRcdGNvbnN0IGxhc3RMaW5lTGVuZ3RoID0gbGluZXNbbGFzdExpbmVdPy5sZW5ndGggfHwgMDtcblx0XHRcdFx0XHRcdGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiBsYXN0TGluZSwgY2g6IGxhc3RMaW5lTGVuZ3RoIH0pO1xuXHRcdFx0XHRcdFx0Ly8gRm9jdXMgdGhlIGVkaXRvciB0byBlbnN1cmUgY3Vyc29yIGlzIHZpc2libGUgYW5kIGZpbGVuYW1lIGlzbid0IHNlbGVjdGVkXG5cdFx0XHRcdFx0XHRlZGl0b3IuZm9jdXMoKTtcblx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9O1xuXG5cdFx0XHQvLyBUcnkgaW1tZWRpYXRlbHlcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRpZiAoIXBvc2l0aW9uQ3Vyc29yKCkpIHtcblx0XHRcdFx0XHQvLyBJZiBpdCBkaWRuJ3Qgd29yaywgdHJ5IGFnYWluIGFmdGVyIGEgbG9uZ2VyIGRlbGF5XG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHRwb3NpdGlvbkN1cnNvcigpO1xuXHRcdFx0XHRcdH0sIDIwMCk7XG5cdFx0XHRcdH1cblx0XHRcdH0sIDEwMCk7XG5cblx0XHRcdHJldHVybiBuZXdGaWxlO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBjcmVhdGUgZmlsZTogJHtlcnJvck1lc3NhZ2V9YCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBnZW5lcmF0ZUluaXRpYWxDb250ZW50KHRpdGxlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG5cdFx0Y29uc3QgZGF0ZVN0cmluZyA9IHdpbmRvdy5tb21lbnQobm93KS5mb3JtYXQodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGF0ZUZvcm1hdCk7XG5cdFx0Y29uc3Qgc2x1ZyA9IHRvS2ViYWJDYXNlKHRpdGxlKTtcblxuXHRcdGxldCB0ZW1wbGF0ZTogc3RyaW5nO1xuXHRcdGlmICh0aGlzLnR5cGUgPT09IFwibm90ZVwiKSB7XG5cdFx0XHQvLyBGb3IgZ2VuZXJpYyBub3RlcywgdXNlIGEgc2ltcGxlIHRlbXBsYXRlXG5cdFx0XHQvLyBQcm9wZXJseSBlc2NhcGUgdGhlIHRpdGxlIGZvciBZQU1MXG5cdFx0XHRjb25zdCBlc2NhcGVkVGl0bGUgPSB0aGlzLmVzY2FwZVlhbWxTdHJpbmcodGl0bGUpO1xuXHRcdFx0dGVtcGxhdGUgPSBgLS0tXFxudGl0bGU6ICR7ZXNjYXBlZFRpdGxlfVxcbmRhdGU6ICR7ZGF0ZVN0cmluZ31cXG4tLS1cXG5gO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMuZmlsZU9wcy5nZXRDb250ZW50VHlwZSh0aGlzLnR5cGUpO1xuXHRcdFx0aWYgKCFjb250ZW50VHlwZSkge1xuXHRcdFx0XHRjb25zdCBlc2NhcGVkVGl0bGUgPSB0aGlzLmVzY2FwZVlhbWxTdHJpbmcodGl0bGUpO1xuXHRcdFx0XHR0ZW1wbGF0ZSA9IGAtLS1cXG50aXRsZTogJHtlc2NhcGVkVGl0bGV9XFxuZGF0ZTogJHtkYXRlU3RyaW5nfVxcbi0tLVxcbmA7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0ZW1wbGF0ZSA9IGNvbnRlbnRUeXBlLnRlbXBsYXRlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZSgvXFx7XFx7dGl0bGVcXH1cXH0vZywgdGl0bGUpO1xuXHRcdHRlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZSgvXFx7XFx7ZGF0ZVxcfVxcfS9nLCBkYXRlU3RyaW5nKTtcblx0XHR0ZW1wbGF0ZSA9IHRlbXBsYXRlLnJlcGxhY2UoL1xce1xce3NsdWdcXH1cXH0vZywgc2x1Zyk7XG5cblx0XHRyZXR1cm4gdGVtcGxhdGU7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGFkZFByb3BlcnRpZXNUb0ZpbGUoZmlsZTogVEZpbGUsIHRpdGxlOiBzdHJpbmcsIHR5cGU6IENvbnRlbnRUeXBlSWQpIHtcblx0XHRjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuXHRcdGNvbnN0IGRhdGVTdHJpbmcgPSB3aW5kb3cubW9tZW50KG5vdykuZm9ybWF0KHRoaXMucGx1Z2luLnNldHRpbmdzLmRhdGVGb3JtYXQpO1xuXHRcdGNvbnN0IHNsdWcgPSB0b0tlYmFiQ2FzZSh0aXRsZSk7XG5cblx0XHRsZXQgdGVtcGxhdGU6IHN0cmluZztcblx0XHRpZiAodHlwZSA9PT0gXCJub3RlXCIpIHtcblx0XHRcdC8vIEZvciBnZW5lcmljIG5vdGVzLCB1c2UgYSBzaW1wbGUgdGVtcGxhdGVcblx0XHRcdC8vIFByb3Blcmx5IGVzY2FwZSB0aGUgdGl0bGUgZm9yIFlBTUxcblx0XHRcdGNvbnN0IGVzY2FwZWRUaXRsZSA9IHRoaXMuZXNjYXBlWWFtbFN0cmluZyh0aXRsZSk7XG5cdFx0XHR0ZW1wbGF0ZSA9IGAtLS1cXG50aXRsZTogJHtlc2NhcGVkVGl0bGV9XFxuZGF0ZTogJHtkYXRlU3RyaW5nfVxcbi0tLVxcbmA7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gdGhpcy5maWxlT3BzLmdldENvbnRlbnRUeXBlKHR5cGUpO1xuXHRcdFx0aWYgKCFjb250ZW50VHlwZSkge1xuXHRcdFx0XHRjb25zdCBlc2NhcGVkVGl0bGUgPSB0aGlzLmVzY2FwZVlhbWxTdHJpbmcodGl0bGUpO1xuXHRcdFx0XHR0ZW1wbGF0ZSA9IGAtLS1cXG50aXRsZTogJHtlc2NhcGVkVGl0bGV9XFxuZGF0ZTogJHtkYXRlU3RyaW5nfVxcbi0tLVxcbmA7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0ZW1wbGF0ZSA9IGNvbnRlbnRUeXBlLnRlbXBsYXRlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZSgvXFx7XFx7dGl0bGVcXH1cXH0vZywgdGl0bGUpO1xuXHRcdHRlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZSgvXFx7XFx7ZGF0ZVxcfVxcfS9nLCBkYXRlU3RyaW5nKTtcblx0XHR0ZW1wbGF0ZSA9IHRlbXBsYXRlLnJlcGxhY2UoL1xce1xce3NsdWdcXH1cXH0vZywgc2x1Zyk7XG5cblx0XHQvLyBFbnN1cmUgbm8gZXh0cmEgbmV3bGluZXMgb3IgLS0tIGFyZSBhZGRlZCBiZXlvbmQgdGhlIHRlbXBsYXRlXG5cdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIHRlbXBsYXRlKTtcblx0fVxuXG5cdHByaXZhdGUgcG9zaXRpb25DdXJzb3JBdEVuZChmaWxlOiBURmlsZSkge1xuXHRcdGNvbnN0IHBvc2l0aW9uQ3Vyc29yID0gKCkgPT4ge1xuXHRcdFx0Y29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdFx0XHRpZiAodmlldyAmJiB2aWV3LmZpbGUgPT09IGZpbGUgJiYgdmlldy5lZGl0b3IpIHtcblx0XHRcdFx0Y29uc3QgZWRpdG9yID0gdmlldy5lZGl0b3I7XG5cdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcblx0XHRcdFx0aWYgKGNvbnRlbnQpIHtcblx0XHRcdFx0XHRjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuXHRcdFx0XHRcdGNvbnN0IGxhc3RMaW5lID0gbGluZXMubGVuZ3RoIC0gMTtcblx0XHRcdFx0XHRjb25zdCBsYXN0TGluZUxlbmd0aCA9IGxpbmVzW2xhc3RMaW5lXT8ubGVuZ3RoIHx8IDA7XG5cdFx0XHRcdFx0ZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGxhc3RMaW5lLCBjaDogbGFzdExpbmVMZW5ndGggfSk7XG5cdFx0XHRcdFx0Ly8gRm9jdXMgdGhlIGVkaXRvciB0byBlbnN1cmUgY3Vyc29yIGlzIHZpc2libGVcblx0XHRcdFx0XHRlZGl0b3IuZm9jdXMoKTtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH07XG5cblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdGlmICghcG9zaXRpb25DdXJzb3IoKSkge1xuXHRcdFx0XHQvLyBJZiBpdCBkaWRuJ3Qgd29yaywgdHJ5IGFnYWluIGFmdGVyIGEgbG9uZ2VyIGRlbGF5XG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdHBvc2l0aW9uQ3Vyc29yKCk7XG5cdFx0XHRcdH0sIDIwMCk7XG5cdFx0XHR9XG5cdFx0fSwgMTAwKTtcblx0fVxuXG5cdHByaXZhdGUgZXNjYXBlWWFtbFN0cmluZyhzdHI6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Ly8gUHJvcGVybHkgZXNjYXBlIFlBTUwgc3RyaW5nIHZhbHVlc1xuXHRcdC8vIFlBTUwgc3RyaW5ncyB3aXRoIHF1b3RlcyBuZWVkIHRvIGJlIHdyYXBwZWQgaW4gc2luZ2xlIHF1b3RlcyBvciBlc2NhcGVkIHByb3Blcmx5XG5cdFx0aWYgKHN0ci5pbmNsdWRlcygnXCInKSB8fCBzdHIuaW5jbHVkZXMoXCInXCIpIHx8IHN0ci5pbmNsdWRlcygnXFxuJykgfHwgc3RyLmluY2x1ZGVzKCdcXFxcJykpIHtcblx0XHRcdC8vIEZvciBzdHJpbmdzIHdpdGggcXVvdGVzLCBuZXdsaW5lcywgb3IgYmFja3NsYXNoZXMsIHVzZSBzaW5nbGUgcXVvdGVzIGFuZCBlc2NhcGUgc2luZ2xlIHF1b3Rlc1xuXHRcdFx0cmV0dXJuIGAnJHtzdHIucmVwbGFjZSgvJy9nLCBcIicnXCIpfSdgO1xuXHRcdH0gZWxzZSBpZiAoc3RyLmluY2x1ZGVzKFwiIFwiKSB8fCBzdHIuaW5jbHVkZXMoXCI6XCIpIHx8IHN0ci5pbmNsdWRlcyhcIiNcIikgfHwgc3RyLmluY2x1ZGVzKFwiQFwiKSkge1xuXHRcdFx0Ly8gRm9yIHN0cmluZ3Mgd2l0aCBzcGFjZXMgb3Igc3BlY2lhbCBZQU1MIGNoYXJhY3RlcnMsIHdyYXAgaW4gZG91YmxlIHF1b3RlcyBhbmQgZXNjYXBlIGRvdWJsZSBxdW90ZXNcblx0XHRcdHJldHVybiBgXCIke3N0ci5yZXBsYWNlKC9cIi9nLCAnXFxcXFwiJyl9XCJgO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBGb3Igc2ltcGxlIHN0cmluZ3MsIG5vIHF1b3RlcyBuZWVkZWRcblx0XHRcdHJldHVybiBzdHI7XG5cdFx0fVxuXHR9XG5cblx0b25DbG9zZSgpIHtcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcblx0fVxufVxuIiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgUGxhdGZvcm0sIHNldEljb24gfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgUGx1Z2luIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IENvbnRlbnRUeXBlLCBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlLCBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgQ29tbWFuZFBpY2tlck1vZGFsIH0gZnJvbSBcIi4vY29tcG9uZW50cy9Db21tYW5kUGlja2VyTW9kYWxcIjtcclxuaW1wb3J0IHsgSWNvblBpY2tlck1vZGFsIH0gZnJvbSBcIi4vY29tcG9uZW50cy9JY29uUGlja2VyTW9kYWxcIjtcclxuaW1wb3J0IHsgQ29uZmlybU1vZGFsIH0gZnJvbSBcIi4vY29tcG9uZW50cy9Db25maXJtTW9kYWxcIjtcclxuaW1wb3J0IHsgY3JlYXRlU2V0dGluZ3NHcm91cCB9IGZyb20gXCIuLi91dGlscy9zZXR0aW5ncy1jb21wYXRcIjtcclxuaW1wb3J0IHsgcmVnaXN0ZXJDb250ZW50VHlwZUNvbW1hbmRzIH0gZnJvbSBcIi4uL2NvbW1hbmRzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQXN0cm9Db21wb3NlclNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuXHRwbHVnaW46IEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2U7XHJcblx0cHVibGljIGljb24gPSAnbHVjaWRlLXBlbmNpbC1saW5lJztcclxuXHRhdXRvUmVuYW1lQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdHBvc3RzRm9sZGVyQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdG9ubHlBdXRvbWF0ZUNvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuXHRjcmVhdGlvbk1vZGVDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0aW5kZXhGaWxlQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdGV4Y2x1ZGVkRGlyc0NvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuXHR1bmRlcnNjb3JlUHJlZml4Q29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdGF1dG9JbnNlcnRDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0cGFnZXNGaWVsZHNDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0cGFnZXNJbmRleEZpbGVDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0cGFnZXNPbmx5QXV0b21hdGVDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0dGVybWluYWxDb21tYW5kQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdGNvbmZpZ0NvbW1hbmRDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0Y3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdHRlcm1pbmFsUmliYm9uVG9nZ2xlOiBTZXR0aW5nIHwgbnVsbCA9IG51bGw7XHJcblx0Y29uZmlnUmliYm9uVG9nZ2xlOiBTZXR0aW5nIHwgbnVsbCA9IG51bGw7XHJcblx0cHJpdmF0ZSB0ZXJtaW5hbFJpYmJvblRvZ2dsZUNvbXBvbmVudDogeyBzZXREaXNhYmxlZDogKGRpc2FibGVkOiBib29sZWFuKSA9PiB2b2lkIH0gfCBudWxsID0gbnVsbDtcclxuXHRwcml2YXRlIGNvbmZpZ1JpYmJvblRvZ2dsZUNvbXBvbmVudDogeyBzZXREaXNhYmxlZDogKGRpc2FibGVkOiBib29sZWFuKSA9PiB2b2lkIH0gfCBudWxsID0gbnVsbDtcclxuXHJcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogUGx1Z2luKSB7XHJcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XHJcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbiBhcyB1bmtub3duIGFzIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2U7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBSZWZyZXNoIGp1c3QgdGhlIGNvbnRlbnQgdHlwZXMgc2VjdGlvblxyXG5cdCAqIE1vcmUgZWZmaWNpZW50IHRoYW4gcmVmcmVzaGluZyB0aGUgZW50aXJlIHNldHRpbmdzIHRhYlxyXG5cdCAqL1xyXG5cdHB1YmxpYyByZWZyZXNoQ29udGVudFR5cGVzKCk6IHZvaWQge1xyXG5cdFx0aWYgKHRoaXMuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyKSB7XHJcblx0XHRcdHRoaXMucmVuZGVyQ3VzdG9tQ29udGVudFR5cGVzKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRkaXNwbGF5KCk6IHZvaWQge1xyXG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcclxuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG5cdFx0Ly8gVXNlIGN1cnJlbnQgcGx1Z2luIHNldHRpbmdzIChhbHJlYWR5IGxvYWRlZCBhbmQgdXAtdG8tZGF0ZSlcclxuXHRcdC8vIEFsd2F5cyByZWFkIGZyZXNoIHNldHRpbmdzIHRvIGVuc3VyZSB3ZSBzaG93IG1pZ3JhdGVkIGNvbnRlbnQgdHlwZXMgaW1tZWRpYXRlbHlcclxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblxyXG5cdFx0Ly8gUmVuZGVyIHRoZSBzZXR0aW5ncyB0YWIgd2l0aCBjdXJyZW50IHNldHRpbmdzXHJcblx0XHQvLyBUaGlzIHdpbGwgc2hvdyBhbGwgY29udGVudCB0eXBlcyBpbmNsdWRpbmcgbmV3bHkgbWlncmF0ZWQgb25lc1xyXG5cdFx0dGhpcy5yZW5kZXJTZXR0aW5nc1RhYihjb250YWluZXJFbCwgc2V0dGluZ3MpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSByZW5kZXJTZXR0aW5nc1RhYihjb250YWluZXJFbDogSFRNTEVsZW1lbnQsIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpOiB2b2lkIHtcclxuXHJcblx0XHQvLyBHbG9iYWwgc2V0dGluZ3MgKGZpcnN0IGdyb3VwIC0gbm8gaGVhZGluZylcclxuXHRcdGNvbnN0IGdlbmVyYWxHcm91cCA9IGNyZWF0ZVNldHRpbmdzR3JvdXAoY29udGFpbmVyRWwsIHVuZGVmaW5lZCwgJ2FzdHJvLWNvbXBvc2VyJyk7XHJcblx0XHRnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoXCJEYXRlIGZvcm1hdFwiKVxyXG5cdFx0XHRcdC8vIERhdGUgZm9ybWF0IGNvZGVzIChNTU1NLCB5eXl5LCBldGMuKSBhcmUgdGVjaG5pY2FsIG5vdGF0aW9uLCBub3QgVUkgdGV4dFxyXG5cdFx0XHRcdC5zZXREZXNjKFwiRm9ybWF0IGZvciB0aGUgZGF0ZSBpbiBwcm9wZXJ0aWVzIChlLmcuLCB5eXl5LW1tLWRkLCBNTU1NIEQsIHl5eXksIHl5eXktbW0tZGQgSEg6bW0pXCIpXHJcblx0XHRcdFx0LmFkZFRleHQoKHRleHQpID0+XHJcblx0XHRcdFx0XHR0ZXh0XHJcblx0XHRcdFx0XHRcdC8vIFwiWVlZWS1NTS1ERFwiIGlzIGEgZGF0ZSBmb3JtYXQgcGxhY2Vob2xkZXIsIG5vdCBVSSB0ZXh0XHJcblx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIllZWVktTU0tRERcIilcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmRhdGVGb3JtYXQpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLmRhdGVGb3JtYXQgPSB2YWx1ZSB8fCBcIllZWVktTU0tRERcIjtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHQpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Z2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdC5zZXROYW1lKFwiRW5hYmxlIGNvcHkgaGVhZGluZyBsaW5rc1wiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiQWRkIHJpZ2h0LWNsaWNrIGNvbnRleHQgbWVudSBvcHRpb24gdG8gY29weSBoZWFkaW5nIGxpbmtzIGluIHZhcmlvdXMgZm9ybWF0cy5cIilcclxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmVuYWJsZUNvcHlIZWFkaW5nTGluaylcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLmVuYWJsZUNvcHlIZWFkaW5nTGluayA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMudXBkYXRlQ29weUhlYWRpbmdGaWVsZHMoKTtcclxuXHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHQpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Z2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdC5zZXROYW1lKFwiRGVmYXVsdCBoZWFkaW5nIGxpbmsgZm9ybWF0XCIpXHJcblx0XHRcdFx0Ly8gXCJBc3Ryb1wiIGlzIGEgcHJvcGVyIG5vdW4gKGZyYW1ld29yayBuYW1lKSBhbmQgc2hvdWxkIGJlIGNhcGl0YWxpemVkXHJcblx0XHRcdFx0LnNldERlc2MoXCJDaG9vc2UgdGhlIGRlZmF1bHQgZm9ybWF0IGZvciBjb3BpZWQgaGVhZGluZyBsaW5rcy4gT2JzaWRpYW4gZm9ybWF0IHJlc3BlY3RzIHlvdXIgT2JzaWRpYW4gc2V0dGluZ3MgZm9yIHdpa2lsaW5rIHZzIG1hcmtkb3duIHByZWZlcmVuY2UuIEFzdHJvIGxpbmsgdXNlcyB5b3VyIGxpbmsgYmFzZSBwYXRoIGZyb20gYWJvdmUgYW5kIGNvbnZlcnRzIHRoZSBoZWFkaW5nIGludG8ga2ViYWItY2FzZSBmb3JtYXQgYXMgYW4gYW5jaG9yIGxpbmtcIilcclxuXHRcdFx0XHQuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PlxyXG5cdFx0XHRcdFx0ZHJvcGRvd25cclxuXHRcdFx0XHRcdFx0LmFkZE9wdGlvbihcIm9ic2lkaWFuXCIsIFwiT2JzaWRpYW4gbGlua1wiKVxyXG5cdFx0XHRcdFx0XHQuYWRkT3B0aW9uKFwiYXN0cm9cIiwgXCJBc3RybyBsaW5rXCIpXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5jb3B5SGVhZGluZ0xpbmtGb3JtYXQpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLmNvcHlIZWFkaW5nTGlua0Zvcm1hdCA9IHZhbHVlIGFzIFwib2JzaWRpYW5cIiB8IFwiYXN0cm9cIjtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHQpO1xyXG5cdFx0XHQvLyBBZGQgY29uZGl0aW9uYWwgdmlzaWJpbGl0eSBjbGFzc2VzIC0ga2VlcCBzZXR0aW5nIGluIGdyb3VwXHJcblx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIHNldHRpbmdzLmVuYWJsZUNvcHlIZWFkaW5nTGluayk7XHJcblx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIXNldHRpbmdzLmVuYWJsZUNvcHlIZWFkaW5nTGluayk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoXCJBZGQgdHJhaWxpbmcgc2xhc2ggdG8gbGlua3NcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIkFkZCB0cmFpbGluZyBzbGFzaGVzIHRvIGFsbCBjb252ZXJ0ZWQgaW50ZXJuYWwgbGlua3MgKGUuZy4sIC9hYm91dC8gaW5zdGVhZCBvZiAvYWJvdXQpLlwiKVxyXG5cdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuXHRcdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuYWRkVHJhaWxpbmdTbGFzaFRvTGlua3MpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5hZGRUcmFpbGluZ1NsYXNoVG9MaW5rcyA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoXCJQcm9jZXNzIGJhY2tncm91bmQgZmlsZSBjaGFuZ2VzXCIpXHJcblx0XHRcdFx0Ly8gVGVjaG5pY2FsIHRlcm1zIGxpa2UgXCJPYnNpZGlhblwiLCBcImdpdFwiIGFyZSBwcm9wZXIgbm91bnMgaW4gdGhpcyBjb250ZXh0XHJcblx0XHRcdFx0LnNldERlc2MoXCJBdXRvbWF0aWNhbGx5IHByb2Nlc3MgbmV3IGZpbGVzIHdoZW4gdGhleSdyZSBjaGFuZ2VkIGluIHRoZSBiYWNrZ3JvdW5kIChieSBHaXQgb3Igb3RoZXIgcGx1Z2lucykuIERpc2FibGUgdG8gcHJldmVudCBtb2RhbCBzcGFtIHdoZW4gZmlsZXMgYXJlIGFscmVhZHkgcHJvY2Vzc2VkIG9uIG90aGVyIGRldmljZXMgZHVyaW5nIGEgc3luYy5cIilcclxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLnByb2Nlc3NCYWNrZ3JvdW5kRmlsZUNoYW5nZXMpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5wcm9jZXNzQmFja2dyb3VuZEZpbGVDaGFuZ2VzID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHQvLyBcIk1EWFwiIGlzIGEgcHJvcGVyIG5vdW4gKGZpbGUgZm9ybWF0KSBhbmQgc2hvdWxkIGJlIGNhcGl0YWxpemVkXHJcblx0XHRcdFx0LnNldE5hbWUoXCJTaG93IE1EWCBmaWxlcyBpbiBmaWxlIGV4cGxvcmVyXCIpXHJcblx0XHRcdFx0LnNldERlc2MoXCJNYWtlIC5tZHggZmlsZXMgdmlzaWJsZSBpbiBPYnNpZGlhbidzIGZpbGUgZXhwbG9yZXIuIFJlcXVpcmVzIHJlbG9hZCB0byB0YWtlIGVmZmVjdC5cIilcclxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLnNob3dNZHhGaWxlc0luRXhwbG9yZXIpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5zaG93TWR4RmlsZXNJbkV4cGxvcmVyID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIFByb3BlcnR5IGF1dG9tYXRpb25cclxuXHRcdGNvbnN0IGF1dG9tYXRpb25Hcm91cCA9IGNyZWF0ZVNldHRpbmdzR3JvdXAoY29udGFpbmVyRWwsIFwiUHJvcGVydHkgYXV0b21hdGlvblwiLCAnYXN0cm8tY29tcG9zZXInKTtcclxuXHJcblx0XHQvLyBBdXRvLWluc2VydCBwcm9wZXJ0aWVzIChtb3ZlZCBmcm9tIGdlbmVyYWxHcm91cClcclxuXHRcdGF1dG9tYXRpb25Hcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHQuc2V0TmFtZShcIkF1dG8taW5zZXJ0IHByb3BlcnRpZXNcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIkF1dG9tYXRpY2FsbHkgaW5zZXJ0IHRoZSBwcm9wZXJ0aWVzIHRlbXBsYXRlIHdoZW4gY3JlYXRpbmcgbmV3IGZpbGVzLlwiKVxyXG5cdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuXHRcdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuYXV0b0luc2VydFByb3BlcnRpZXMpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5hdXRvSW5zZXJ0UHJvcGVydGllcyA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRsZXQgZHJhZnRQcm9wZXJ0eVNldHRpbmc6IFNldHRpbmc7XHJcblx0XHRsZXQgZHJhZnRMb2dpY1NldHRpbmc6IFNldHRpbmc7XHJcblx0XHRsZXQgcHVibGlzaERhdGVGaWVsZFNldHRpbmc6IFNldHRpbmc7XHJcblxyXG5cdFx0YXV0b21hdGlvbkdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdC5zZXROYW1lKFwiVXBkYXRlIGRhdGUgb24gcHVibGlzaFwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiVXBkYXRlICdkYXRlJyBwcm9wZXJ0eSB3aGVuIHN3aXRjaGluZyBmcm9tIGRyYWZ0IHRvIHB1Ymxpc2hlZCBzdGF0dXMuXCIpXHJcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5zeW5jRHJhZnREYXRlKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0c2V0dGluZ3Muc3luY0RyYWZ0RGF0ZSA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHQvLyBGaXggZm9yIGp1bXBpbmc6IHVzZSBpbmRpdmlkdWFsIGNsYXNzLWJhc2VkIHRvZ2dsaW5nXHJcblx0XHRcdFx0XHRcdFx0aWYgKGRyYWZ0UHJvcGVydHlTZXR0aW5nKSBkcmFmdFByb3BlcnR5U2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZSgnYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuJywgIXZhbHVlKTtcclxuXHRcdFx0XHRcdFx0XHRpZiAoZHJhZnRMb2dpY1NldHRpbmcpIGRyYWZ0TG9naWNTZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKCdhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW4nLCAhdmFsdWUpO1xyXG5cdFx0XHRcdFx0XHRcdGlmIChwdWJsaXNoRGF0ZUZpZWxkU2V0dGluZykgcHVibGlzaERhdGVGaWVsZFNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoJ2FzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlbicsICF2YWx1ZSk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGF1dG9tYXRpb25Hcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdGRyYWZ0UHJvcGVydHlTZXR0aW5nID0gc2V0dGluZztcclxuXHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZSgnYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuJywgIXNldHRpbmdzLnN5bmNEcmFmdERhdGUpO1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoXCJEcmFmdCBwcm9wZXJ0eSBuYW1lXCIpXHJcblx0XHRcdFx0LnNldERlc2MoXCJUaGUgcHJvcGVydHkgZmllbGQgdG8gdXNlIGZvciBkcmFmdCBzdGF0dXMuXCIpXHJcblx0XHRcdFx0LmFkZFRleHQoKHRleHQpID0+XHJcblx0XHRcdFx0XHR0ZXh0XHJcblx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcImRyYWZ0XCIpXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5kcmFmdFByb3BlcnR5IHx8IFwiXCIpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLmRyYWZ0UHJvcGVydHkgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHQvLyBSZWZyZXNoIG1hcCB3aXRoIG5ldyBwcm9wZXJ0eVxyXG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmZyb250bWF0dGVyU2VydmljZT8uaW5pdGlhbGl6ZURyYWZ0U3RhdHVzTWFwKCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGF1dG9tYXRpb25Hcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdGRyYWZ0TG9naWNTZXR0aW5nID0gc2V0dGluZztcclxuXHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZSgnYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuJywgIXNldHRpbmdzLnN5bmNEcmFmdERhdGUpO1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoXCJEcmFmdCBsb2dpY1wiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiV2hldGhlciB0aGUgcHJvcGVydHkgdmFsdWUgJ3RydWUnIG1lYW5zIGl0IGlzIGEgZHJhZnQgb3IgcHVibGlzaGVkLlwiKVxyXG5cdFx0XHRcdC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+XHJcblx0XHRcdFx0XHRkcm9wZG93blxyXG5cdFx0XHRcdFx0XHQuYWRkT3B0aW9uKFwidHJ1ZS1pcy1kcmFmdFwiLCBcIlRydWUgPSBEcmFmdFwiKVxyXG5cdFx0XHRcdFx0XHQuYWRkT3B0aW9uKFwiZmFsc2UtaXMtZHJhZnRcIiwgXCJUcnVlID0gUHVibGlzaGVkXCIpXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5kcmFmdExvZ2ljIHx8IFwidHJ1ZS1pcy1kcmFmdFwiKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuZHJhZnRMb2dpYyA9IHZhbHVlIGFzICd0cnVlLWlzLWRyYWZ0JyB8ICdmYWxzZS1pcy1kcmFmdCc7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBtYXAgd2l0aCBuZXcgbG9naWNcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5mcm9udG1hdHRlclNlcnZpY2U/LmluaXRpYWxpemVEcmFmdFN0YXR1c01hcCgpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRhdXRvbWF0aW9uR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRwdWJsaXNoRGF0ZUZpZWxkU2V0dGluZyA9IHNldHRpbmc7XHJcblx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoJ2FzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlbicsICFzZXR0aW5ncy5zeW5jRHJhZnREYXRlKTtcclxuXHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdC5zZXROYW1lKFwiUHVibGlzaGVkIGRhdGUgcHJvcGVydHkgbmFtZVwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiVGhlIHByb3BlcnR5IGZpZWxkIHRvIHVwZGF0ZSB3aGVuIHB1Ymxpc2hlZCAoZS5nLiwgJ2RhdGUnIG9yICdwdWJEYXRlJykuXCIpXHJcblx0XHRcdFx0LmFkZFRleHQoKHRleHQpID0+XHJcblx0XHRcdFx0XHR0ZXh0XHJcblx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcImRhdGVcIilcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLnB1Ymxpc2hEYXRlRmllbGQgfHwgXCJcIilcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0c2V0dGluZ3MucHVibGlzaERhdGVGaWVsZCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRsZXQgbW9kaWZpZWREYXRlRmllbGRTZXR0aW5nOiBTZXR0aW5nO1xyXG5cclxuXHRcdGF1dG9tYXRpb25Hcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHQuc2V0TmFtZShcIlVwZGF0ZSBtb2RpZmllZCBkYXRlXCIpXHJcblx0XHRcdFx0LnNldERlc2MoXCJBdXRvbWF0aWNhbGx5IHVwZGF0ZSBhIHByb3BlcnR5IHdpdGggY3VycmVudCBkYXRlIHdoZW4gYSBmaWxlIGlzIGVkaXRlZC5cIilcclxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLnVwZGF0ZU1vZGlmaWVkRGF0ZSlcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLnVwZGF0ZU1vZGlmaWVkRGF0ZSA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdC8vIEZpeCBmb3IganVtcGluZzogdXNlIENTUyBjbGFzcyBpbnN0ZWFkIG9mIHRoaXMuZGlzcGxheSgpXHJcblx0XHRcdFx0XHRcdFx0aWYgKG1vZGlmaWVkRGF0ZUZpZWxkU2V0dGluZykge1xyXG5cdFx0XHRcdFx0XHRcdFx0bW9kaWZpZWREYXRlRmllbGRTZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKCdhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW4nLCAhdmFsdWUpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHQpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0YXV0b21hdGlvbkdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0bW9kaWZpZWREYXRlRmllbGRTZXR0aW5nID0gc2V0dGluZztcclxuXHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZSgnYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuJywgIXNldHRpbmdzLnVwZGF0ZU1vZGlmaWVkRGF0ZSk7XHJcblx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHQuc2V0TmFtZShcIk1vZGlmaWVkIGRhdGUgcHJvcGVydHkgbmFtZVwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiVGhlIHByb3BlcnR5IGZpZWxkIHRvIHVwZGF0ZSB3aXRoIHRoZSBtb2RpZmllZCBkYXRlLlwiKVxyXG5cdFx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG5cdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCJtb2RpZmllZFwiKVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MubW9kaWZpZWREYXRlRmllbGQgfHwgXCJcIilcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0c2V0dGluZ3MubW9kaWZpZWREYXRlRmllbGQgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHQpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gQ29udGVudCB0eXBlc1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzR3JvdXAgPSBjcmVhdGVTZXR0aW5nc0dyb3VwKGNvbnRhaW5lckVsLCBcIkNvbnRlbnQgdHlwZXNcIiwgJ2FzdHJvLWNvbXBvc2VyJyk7XHJcblxyXG5cdFx0Ly8gQWRkIGNvbnRhaW5lciBhcyBhIHNldHRpbmcgLSBoaWRlIHRoZSBzZXR0aW5nJ3MgZGVmYXVsdCBVSSwgYWRkIG91ciBjb250YWluZXIgaW5zaWRlXHJcblx0XHRjb250ZW50VHlwZXNHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdC8vIEhpZGUgdGhlIHNldHRpbmcncyBkZWZhdWx0IFVJIGVsZW1lbnRzIHVzaW5nIENTUyBjbGFzc2VzXHJcblx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmFkZENsYXNzKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1oaWRkZW4tZWxlbWVudHNcIik7XHJcblx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmFkZENsYXNzKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItZnVsbC13aWR0aFwiKTtcclxuXHRcdFx0Ly8gQWRkIG91ciBjb250YWluZXIgaW5zaWRlIHRoZSBzZXR0aW5nIGVsZW1lbnQgLSBlbnN1cmUgaXQncyB2aXNpYmxlXHJcblx0XHRcdHRoaXMuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyID0gc2V0dGluZy5zZXR0aW5nRWwuY3JlYXRlRGl2KHtcclxuXHRcdFx0XHRjbHM6IFwiY3VzdG9tLWNvbnRlbnQtdHlwZXMtY29udGFpbmVyIGFzdHJvLWNvbXBvc2VyLWN1c3RvbS10eXBlcy1jb250YWluZXItdmlzaWJsZVwiXHJcblx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblx0XHQvLyBSZW5kZXIgY29udGVudCB0eXBlcyBhZnRlciBjb250YWluZXIgaXMgY3JlYXRlZFxyXG5cdFx0aWYgKHRoaXMuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyKSB7XHJcblx0XHRcdHRoaXMucmVuZGVyQ3VzdG9tQ29udGVudFR5cGVzKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gRGV2ZWxvcGVyIGNvbW1hbmRzIChkZXNrdG9wIG9ubHkgLSBub3QgYXZhaWxhYmxlIG9uIG1vYmlsZSlcclxuXHRcdGlmICghUGxhdGZvcm0uaXNNb2JpbGUpIHtcclxuXHRcdFx0Y29uc3QgZGV2ZWxvcGVyR3JvdXAgPSBjcmVhdGVTZXR0aW5nc0dyb3VwKGNvbnRhaW5lckVsLCBcIkRldmVsb3BlciBjb21tYW5kc1wiLCAnYXN0cm8tY29tcG9zZXInKTtcclxuXHJcblx0XHRcdC8vIFRlcm1pbmFsIGNvbW1hbmQgc2V0dGluZ3NcclxuXHRcdFx0ZGV2ZWxvcGVyR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHRcdC5zZXROYW1lKFwiRW5hYmxlIG9wZW4gdGVybWluYWwgY29tbWFuZFwiKVxyXG5cdFx0XHRcdFx0LnNldERlc2MoXCJFbmFibGUgY29tbWFuZCB0byBvcGVuIHRlcm1pbmFsIGluIHByb2plY3Qgcm9vdCBkaXJlY3RvcnkuXCIpXHJcblx0XHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdHNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy51cGRhdGVUZXJtaW5hbENvbW1hbmRGaWVsZHMoKTtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIHJlZ2lzdGVyUmliYm9uSWNvbnMgY2hlY2tzIGJvdGggY29tbWFuZCBhbmQgaWNvbiBzZXR0aW5nc1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gSWYgY29tbWFuZCBpcyBlbmFibGVkIEFORCBpY29uIGlzIGVuYWJsZWQsIGl0IHdpbGwgc2hvdzsgb3RoZXJ3aXNlIGl0IHdpbGwgaGlkZVxyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnJlZ2lzdGVyUmliYm9uSWNvbnMpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJSaWJib25JY29ucygpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0XHQpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIENyZWF0ZSBjb250YWluZXIgZm9yIHRlcm1pbmFsIGNvbW1hbmQgZmllbGRzIC0ga2VlcCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSB3aXRoIHVwZGF0ZSBtZXRob2RzXHJcblx0XHRcdHRoaXMudGVybWluYWxDb21tYW5kQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcInRlcm1pbmFsLWNvbW1hbmQtZmllbGRzXCIgfSk7XHJcblx0XHRcdHRoaXMudGVybWluYWxDb21tYW5kQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIHNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpO1xyXG5cdFx0XHR0aGlzLnRlcm1pbmFsQ29tbWFuZENvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKTtcclxuXHJcblx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0XHRjb25zdCBkZXNjRnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcblx0XHRcdFx0Ly8gVGV4dCBpcyBhbHJlYWR5IGluIHNlbnRlbmNlIGNhc2U7IFwiT2JzaWRpYW5cIiBpcyBhIHByb3BlciBub3VuXHJcblx0XHRcdFx0ZGVzY0ZyYWdtZW50LmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogXCJQYXRoIHJlbGF0aXZlIHRvIHRoZSBPYnNpZGlhbiB2YXVsdCByb290IGZvbGRlci4gVXNlIC4uLy4uIGZvciB0d28gbGV2ZWxzIHVwLiBMZWF2ZSBibGFuayB0byB1c2UgdGhlIHZhdWx0IGZvbGRlclwiIH0pO1xyXG5cdFx0XHRcdGRlc2NGcmFnbWVudC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IFwiVGhpcyBpcyB3aGVyZSB0aGUgdGVybWluYWwgd2lsbCBvcGVuLiBBYnNvbHV0ZSBwYXRocyB3b3JrIGFsc28uXCIgfSk7XHJcblx0XHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdFx0LnNldE5hbWUoXCJQcm9qZWN0IHJvb3QgZGlyZWN0b3J5IHBhdGhcIilcclxuXHRcdFx0XHRcdC5zZXREZXNjKGRlc2NGcmFnbWVudClcclxuXHRcdFx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG5cdFx0XHRcdFx0XHR0ZXh0XHJcblx0XHRcdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKFwiLi4vLi5cIilcclxuXHRcdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MudGVybWluYWxQcm9qZWN0Um9vdFBhdGgpXHJcblx0XHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy50ZXJtaW5hbFByb2plY3RSb290UGF0aCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHRcdCk7XHJcblx0XHRcdFx0Ly8gQWRkIGNsYXNzIGZvciBjb25kaXRpb25hbCB2aXNpYmlsaXR5IC0ga2VlcCBzZXR0aW5nIGluIGdyb3VwXHJcblx0XHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZCk7XHJcblx0XHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0ZGV2ZWxvcGVyR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdGNvbnN0IGRlc2NGcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcclxuXHRcdFx0XHQvLyBUZXh0IGlzIGFscmVhZHkgaW4gc2VudGVuY2UgY2FzZTsgcHJvcGVyIG5vdW5zIG9yIHByb2R1Y3QgbmFtZXMgbGlrZSBcIm1hY09TXCIsIFwiV2luZG93c1wiLCBcIkxpbnV4XCJcclxuXHRcdFx0XHRkZXNjRnJhZ21lbnQuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIkxlYXZlIGJsYW5rIHRvIHVzZSBwbGF0Zm9ybSBkZWZhdWx0cy4gT24gbWFjT1MsIHRoZSBkZWZhdWx0IGlzIFRlcm1pbmFsLiBPbiBXaW5kb3dzLCBpdCdzIFdpbmRvd3MgVGVybWluYWwgKFdpbiAxMSkgb3IgY21kLmV4ZSAoV2luIDEwKS4gT24gTGludXgsIGl0J3MgZ25vbWUtdGVybWluYWwsIGtvbnNvbGUsIG9yIHh0ZXJtXCIgfSk7XHJcblx0XHRcdFx0Ly8gVGV4dCBpcyBhbHJlYWR5IGluIHNlbnRlbmNlIGNhc2U7IHByb3BlciBub3VucyBsaWtlIFwiVGVybWluYWxcIiwgXCJpVGVybVwiLCBcIlBvd2VyU2hlbGxcIlxyXG5cdFx0XHRcdGRlc2NGcmFnbWVudC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IFwiRXhhbXBsZXMgaW5jbHVkZSBUZXJtaW5hbCwgaVRlcm0sIFBvd2VyU2hlbGwsIGFuZCBBbGFjcml0dHlcIiB9KTtcclxuXHRcdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0XHQuc2V0TmFtZShcIlRlcm1pbmFsIGFwcGxpY2F0aW9uIG5hbWVcIilcclxuXHRcdFx0XHRcdC5zZXREZXNjKGRlc2NGcmFnbWVudClcclxuXHRcdFx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG5cdFx0XHRcdFx0XHR0ZXh0XHJcblx0XHRcdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKFwiVGVybWluYWxcIilcclxuXHRcdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MudGVybWluYWxBcHBsaWNhdGlvbk5hbWUpXHJcblx0XHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy50ZXJtaW5hbEFwcGxpY2F0aW9uTmFtZSA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHRcdCk7XHJcblx0XHRcdFx0Ly8gQWRkIGNsYXNzIGZvciBjb25kaXRpb25hbCB2aXNpYmlsaXR5IC0ga2VlcCBzZXR0aW5nIGluIGdyb3VwXHJcblx0XHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZCk7XHJcblx0XHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0ZGV2ZWxvcGVyR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHRcdC5zZXROYW1lKFwiRW5hYmxlIGRlYnVnIGxvZ2dpbmdcIilcclxuXHRcdFx0XHRcdC5zZXREZXNjKFwiTG9nIHRlcm1pbmFsIGxhdW5jaCBjb21tYW5kcyBhbmQgcGxhdGZvcm0gZGVjaXNpb25zIHRvIHRoZSBkZXZlbG9wZXIgY29uc29sZSBmb3IgdHJvdWJsZXNob290aW5nLlwiKVxyXG5cdFx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuZW5hYmxlVGVybWluYWxEZWJ1Z0xvZ2dpbmcpXHJcblx0XHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuZW5hYmxlVGVybWluYWxEZWJ1Z0xvZ2dpbmcgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdC8vIEFkZCBjbGFzcyBmb3IgY29uZGl0aW9uYWwgdmlzaWJpbGl0eSAtIGtlZXAgc2V0dGluZyBpbiBncm91cFxyXG5cdFx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIHNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpO1xyXG5cdFx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIXNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0XHQuc2V0TmFtZShcIlNob3cgb3BlbiB0ZXJtaW5hbCByaWJib24gaWNvblwiKVxyXG5cdFx0XHRcdFx0LnNldERlc2MoXCJBZGQgYSByaWJib24gaWNvbiB0byBsYXVuY2ggdGhlIHRlcm1pbmFsIGNvbW1hbmQuXCIpXHJcblx0XHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHtcclxuXHRcdFx0XHRcdFx0dGhpcy50ZXJtaW5hbFJpYmJvblRvZ2dsZUNvbXBvbmVudCA9IHRvZ2dsZTtcclxuXHRcdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmVuYWJsZVRlcm1pbmFsUmliYm9uSWNvbilcclxuXHRcdFx0XHRcdFx0XHQuc2V0RGlzYWJsZWQoIXNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpXHJcblx0XHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gVXBkYXRlIHNldHRpbmdzIGRpcmVjdGx5IG9uIHBsdWdpbiBpbnN0YW5jZVxyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlVGVybWluYWxSaWJib25JY29uID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5lbmFibGVUZXJtaW5hbFJpYmJvbkljb24gPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gU21hbGwgZGVsYXkgdG8gZW5zdXJlIHNldHRpbmdzIGFyZSBzYXZlZCwgdGhlbiByZS1yZWdpc3RlclxyXG5cdFx0XHRcdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5yZWdpc3RlclJpYmJvbkljb25zKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJSaWJib25JY29ucygpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHR9LCA1MCk7XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHQvLyBBZGQgY2xhc3MgZm9yIGNvbmRpdGlvbmFsIHZpc2liaWxpdHkgLSBrZWVwIHNldHRpbmcgaW4gZ3JvdXBcclxuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKTtcclxuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKTtcclxuXHRcdFx0XHQvLyBTdG9yZSByZWZlcmVuY2UgZm9yIHVwZGF0aW5nIGRpc2FibGVkIHN0YXRlXHJcblx0XHRcdFx0dGhpcy50ZXJtaW5hbFJpYmJvblRvZ2dsZSA9IHNldHRpbmc7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gQ29uZmlnIGZpbGUgY29tbWFuZCBzZXR0aW5nc1xyXG5cdFx0XHRkZXZlbG9wZXJHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdFx0LnNldE5hbWUoXCJFbmFibGUgZWRpdCBjb25maWcgZmlsZSBjb21tYW5kXCIpXHJcblx0XHRcdFx0XHQuc2V0RGVzYyhcIkVuYWJsZSBjb21tYW5kIHRvIG9wZW4gYXN0cm8gY29uZmlnIGZpbGUgaW4gZGVmYXVsdCBlZGl0b3IuXCIpXHJcblx0XHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpXHJcblx0XHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMudXBkYXRlQ29uZmlnQ29tbWFuZEZpZWxkcygpO1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gcmVnaXN0ZXJSaWJib25JY29ucyBjaGVja3MgYm90aCBjb21tYW5kIGFuZCBpY29uIHNldHRpbmdzXHJcblx0XHRcdFx0XHRcdFx0XHQvLyBJZiBjb21tYW5kIGlzIGVuYWJsZWQgQU5EIGljb24gaXMgZW5hYmxlZCwgaXQgd2lsbCBzaG93OyBvdGhlcndpc2UgaXQgd2lsbCBoaWRlXHJcblx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4ucmVnaXN0ZXJSaWJib25JY29ucykge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlclJpYmJvbkljb25zKCk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHRcdCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gQ3JlYXRlIGNvbnRhaW5lciBmb3IgY29uZmlnIGNvbW1hbmQgZmllbGRzIC0ga2VlcCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSB3aXRoIHVwZGF0ZSBtZXRob2RzXHJcblx0XHRcdHRoaXMuY29uZmlnQ29tbWFuZENvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJjb25maWctY29tbWFuZC1maWVsZHNcIiB9KTtcclxuXHRcdFx0dGhpcy5jb25maWdDb21tYW5kQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIHNldHRpbmdzLmVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZCk7XHJcblx0XHRcdHRoaXMuY29uZmlnQ29tbWFuZENvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpO1xyXG5cclxuXHRcdFx0ZGV2ZWxvcGVyR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdGNvbnN0IGRlc2NGcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcclxuXHRcdFx0XHRkZXNjRnJhZ21lbnQuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIlBhdGggdG8gdGhlIGNvbmZpZyBmaWxlIHJlbGF0aXZlIHRvIHRoZSB2YXVsdCByb290LiBVc2UgLi4vY29uZmlnLnRzIG9yIC4uLy4uL2FzdHJvLmNvbmZpZy5tanMuXCIgfSk7XHJcblx0XHRcdFx0ZGVzY0ZyYWdtZW50LmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogXCJBYnNvbHV0ZSBwYXRocyB3b3JrIGFsc28uXCIgfSk7XHJcblx0XHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdFx0LnNldE5hbWUoXCJDb25maWcgZmlsZSBwYXRoXCIpXHJcblx0XHRcdFx0XHQuc2V0RGVzYyhkZXNjRnJhZ21lbnQpXHJcblx0XHRcdFx0XHQuYWRkVGV4dCgodGV4dCkgPT5cclxuXHRcdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIi4uL2NvbmZpZy50c1wiKVxyXG5cdFx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5jb25maWdGaWxlUGF0aClcclxuXHRcdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdHNldHRpbmdzLmNvbmZpZ0ZpbGVQYXRoID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdFx0KTtcclxuXHRcdFx0XHQvLyBBZGQgY2xhc3MgZm9yIGNvbmRpdGlvbmFsIHZpc2liaWxpdHkgLSBrZWVwIHNldHRpbmcgaW4gZ3JvdXBcclxuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpO1xyXG5cdFx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIXNldHRpbmdzLmVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0ZGV2ZWxvcGVyR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHRcdC5zZXROYW1lKFwiU2hvdyBvcGVuIGNvbmZpZyByaWJib24gaWNvblwiKVxyXG5cdFx0XHRcdFx0LnNldERlc2MoXCJBZGQgYSByaWJib24gaWNvbiB0byBsYXVuY2ggdGhlIGNvbmZpZyBmaWxlIGNvbW1hbmQuXCIpXHJcblx0XHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHtcclxuXHRcdFx0XHRcdFx0dGhpcy5jb25maWdSaWJib25Ub2dnbGVDb21wb25lbnQgPSB0b2dnbGU7XHJcblx0XHRcdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5lbmFibGVDb25maWdSaWJib25JY29uKVxyXG5cdFx0XHRcdFx0XHRcdC5zZXREaXNhYmxlZCghc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIFVwZGF0ZSBzZXR0aW5ncyBkaXJlY3RseSBvbiBwbHVnaW4gaW5zdGFuY2VcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUNvbmZpZ1JpYmJvbkljb24gPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdHNldHRpbmdzLmVuYWJsZUNvbmZpZ1JpYmJvbkljb24gPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gU21hbGwgZGVsYXkgdG8gZW5zdXJlIHNldHRpbmdzIGFyZSBzYXZlZCwgdGhlbiByZS1yZWdpc3RlclxyXG5cdFx0XHRcdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5yZWdpc3RlclJpYmJvbkljb25zKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJSaWJib25JY29ucygpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHR9LCA1MCk7XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHQvLyBBZGQgY2xhc3MgZm9yIGNvbmRpdGlvbmFsIHZpc2liaWxpdHkgLSBrZWVwIHNldHRpbmcgaW4gZ3JvdXBcclxuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpO1xyXG5cdFx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIXNldHRpbmdzLmVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZCk7XHJcblx0XHRcdFx0Ly8gU3RvcmUgcmVmZXJlbmNlIGZvciB1cGRhdGluZyBkaXNhYmxlZCBzdGF0ZVxyXG5cdFx0XHRcdHRoaXMuY29uZmlnUmliYm9uVG9nZ2xlID0gc2V0dGluZztcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBIZWxwIGJ1dHRvbiByZXBsYWNlbWVudCB0b2dnbGUgKHBhcnQgb2YgZGV2ZWxvcGVyIGNvbW1hbmRzIGdyb3VwKVxyXG5cdFx0XHRkZXZlbG9wZXJHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdFx0LnNldE5hbWUoJ1N3YXAgb3V0IGhlbHAgYnV0dG9uIGZvciBjdXN0b20gYWN0aW9uJylcclxuXHRcdFx0XHRcdC5zZXREZXNjKCdSZXBsYWNlIHRoZSBoZWxwIGJ1dHRvbiBpbiB0aGUgdmF1bHQgcHJvZmlsZSBhcmVhIHdpdGggYSBjdXN0b20gYWN0aW9uLicpXHJcblx0XHRcdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudD8uZW5hYmxlZCA/PyBmYWxzZSlcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGlmICghc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQgPSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGVuYWJsZWQ6IGZhbHNlLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRjb21tYW5kSWQ6ICdlZGl0LWFzdHJvLWNvbmZpZycsXHJcblx0XHRcdFx0XHRcdFx0XHRcdGljb25JZDogJ3JvY2tldCcsXHJcblx0XHRcdFx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQuZW5hYmxlZCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdC8vIFRyaWdnZXIgaGVscCBidXR0b24gcmVwbGFjZW1lbnQgdXBkYXRlIChpdCB3aWxsIHJlbG9hZCBzZXR0aW5ncylcclxuXHRcdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4udXBkYXRlSGVscEJ1dHRvbikge1xyXG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4udXBkYXRlSGVscEJ1dHRvbigpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHQvLyBSZS1yZW5kZXIgdG8gc2hvdy9oaWRlIG9wdGlvbnNcclxuXHRcdFx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcclxuXHRcdFx0XHRcdFx0fSkpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIFNob3cgY29tbWFuZCBhbmQgaWNvbiBwaWNrZXJzIG9ubHkgaWYgZW5hYmxlZCAocGFydCBvZiBkZXZlbG9wZXIgY29tbWFuZHMgZ3JvdXApXHJcblx0XHRcdGlmIChzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQ/LmVuYWJsZWQpIHtcclxuXHRcdFx0XHQvLyBDb21tYW5kIHBpY2tlclxyXG5cdFx0XHRcdGNvbnN0IGNvbW1hbmROYW1lID0gdGhpcy5nZXRDb21tYW5kTmFtZShzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQuY29tbWFuZElkKTtcclxuXHRcdFx0XHRkZXZlbG9wZXJHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0XHRcdC5zZXROYW1lKCdDb21tYW5kJylcclxuXHRcdFx0XHRcdFx0LnNldERlc2MoJ1NlbGVjdCB0aGUgY29tbWFuZCB0byBleGVjdXRlIHdoZW4gdGhlIGJ1dHRvbiBpcyBjbGlja2VkLicpXHJcblx0XHRcdFx0XHRcdC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxyXG5cdFx0XHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KGNvbW1hbmROYW1lIHx8ICdTZWxlY3QgY29tbWFuZCcpXHJcblx0XHRcdFx0XHRcdFx0Lm9uQ2xpY2soKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgbW9kYWwgPSBuZXcgQ29tbWFuZFBpY2tlck1vZGFsKHRoaXMuYXBwLCAoY29tbWFuZElkKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZvaWQgKGFzeW5jICgpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoIXNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50ID0ge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbmFibGVkOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjb21tYW5kSWQ6ICdlZGl0LWFzdHJvLWNvbmZpZycsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGljb25JZDogJ3JvY2tldCcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQuY29tbWFuZElkID0gY29tbWFuZElkO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRyaWdnZXIgaGVscCBidXR0b24gcmVwbGFjZW1lbnQgdXBkYXRlIGltbWVkaWF0ZWx5IChpdCB3aWxsIHJlbG9hZCBzZXR0aW5ncylcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4udXBkYXRlSGVscEJ1dHRvbikge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4udXBkYXRlSGVscEJ1dHRvbigpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBSZS1yZW5kZXIgdG8gc2hvdyB1cGRhdGVkIGNvbW1hbmQgbmFtZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9KSgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRtb2RhbC5vcGVuKCk7XHJcblx0XHRcdFx0XHRcdFx0fSkpO1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHQvLyBJY29uIHBpY2tlclxyXG5cdFx0XHRcdGNvbnN0IGljb25OYW1lID0gdGhpcy5nZXRJY29uTmFtZShzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQuaWNvbklkKTtcclxuXHRcdFx0XHRkZXZlbG9wZXJHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0XHRcdC5zZXROYW1lKCdJY29uJylcclxuXHRcdFx0XHRcdFx0LnNldERlc2MoJ1NlbGVjdCB0aGUgaWNvbiB0byBkaXNwbGF5IG9uIHRoZSBidXR0b24uJylcclxuXHRcdFx0XHRcdFx0LmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXHJcblx0XHRcdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoaWNvbk5hbWUgfHwgJ1NlbGVjdCBpY29uLi4uJylcclxuXHRcdFx0XHRcdFx0XHQub25DbGljaygoKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBtb2RhbCA9IG5ldyBJY29uUGlja2VyTW9kYWwodGhpcy5hcHAsIChpY29uSWQpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dm9pZCAoYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmICghc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQgPSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGVuYWJsZWQ6IHRydWUsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNvbW1hbmRJZDogJ2VkaXQtYXN0cm8tY29uZmlnJyxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWNvbklkOiAncm9ja2V0JyxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudC5pY29uSWQgPSBpY29uSWQ7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVHJpZ2dlciBoZWxwIGJ1dHRvbiByZXBsYWNlbWVudCB1cGRhdGUgaW1tZWRpYXRlbHkgKGl0IHdpbGwgcmVsb2FkIHNldHRpbmdzKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi51cGRhdGVIZWxwQnV0dG9uKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi51cGRhdGVIZWxwQnV0dG9uKCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFJlLXJlbmRlciB0byBzaG93IHVwZGF0ZWQgaWNvbiBuYW1lXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH0pKCk7XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRcdG1vZGFsLm9wZW4oKTtcclxuXHRcdFx0XHRcdFx0XHR9KSk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLnVwZGF0ZUNvcHlIZWFkaW5nRmllbGRzKCk7XHJcblx0XHQvLyBPbmx5IHVwZGF0ZSB0ZXJtaW5hbC9jb25maWcgZmllbGRzIGlmIG5vdCBvbiBtb2JpbGVcclxuXHRcdGlmICghUGxhdGZvcm0uaXNNb2JpbGUpIHtcclxuXHRcdFx0dGhpcy51cGRhdGVUZXJtaW5hbENvbW1hbmRGaWVsZHMoKTtcclxuXHRcdFx0dGhpcy51cGRhdGVDb25maWdDb21tYW5kRmllbGRzKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHJcblx0dXBkYXRlQ29weUhlYWRpbmdGaWVsZHMoKSB7XHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0Y29uc3QgaXNWaXNpYmxlID0gc2V0dGluZ3MuZW5hYmxlQ29weUhlYWRpbmdMaW5rO1xyXG5cclxuXHRcdC8vIFVwZGF0ZSB0aGUgXCJEZWZhdWx0IGhlYWRpbmcgbGluayBmb3JtYXRcIiBzZXR0aW5nIGVsZW1lbnQgdmlzaWJpbGl0eVxyXG5cdFx0Y29uc3QgY29udGFpbmVyRWwgPSB0aGlzLmNvbnRhaW5lckVsO1xyXG5cdFx0Y29uc3QgYWxsU2V0dGluZ3MgPSBjb250YWluZXJFbC5xdWVyeVNlbGVjdG9yQWxsKCcuc2V0dGluZy1pdGVtJyk7XHJcblx0XHRhbGxTZXR0aW5ncy5mb3JFYWNoKChzZXR0aW5nRWwpID0+IHtcclxuXHRcdFx0Y29uc3QgbmFtZUVsID0gc2V0dGluZ0VsLnF1ZXJ5U2VsZWN0b3IoJy5zZXR0aW5nLWl0ZW0tbmFtZScpO1xyXG5cdFx0XHRpZiAobmFtZUVsICYmIG5hbWVFbC50ZXh0Q29udGVudD8udHJpbSgpID09PSBcIkRlZmF1bHQgaGVhZGluZyBsaW5rIGZvcm1hdFwiKSB7XHJcblx0XHRcdFx0c2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIGlzVmlzaWJsZSk7XHJcblx0XHRcdFx0c2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIWlzVmlzaWJsZSk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0dXBkYXRlVGVybWluYWxDb21tYW5kRmllbGRzKCkge1xyXG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcclxuXHRcdGNvbnN0IGlzVmlzaWJsZSA9IHNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQ7XHJcblxyXG5cdFx0Ly8gVXBkYXRlIGNvbnRhaW5lciBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxyXG5cdFx0aWYgKHRoaXMudGVybWluYWxDb21tYW5kQ29udGFpbmVyKSB7XHJcblx0XHRcdHRoaXMudGVybWluYWxDb21tYW5kQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIGlzVmlzaWJsZSk7XHJcblx0XHRcdHRoaXMudGVybWluYWxDb21tYW5kQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIWlzVmlzaWJsZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gVXBkYXRlIGluZGl2aWR1YWwgc2V0dGluZyBlbGVtZW50cyB0aGF0IGFyZSBpbiB0aGUgZ3JvdXBcclxuXHRcdC8vIEZpbmQgc2V0dGluZ3MgYnkgdGhlaXIgbmFtZSB0ZXh0IGNvbnRlbnRcclxuXHRcdGNvbnN0IGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbDtcclxuXHRcdGNvbnN0IGFsbFNldHRpbmdzID0gY29udGFpbmVyRWwucXVlcnlTZWxlY3RvckFsbCgnLnNldHRpbmctaXRlbScpO1xyXG5cdFx0YWxsU2V0dGluZ3MuZm9yRWFjaCgoc2V0dGluZ0VsKSA9PiB7XHJcblx0XHRcdGNvbnN0IG5hbWVFbCA9IHNldHRpbmdFbC5xdWVyeVNlbGVjdG9yKCcuc2V0dGluZy1pdGVtLW5hbWUnKTtcclxuXHRcdFx0aWYgKG5hbWVFbCkge1xyXG5cdFx0XHRcdGNvbnN0IG5hbWUgPSBuYW1lRWwudGV4dENvbnRlbnQ/LnRyaW0oKTtcclxuXHRcdFx0XHRpZiAobmFtZSA9PT0gXCJQcm9qZWN0IHJvb3QgZGlyZWN0b3J5IHBhdGhcIiB8fCBuYW1lID09PSBcIlNob3cgb3BlbiB0ZXJtaW5hbCByaWJib24gaWNvblwiKSB7XHJcblx0XHRcdFx0XHRzZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgaXNWaXNpYmxlKTtcclxuXHRcdFx0XHRcdHNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFpc1Zpc2libGUpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gVXBkYXRlIHJpYmJvbiB0b2dnbGUgZGlzYWJsZWQgc3RhdGUgdXNpbmcgdGhlIHRvZ2dsZSBjb21wb25lbnRcclxuXHRcdGlmICh0aGlzLnRlcm1pbmFsUmliYm9uVG9nZ2xlQ29tcG9uZW50KSB7XHJcblx0XHRcdHRoaXMudGVybWluYWxSaWJib25Ub2dnbGVDb21wb25lbnQuc2V0RGlzYWJsZWQoIXRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0dXBkYXRlQ29uZmlnQ29tbWFuZEZpZWxkcygpIHtcclxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblx0XHRjb25zdCBpc1Zpc2libGUgPSBzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQ7XHJcblxyXG5cdFx0Ly8gVXBkYXRlIGNvbnRhaW5lciBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxyXG5cdFx0aWYgKHRoaXMuY29uZmlnQ29tbWFuZENvbnRhaW5lcikge1xyXG5cdFx0XHR0aGlzLmNvbmZpZ0NvbW1hbmRDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgaXNWaXNpYmxlKTtcclxuXHRcdFx0dGhpcy5jb25maWdDb21tYW5kQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIWlzVmlzaWJsZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gVXBkYXRlIGluZGl2aWR1YWwgc2V0dGluZyBlbGVtZW50cyB0aGF0IGFyZSBpbiB0aGUgZ3JvdXBcclxuXHRcdC8vIEZpbmQgc2V0dGluZ3MgYnkgdGhlaXIgbmFtZSB0ZXh0IGNvbnRlbnRcclxuXHRcdGNvbnN0IGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbDtcclxuXHRcdGNvbnN0IGFsbFNldHRpbmdzID0gY29udGFpbmVyRWwucXVlcnlTZWxlY3RvckFsbCgnLnNldHRpbmctaXRlbScpO1xyXG5cdFx0YWxsU2V0dGluZ3MuZm9yRWFjaCgoc2V0dGluZ0VsKSA9PiB7XHJcblx0XHRcdGNvbnN0IG5hbWVFbCA9IHNldHRpbmdFbC5xdWVyeVNlbGVjdG9yKCcuc2V0dGluZy1pdGVtLW5hbWUnKTtcclxuXHRcdFx0aWYgKG5hbWVFbCkge1xyXG5cdFx0XHRcdGNvbnN0IG5hbWUgPSBuYW1lRWwudGV4dENvbnRlbnQ/LnRyaW0oKTtcclxuXHRcdFx0XHRpZiAobmFtZSA9PT0gXCJDb25maWcgZmlsZSBwYXRoXCIgfHwgbmFtZSA9PT0gXCJTaG93IG9wZW4gY29uZmlnIHJpYmJvbiBpY29uXCIpIHtcclxuXHRcdFx0XHRcdHNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBpc1Zpc2libGUpO1xyXG5cdFx0XHRcdFx0c2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIWlzVmlzaWJsZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBVcGRhdGUgcmliYm9uIHRvZ2dsZSBkaXNhYmxlZCBzdGF0ZSB1c2luZyB0aGUgdG9nZ2xlIGNvbXBvbmVudFxyXG5cdFx0aWYgKHRoaXMuY29uZmlnUmliYm9uVG9nZ2xlQ29tcG9uZW50KSB7XHJcblx0XHRcdHRoaXMuY29uZmlnUmliYm9uVG9nZ2xlQ29tcG9uZW50LnNldERpc2FibGVkKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Y2hlY2tGb3JGb2xkZXJDb25mbGljdHMoKSB7XHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0Y29uc3QgYmxhbmtGb2xkZXJzOiBzdHJpbmdbXSA9IFtdO1xyXG5cdFx0Y29uc3QgZm9sZGVyQ29uZmxpY3RzOiB7IFtmb2xkZXI6IHN0cmluZ106IHN0cmluZ1tdIH0gPSB7fTtcclxuXHJcblx0XHQvLyBDaGVjayBjb250ZW50IHR5cGVzXHJcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XHJcblx0XHRmb3IgKGNvbnN0IGNvbnRlbnRUeXBlIG9mIGNvbnRlbnRUeXBlcykge1xyXG5cdFx0XHRpZiAoY29udGVudFR5cGUuZW5hYmxlZCkge1xyXG5cdFx0XHRcdGlmICghY29udGVudFR5cGUuZm9sZGVyIHx8IGNvbnRlbnRUeXBlLmZvbGRlci50cmltKCkgPT09IFwiXCIpIHtcclxuXHRcdFx0XHRcdGJsYW5rRm9sZGVycy5wdXNoKGNvbnRlbnRUeXBlLm5hbWUgfHwgXCJDb250ZW50XCIpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRpZiAoIWZvbGRlckNvbmZsaWN0c1tjb250ZW50VHlwZS5mb2xkZXJdKSB7XHJcblx0XHRcdFx0XHRcdGZvbGRlckNvbmZsaWN0c1tjb250ZW50VHlwZS5mb2xkZXJdID0gW107XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRmb2xkZXJDb25mbGljdHNbY29udGVudFR5cGUuZm9sZGVyXS5wdXNoKGNvbnRlbnRUeXBlLm5hbWUgfHwgXCJDb250ZW50XCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIENoZWNrIGZvciBjb25mbGljdHNcclxuXHRcdC8vIFdhcm5pbmcgYm94IHJlbW92ZWQgLSBjb25mbGljdHMgYXJlIHN0aWxsIGRldGVjdGVkIGF0IHJ1bnRpbWVcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgYWRkQ3VzdG9tQ29udGVudFR5cGUoKSB7XHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Y29uc3QgbmV3VHlwZTogQ29udGVudFR5cGUgPSB7XHJcblx0XHRcdGlkOiBgY29udGVudC0ke0RhdGUubm93KCl9YCxcclxuXHRcdFx0bmFtZTogYENvbnRlbnQgJHtjb250ZW50VHlwZXMubGVuZ3RoICsgMX1gLFxyXG5cdFx0XHRmb2xkZXI6IFwiXCIsXHJcblx0XHRcdGxpbmtCYXNlUGF0aDogXCJcIixcclxuXHRcdFx0dGVtcGxhdGU6ICctLS1cXG50aXRsZTogXCJ7e3RpdGxlfX1cIlxcbmRhdGU6IHt7ZGF0ZX19XFxuLS0tXFxuJyxcclxuXHRcdFx0ZW5hYmxlZDogdHJ1ZSxcclxuXHRcdFx0Y3JlYXRpb25Nb2RlOiBcImZpbGVcIixcclxuXHRcdFx0aW5kZXhGaWxlTmFtZTogXCJcIixcclxuXHRcdFx0aWdub3JlU3ViZm9sZGVyczogZmFsc2UsXHJcblx0XHRcdGVuYWJsZVVuZGVyc2NvcmVQcmVmaXg6IGZhbHNlLFxyXG5cdFx0XHR1c2VNZHhFeHRlbnNpb246IGZhbHNlLFxyXG5cdFx0fTtcclxuXHRcdGNvbnRlbnRUeXBlcy5wdXNoKG5ld1R5cGUpO1xyXG5cdFx0c2V0dGluZ3MuY29udGVudFR5cGVzID0gY29udGVudFR5cGVzO1xyXG5cdFx0dm9pZCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdHRoaXMucmVuZGVyQ3VzdG9tQ29udGVudFR5cGVzKCk7XHJcblx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckNyZWF0ZUV2ZW50KCk7XHJcblx0XHQvLyBSZS1yZWdpc3RlciBjb250ZW50IHR5cGUgY29tbWFuZHMgdG8gaW5jbHVkZSB0aGUgbmV3IHR5cGVcclxuXHRcdHJlZ2lzdGVyQ29udGVudFR5cGVDb21tYW5kcyh0aGlzLnBsdWdpbiBhcyB1bmtub3duIGFzIFBsdWdpbiwgc2V0dGluZ3MpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSByZW5kZXJDdXN0b21Db250ZW50VHlwZXMoKSB7XHJcblx0XHRpZiAoIXRoaXMuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyKSByZXR1cm47XHJcblxyXG5cdFx0dGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXIuZW1wdHkoKTtcclxuXHJcblx0XHQvLyBBbHdheXMgcmVhZCBmcmVzaCBzZXR0aW5ncyBmcm9tIHBsdWdpbiB0byBlbnN1cmUgd2UgaGF2ZSBsYXRlc3QgZGF0YVxyXG5cdFx0Ly8gVGhpcyBpcyBjcml0aWNhbCBhZnRlciBtaWdyYXRpb25cclxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XHJcblx0XHRjb250ZW50VHlwZXMuZm9yRWFjaCgoY3VzdG9tVHlwZTogQ29udGVudFR5cGUsIGluZGV4OiBudW1iZXIpID0+IHtcclxuXHRcdFx0aWYgKCF0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcikgcmV0dXJuO1xyXG5cdFx0XHRjb25zdCB0eXBlQ29udGFpbmVyID0gdGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXIuY3JlYXRlRGl2KHtcclxuXHRcdFx0XHRjbHM6IFwiY3VzdG9tLWNvbnRlbnQtdHlwZS1pdGVtXCIsXHJcblx0XHRcdFx0YXR0cjogeyBcImRhdGEtdHlwZS1pZFwiOiBjdXN0b21UeXBlLmlkIH1cclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBIZWFkZXIgd2l0aCBjb250cm9sc1xyXG5cdFx0XHRjb25zdCBoZWFkZXIgPSB0eXBlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJjdXN0b20tY29udGVudC10eXBlLWhlYWRlclwiIH0pO1xyXG5cdFx0XHRoZWFkZXIuY2xhc3NMaXN0LmFkZChcImFzdHJvLWNvbXBvc2VyLWN1c3RvbS10eXBlLWhlYWRlclwiKTtcclxuXHJcblx0XHRcdC8vIExlZnQgc2lkZSAtIGNvbGxhcHNlL2V4cGFuZCBidXR0b25cclxuXHRcdFx0Y29uc3QgY29sbGFwc2VCdXR0b24gPSBoZWFkZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xyXG5cdFx0XHRcdGNsczogXCJhc3Ryby1jb21wb3Nlci1jb2xsYXBzZS1idXR0b25cIixcclxuXHRcdFx0XHRhdHRyOiB7IFwiYXJpYS1sYWJlbFwiOiBcIkNvbGxhcHNlL2V4cGFuZFwiIH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdGNvbnN0IGlzQ29sbGFwc2VkID0gY3VzdG9tVHlwZS5jb2xsYXBzZWQgPz8gZmFsc2U7XHJcblx0XHRcdC8vIEFsd2F5cyB1c2UgY2hldnJvbi1kb3duLCByb3RhdGUgaXQgd2hlbiBjb2xsYXBzZWQgdG8gcG9pbnQgcmlnaHRcclxuXHRcdFx0c2V0SWNvbihjb2xsYXBzZUJ1dHRvbiwgXCJjaGV2cm9uLWRvd25cIik7XHJcblx0XHRcdGlmIChpc0NvbGxhcHNlZCkge1xyXG5cdFx0XHRcdGNvbGxhcHNlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJpcy1jb2xsYXBzZWRcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0Y29sbGFwc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuXHRcdFx0XHR2b2lkIHRoaXMudG9nZ2xlQ29udGVudFR5cGVDb2xsYXBzZShjdXN0b21UeXBlLmlkKTtcclxuXHRcdFx0XHQvLyBVcGRhdGUgY2xhc3MgYWZ0ZXIgdG9nZ2xlIChpY29uIHN0YXlzIHRoZSBzYW1lLCBqdXN0IHJvdGF0ZXMpXHJcblx0XHRcdFx0Y29uc3QgdXBkYXRlZFR5cGUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb250ZW50VHlwZXMuZmluZCgoY3Q6IENvbnRlbnRUeXBlKSA9PiBjdC5pZCA9PT0gY3VzdG9tVHlwZS5pZCk7XHJcblx0XHRcdFx0aWYgKHVwZGF0ZWRUeXBlKSB7XHJcblx0XHRcdFx0XHRpZiAodXBkYXRlZFR5cGUuY29sbGFwc2VkKSB7XHJcblx0XHRcdFx0XHRcdGNvbGxhcHNlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJpcy1jb2xsYXBzZWRcIik7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRjb2xsYXBzZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiaXMtY29sbGFwc2VkXCIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBNaWRkbGUgbGVmdCAtIGNvbnRlbnQgdHlwZSBuYW1lXHJcblx0XHRcdGNvbnN0IGhlYWRlck5hbWUgPSBoZWFkZXIuY3JlYXRlRGl2KHsgY2xzOiBcImFzdHJvLWNvbXBvc2VyLWhlYWRlci1uYW1lXCIgfSk7XHJcblx0XHRcdGhlYWRlck5hbWUuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBjdXN0b21UeXBlLm5hbWUgfHwgYENvbnRlbnQgJHtpbmRleCArIDF9YCwgY2xzOiBcInNldHRpbmctaXRlbS1uYW1lXCIgfSk7XHJcblxyXG5cdFx0XHQvLyBNaWRkbGUgcmlnaHQgLSB1cC9kb3duIGJ1dHRvbnMgKHNpZGUtYnktc2lkZSlcclxuXHRcdFx0Y29uc3QgcmVvcmRlckNvbnRhaW5lciA9IGhlYWRlci5jcmVhdGVEaXYoeyBjbHM6IFwiYXN0cm8tY29tcG9zZXItcmVvcmRlci1idXR0b25zXCIgfSk7XHJcblx0XHRcdGNvbnN0IHVwQnV0dG9uID0gcmVvcmRlckNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7XHJcblx0XHRcdFx0Y2xzOiBcImFzdHJvLWNvbXBvc2VyLXJlb3JkZXItYnV0dG9uXCIsXHJcblx0XHRcdFx0YXR0cjogeyBcImFyaWEtbGFiZWxcIjogXCJNb3ZlIHVwXCIgfVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0c2V0SWNvbih1cEJ1dHRvbiwgXCJjaGV2cm9uLXVwXCIpO1xyXG5cdFx0XHR1cEJ1dHRvbi5kaXNhYmxlZCA9IGluZGV4ID09PSAwO1xyXG5cdFx0XHR1cEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG5cdFx0XHRcdHZvaWQgdGhpcy5tb3ZlQ29udGVudFR5cGVVcChjdXN0b21UeXBlLmlkKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRjb25zdCBkb3duQnV0dG9uID0gcmVvcmRlckNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7XHJcblx0XHRcdFx0Y2xzOiBcImFzdHJvLWNvbXBvc2VyLXJlb3JkZXItYnV0dG9uXCIsXHJcblx0XHRcdFx0YXR0cjogeyBcImFyaWEtbGFiZWxcIjogXCJNb3ZlIGRvd25cIiB9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRzZXRJY29uKGRvd25CdXR0b24sIFwiY2hldnJvbi1kb3duXCIpO1xyXG5cdFx0XHRkb3duQnV0dG9uLmRpc2FibGVkID0gaW5kZXggPT09IGNvbnRlbnRUeXBlcy5sZW5ndGggLSAxO1xyXG5cdFx0XHRkb3duQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcblx0XHRcdFx0dm9pZCB0aGlzLm1vdmVDb250ZW50VHlwZURvd24oY3VzdG9tVHlwZS5pZCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gUmlnaHQgc2lkZSAtIHRvZ2dsZVxyXG5cdFx0XHRjb25zdCB0b2dnbGVDb250YWluZXIgPSBoZWFkZXIuY3JlYXRlRGl2KHsgY2xzOiBcImNoZWNrYm94LWNvbnRhaW5lclwiIH0pO1xyXG5cdFx0XHRpZiAoY3VzdG9tVHlwZS5lbmFibGVkKSB7XHJcblx0XHRcdFx0dG9nZ2xlQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJpcy1lbmFibGVkXCIpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRjb25zdCB0b2dnbGUgPSB0b2dnbGVDb250YWluZXIuY3JlYXRlRWwoXCJpbnB1dFwiLCB7IHR5cGU6IFwiY2hlY2tib3hcIiwgY2xzOiBcImNoZWNrYm94LWlucHV0XCIgfSk7XHJcblx0XHRcdHRvZ2dsZS5jaGVja2VkID0gY3VzdG9tVHlwZS5lbmFibGVkO1xyXG5cclxuXHRcdFx0Ly8gQWRkIGNsaWNrIGV2ZW50IHRvIHRoZSBjb250YWluZXIgYXMgd2VsbFxyXG5cdFx0XHR0b2dnbGVDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcblx0XHRcdFx0dm9pZCAoYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRcdFx0Y29uc3QgbmV3VmFsdWUgPSAhY3VzdG9tVHlwZS5lbmFibGVkO1xyXG5cdFx0XHRcdFx0Y3VzdG9tVHlwZS5lbmFibGVkID0gbmV3VmFsdWU7XHJcblx0XHRcdFx0XHR0b2dnbGUuY2hlY2tlZCA9IG5ld1ZhbHVlO1xyXG5cclxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJDcmVhdGVFdmVudCgpO1xyXG5cclxuXHRcdFx0XHRcdC8vIFVwZGF0ZSB0aGUgY29udGFpbmVyIGNsYXNzIGZvciB2aXN1YWwgZmVlZGJhY2tcclxuXHRcdFx0XHRcdGlmIChuZXdWYWx1ZSkge1xyXG5cdFx0XHRcdFx0XHR0b2dnbGVDb250YWluZXIuY2xhc3NMaXN0LmFkZChcImlzLWVuYWJsZWRcIik7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHR0b2dnbGVDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcImlzLWVuYWJsZWRcIik7XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0Ly8gVXBkYXRlIHZpc2liaWxpdHlcclxuXHRcdFx0XHRcdHRoaXMudXBkYXRlQ3VzdG9tQ29udGVudFR5cGVWaXNpYmlsaXR5KGN1c3RvbVR5cGUuaWQsIG5ld1ZhbHVlKTtcclxuXHJcblx0XHRcdFx0XHQvLyBSZS1yZWdpc3RlciBjb250ZW50IHR5cGUgY29tbWFuZHMgdG8gcmVmbGVjdCBlbmFibGVkL2Rpc2FibGVkIHN0YXRlXHJcblx0XHRcdFx0XHRyZWdpc3RlckNvbnRlbnRUeXBlQ29tbWFuZHModGhpcy5wbHVnaW4gYXMgdW5rbm93biBhcyBQbHVnaW4sIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuXHJcblx0XHRcdFx0XHQvLyBDb25mbGljdCBjaGVja2luZyByZW1vdmVkIGZyb20gc2V0dGluZ3MgVUlcclxuXHRcdFx0XHR9KSgpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIEFsc28gYWRkIGNoYW5nZSBldmVudCBhcyBiYWNrdXBcclxuXHRcdFx0dG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKGUpID0+IHtcclxuXHRcdFx0XHR2b2lkIChhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0XHRjb25zdCB2YWx1ZSA9IChlLnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50KS5jaGVja2VkO1xyXG5cdFx0XHRcdFx0Y3VzdG9tVHlwZS5lbmFibGVkID0gdmFsdWU7XHJcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyQ3JlYXRlRXZlbnQoKTtcclxuXHJcblx0XHRcdFx0XHQvLyBVcGRhdGUgdGhlIGNvbnRhaW5lciBjbGFzcyBmb3IgdmlzdWFsIGZlZWRiYWNrXHJcblx0XHRcdFx0XHRpZiAodmFsdWUpIHtcclxuXHRcdFx0XHRcdFx0dG9nZ2xlQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJpcy1lbmFibGVkXCIpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0dG9nZ2xlQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJpcy1lbmFibGVkXCIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdC8vIFVwZGF0ZSB2aXNpYmlsaXR5XHJcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlVmlzaWJpbGl0eShjdXN0b21UeXBlLmlkLCB2YWx1ZSk7XHJcblxyXG5cdFx0XHRcdFx0Ly8gUmUtcmVnaXN0ZXIgY29udGVudCB0eXBlIGNvbW1hbmRzIHRvIHJlZmxlY3QgZW5hYmxlZC9kaXNhYmxlZCBzdGF0ZVxyXG5cdFx0XHRcdFx0cmVnaXN0ZXJDb250ZW50VHlwZUNvbW1hbmRzKHRoaXMucGx1Z2luIGFzIHVua25vd24gYXMgUGx1Z2luLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcblx0XHRcdFx0fSkoKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBTZXR0aW5ncyBjb250YWluZXIgdGhhdCBjYW4gYmUgY29sbGFwc2VkXHJcblx0XHRcdGNvbnN0IHNldHRpbmdzQ29udGFpbmVyID0gdHlwZUNvbnRhaW5lci5jcmVhdGVEaXYoe1xyXG5cdFx0XHRcdGNsczogXCJjdXN0b20tY29udGVudC10eXBlLXNldHRpbmdzXCIsXHJcblx0XHRcdFx0YXR0cjogeyBcImRhdGEtdHlwZS1pZFwiOiBjdXN0b21UeXBlLmlkIH1cclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBTZXQgaW5pdGlhbCB2aXNpYmlsaXR5IHN0YXRlIGJhc2VkIG9uIGVuYWJsZWQgYW5kIGNvbGxhcHNlZCBzdGF0ZVxyXG5cdFx0XHRjb25zdCBpbml0aWFsbHlDb2xsYXBzZWQgPSBjdXN0b21UeXBlLmNvbGxhcHNlZCA/PyBmYWxzZTtcclxuXHRcdFx0Y29uc3QgaW5pdGlhbGx5VmlzaWJsZSA9IGN1c3RvbVR5cGUuZW5hYmxlZCAmJiAhaW5pdGlhbGx5Q29sbGFwc2VkO1xyXG5cdFx0XHRpZiAoaW5pdGlhbGx5VmlzaWJsZSkge1xyXG5cdFx0XHRcdHNldHRpbmdzQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHNldHRpbmdzQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIik7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIENvbnRlbnQgdHlwZSBuYW1lXHJcblx0XHRcdGNvbnN0IG5hbWVDb250YWluZXIgPSBzZXR0aW5nc0NvbnRhaW5lci5jcmVhdGVEaXYoKTtcclxuXHRcdFx0bmV3IFNldHRpbmcobmFtZUNvbnRhaW5lcilcclxuXHRcdFx0XHQuc2V0TmFtZShcIkNvbnRlbnQgdHlwZSBuYW1lXCIpXHJcblx0XHRcdFx0LnNldERlc2MoXCJEaXNwbGF5IG5hbWUgZm9yIHRoaXMgY29udGVudCB0eXBlIChlLmcuLCAncHJvamVjdHMnLCAnbm90ZXMnLCAndHV0b3JpYWxzJylcIilcclxuXHRcdFx0XHQuYWRkVGV4dCgodGV4dCkgPT4ge1xyXG5cdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCJFbnRlciBjb250ZW50IHR5cGUgbmFtZVwiKVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoY3VzdG9tVHlwZS5uYW1lKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRjdXN0b21UeXBlLm5hbWUgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHQvLyBSZS1yZWdpc3RlciBjb250ZW50IHR5cGUgY29tbWFuZHMgdG8gdXBkYXRlIGNvbW1hbmQgbmFtZVxyXG5cdFx0XHRcdFx0XHRcdHJlZ2lzdGVyQ29udGVudFR5cGVDb21tYW5kcyh0aGlzLnBsdWdpbiBhcyB1bmtub3duIGFzIFBsdWdpbiwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIEZvbGRlciBsb2NhdGlvblxyXG5cdFx0XHRjb25zdCBmb2xkZXJDb250YWluZXIgPSBzZXR0aW5nc0NvbnRhaW5lci5jcmVhdGVEaXYoKTtcclxuXHRcdFx0Y29uc3QgZm9sZGVyU2V0dGluZyA9IG5ldyBTZXR0aW5nKGZvbGRlckNvbnRhaW5lcilcclxuXHRcdFx0XHQuc2V0TmFtZShcIkZvbGRlciBsb2NhdGlvblwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiRm9sZGVyIHBhdGggd2hlcmUgdGhpcyBjb250ZW50IHR5cGUgd2lsbCBiZSBjcmVhdGVkLiBMZWF2ZSBibGFuayB0byB1c2UgdGhlIHZhdWx0IGZvbGRlci4gU3VwcG9ydHMgd2lsZGNhcmRzIGxpa2UgZGlyZWN0b3J5Lyogb3IgZGlyZWN0b3J5LyovKiB0byBtYXRjaCBzcGVjaWZpYyBmb2xkZXIgZGVwdGhzLlwiKVxyXG5cdFx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PiB7XHJcblx0XHRcdFx0XHR0ZXh0XHJcblx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIkVudGVyIGZvbGRlciBwYXRoIChlLmcuLCAnZG9jcycsICdkb2NzLyonLCAnZG9jcy8qLyonKSBvciBsZWF2ZSBibGFuayBmb3IgdmF1bHQgcm9vdFwiKVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoY3VzdG9tVHlwZS5mb2xkZXIpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGN1c3RvbVR5cGUuZm9sZGVyID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJDcmVhdGVFdmVudCgpO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMudXBkYXRlQ3VzdG9tQ29udGVudFR5cGVJZ25vcmVTdWJmb2xkZXJzRmllbGQoY3VzdG9tVHlwZS5pZCk7XHJcblx0XHRcdFx0XHRcdFx0Ly8gVXBkYXRlIGNvbmZsaWN0IHdhcm5pbmdzIGZvciBhbGwgY29udGVudCB0eXBlcyAoZm9sZGVyIGNoYW5nZSBtYXkgYWZmZWN0IG90aGVycylcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBhbGxDb250ZW50VHlwZXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XHJcblx0XHRcdFx0XHRcdFx0Zm9yIChjb25zdCBjdCBvZiBhbGxDb250ZW50VHlwZXMpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMudXBkYXRlRm9sZGVyQ29uZmxpY3RXYXJuaW5nKGN0LmlkLCBudWxsKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gQWRkIGNvbmZsaWN0IHdhcm5pbmcgZWxlbWVudFxyXG5cdFx0XHRmb2xkZXJDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImFzdHJvLWNvbXBvc2VyLWNvbmZsaWN0LXdhcm5pbmcgaGlkZGVuXCIsIGF0dHI6IHsgXCJkYXRhLXR5cGUtaWRcIjogY3VzdG9tVHlwZS5pZCB9IH0pO1xyXG5cdFx0XHR0aGlzLnVwZGF0ZUZvbGRlckNvbmZsaWN0V2FybmluZyhjdXN0b21UeXBlLmlkLCBmb2xkZXJTZXR0aW5nKTtcclxuXHJcblx0XHRcdC8vIElnbm9yZSBzdWJmb2xkZXJzIChvbmx5IHNob3cgd2hlbiBmb2xkZXIgaXMgc2V0KVxyXG5cdFx0XHRjb25zdCBpZ25vcmVTdWJmb2xkZXJzQ29udGFpbmVyID0gc2V0dGluZ3NDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImN1c3RvbS1pZ25vcmUtc3ViZm9sZGVycy1maWVsZFwiIH0pO1xyXG5cdFx0XHRpZ25vcmVTdWJmb2xkZXJzQ29udGFpbmVyLnNldEF0dHJpYnV0ZShcImRhdGEtdHlwZS1pZFwiLCBjdXN0b21UeXBlLmlkKTtcclxuXHRcdFx0aWdub3JlU3ViZm9sZGVyc0NvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCAhIWN1c3RvbVR5cGUuZm9sZGVyKTtcclxuXHRcdFx0aWdub3JlU3ViZm9sZGVyc0NvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFjdXN0b21UeXBlLmZvbGRlcik7XHJcblx0XHRcdG5ldyBTZXR0aW5nKGlnbm9yZVN1YmZvbGRlcnNDb250YWluZXIpXHJcblx0XHRcdFx0LnNldE5hbWUoXCJJZ25vcmUgc3ViZm9sZGVyc1wiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiV2hlbiBlbmFibGVkLCBhdXRvbWF0aW9uIHdpbGwgb25seSB0cmlnZ2VyIGZvciBuZXcgLm1kIGZpbGVzIHdpdGhpbiB0aGlzIGNvbnRlbnQgdHlwZSdzIGZvbGRlciBhbmQgb25lIGxldmVsIGRvd24gKGZvciBmb2xkZXItYmFzZWQgY29udGVudCkuIEZpbGVzIGluIGRlZXBlciBzdWJmb2xkZXJzIHdpbGwgYmUgaWdub3JlZC5cIilcclxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUuaWdub3JlU3ViZm9sZGVycyB8fCBmYWxzZSlcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGN1c3RvbVR5cGUuaWdub3JlU3ViZm9sZGVycyA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblxyXG5cdFx0XHQvLyBVbmRlcnNjb3JlIHByZWZpeFxyXG5cdFx0XHRjb25zdCB1bmRlcnNjb3JlUHJlZml4Q29udGFpbmVyID0gc2V0dGluZ3NDb250YWluZXIuY3JlYXRlRGl2KCk7XHJcblx0XHRcdG5ldyBTZXR0aW5nKHVuZGVyc2NvcmVQcmVmaXhDb250YWluZXIpXHJcblx0XHRcdFx0LnNldE5hbWUoXCJVc2UgdW5kZXJzY29yZSBwcmVmaXggZm9yIGRyYWZ0c1wiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiQWRkIGFuIHVuZGVyc2NvcmUgcHJlZml4IChfY29udGVudC10aXRsZSkgdG8gbmV3IG5vdGVzIGJ5IGRlZmF1bHQgd2hlbiBlbmFibGVkLiBUaGlzIGhpZGVzIHRoZW0gZnJvbSBhc3Rybywgd2hpY2ggY2FuIGJlIGhlbHBmdWwgZm9yIGRyYWZ0c1wiKVxyXG5cdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuXHRcdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoY3VzdG9tVHlwZS5lbmFibGVVbmRlcnNjb3JlUHJlZml4IHx8IGZhbHNlKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0Y3VzdG9tVHlwZS5lbmFibGVVbmRlcnNjb3JlUHJlZml4ID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHJcblx0XHRcdC8vIExpbmsgYmFzZSBwYXRoXHJcblx0XHRcdGNvbnN0IGxpbmtDb250YWluZXIgPSBzZXR0aW5nc0NvbnRhaW5lci5jcmVhdGVEaXYoKTtcclxuXHRcdFx0bmV3IFNldHRpbmcobGlua0NvbnRhaW5lcilcclxuXHRcdFx0XHQuc2V0TmFtZShcIkxpbmsgYmFzZSBwYXRoXCIpXHJcblx0XHRcdFx0LnNldERlc2MoXCJCYXNlIHBhdGggZm9yIGNvbnZlcnRlZCBsaW5rcyAoZS5nLiwgJy9wcm9qZWN0cy8nLCAnL25vdGVzL3R1dG9yaWFscy8nLCBsZWF2ZSBibGFuayBmb3Igcm9vdCAvKS5cIilcclxuXHRcdFx0XHQuYWRkVGV4dCgodGV4dCkgPT4ge1xyXG5cdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCJFbnRlciBsaW5rIGJhc2UgcGF0aFwiKVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoY3VzdG9tVHlwZS5saW5rQmFzZVBhdGggfHwgXCJcIilcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0Y3VzdG9tVHlwZS5saW5rQmFzZVBhdGggPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBDcmVhdGlvbiBtb2RlXHJcblx0XHRcdGNvbnN0IGNyZWF0aW9uTW9kZUNvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xyXG5cdFx0XHRuZXcgU2V0dGluZyhjcmVhdGlvbk1vZGVDb250YWluZXIpXHJcblx0XHRcdFx0LnNldE5hbWUoXCJDcmVhdGlvbiBtb2RlXCIpXHJcblx0XHRcdFx0LnNldERlc2MoXCJIb3cgdG8gY3JlYXRlIG5ldyBlbnRyaWVzOiBmaWxlLWJhc2VkIG9yIGZvbGRlci1iYXNlZCB3aXRoIGFuIGluZGV4IGZpbGUuXCIpXHJcblx0XHRcdFx0LmFkZERyb3Bkb3duKChkcm9wZG93bikgPT5cclxuXHRcdFx0XHRcdGRyb3Bkb3duXHJcblx0XHRcdFx0XHRcdC5hZGRPcHRpb24oXCJmaWxlXCIsIFwiRmlsZS1iYXNlZCAoY29udGVudC10aXRsZS5tZClcIilcclxuXHRcdFx0XHRcdFx0LmFkZE9wdGlvbihcImZvbGRlclwiLCBcIkZvbGRlci1iYXNlZCAoY29udGVudC10aXRsZS9pbmRleC5tZClcIilcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUuY3JlYXRpb25Nb2RlKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRjdXN0b21UeXBlLmNyZWF0aW9uTW9kZSA9IHZhbHVlIGFzIFwiZmlsZVwiIHwgXCJmb2xkZXJcIjtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlSW5kZXhGaWxlRmllbGQoY3VzdG9tVHlwZS5pZCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHJcblx0XHRcdC8vIFVzZSBNRFggZXh0ZW5zaW9uXHJcblx0XHRcdGNvbnN0IHVzZU1keENvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xyXG5cdFx0XHRuZXcgU2V0dGluZyh1c2VNZHhDb250YWluZXIpXHJcblx0XHRcdFx0Ly8gXCJNRFhcIiBpcyBhIHByb3BlciBub3VuIChmaWxlIGZvcm1hdCkgYW5kIHNob3VsZCBiZSBjYXBpdGFsaXplZFxyXG5cdFx0XHRcdC5zZXROYW1lKFwiVXNlIE1EWCBpbnN0ZWFkIG9mIE1EXCIpXHJcblx0XHRcdFx0LnNldERlc2MoXCJDcmVhdGUgZmlsZXMgd2l0aCAubWR4IGV4dGVuc2lvbiBpbnN0ZWFkIG9mIC5tZCBleHRlbnNpb24uXCIpXHJcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShjdXN0b21UeXBlLnVzZU1keEV4dGVuc2lvbiB8fCBmYWxzZSlcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGN1c3RvbVR5cGUudXNlTWR4RXh0ZW5zaW9uID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHJcblx0XHRcdC8vIEluZGV4IGZpbGUgbmFtZSAob25seSBzaG93IGZvciBmb2xkZXItYmFzZWQpXHJcblx0XHRcdGNvbnN0IGluZGV4RmlsZUNvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJjdXN0b20taW5kZXgtZmlsZS1maWVsZFwiIH0pO1xyXG5cdFx0XHRpbmRleEZpbGVDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgY3VzdG9tVHlwZS5jcmVhdGlvbk1vZGUgPT09IFwiZm9sZGVyXCIpO1xyXG5cdFx0XHRpbmRleEZpbGVDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCBjdXN0b21UeXBlLmNyZWF0aW9uTW9kZSAhPT0gXCJmb2xkZXJcIik7XHJcblx0XHRcdG5ldyBTZXR0aW5nKGluZGV4RmlsZUNvbnRhaW5lcilcclxuXHRcdFx0XHQuc2V0TmFtZShcIkluZGV4IGZpbGUgbmFtZVwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiTmFtZSBmb3IgaW5kZXggZmlsZXMgaW4gZm9sZGVyLWJhc2VkIGNvbnRlbnQgKHdpdGhvdXQgLm1kIGV4dGVuc2lvbikuIERlZmF1bHRzIHRvICdpbmRleCcgaWYgbGVmdCBibGFuay5cIilcclxuXHRcdFx0XHQuYWRkVGV4dCgodGV4dCkgPT5cclxuXHRcdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKFwiSW5kZXhcIilcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUuaW5kZXhGaWxlTmFtZSlcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0Y3VzdG9tVHlwZS5pbmRleEZpbGVOYW1lID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHJcblx0XHRcdC8vIFRlbXBsYXRlXHJcblx0XHRcdGNvbnN0IHRlbXBsYXRlQ29udGFpbmVyID0gc2V0dGluZ3NDb250YWluZXIuY3JlYXRlRGl2KCk7XHJcblx0XHRcdG5ldyBTZXR0aW5nKHRlbXBsYXRlQ29udGFpbmVyKVxyXG5cdFx0XHRcdC5zZXROYW1lKFwiUHJvcGVydGllcyB0ZW1wbGF0ZVwiKVxyXG5cdFx0XHRcdC5hZGRUZXh0QXJlYSgodGV4dCkgPT4ge1xyXG5cdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJy0tLVxcbnRpdGxlOiBcInt7dGl0bGV9fVwiXFxuZGF0ZToge3tkYXRlfX1cXG4tLS1cXG4nKVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoY3VzdG9tVHlwZS50ZW1wbGF0ZSlcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0Y3VzdG9tVHlwZS50ZW1wbGF0ZSA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdHRleHQuaW5wdXRFbC5jbGFzc0xpc3QuYWRkKFwiYXN0cm8tY29tcG9zZXItdGVtcGxhdGUtdGV4dGFyZWFcIik7XHJcblx0XHRcdFx0XHRyZXR1cm4gdGV4dDtcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHRcdC50aGVuKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdFx0XHRzZXR0aW5nLmRlc2NFbC5lbXB0eSgpO1xyXG5cdFx0XHRcdFx0Y29uc3QgZGVzY0RpdiA9IHNldHRpbmcuZGVzY0VsLmNyZWF0ZUVsKFwiZGl2XCIpO1xyXG5cdFx0XHRcdFx0ZGVzY0Rpdi5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IFwiVGVtcGxhdGUgZm9yIG5ldyBmaWxlcyBvZiB0aGlzIGNvbnRlbnQgdHlwZS5cIiB9KTtcclxuXHRcdFx0XHRcdGRlc2NEaXYuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIlZhcmlhYmxlcyBpbmNsdWRlIHt7dGl0bGV9fSwge3tkYXRlfX0sIGFuZCB7e3NsdWd9fS5cIiB9KTtcclxuXHRcdFx0XHRcdGRlc2NEaXYuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIkRvIG5vdCB3cmFwIHt7ZGF0ZX19IGluIHF1b3RlcyBhcyBpdCByZXByZXNlbnRzIGEgZGF0ZXRpbWUgdmFsdWUsIG5vdCBhIHN0cmluZy5cIiB9KTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIFJlbW92ZSBidXR0b24gYXQgdGhlIGJvdHRvbSAobm8gZGl2aWRlcilcclxuXHRcdFx0Y29uc3QgcmVtb3ZlQ29udGFpbmVyID0gc2V0dGluZ3NDb250YWluZXIuY3JlYXRlRGl2KCk7XHJcblx0XHRcdGNvbnN0IHJlbW92ZVNldHRpbmcgPSBuZXcgU2V0dGluZyhyZW1vdmVDb250YWluZXIpXHJcblx0XHRcdFx0LnNldE5hbWUoXCJcIilcclxuXHRcdFx0XHQuYWRkQnV0dG9uKChidXR0b24pID0+IHtcclxuXHRcdFx0XHRcdGJ1dHRvblxyXG5cdFx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dChcIlJlbW92ZVwiKVxyXG5cdFx0XHRcdFx0XHQuc2V0V2FybmluZygpXHJcblx0XHRcdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnRlbnRUeXBlcy5maW5kKGN0ID0+IGN0LmlkID09PSBjdXN0b21UeXBlLmlkKTtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCB0eXBlTmFtZSA9IGNvbnRlbnRUeXBlPy5uYW1lIHx8IFwiY29udGVudCB0eXBlXCI7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgbW9kYWwgPSBuZXcgQ29uZmlybU1vZGFsKFxyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5hcHAsXHJcblx0XHRcdFx0XHRcdFx0XHRgQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIHJlbW92ZSBcIiR7dHlwZU5hbWV9XCI/IFRoaXMgYWN0aW9uIGNhbm5vdCBiZSB1bmRvbmUuYCxcclxuXHRcdFx0XHRcdFx0XHRcdFwiUmVtb3ZlXCIsXHJcblx0XHRcdFx0XHRcdFx0XHRcIkNhbmNlbFwiXHJcblx0XHRcdFx0XHRcdFx0KTtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBjb25maXJtZWQgPSBhd2FpdCBtb2RhbC53YWl0Rm9yUmVzdWx0KCk7XHJcblx0XHRcdFx0XHRcdFx0aWYgKGNvbmZpcm1lZCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5yZW1vdmVDdXN0b21Db250ZW50VHlwZShjdXN0b21UeXBlLmlkKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gSGlkZSB0aGUgZGl2aWRlciBsaW5lIGZvciB0aGUgcmVtb3ZlIGJ1dHRvblxyXG5cdFx0XHRyZW1vdmVTZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QuYWRkKFwiYXN0cm8tY29tcG9zZXItcmVtb3ZlLXNldHRpbmdcIik7XHJcblxyXG5cdFx0XHQvLyBTZXQgaW5pdGlhbCB2aXNpYmlsaXR5IChjaGVja3MgYm90aCBlbmFibGVkIGFuZCBjb2xsYXBzZWQgc3RhdGUpXHJcblx0XHRcdHRoaXMudXBkYXRlQ3VzdG9tQ29udGVudFR5cGVWaXNpYmlsaXR5KGN1c3RvbVR5cGUuaWQsIGN1c3RvbVR5cGUuZW5hYmxlZCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBVcGRhdGUgY29uZmxpY3Qgd2FybmluZ3MgZm9yIGFsbCB0eXBlcyBhZnRlciByZW5kZXJpbmcgKGZvbGRlciBjaGFuZ2VzIG1heSBhZmZlY3Qgb3RoZXJzKVxyXG5cdFx0Y29udGVudFR5cGVzLmZvckVhY2goKGN1c3RvbVR5cGU6IENvbnRlbnRUeXBlKSA9PiB7XHJcblx0XHRcdHRoaXMudXBkYXRlRm9sZGVyQ29uZmxpY3RXYXJuaW5nKGN1c3RvbVR5cGUuaWQsIG51bGwpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gQWRkIGZsb2F0aW5nIGJ1dHRvbiBmb3IgY3JlYXRpbmcgbmV3IGN1c3RvbSBjb250ZW50IHR5cGVzIChubyBzZXR0aW5ncyBiYWNrZ3JvdW5kKVxyXG5cdFx0Y29uc3QgYWRkQnV0dG9uQ29udGFpbmVyID0gdGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImFzdHJvLWNvbXBvc2VyLWFkZC1idXR0b24tY29udGFpbmVyXCIgfSk7XHJcblx0XHRjb25zdCBhZGRCdXR0b24gPSBhZGRCdXR0b25Db250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xyXG5cdFx0XHRjbHM6IFwibW9kLWN0YVwiLFxyXG5cdFx0XHR0ZXh0OiBcIkFkZCBjb250ZW50IHR5cGVcIlxyXG5cdFx0fSk7XHJcblx0XHRhZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuXHRcdFx0dGhpcy5hZGRDdXN0b21Db250ZW50VHlwZSgpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlVmlzaWJpbGl0eSh0eXBlSWQ6IHN0cmluZywgZW5hYmxlZDogYm9vbGVhbikge1xyXG5cdFx0Y29uc3Qgc2V0dGluZ3NDb250YWluZXIgPSB0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcj8ucXVlcnlTZWxlY3RvcihgW2RhdGEtdHlwZS1pZD1cIiR7dHlwZUlkfVwiXS5jdXN0b20tY29udGVudC10eXBlLXNldHRpbmdzYCkgYXMgSFRNTEVsZW1lbnQ7XHJcblx0XHRpZiAoc2V0dGluZ3NDb250YWluZXIpIHtcclxuXHRcdFx0Y29uc3QgY29udGVudFR5cGVzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0XHRjb25zdCBjb250ZW50VHlwZSA9IGNvbnRlbnRUeXBlcy5maW5kKChjdDogQ29udGVudFR5cGUpID0+IGN0LmlkID09PSB0eXBlSWQpO1xyXG5cdFx0XHRjb25zdCBpc0NvbGxhcHNlZCA9IGNvbnRlbnRUeXBlPy5jb2xsYXBzZWQgPz8gZmFsc2U7XHJcblx0XHRcdGNvbnN0IHNob3VsZEJlVmlzaWJsZSA9IGVuYWJsZWQgJiYgIWlzQ29sbGFwc2VkO1xyXG5cclxuXHRcdFx0c2V0dGluZ3NDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgc2hvdWxkQmVWaXNpYmxlKTtcclxuXHRcdFx0c2V0dGluZ3NDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhc2hvdWxkQmVWaXNpYmxlKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHByaXZhdGUgdXBkYXRlQ3VzdG9tQ29udGVudFR5cGVJbmRleEZpbGVGaWVsZCh0eXBlSWQ6IHN0cmluZykge1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Y29uc3QgY3VzdG9tVHlwZSA9IGNvbnRlbnRUeXBlcy5maW5kKHR5cGUgPT4gdHlwZS5pZCA9PT0gdHlwZUlkKTtcclxuXHRcdGlmICghY3VzdG9tVHlwZSkgcmV0dXJuO1xyXG5cclxuXHRcdGNvbnN0IGluZGV4RmlsZUNvbnRhaW5lciA9IHRoaXMuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyPy5xdWVyeVNlbGVjdG9yKGBbZGF0YS10eXBlLWlkPVwiJHt0eXBlSWR9XCJdIC5jdXN0b20taW5kZXgtZmlsZS1maWVsZGApIGFzIEhUTUxFbGVtZW50O1xyXG5cdFx0aWYgKGluZGV4RmlsZUNvbnRhaW5lcikge1xyXG5cdFx0XHRpbmRleEZpbGVDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgY3VzdG9tVHlwZS5jcmVhdGlvbk1vZGUgPT09IFwiZm9sZGVyXCIpO1xyXG5cdFx0XHRpbmRleEZpbGVDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCBjdXN0b21UeXBlLmNyZWF0aW9uTW9kZSAhPT0gXCJmb2xkZXJcIik7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlSWdub3JlU3ViZm9sZGVyc0ZpZWxkKHR5cGVJZDogc3RyaW5nKSB7XHJcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XHJcblx0XHRjb25zdCBjdXN0b21UeXBlID0gY29udGVudFR5cGVzLmZpbmQodHlwZSA9PiB0eXBlLmlkID09PSB0eXBlSWQpO1xyXG5cdFx0aWYgKCFjdXN0b21UeXBlKSByZXR1cm47XHJcblxyXG5cdFx0Y29uc3QgaWdub3JlU3ViZm9sZGVyc0NvbnRhaW5lciA9IHRoaXMuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyPy5xdWVyeVNlbGVjdG9yKGBbZGF0YS10eXBlLWlkPVwiJHt0eXBlSWR9XCJdLmN1c3RvbS1pZ25vcmUtc3ViZm9sZGVycy1maWVsZGApIGFzIEhUTUxFbGVtZW50O1xyXG5cdFx0aWYgKGlnbm9yZVN1YmZvbGRlcnNDb250YWluZXIpIHtcclxuXHRcdFx0aWdub3JlU3ViZm9sZGVyc0NvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCAhIWN1c3RvbVR5cGUuZm9sZGVyICYmIGN1c3RvbVR5cGUuZm9sZGVyLnRyaW0oKSAhPT0gXCJcIik7XHJcblx0XHRcdGlnbm9yZVN1YmZvbGRlcnNDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhY3VzdG9tVHlwZS5mb2xkZXIgfHwgY3VzdG9tVHlwZS5mb2xkZXIudHJpbSgpID09PSBcIlwiKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHByaXZhdGUgdXBkYXRlRm9sZGVyQ29uZmxpY3RXYXJuaW5nKHR5cGVJZDogc3RyaW5nLCBzZXR0aW5nOiBTZXR0aW5nIHwgbnVsbCkge1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Y29uc3QgY3VycmVudFR5cGUgPSBjb250ZW50VHlwZXMuZmluZCh0eXBlID0+IHR5cGUuaWQgPT09IHR5cGVJZCk7XHJcblx0XHRpZiAoIWN1cnJlbnRUeXBlKSByZXR1cm47XHJcblxyXG5cdFx0Y29uc3QgY29uZmxpY3RXYXJuaW5nRWwgPSB0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcj8ucXVlcnlTZWxlY3RvcihgW2RhdGEtdHlwZS1pZD1cIiR7dHlwZUlkfVwiXS5hc3Ryby1jb21wb3Nlci1jb25mbGljdC13YXJuaW5nYCkgYXMgSFRNTEVsZW1lbnQ7XHJcblx0XHRpZiAoIWNvbmZsaWN0V2FybmluZ0VsKSByZXR1cm47XHJcblxyXG5cdFx0Ly8gRmluZCBjb25mbGljdHMgLSBvdGhlciBjb250ZW50IHR5cGVzIHdpdGggdGhlIHNhbWUgZm9sZGVyIHBhdHRlcm5cclxuXHRcdGNvbnN0IGN1cnJlbnRGb2xkZXIgPSAoY3VycmVudFR5cGUuZm9sZGVyIHx8IFwiXCIpLnRyaW0oKTtcclxuXHRcdGNvbnN0IGNvbmZsaWN0aW5nVHlwZXM6IHN0cmluZ1tdID0gW107XHJcblxyXG5cdFx0Zm9yIChjb25zdCBvdGhlclR5cGUgb2YgY29udGVudFR5cGVzKSB7XHJcblx0XHRcdGlmIChvdGhlclR5cGUuaWQgPT09IHR5cGVJZCB8fCAhb3RoZXJUeXBlLmVuYWJsZWQpIGNvbnRpbnVlO1xyXG5cclxuXHRcdFx0Y29uc3Qgb3RoZXJGb2xkZXIgPSAob3RoZXJUeXBlLmZvbGRlciB8fCBcIlwiKS50cmltKCk7XHJcblxyXG5cdFx0XHQvLyBDaGVjayBpZiBmb2xkZXJzIGNvbmZsaWN0XHJcblx0XHRcdC8vIEJvdGggYmxhbmsgPSBjb25mbGljdCAoYm90aCBtYXRjaCB2YXVsdCByb290KVxyXG5cdFx0XHRpZiAoY3VycmVudEZvbGRlciA9PT0gXCJcIiAmJiBvdGhlckZvbGRlciA9PT0gXCJcIikge1xyXG5cdFx0XHRcdGNvbmZsaWN0aW5nVHlwZXMucHVzaChvdGhlclR5cGUubmFtZSB8fCBcIlVubmFtZWRcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gU2FtZSBmb2xkZXIgPSBjb25mbGljdFxyXG5cdFx0XHRlbHNlIGlmIChjdXJyZW50Rm9sZGVyID09PSBvdGhlckZvbGRlciAmJiBjdXJyZW50Rm9sZGVyICE9PSBcIlwiKSB7XHJcblx0XHRcdFx0Y29uZmxpY3RpbmdUeXBlcy5wdXNoKG90aGVyVHlwZS5uYW1lIHx8IFwiVW5uYW1lZFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChjb25mbGljdGluZ1R5cGVzLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0Y29uZmxpY3RXYXJuaW5nRWwucmVtb3ZlQ2xhc3MoXCJoaWRkZW5cIik7XHJcblx0XHRcdGNvbmZsaWN0V2FybmluZ0VsLnRleHRDb250ZW50ID0gYENvbmZsaWN0OiAke2NvbmZsaWN0aW5nVHlwZXMuam9pbihcIiwgXCIpfSBhbHNvIHVzZSR7Y29uZmxpY3RpbmdUeXBlcy5sZW5ndGggPT09IDEgPyBcInNcIiA6IFwiXCJ9IHRoaXMgZm9sZGVyLiBNb3JlIHNwZWNpZmljIHBhdHRlcm5zIHdpbGwgdGFrZSBwcmlvcml0eS5gO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Y29uZmxpY3RXYXJuaW5nRWwuYWRkQ2xhc3MoXCJoaWRkZW5cIik7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHJcblx0cHJpdmF0ZSBhc3luYyBtb3ZlQ29udGVudFR5cGVVcCh0eXBlSWQ6IHN0cmluZykge1xyXG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcclxuXHRcdGNvbnN0IGN1cnJlbnRJbmRleCA9IGNvbnRlbnRUeXBlcy5maW5kSW5kZXgoKGN0OiBDb250ZW50VHlwZSkgPT4gY3QuaWQgPT09IHR5cGVJZCk7XHJcblxyXG5cdFx0aWYgKGN1cnJlbnRJbmRleCA8PSAwKSByZXR1cm47IC8vIEFscmVhZHkgYXQgdGhlIHRvcFxyXG5cclxuXHRcdC8vIFN3YXAgd2l0aCBwcmV2aW91cyBpdGVtXHJcblx0XHRbY29udGVudFR5cGVzW2N1cnJlbnRJbmRleF0sIGNvbnRlbnRUeXBlc1tjdXJyZW50SW5kZXggLSAxXV0gPSBbY29udGVudFR5cGVzW2N1cnJlbnRJbmRleCAtIDFdLCBjb250ZW50VHlwZXNbY3VycmVudEluZGV4XV07XHJcblx0XHRzZXR0aW5ncy5jb250ZW50VHlwZXMgPSBjb250ZW50VHlwZXM7XHJcblx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdHRoaXMucmVuZGVyQ3VzdG9tQ29udGVudFR5cGVzKCk7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIGFzeW5jIG1vdmVDb250ZW50VHlwZURvd24odHlwZUlkOiBzdHJpbmcpIHtcclxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XHJcblx0XHRjb25zdCBjdXJyZW50SW5kZXggPSBjb250ZW50VHlwZXMuZmluZEluZGV4KChjdDogQ29udGVudFR5cGUpID0+IGN0LmlkID09PSB0eXBlSWQpO1xyXG5cclxuXHRcdGlmIChjdXJyZW50SW5kZXggPCAwIHx8IGN1cnJlbnRJbmRleCA+PSBjb250ZW50VHlwZXMubGVuZ3RoIC0gMSkgcmV0dXJuOyAvLyBBbHJlYWR5IGF0IHRoZSBib3R0b21cclxuXHJcblx0XHQvLyBTd2FwIHdpdGggbmV4dCBpdGVtXHJcblx0XHRbY29udGVudFR5cGVzW2N1cnJlbnRJbmRleF0sIGNvbnRlbnRUeXBlc1tjdXJyZW50SW5kZXggKyAxXV0gPSBbY29udGVudFR5cGVzW2N1cnJlbnRJbmRleCArIDFdLCBjb250ZW50VHlwZXNbY3VycmVudEluZGV4XV07XHJcblx0XHRzZXR0aW5ncy5jb250ZW50VHlwZXMgPSBjb250ZW50VHlwZXM7XHJcblx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdHRoaXMucmVuZGVyQ3VzdG9tQ29udGVudFR5cGVzKCk7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIGFzeW5jIHRvZ2dsZUNvbnRlbnRUeXBlQ29sbGFwc2UodHlwZUlkOiBzdHJpbmcpIHtcclxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XHJcblx0XHRjb25zdCBjb250ZW50VHlwZSA9IGNvbnRlbnRUeXBlcy5maW5kKChjdDogQ29udGVudFR5cGUpID0+IGN0LmlkID09PSB0eXBlSWQpO1xyXG5cclxuXHRcdGlmICghY29udGVudFR5cGUpIHJldHVybjtcclxuXHJcblx0XHRjb250ZW50VHlwZS5jb2xsYXBzZWQgPSAhY29udGVudFR5cGUuY29sbGFwc2VkO1xyXG5cdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHR0aGlzLnVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlVmlzaWJpbGl0eSh0eXBlSWQsIGNvbnRlbnRUeXBlLmVuYWJsZWQpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBhc3luYyByZW1vdmVDdXN0b21Db250ZW50VHlwZSh0eXBlSWQ6IHN0cmluZykge1xyXG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcclxuXHRcdHNldHRpbmdzLmNvbnRlbnRUeXBlcyA9IGNvbnRlbnRUeXBlcy5maWx0ZXIoKGN0OiBDb250ZW50VHlwZSkgPT4gY3QuaWQgIT09IHR5cGVJZCk7XHJcblx0XHQvLyBDUklUSUNBTDogQXdhaXQgdGhlIHNhdmUgdG8gZW5zdXJlIGRlbGV0aW9uIGlzIHBlcnNpc3RlZCBiZWZvcmUgYW55IHJlbG9hZHMgaGFwcGVuXHJcblx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdHRoaXMucmVuZGVyQ3VzdG9tQ29udGVudFR5cGVzKCk7XHJcblx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckNyZWF0ZUV2ZW50KCk7XHJcblx0XHQvLyBSZS1yZWdpc3RlciBjb250ZW50IHR5cGUgY29tbWFuZHMgdG8gcmVtb3ZlIHRoZSBkZWxldGVkIHR5cGVcclxuXHRcdHJlZ2lzdGVyQ29udGVudFR5cGVDb21tYW5kcyh0aGlzLnBsdWdpbiBhcyB1bmtub3duIGFzIFBsdWdpbiwgc2V0dGluZ3MpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBnZXRDb21tYW5kTmFtZShjb21tYW5kSWQ6IHN0cmluZyk6IHN0cmluZyB7XHJcblx0XHRpZiAoIWNvbW1hbmRJZCkgcmV0dXJuICcnO1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Y29uc3QgY29tbWFuZFJlZ2lzdHJ5ID0gKHRoaXMuYXBwIGFzIHVua25vd24gYXMgeyBjb21tYW5kcz86IHsgbGlzdENvbW1hbmRzPzogKCkgPT4gQXJyYXk8eyBpZDogc3RyaW5nOyBuYW1lOiBzdHJpbmcgfT47IGNvbW1hbmRzPzogUmVjb3JkPHN0cmluZywgeyBpZDogc3RyaW5nOyBuYW1lOiBzdHJpbmcgfT4gfSB9KS5jb21tYW5kcztcclxuXHJcblx0XHRcdC8vIE1ldGhvZCAxOiBUcnkgbGlzdENvbW1hbmRzKClcclxuXHRcdFx0aWYgKGNvbW1hbmRSZWdpc3RyeSAmJiB0eXBlb2YgY29tbWFuZFJlZ2lzdHJ5Lmxpc3RDb21tYW5kcyA9PT0gJ2Z1bmN0aW9uJykge1xyXG5cdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRjb25zdCBhbGxDb21tYW5kcyA9IGNvbW1hbmRSZWdpc3RyeS5saXN0Q29tbWFuZHMoKTtcclxuXHRcdFx0XHRcdGNvbnN0IGNvbW1hbmQgPSBhbGxDb21tYW5kcy5maW5kKChjbWQ6IHsgaWQ6IHN0cmluZzsgbmFtZT86IHN0cmluZyB9KSA9PiBjbWQuaWQgPT09IGNvbW1hbmRJZCk7XHJcblx0XHRcdFx0XHRpZiAoY29tbWFuZD8ubmFtZSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gY29tbWFuZC5uYW1lO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0XHRcdGNvbnNvbGUud2FybignW0FzdHJvIENvbXBvc2VyXSBFcnJvciBnZXR0aW5nIGNvbW1hbmQgbmFtZSB2aWEgbGlzdENvbW1hbmRzKCk6JywgZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBNZXRob2QgMjogVHJ5IGFjY2Vzc2luZyB0aGUgaW50ZXJuYWwgY29tbWFuZHMgcmVnaXN0cnkgZGlyZWN0bHlcclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRjb25zdCByZWdpc3RyeSA9IGNvbW1hbmRSZWdpc3RyeT8uY29tbWFuZHM7XHJcblx0XHRcdFx0aWYgKHJlZ2lzdHJ5ICYmIHR5cGVvZiByZWdpc3RyeSA9PT0gJ29iamVjdCcpIHtcclxuXHRcdFx0XHRcdGNvbnN0IGNvbW1hbmQgPSAocmVnaXN0cnkgYXMgUmVjb3JkPHN0cmluZywgeyBuYW1lPzogc3RyaW5nIH0+KVtjb21tYW5kSWRdO1xyXG5cdFx0XHRcdFx0aWYgKGNvbW1hbmQ/Lm5hbWUpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGNvbW1hbmQubmFtZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3IgZ2V0dGluZyBjb21tYW5kIG5hbWUgdmlhIHJlZ2lzdHJ5OicsIGUpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdGNvbnNvbGUud2FybignW0FzdHJvIENvbXBvc2VyXSBFcnJvciBnZXR0aW5nIGNvbW1hbmQgbmFtZTonLCBlKTtcclxuXHRcdH1cclxuXHRcdC8vIFJldHVybiBlbXB0eSBzdHJpbmcgaWYgY29tbWFuZCBub3QgZm91bmQsIHNvIGl0IHNob3dzIFwiU2VsZWN0IGNvbW1hbmQuLi5cIiBwbGFjZWhvbGRlclxyXG5cdFx0cmV0dXJuICcnO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBnZXRJY29uTmFtZShpY29uSWQ6IHN0cmluZyk6IHN0cmluZyB7XHJcblx0XHRpZiAoIWljb25JZCkgcmV0dXJuICcnO1xyXG5cdFx0Ly8gQ29udmVydCBpY29uIElEIHRvIGEgcmVhZGFibGUgbmFtZSwgcmVtb3ZpbmcgbHVjaWRlLSBwcmVmaXggaWYgcHJlc2VudFxyXG5cdFx0cmV0dXJuIGljb25JZFxyXG5cdFx0XHQucmVwbGFjZSgvXmx1Y2lkZS0vLCAnJykgLy8gUmVtb3ZlIGx1Y2lkZS0gcHJlZml4XHJcblx0XHRcdC5zcGxpdCgnLScpXHJcblx0XHRcdC5tYXAod29yZCA9PiB3b3JkLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgd29yZC5zbGljZSgxKSlcclxuXHRcdFx0LmpvaW4oJyAnKTtcclxuXHR9XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBDb21tYW5kIFBpY2tlciBNb2RhbFxyXG4gKiBTZWFyY2hhYmxlIG1vZGFsIGZvciBzZWxlY3RpbmcgYW4gT2JzaWRpYW4gY29tbWFuZFxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEFwcCwgRnV6enlTdWdnZXN0TW9kYWwgfSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG5pbnRlcmZhY2UgQ29tbWFuZE9wdGlvbiB7XHJcblx0aWQ6IHN0cmluZztcclxuXHRuYW1lOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDb21tYW5kUGlja2VyTW9kYWwgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxDb21tYW5kT3B0aW9uPiB7XHJcblx0cHJpdmF0ZSBvblNlbGVjdDogKGNvbW1hbmRJZDogc3RyaW5nKSA9PiB2b2lkO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgb25TZWxlY3Q6IChjb21tYW5kSWQ6IHN0cmluZykgPT4gdm9pZCkge1xyXG5cdFx0c3VwZXIoYXBwKTtcclxuXHRcdHRoaXMub25TZWxlY3QgPSBvblNlbGVjdDtcclxuXHR9XHJcblxyXG5cdGdldEl0ZW1zKCk6IENvbW1hbmRPcHRpb25bXSB7XHJcblx0XHQvLyBHZXQgYWxsIGF2YWlsYWJsZSBjb21tYW5kc1xyXG5cdFx0Ly8gVHJ5IG11bHRpcGxlIG1ldGhvZHMgdG8gZW5zdXJlIHdlIGdldCBBTEwgY29tbWFuZHMsIG5vdCBqdXN0IGNvbnRleHQtZmlsdGVyZWQgb25lc1xyXG5cdFx0Y29uc3QgY29tbWFuZFJlZ2lzdHJ5ID0gKHRoaXMuYXBwIGFzIHsgY29tbWFuZHM/OiB7IGxpc3RDb21tYW5kcz86ICgpID0+IENvbW1hbmRPcHRpb25bXTsgY29tbWFuZHM/OiBSZWNvcmQ8c3RyaW5nLCBDb21tYW5kT3B0aW9uPjsgY29tbWFuZFJlZ2lzdHJ5PzogUmVjb3JkPHN0cmluZywgQ29tbWFuZE9wdGlvbj4gfSB9KS5jb21tYW5kcztcclxuXHRcdFxyXG5cdFx0Ly8gVXNlIGEgU2V0IHRvIGRlZHVwbGljYXRlIGJ5IGNvbW1hbmQgSURcclxuXHRcdGNvbnN0IGNvbW1hbmRNYXAgPSBuZXcgTWFwPHN0cmluZywgQ29tbWFuZE9wdGlvbj4oKTtcclxuXHRcdFxyXG5cdFx0Ly8gTWV0aG9kIDE6IFRyeSBsaXN0Q29tbWFuZHMoKSAtIGJ1dCB0aGlzIG1pZ2h0IGJlIGNvbnRleHQtZmlsdGVyZWRcclxuXHRcdGlmIChjb21tYW5kUmVnaXN0cnkgJiYgdHlwZW9mIGNvbW1hbmRSZWdpc3RyeS5saXN0Q29tbWFuZHMgPT09ICdmdW5jdGlvbicpIHtcclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRjb25zdCBjb21tYW5kcyA9IGNvbW1hbmRSZWdpc3RyeS5saXN0Q29tbWFuZHMoKTtcclxuXHRcdFx0XHRmb3IgKGNvbnN0IGNvbW1hbmQgb2YgY29tbWFuZHMpIHtcclxuXHRcdFx0XHRcdGlmIChjb21tYW5kICYmIGNvbW1hbmQuaWQgJiYgY29tbWFuZC5uYW1lICYmICFjb21tYW5kTWFwLmhhcyhjb21tYW5kLmlkKSkge1xyXG5cdFx0XHRcdFx0XHRjb21tYW5kTWFwLnNldChjb21tYW5kLmlkLCB7XHJcblx0XHRcdFx0XHRcdFx0aWQ6IGNvbW1hbmQuaWQsXHJcblx0XHRcdFx0XHRcdFx0bmFtZTogY29tbWFuZC5uYW1lXHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRcdGNvbnNvbGUud2FybignW0FzdHJvIENvbXBvc2VyXSBFcnJvciBnZXR0aW5nIGNvbW1hbmRzIHZpYSBsaXN0Q29tbWFuZHMoKTonLCBlKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHQvLyBNZXRob2QgMjogVHJ5IGFjY2Vzc2luZyB0aGUgaW50ZXJuYWwgY29tbWFuZHMgcmVnaXN0cnkgZGlyZWN0bHlcclxuXHRcdC8vIFRoaXMgc2hvdWxkIGdpdmUgdXMgQUxMIGNvbW1hbmRzIHJlZ2FyZGxlc3Mgb2YgY29udGV4dFxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Y29uc3QgcmVnaXN0cnkgPSBjb21tYW5kUmVnaXN0cnk/LmNvbW1hbmRzO1xyXG5cdFx0XHRpZiAocmVnaXN0cnkgJiYgdHlwZW9mIHJlZ2lzdHJ5ID09PSAnb2JqZWN0Jykge1xyXG5cdFx0XHRcdGNvbnN0IGFsbENvbW1hbmRzID0gT2JqZWN0LnZhbHVlcyhyZWdpc3RyeSk7XHJcblx0XHRcdFx0Zm9yIChjb25zdCBjb21tYW5kIG9mIGFsbENvbW1hbmRzKSB7XHJcblx0XHRcdFx0XHRpZiAoY29tbWFuZCAmJiBjb21tYW5kLmlkICYmIGNvbW1hbmQubmFtZSAmJiAhY29tbWFuZE1hcC5oYXMoY29tbWFuZC5pZCkpIHtcclxuXHRcdFx0XHRcdFx0Y29tbWFuZE1hcC5zZXQoY29tbWFuZC5pZCwge1xyXG5cdFx0XHRcdFx0XHRcdGlkOiBjb21tYW5kLmlkLFxyXG5cdFx0XHRcdFx0XHRcdG5hbWU6IGNvbW1hbmQubmFtZVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0Y29uc29sZS53YXJuKCdbQXN0cm8gQ29tcG9zZXJdIEVycm9yIGdldHRpbmcgY29tbWFuZHMgdmlhIHJlZ2lzdHJ5OicsIGUpO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHQvLyBNZXRob2QgMzogVHJ5IGFjY2Vzc2luZyB2aWEgaW50ZXJuYWwgc3RydWN0dXJlIChmYWxsYmFjaylcclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IGludGVybmFsUmVnaXN0cnkgPSBjb21tYW5kUmVnaXN0cnk/LmNvbW1hbmRSZWdpc3RyeTtcclxuXHRcdFx0aWYgKGludGVybmFsUmVnaXN0cnkgJiYgdHlwZW9mIGludGVybmFsUmVnaXN0cnkgPT09ICdvYmplY3QnKSB7XHJcblx0XHRcdFx0Y29uc3QgYWxsQ29tbWFuZHMgPSBPYmplY3QudmFsdWVzKGludGVybmFsUmVnaXN0cnkpO1xyXG5cdFx0XHRcdGZvciAoY29uc3QgY29tbWFuZCBvZiBhbGxDb21tYW5kcykge1xyXG5cdFx0XHRcdFx0aWYgKGNvbW1hbmQgJiYgY29tbWFuZC5pZCAmJiBjb21tYW5kLm5hbWUgJiYgIWNvbW1hbmRNYXAuaGFzKGNvbW1hbmQuaWQpKSB7XHJcblx0XHRcdFx0XHRcdGNvbW1hbmRNYXAuc2V0KGNvbW1hbmQuaWQsIHtcclxuXHRcdFx0XHRcdFx0XHRpZDogY29tbWFuZC5pZCxcclxuXHRcdFx0XHRcdFx0XHRuYW1lOiBjb21tYW5kLm5hbWVcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdGNvbnNvbGUud2FybignW0FzdHJvIENvbXBvc2VyXSBFcnJvciBnZXR0aW5nIGNvbW1hbmRzIHZpYSBpbnRlcm5hbCByZWdpc3RyeTonLCBlKTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Y29uc3QgY29tbWFuZE9wdGlvbnMgPSBBcnJheS5mcm9tKGNvbW1hbmRNYXAudmFsdWVzKCkpO1xyXG5cdFx0XHJcblx0XHQvLyBTb3J0IGFscGhhYmV0aWNhbGx5IGJ5IG5hbWVcclxuXHRcdGNvbW1hbmRPcHRpb25zLnNvcnQoKGEsIGIpID0+IGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSkpO1xyXG5cdFx0XHJcblx0XHRyZXR1cm4gY29tbWFuZE9wdGlvbnM7XHJcblx0fVxyXG5cclxuXHRnZXRJdGVtVGV4dChpdGVtOiBDb21tYW5kT3B0aW9uKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBpdGVtLm5hbWU7XHJcblx0fVxyXG5cclxuXHRvbkNob29zZUl0ZW0oaXRlbTogQ29tbWFuZE9wdGlvbiwgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xyXG5cdFx0dGhpcy5vblNlbGVjdChpdGVtLmlkKTtcclxuXHR9XHJcblxyXG5cdC8vIE92ZXJyaWRlIHRvIHNob3cgY29tbWFuZCBuYW1lIG9ubHlcclxuXHRyZW5kZXJTdWdnZXN0aW9uKG1hdGNoOiB7IGl0ZW06IENvbW1hbmRPcHRpb24gfSwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcblx0XHRjb25zdCBpdGVtID0gbWF0Y2guaXRlbTtcclxuXHRcdGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tdGl0bGUnLCB0ZXh0OiBpdGVtLm5hbWUgfSk7XHJcblx0fVxyXG59XHJcblxyXG4iLCAiLyoqXHJcbiAqIEljb24gUGlja2VyIE1vZGFsXHJcbiAqIFNlYXJjaGFibGUgbW9kYWwgZm9yIHNlbGVjdGluZyBhIEx1Y2lkZSBpY29uXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgQXBwLCBGdXp6eVN1Z2dlc3RNb2RhbCwgc2V0SWNvbiwgZ2V0SWNvbklkcywgcmVxdWlyZUFwaVZlcnNpb24gfSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG5pbnRlcmZhY2UgSWNvbk9wdGlvbiB7XHJcblx0aWQ6IHN0cmluZztcclxuXHRuYW1lOiBzdHJpbmc7XHJcbn1cclxuXHJcbi8vIEdldCBpY29uIGxpc3QgZnJvbSBPYnNpZGlhbiBBUEkgaWYgYXZhaWxhYmxlLCBvdGhlcndpc2UgdXNlIGZhbGxiYWNrIGxpc3RcclxuY29uc3QgZ2V0SWNvbkxpc3QgPSAoKTogc3RyaW5nW10gPT4ge1xyXG5cdGlmIChyZXF1aXJlQXBpVmVyc2lvbiAmJiByZXF1aXJlQXBpVmVyc2lvbignMS43LjMnKSAmJiBnZXRJY29uSWRzKSB7XHJcblx0XHR0cnkge1xyXG5cdFx0XHRyZXR1cm4gZ2V0SWNvbklkcygpO1xyXG5cdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3IgZ2V0dGluZyBpY29uIElEcyBmcm9tIE9ic2lkaWFuOicsIGUpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHQvLyBGYWxsYmFjayB0byBhIGJhc2ljIGxpc3QgaWYgQVBJIGlzIG5vdCBhdmFpbGFibGVcclxuXHRyZXR1cm4gW1xyXG5cdFx0J3NldHRpbmdzLTInLCAnc2V0dGluZ3MnLCAnaGVscC1jaXJjbGUnLCAnaW5mbycsICdzdGFyJywgJ2hlYXJ0JywgJ2Jvb2ttYXJrJyxcclxuXHRcdCdob21lJywgJ3NlYXJjaCcsICdiZWxsJywgJ21haWwnLCAndXNlcicsICd1c2VycycsICdmb2xkZXInLCAnZmlsZScsICdmaWxlLXRleHQnLFxyXG5cdFx0J2ltYWdlJywgJ3ZpZGVvJywgJ211c2ljJywgJ2NhbGVuZGFyJywgJ2Nsb2NrJywgJ2VkaXQnLCAncGVuY2lsJywgJ3RyYXNoJyxcclxuXHRcdCdjb3B5JywgJ2N1dCcsICdwYXN0ZScsICdkb3dubG9hZCcsICd1cGxvYWQnLCAnc2F2ZScsICdzaGFyZScsICdsaW5rJyxcclxuXHRcdCdleHRlcm5hbC1saW5rJywgJ2xvY2snLCAndW5sb2NrJywgJ2V5ZScsICdleWUtb2ZmJywgJ2tleScsICdzaGllbGQnLFxyXG5cdFx0J2NoZWNrJywgJ3gnLCAncGx1cycsICdtaW51cycsICdhcnJvdy1sZWZ0JywgJ2Fycm93LXJpZ2h0JywgJ2Fycm93LXVwJyxcclxuXHRcdCdhcnJvdy1kb3duJywgJ2NoZXZyb24tbGVmdCcsICdjaGV2cm9uLXJpZ2h0JywgJ2NoZXZyb24tdXAnLCAnY2hldnJvbi1kb3duJyxcclxuXHRcdCdtZW51JywgJ21vcmUtaG9yaXpvbnRhbCcsICdtb3JlLXZlcnRpY2FsJywgJ2dyaWQnLCAnbGlzdCcsICdsYXlvdXQnLFxyXG5cdFx0J2NvbHVtbnMnLCAncm93cycsICdtYXhpbWl6ZScsICdtaW5pbWl6ZScsICd6b29tLWluJywgJ3pvb20tb3V0JyxcclxuXHRcdCdyZWZyZXNoLWN3JywgJ3BsYXknLCAncGF1c2UnLCAnc3RvcCcsICdzdW4nLCAnbW9vbicsICdjbG91ZCcsICd6YXAnLFxyXG5cdFx0J3dhbmQtMicsICd3YW5kJywgJ3dhbmQtc3BhcmtsZXMnLCAncGFsZXR0ZScsICdicnVzaCcsICdzbGlkZXJzJyxcclxuXHRcdCdwb3dlcicsICd3aWZpJywgJ2JsdWV0b290aCcsICdtb25pdG9yJywgJ2xhcHRvcCcsICdzbWFydHBob25lJyxcclxuXHRcdCdjYW1lcmEnLCAnbWljJywgJ2hlYWRwaG9uZXMnLCAnY29kZScsICd0ZXJtaW5hbCcsICd0ZXJtaW5hbC1zcXVhcmUnLFxyXG5cdFx0J2dpdGh1YicsICdnaXRsYWInLCAnZ2l0LWJyYW5jaCcsICdnaXQtY29tbWl0JywgJ2RhdGFiYXNlJywgJ3NlcnZlcicsXHJcblx0XHQnY2xvdWQtZG93bmxvYWQnLCAnY2xvdWQtdXBsb2FkJywgJ3RhZycsICd0YWdzJywgJ2ZsYWcnLCAncGluJyxcclxuXHRcdCdtYXAtcGluJywgJ2NvbXBhc3MnLCAnZ2xvYmUnLCAncm9ja2V0JywgJ2NhcicsICdiaWtlJywgJ3JvYm90JyxcclxuXHRcdCdhcHBsZScsICd3aW5kb3dzJywgJ2xpbnV4JywgJ2Nocm9tZScsICdmaXJlZm94JywgJ3NhZmFyaScsXHJcblx0XHQnY3JlZGl0LWNhcmQnLCAnd2FsbGV0JywgJ2NvaW5zJywgJ2Jvb2snLCAnYm9vay1vcGVuJywgJ2F3YXJkJyxcclxuXHRcdCd0cm9waHknLCAnYmFkZ2UnLCAnd3JlbmNoJywgJ3Rvb2wnLCAncGFja2FnZScsICdib3gnLCAnYXJjaGl2ZScsXHJcblx0XHQnc2VuZCcsICdyZXBseScsICdmb3J3YXJkJywgJ21haWwtb3BlbicsICd0YWctcGx1cycsICd0YWctbWludXMnLFxyXG5cdFx0J2ZsYWctb2ZmJywgJ3Bpbi1vZmYnLCAnbWFwLXBpbi1vZmYnLCAnbmF2aWdhdGlvbicsICdtYXAnLCAnZWFydGgnLFxyXG5cdFx0J3BsYW5lJywgJ3NoaXAnLCAnYW5jaG9yJywgJ2hlbGljb3B0ZXInLCAnZHJvbmUnLCAnYW5kcm9pZCcsXHJcblx0XHQna2V5aG9sZScsICdrZXlzJywgJ2ZpbmdlcnByaW50JywgJ3NjYW4nLCAncXItY29kZScsICdiYXJjb2RlJyxcclxuXHRcdCdyZWNlaXB0JywgJ3BpZ2d5LWJhbmsnLCAnYmFua25vdGUnXHJcblx0XTtcclxufTtcclxuXHJcbi8vIENvbnZlcnQgaWNvbiBJRHMgdG8gSWNvbk9wdGlvbiBmb3JtYXRcclxuY29uc3QgTFVDSURFX0lDT05TOiBJY29uT3B0aW9uW10gPSBnZXRJY29uTGlzdCgpLm1hcChpZCA9PiAoe1xyXG5cdGlkOiBpZCxcclxuXHRuYW1lOiBpZFxyXG5cdFx0LnJlcGxhY2UoL15sdWNpZGUtLywgJycpIC8vIFJlbW92ZSBsdWNpZGUtIHByZWZpeCBmb3IgZGlzcGxheVxyXG5cdFx0LnJlcGxhY2UoLy0vZywgJyAnKVxyXG5cdFx0LnJlcGxhY2UoLyheXFx3ezF9KXwoXFxzK1xcd3sxfSkvZywgKGxldHRlcikgPT4gbGV0dGVyLnRvVXBwZXJDYXNlKCkpXHJcbn0pKS5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKTtcclxuXHJcbmV4cG9ydCBjbGFzcyBJY29uUGlja2VyTW9kYWwgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxJY29uT3B0aW9uPiB7XHJcblx0cHJpdmF0ZSBvblNlbGVjdDogKGljb25JZDogc3RyaW5nKSA9PiB2b2lkO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgb25TZWxlY3Q6IChpY29uSWQ6IHN0cmluZykgPT4gdm9pZCkge1xyXG5cdFx0c3VwZXIoYXBwKTtcclxuXHRcdHRoaXMub25TZWxlY3QgPSBvblNlbGVjdDtcclxuXHR9XHJcblxyXG5cdGdldEl0ZW1zKCk6IEljb25PcHRpb25bXSB7XHJcblx0XHRyZXR1cm4gTFVDSURFX0lDT05TO1xyXG5cdH1cclxuXHJcblx0Z2V0SXRlbVRleHQoaXRlbTogSWNvbk9wdGlvbik6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gaXRlbS5uYW1lO1xyXG5cdH1cclxuXHJcblx0b25DaG9vc2VJdGVtKGl0ZW06IEljb25PcHRpb24sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcclxuXHRcdC8vIFN0YW5kYXJkaXplIGljb24gSUQgYnkgcmVtb3ZpbmcgbHVjaWRlLSBwcmVmaXhcclxuXHRcdGNvbnN0IG5vcm1hbGl6ZWRJZCA9IGl0ZW0uaWQucmVwbGFjZSgvXmx1Y2lkZS0vLCAnJyk7XHJcblx0XHR0aGlzLm9uU2VsZWN0KG5vcm1hbGl6ZWRJZCk7XHJcblx0fVxyXG5cclxuXHQvLyBPdmVycmlkZSB0byBzaG93IGljb24gcHJldmlld1xyXG5cdHJlbmRlclN1Z2dlc3Rpb24obWF0Y2g6IHsgaXRlbTogSWNvbk9wdGlvbiB9LCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuXHRcdGNvbnN0IGl0ZW0gPSBtYXRjaC5pdGVtO1xyXG5cdFx0ZWwuYWRkQ2xhc3MoJ21vZC1jb21wbGV4Jyk7XHJcblx0XHRjb25zdCBjb250ZW50ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1jb250ZW50JyB9KTtcclxuXHRcdGNvbnRlbnQuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi10aXRsZScsIHRleHQ6IGl0ZW0ubmFtZSB9KTtcclxuXHJcblx0XHQvLyBDcmVhdGUgaWNvbiBwcmV2aWV3IHVzaW5nIE9ic2lkaWFuJ3Mgc2V0SWNvblxyXG5cdFx0Y29uc3QgYXV4ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1hdXgnIH0pO1xyXG5cdFx0c2V0SWNvbihhdXguY3JlYXRlU3Bhbih7IGNsczogJ3N1Z2dlc3Rpb24tZmxhaXInIH0pLCBpdGVtLmlkKTtcclxuXHR9XHJcbn1cclxuXHJcbiIsICJpbXBvcnQgeyBBcHAsIE1vZGFsIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQ29uZmlybU1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG5cdHJlc3VsdDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cdHJlc29sdmVQcm9taXNlOiAoKHJlc3VsdDogYm9vbGVhbikgPT4gdm9pZCkgfCBudWxsID0gbnVsbDtcclxuXHJcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHByaXZhdGUgbWVzc2FnZTogc3RyaW5nLCBwcml2YXRlIGNvbmZpcm1UZXh0OiBzdHJpbmcgPSBcIkNvbmZpcm1cIiwgcHJpdmF0ZSBjYW5jZWxUZXh0OiBzdHJpbmcgPSBcIkNhbmNlbFwiKSB7XHJcblx0XHRzdXBlcihhcHApO1xyXG5cdH1cclxuXHJcblx0b25PcGVuKCkge1xyXG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcclxuXHRcdGNvbnRlbnRFbC5hZGRDbGFzcyhcImFzdHJvLWNvbXBvc2VyLWNvbmZpcm0tbW9kYWxcIik7XHJcblxyXG5cdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IHRoaXMubWVzc2FnZSB9KTtcclxuXHJcblx0XHRjb25zdCBidXR0b25Db250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1vZGFsLWJ1dHRvbi1jb250YWluZXJcIiB9KTtcclxuXHJcblx0XHRjb25zdCBjYW5jZWxCdXR0b24gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xyXG5cdFx0XHR0ZXh0OiB0aGlzLmNhbmNlbFRleHQsXHJcblx0XHR9KTtcclxuXHRcdGNhbmNlbEJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG5cdFx0XHR0aGlzLnJlc3VsdCA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLmNsb3NlKCk7XHJcblx0XHR9O1xyXG5cclxuXHRcdGNvbnN0IGNvbmZpcm1CdXR0b24gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xyXG5cdFx0XHR0ZXh0OiB0aGlzLmNvbmZpcm1UZXh0LFxyXG5cdFx0XHRjbHM6IFwibW9kLWN0YSBtb2Qtd2FybmluZ1wiLFxyXG5cdFx0fSk7XHJcblx0XHRjb25maXJtQnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XHJcblx0XHRcdHRoaXMucmVzdWx0ID0gdHJ1ZTtcclxuXHRcdFx0dGhpcy5jbG9zZSgpO1xyXG5cdFx0fTtcclxuXHR9XHJcblxyXG5cdG9uQ2xvc2UoKSB7XHJcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xyXG5cdFx0aWYgKHRoaXMucmVzb2x2ZVByb21pc2UpIHtcclxuXHRcdFx0dGhpcy5yZXNvbHZlUHJvbWlzZSh0aGlzLnJlc3VsdCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRhc3luYyB3YWl0Rm9yUmVzdWx0KCk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcblx0XHRcdHRoaXMucmVzb2x2ZVByb21pc2UgPSByZXNvbHZlO1xyXG5cdFx0XHR0aGlzLm9wZW4oKTtcclxuXHRcdH0pO1xyXG5cdH1cclxufVxyXG5cclxuIiwgIi8qKlxyXG4gKiBDb21wYXRpYmlsaXR5IHV0aWxpdGllcyBmb3Igc2V0dGluZ3NcclxuICogUHJvdmlkZXMgYmFja3dhcmQgY29tcGF0aWJpbGl0eSBmb3IgU2V0dGluZ0dyb3VwIChyZXF1aXJlcyBBUEkgMS4xMS4wKylcclxuICovXHJcblxyXG5pbXBvcnQgeyBTZXR0aW5nLCByZXF1aXJlQXBpVmVyc2lvbiB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0ICogYXMgT2JzaWRpYW5Nb2R1bGUgZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuLyoqXHJcbiAqIEludGVyZmFjZSB0aGF0IHdvcmtzIHdpdGggYm90aCBTZXR0aW5nR3JvdXAgYW5kIGZhbGxiYWNrIGNvbnRhaW5lclxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBTZXR0aW5nc0NvbnRhaW5lciB7XHJcblx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpOiB2b2lkO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlcyBhIHNldHRpbmdzIGNvbnRhaW5lciB0aGF0IHVzZXMgU2V0dGluZ0dyb3VwIGlmIGF2YWlsYWJsZSAoQVBJIDEuMTEuMCspLFxyXG4gKiBvdGhlcndpc2UgZmFsbHMgYmFjayB0byBjcmVhdGluZyBhIGhlYWRpbmcgYW5kIHVzaW5nIHRoZSBjb250YWluZXIgZGlyZWN0bHkuXHJcbiAqIFxyXG4gKiBVc2VzIHJlcXVpcmVBcGlWZXJzaW9uKCcxLjExLjAnKSB0byBjaGVjayBpZiBTZXR0aW5nR3JvdXAgaXMgYXZhaWxhYmxlLlxyXG4gKiBUaGlzIGlzIHRoZSBvZmZpY2lhbCBPYnNpZGlhbiBBUEkgbWV0aG9kIGZvciB2ZXJzaW9uIGNoZWNraW5nLlxyXG4gKiBcclxuICogQHBhcmFtIGNvbnRhaW5lckVsIC0gVGhlIGNvbnRhaW5lciBlbGVtZW50IGZvciBzZXR0aW5nc1xyXG4gKiBAcGFyYW0gaGVhZGluZyAtIFRoZSBoZWFkaW5nIHRleHQgZm9yIHRoZSBzZXR0aW5ncyBncm91cCAob3B0aW9uYWwpXHJcbiAqIEBwYXJhbSBtYW5pZmVzdElkIC0gVGhlIHBsdWdpbidzIG1hbmlmZXN0IElEIGZvciBDU1Mgc2NvcGluZyAocmVxdWlyZWQgZm9yIGZhbGxiYWNrIG1vZGUpXHJcbiAqIEByZXR1cm5zIEEgY29udGFpbmVyIHRoYXQgY2FuIGJlIHVzZWQgdG8gYWRkIHNldHRpbmdzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2V0dGluZ3NHcm91cChcclxuXHRjb250YWluZXJFbDogSFRNTEVsZW1lbnQsXHJcblx0aGVhZGluZz86IHN0cmluZyxcclxuXHRtYW5pZmVzdElkPzogc3RyaW5nXHJcbik6IFNldHRpbmdzQ29udGFpbmVyIHtcclxuXHQvLyBDaGVjayBpZiBTZXR0aW5nR3JvdXAgaXMgYXZhaWxhYmxlIChBUEkgMS4xMS4wKylcclxuXHQvLyByZXF1aXJlQXBpVmVyc2lvbiBpcyB0aGUgb2ZmaWNpYWwgT2JzaWRpYW4gQVBJIG1ldGhvZCBmb3IgdmVyc2lvbiBjaGVja2luZ1xyXG5cdGlmIChyZXF1aXJlQXBpVmVyc2lvbignMS4xMS4wJykpIHtcclxuXHRcdC8vIFVzZSBTZXR0aW5nR3JvdXAgLSBpdCdzIGd1YXJhbnRlZWQgdG8gZXhpc3QgaWYgcmVxdWlyZUFwaVZlcnNpb24gcmV0dXJucyB0cnVlXHJcblx0XHQvLyBBY2Nlc3MgU2V0dGluZ0dyb3VwIHZpYSB0eXBlIGFzc2VydGlvbiBzaW5jZSBpdCBtYXkgbm90IGJlIGluIHR5cGUgZGVmaW5pdGlvbnNcclxuXHRcdC8vIGZvciBvbGRlciBUeXBlU2NyaXB0IHZlcnNpb25zLCBidXQgZXhpc3RzIGF0IHJ1bnRpbWUgaW4gT2JzaWRpYW4gMS4xMS4wK1xyXG5cdFx0Ly8gVXNpbmcgdW5rbm93biBpbnN0ZWFkIG9mIGFueSB0byBzYXRpc2Z5IGVzbGludCB3aGlsZSBtYWludGFpbmluZyB0eXBlIHNhZmV0eVxyXG5cdFx0Y29uc3QgU2V0dGluZ0dyb3VwQ2xhc3MgPSAoT2JzaWRpYW5Nb2R1bGUgYXMgdW5rbm93biBhcyB7IFNldHRpbmdHcm91cD86IG5ldyAoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KSA9PiB7XHJcblx0XHRcdHNldEhlYWRpbmcoaGVhZGluZzogc3RyaW5nKToge1xyXG5cdFx0XHRcdGFkZFNldHRpbmcoY2I6IChzZXR0aW5nOiBTZXR0aW5nKSA9PiB2b2lkKTogdm9pZDtcclxuXHRcdFx0fTtcclxuXHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpOiB2b2lkO1xyXG5cdFx0fSB9KS5TZXR0aW5nR3JvdXA7XHJcblx0XHRcclxuXHRcdGlmIChTZXR0aW5nR3JvdXBDbGFzcykge1xyXG5cdFx0XHRjb25zdCBncm91cCA9IGhlYWRpbmcgXHJcblx0XHRcdFx0PyBuZXcgU2V0dGluZ0dyb3VwQ2xhc3MoY29udGFpbmVyRWwpLnNldEhlYWRpbmcoaGVhZGluZylcclxuXHRcdFx0XHQ6IG5ldyBTZXR0aW5nR3JvdXBDbGFzcyhjb250YWluZXJFbCk7XHJcblx0XHRcdHJldHVybiB7XHJcblx0XHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpIHtcclxuXHRcdFx0XHRcdGdyb3VwLmFkZFNldHRpbmcoY2IpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fTtcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0Ly8gRmFsbGJhY2sgcGF0aCAoZWl0aGVyIEFQSSA8IDEuMTEuMCBvciBTZXR0aW5nR3JvdXAgbm90IGZvdW5kKVxyXG5cdC8vIEFkZCBzY29waW5nIGNsYXNzIHRvIGNvbnRhaW5lckVsIHRvIHNjb3BlIENTUyB0byBvbmx5IHRoaXMgcGx1Z2luJ3Mgc2V0dGluZ3NcclxuXHRpZiAobWFuaWZlc3RJZCkge1xyXG5cdFx0Y29udGFpbmVyRWwuYWRkQ2xhc3MoYCR7bWFuaWZlc3RJZH0tc2V0dGluZ3MtY29tcGF0YCk7XHJcblx0fVxyXG5cdFxyXG5cdHtcclxuXHRcdC8vIEZhbGxiYWNrOiBDcmVhdGUgYSBoZWFkaW5nIG1hbnVhbGx5IGZvciBvbGRlciBBUEkgdmVyc2lvbnNcclxuXHRcdC8vIE5vdGU6IFdoaWxlIGJlc3QgcHJhY3RpY2UgcHJlZmVycyBTZXR0aW5nLnNldEhlYWRpbmcoKSwgdGhlIGZhbGxiYWNrIHBhdGhcclxuXHRcdC8vIGlzIGZvciB2ZXJzaW9ucyB0aGF0IG1heSBub3Qgc3VwcG9ydCBpdCwgc28gbWFudWFsIGhlYWRpbmcgaXMgYXBwcm9wcmlhdGUgaGVyZVxyXG5cdFx0aWYgKGhlYWRpbmcpIHtcclxuXHRcdFx0Y29uc3QgaGVhZGluZ0VsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCdzZXR0aW5nLWdyb3VwLWhlYWRpbmcnKTtcclxuXHRcdFx0aGVhZGluZ0VsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogaGVhZGluZyB9KTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0cmV0dXJuIHtcclxuXHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpIHtcclxuXHRcdFx0XHRjb25zdCBzZXR0aW5nID0gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpO1xyXG5cdFx0XHRcdGNiKHNldHRpbmcpO1xyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHsgVEZpbGUsIEhlYWRpbmdDYWNoZSwgQXBwIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcbmltcG9ydCB7IG1hdGNoZXNGb2xkZXJQYXR0ZXJuLCBzb3J0QnlQYXR0ZXJuU3BlY2lmaWNpdHkgfSBmcm9tIFwiLi9wYXRoLW1hdGNoaW5nXCI7XG5pbXBvcnQgeyB0b0tlYmFiQ2FzZSB9IGZyb20gXCIuL3N0cmluZy11dGlsc1wiO1xuXG5leHBvcnQgY2xhc3MgSGVhZGluZ0xpbmtHZW5lcmF0b3Ige1xuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpIHsgfVxuXG5cdC8qKlxuXHQgKiBDb252ZXJ0cyB0ZXh0IHRvIGtlYmFiLWNhc2Ugc2x1ZyBmb3IgVVJMc1xuXHQgKi9cblx0Ly8gTG9jYWwgdG9LZWJhYkNhc2UgcmVtb3ZlZCwgdXNpbmcgaW1wb3J0ZWQgb25lIGluc3RlYWRcblxuXHQvKipcblx0ICogR2V0cyB0aGUgQXN0cm8tY29tcGF0aWJsZSBVUkwgZnJvbSBhbiBpbnRlcm5hbCBsaW5rIChjb3BpZWQgZnJvbSBMaW5rQ29udmVydGVyKVxuXHQgKi9cblx0cHJpdmF0ZSBnZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmsobGluazogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBoYXNoSW5kZXggPSBsaW5rLmluZGV4T2YoJyMnKTtcblx0XHRsZXQgcGF0aCA9IGhhc2hJbmRleCA+PSAwID8gbGluay5zbGljZSgwLCBoYXNoSW5kZXgpIDogbGluaztcblx0XHRjb25zdCBhbmNob3IgPSBoYXNoSW5kZXggPj0gMCA/IGxpbmsuc2xpY2UoaGFzaEluZGV4KSA6ICcnO1xuXG5cdFx0cGF0aCA9IHBhdGgucmVwbGFjZSgvXFwubWQkLywgXCJcIik7XG5cblx0XHQvLyBEZXRlcm1pbmUgY29udGVudCB0eXBlIGFuZCBhcHByb3ByaWF0ZSBiYXNlIHBhdGhcblx0XHRsZXQgYmFzZVBhdGggPSBcIlwiO1xuXHRcdGxldCBjb250ZW50Rm9sZGVyID0gXCJcIjtcblx0XHRsZXQgY3JlYXRpb25Nb2RlOiBcImZpbGVcIiB8IFwiZm9sZGVyXCIgPSBcImZpbGVcIjtcblx0XHRsZXQgaW5kZXhGaWxlTmFtZSA9IFwiXCI7XG5cblx0XHQvLyBDaGVjayBhbGwgY29udGVudCB0eXBlcywgc29ydGVkIGJ5IHBhdHRlcm4gc3BlY2lmaWNpdHkgKG1vcmUgc3BlY2lmaWMgZmlyc3QpXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gdGhpcy5zZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XG5cdFx0Y29uc3Qgc29ydGVkVHlwZXMgPSBzb3J0QnlQYXR0ZXJuU3BlY2lmaWNpdHkoY29udGVudFR5cGVzKTtcblxuXHRcdGZvciAoY29uc3QgY29udGVudFR5cGUgb2Ygc29ydGVkVHlwZXMpIHtcblx0XHRcdGlmICghY29udGVudFR5cGUuZW5hYmxlZCkgY29udGludWU7XG5cblx0XHRcdGxldCBtYXRjaGVzID0gZmFsc2U7XG5cblx0XHRcdC8vIEhhbmRsZSBibGFuayBmb2xkZXIgKHJvb3QpIC0gbWF0Y2hlcyBmaWxlcyBpbiB2YXVsdCByb290IG9ubHlcblx0XHRcdGlmICghY29udGVudFR5cGUuZm9sZGVyIHx8IGNvbnRlbnRUeXBlLmZvbGRlci50cmltKCkgPT09IFwiXCIpIHtcblx0XHRcdFx0aWYgKCFwYXRoLmluY2x1ZGVzKFwiL1wiKSB8fCBwYXRoLnNwbGl0KFwiL1wiKS5sZW5ndGggPT09IDEpIHtcblx0XHRcdFx0XHRtYXRjaGVzID0gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmIChtYXRjaGVzRm9sZGVyUGF0dGVybihwYXRoLCBjb250ZW50VHlwZS5mb2xkZXIpKSB7XG5cdFx0XHRcdG1hdGNoZXMgPSB0cnVlO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAobWF0Y2hlcykge1xuXHRcdFx0XHRjb250ZW50Rm9sZGVyID0gY29udGVudFR5cGUuZm9sZGVyIHx8IFwiXCI7XG5cdFx0XHRcdGJhc2VQYXRoID0gY29udGVudFR5cGUubGlua0Jhc2VQYXRoIHx8IFwiXCI7XG5cdFx0XHRcdGNyZWF0aW9uTW9kZSA9IGNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZTtcblx0XHRcdFx0aW5kZXhGaWxlTmFtZSA9IGNvbnRlbnRUeXBlLmluZGV4RmlsZU5hbWUgfHwgXCJcIjtcblx0XHRcdFx0YnJlYWs7IC8vIE1vc3Qgc3BlY2lmaWMgcGF0dGVybiB3aW5zXG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gU3RyaXAgY29udGVudCBmb2xkZXIgaWYgcHJlc2VudFxuXHRcdGlmIChjb250ZW50Rm9sZGVyKSB7XG5cdFx0XHRwYXRoID0gcGF0aC5zbGljZShjb250ZW50Rm9sZGVyLmxlbmd0aCArIDEpO1xuXHRcdH1cblxuXHRcdGxldCBhZGRUcmFpbGluZ1NsYXNoID0gZmFsc2U7XG5cblx0XHQvLyBTbWFydCBkZXRlY3Rpb246IGlmIHRoZSBmaWxlbmFtZSBtYXRjaGVzIHRoZSBpbmRleCBmaWxlIG5hbWUgKHJlZ2FyZGxlc3Mgb2YgY3JlYXRpb24gbW9kZSksXG5cdFx0Ly8gdHJlYXQgaXQgYXMgZm9sZGVyLWJhc2VkIGxvZ2ljXG5cdFx0Ly8gTm90ZTogV2Ugb25seSBzZXQgYWRkVHJhaWxpbmdTbGFzaCBoZXJlOyB0aGUgZmluYWwgY2hlY2sgd2lsbCBwcmV2ZW50IGl0IGlmIHRoZXJlJ3MgYW4gYW5jaG9yXG5cdFx0aWYgKGluZGV4RmlsZU5hbWUgJiYgaW5kZXhGaWxlTmFtZS50cmltKCkgIT09IFwiXCIpIHtcblx0XHRcdGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xuXHRcdFx0aWYgKHBhcnRzW3BhcnRzLmxlbmd0aCAtIDFdID09PSBpbmRleEZpbGVOYW1lKSB7XG5cdFx0XHRcdHBhcnRzLnBvcCgpO1xuXHRcdFx0XHRwYXRoID0gcGFydHMuam9pbignLycpO1xuXHRcdFx0XHRhZGRUcmFpbGluZ1NsYXNoID0gdHJ1ZTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKGNyZWF0aW9uTW9kZSA9PT0gXCJmb2xkZXJcIikge1xuXHRcdFx0Ly8gRmFsbGJhY2sgdG8gb3JpZ2luYWwgbG9naWMgaWYgbm8gaW5kZXggZmlsZSBuYW1lIGlzIHNwZWNpZmllZFxuXHRcdFx0Ly8gRGVmYXVsdCB0byBcImluZGV4XCIgd2hlbiBpbmRleEZpbGVOYW1lIGlzIGJsYW5rXG5cdFx0XHRjb25zdCBkZWZhdWx0SW5kZXhOYW1lID0gXCJpbmRleFwiO1xuXHRcdFx0Y29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XG5cdFx0XHRpZiAocGFydHNbcGFydHMubGVuZ3RoIC0gMV0gPT09IGRlZmF1bHRJbmRleE5hbWUpIHtcblx0XHRcdFx0cGFydHMucG9wKCk7XG5cdFx0XHRcdHBhdGggPSBwYXJ0cy5qb2luKCcvJyk7XG5cdFx0XHRcdGFkZFRyYWlsaW5nU2xhc2ggPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGNvbnN0IHNsdWdQYXJ0cyA9IHBhdGguc3BsaXQoJy8nKS5tYXAocGFydCA9PiB0b0tlYmFiQ2FzZShwYXJ0KSk7XG5cdFx0Y29uc3Qgc2x1ZyA9IHNsdWdQYXJ0cy5qb2luKCcvJyk7XG5cblx0XHQvLyBGb3JtYXQgYmFzZSBwYXRoXG5cdFx0aWYgKGJhc2VQYXRoKSB7XG5cdFx0XHRpZiAoIWJhc2VQYXRoLnN0YXJ0c1dpdGgoXCIvXCIpKSBiYXNlUGF0aCA9IFwiL1wiICsgYmFzZVBhdGg7XG5cdFx0XHRpZiAoIWJhc2VQYXRoLmVuZHNXaXRoKFwiL1wiKSkgYmFzZVBhdGggKz0gXCIvXCI7XG5cdFx0fVxuXG5cdFx0Ly8gRGV0ZXJtaW5lIGlmIHdlIHNob3VsZCBhZGQgdHJhaWxpbmcgc2xhc2hcblx0XHQvLyBDUklUSUNBTDogTmV2ZXIgYWRkIHRyYWlsaW5nIHNsYXNoIGJlZm9yZSBhbiBhbmNob3IgKGUuZy4sIC9hYm91dCNoZWFkaW5nIG5vdCAvYWJvdXQvI2hlYWRpbmcpXG5cdFx0Ly8gVGhpcyBpcyBlc3BlY2lhbGx5IGltcG9ydGFudCBmb3IgYW5jaG9yIGxpbmtzIGZyb20gY29weSBoZWFkaW5nIFVSTCBmdW5jdGlvbmFsaXR5XG5cdFx0Ly8gQW5jaG9yIGxpbmtzIHNob3VsZCBORVZFUiBoYXZlIHRyYWlsaW5nIHNsYXNoZXMsIHJlZ2FyZGxlc3Mgb2Ygc2V0dGluZ3Ncblx0XHRjb25zdCBzaG91bGRBZGRUcmFpbGluZ1NsYXNoID0gKHRoaXMuc2V0dGluZ3MuYWRkVHJhaWxpbmdTbGFzaFRvTGlua3MgfHwgYWRkVHJhaWxpbmdTbGFzaCkgJiYgIWFuY2hvcjtcblxuXHRcdHJldHVybiBgJHtiYXNlUGF0aH0ke3NsdWd9JHtzaG91bGRBZGRUcmFpbGluZ1NsYXNoID8gJy8nIDogJyd9JHthbmNob3J9YDtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgYSBzdGFuZGFyZCBPYnNpZGlhbiBsaW5rIHRvIGEgaGVhZGluZywgcmVzcGVjdGluZyB1c2VyJ3MgbGluayBmb3JtYXQgcHJlZmVyZW5jZVxuXHQgKi9cblx0Z2VuZXJhdGVPYnNpZGlhbkxpbmsoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBoZWFkaW5nOiBIZWFkaW5nQ2FjaGUpOiBzdHJpbmcge1xuXHRcdGNvbnN0IGhlYWRpbmdUZXh0ID0gaGVhZGluZy5oZWFkaW5nO1xuXG5cdFx0Ly8gQ2hlY2sgaWYgdXNlciBwcmVmZXJzIHdpa2lsaW5rcyBieSB0ZXN0aW5nIE9ic2lkaWFuJ3MgZGVmYXVsdCBiZWhhdmlvclxuXHRcdGNvbnN0IHRlc3RMaW5rID0gYXBwLmZpbGVNYW5hZ2VyLmdlbmVyYXRlTWFya2Rvd25MaW5rKGZpbGUsICcnLCAnJyk7XG5cdFx0aWYgKHRlc3RMaW5rLnN0YXJ0c1dpdGgoJ1tbJykpIHtcblx0XHRcdC8vIFVzZXIgcHJlZmVycyB3aWtpbGlua3MgLSB1c2UganVzdCB0aGUgZmlsZW5hbWUgKGJhc2VuYW1lKSB3aXRob3V0IHBhdGhcblx0XHRcdGNvbnN0IGZpbGVOYW1lID0gZmlsZS5iYXNlbmFtZTtcblx0XHRcdHJldHVybiBgW1ske2ZpbGVOYW1lfSMke2hlYWRpbmdUZXh0fXwke2hlYWRpbmdUZXh0fV1dYDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gVXNlciBwcmVmZXJzIG1hcmtkb3duIGxpbmtzIC0gdXNlIE9ic2lkaWFuJ3MgbWV0aG9kIHdpdGggaGVhZGluZyB0ZXh0IGFzLWlzIChVUkwtZW5jb2RlZClcblx0XHRcdC8vIEdldCB0aGUgYmFzZSBsaW5rIGZyb20gT2JzaWRpYW4gKHJlc3BlY3RzIHVzZXIncyBwYXRoIHNldHRpbmdzKVxuXHRcdFx0Y29uc3QgYmFzZUxpbmsgPSBhcHAuZmlsZU1hbmFnZXIuZ2VuZXJhdGVNYXJrZG93bkxpbmsoZmlsZSwgJycsICcnKTtcblx0XHRcdC8vIEV4dHJhY3QgdGhlIHBhdGggcGFydCBhbmQgYWRkIG91ciBhbmNob3Igd2l0aCBwcm9wZXIgZGlzcGxheSB0ZXh0XG5cdFx0XHRpZiAoYmFzZUxpbmsuc3RhcnRzV2l0aCgnW1snKSkge1xuXHRcdFx0XHQvLyBUaGlzIHNob3VsZG4ndCBoYXBwZW4gc2luY2Ugd2UncmUgaW4gdGhlIG1hcmtkb3duIGJyYW5jaCwgYnV0IGp1c3QgaW4gY2FzZVxuXHRcdFx0XHRjb25zdCBmaWxlTmFtZSA9IGZpbGUuYmFzZW5hbWU7XG5cdFx0XHRcdHJldHVybiBgW1ske2ZpbGVOYW1lfSMke2hlYWRpbmdUZXh0fXwke2hlYWRpbmdUZXh0fV1dYDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEV4dHJhY3QgdGhlIHBhdGggZnJvbSB0aGUgZ2VuZXJhdGVkIGxpbmsgYW5kIHJlY29uc3RydWN0IHdpdGggcHJvcGVyIGRpc3BsYXkgdGV4dFxuXHRcdFx0XHRjb25zdCBtYXRjaCA9IGJhc2VMaW5rLm1hdGNoKC9cXFsoW15cXF1dKylcXF1cXCgoW14pXSspXFwpLyk7XG5cdFx0XHRcdGlmIChtYXRjaCkge1xuXHRcdFx0XHRcdGNvbnN0IFssICwgcGF0aF0gPSBtYXRjaDtcblx0XHRcdFx0XHQvLyBGb3IgT2JzaWRpYW4sIHVzZSB0aGUgaGVhZGluZyB0ZXh0IGFzLWlzIChVUkwtZW5jb2RlZCksIG5vdCBrZWJhYi1jYXNlXG5cdFx0XHRcdFx0cmV0dXJuIGBbJHtoZWFkaW5nVGV4dH1dKCR7cGF0aH0jJHtlbmNvZGVVUklDb21wb25lbnQoaGVhZGluZ1RleHQpfSlgO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIEZhbGxiYWNrIHRvIG1hbnVhbCBjb25zdHJ1Y3Rpb25cblx0XHRcdFx0XHRjb25zdCBlbmNvZGVkRmlsZW5hbWUgPSBlbmNvZGVVUklDb21wb25lbnQoZmlsZS5uYW1lKTtcblx0XHRcdFx0XHQvLyBGb3IgT2JzaWRpYW4sIHVzZSB0aGUgaGVhZGluZyB0ZXh0IGFzLWlzIChVUkwtZW5jb2RlZClcblx0XHRcdFx0XHRyZXR1cm4gYFske2hlYWRpbmdUZXh0fV0oJHtlbmNvZGVkRmlsZW5hbWV9IyR7ZW5jb2RlVVJJQ29tcG9uZW50KGhlYWRpbmdUZXh0KX0pYDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgYSBzdGFuZGFyZCBPYnNpZGlhbiB3aWtpbGluayB0byBhIGhlYWRpbmdcblx0ICovXG5cdGdlbmVyYXRlT2JzaWRpYW5XaWtpbGluayhmaWxlOiBURmlsZSwgaGVhZGluZzogSGVhZGluZ0NhY2hlKTogc3RyaW5nIHtcblx0XHRjb25zdCBoZWFkaW5nVGV4dCA9IGhlYWRpbmcuaGVhZGluZztcblx0XHQvLyBVc2UganVzdCB0aGUgZmlsZW5hbWUgKGJhc2VuYW1lKSwgbm90IHRoZSBmdWxsIHBhdGhcblx0XHRjb25zdCBmaWxlTmFtZSA9IGZpbGUuYmFzZW5hbWU7XG5cdFx0cmV0dXJuIGBbWyR7ZmlsZU5hbWV9IyR7aGVhZGluZ1RleHR9fCR7aGVhZGluZ1RleHR9XV1gO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBhbiBBc3Ryby1jb21wYXRpYmxlIG1hcmtkb3duIGxpbmsgdG8gYSBoZWFkaW5nXG5cdCAqL1xuXHRnZW5lcmF0ZUFzdHJvTGluayhmaWxlOiBURmlsZSwgaGVhZGluZzogSGVhZGluZ0NhY2hlKTogc3RyaW5nIHtcblx0XHRjb25zdCBoZWFkaW5nVGV4dCA9IGhlYWRpbmcuaGVhZGluZztcblx0XHRjb25zdCBhbmNob3IgPSB0b0tlYmFiQ2FzZShoZWFkaW5nVGV4dCk7XG5cdFx0Ly8gVXNlIHRoZSBzYW1lIGxvZ2ljIGFzIHRoZSBleGlzdGluZyBsaW5rIGNvbnZlcnRlclxuXHRcdGNvbnN0IGludGVybmFsTGluayA9IGAke2ZpbGUucGF0aH0jJHthbmNob3J9YDtcblx0XHRjb25zdCBhc3Ryb1VybCA9IHRoaXMuZ2V0QXN0cm9VcmxGcm9tSW50ZXJuYWxMaW5rKGludGVybmFsTGluayk7XG5cdFx0cmV0dXJuIGBbJHtoZWFkaW5nVGV4dH1dKCR7YXN0cm9Vcmx9KWA7XG5cdH1cblxuXHQvKipcblx0ICogR2VuZXJhdGVzIGFuIEFzdHJvLWNvbXBhdGlibGUgd2lraWxpbmsgdG8gYSBoZWFkaW5nXG5cdCAqL1xuXHRnZW5lcmF0ZUFzdHJvV2lraWxpbmsoZmlsZTogVEZpbGUsIGhlYWRpbmc6IEhlYWRpbmdDYWNoZSk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaGVhZGluZ1RleHQgPSBoZWFkaW5nLmhlYWRpbmc7XG5cdFx0Y29uc3QgYW5jaG9yID0gdG9LZWJhYkNhc2UoaGVhZGluZ1RleHQpO1xuXHRcdC8vIFVzZSB0aGUgc2FtZSBsb2dpYyBhcyB0aGUgZXhpc3RpbmcgbGluayBjb252ZXJ0ZXJcblx0XHRjb25zdCBpbnRlcm5hbExpbmsgPSBgJHtmaWxlLnBhdGh9IyR7YW5jaG9yfWA7XG5cdFx0Y29uc3QgYXN0cm9VcmwgPSB0aGlzLmdldEFzdHJvVXJsRnJvbUludGVybmFsTGluayhpbnRlcm5hbExpbmspO1xuXHRcdC8vIENyZWF0ZSBhIHdpa2lsaW5rIHdpdGggdGhlIEFzdHJvIFVSTCBhcyB0aGUgdGFyZ2V0XG5cdFx0cmV0dXJuIGBbWyR7aGVhZGluZ1RleHR9fCR7YXN0cm9Vcmx9XV1gO1xuXHR9XG5cblx0LyoqXG5cdCAqIEV4dHJhY3RzIHRoZSBVUkwgZnJvbSBhIG1hcmtkb3duIGxpbmsgb3Igd2lraWxpbmtcblx0ICovXG5cdGV4dHJhY3RVcmwobGluazogc3RyaW5nKTogc3RyaW5nIHtcblx0XHQvLyBIYW5kbGUgbWFya2Rvd24gbGlua3M6IFt0ZXh0XSh1cmwpXG5cdFx0Y29uc3QgbWFya2Rvd25NYXRjaCA9IGxpbmsubWF0Y2goL1xcWyhbXlxcXV0rKVxcXVxcKChbXildKylcXCkvKTtcblx0XHRpZiAobWFya2Rvd25NYXRjaCkge1xuXHRcdFx0cmV0dXJuIG1hcmtkb3duTWF0Y2hbMl07XG5cdFx0fVxuXG5cdFx0Ly8gSGFuZGxlIHdpa2lsaW5rczogW1twYXRoI2hlYWRpbmd8dGV4dF1dIG9yIFtbcGF0aCNoZWFkaW5nXV1cblx0XHRjb25zdCB3aWtpbGlua01hdGNoID0gbGluay5tYXRjaCgvXFxbXFxbKFteXFxdXSspXFxdXFxdLyk7XG5cdFx0aWYgKHdpa2lsaW5rTWF0Y2gpIHtcblx0XHRcdGNvbnN0IGNvbnRlbnQgPSB3aWtpbGlua01hdGNoWzFdO1xuXHRcdFx0Ly8gRXh0cmFjdCB0aGUgcGF0aCBwYXJ0IChiZWZvcmUgfCBpZiBwcmVzZW50KVxuXHRcdFx0Y29uc3QgcGF0aFBhcnQgPSBjb250ZW50LnNwbGl0KCd8JylbMF07XG5cdFx0XHRyZXR1cm4gcGF0aFBhcnQ7XG5cdFx0fVxuXG5cdFx0Ly8gSWYgaXQgZG9lc24ndCBtYXRjaCBlaXRoZXIgZm9ybWF0LCByZXR1cm4gYXMtaXMgKG1pZ2h0IGFscmVhZHkgYmUgYSBVUkwpXG5cdFx0cmV0dXJuIGxpbms7XG5cdH1cblxuXHQvKipcblx0ICogR2VuZXJhdGVzIHRoZSBhcHByb3ByaWF0ZSBsaW5rIGZvcm1hdCBiYXNlZCBvbiBzZXR0aW5nc1xuXHQgKi9cblx0Z2VuZXJhdGVMaW5rKGFwcDogQXBwLCBmaWxlOiBURmlsZSwgaGVhZGluZzogSGVhZGluZ0NhY2hlKTogc3RyaW5nIHtcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5jb3B5SGVhZGluZ0xpbmtGb3JtYXQgPT09IFwiYXN0cm9cIikge1xuXHRcdFx0Ly8gQXN0cm8gZm9ybWF0IGFsd2F5cyB1c2VzIG1hcmtkb3duIGxpbmtzICh3aWtpbGlua3Mgd2l0aCBBc3RybyBVUkxzIGRvbid0IG1ha2Ugc2Vuc2UpXG5cdFx0XHRyZXR1cm4gdGhpcy5nZW5lcmF0ZUFzdHJvTGluayhmaWxlLCBoZWFkaW5nKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gVXNlIE9ic2lkaWFuJ3MgYnVpbHQtaW4gbWV0aG9kIHdoaWNoIHJlc3BlY3RzIHVzZXIgc2V0dGluZ3Ncblx0XHRcdHJldHVybiB0aGlzLmdlbmVyYXRlT2JzaWRpYW5MaW5rKGFwcCwgZmlsZSwgaGVhZGluZyk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEZpbmRzIHRoZSBoZWFkaW5nIGF0IGEgc3BlY2lmaWMgbGluZSBpbiBhIGZpbGVcblx0ICovXG5cdGZpbmRIZWFkaW5nQXRMaW5lKGFwcDogQXBwLCBmaWxlOiBURmlsZSwgbGluZTogbnVtYmVyKTogSGVhZGluZ0NhY2hlIHwgbnVsbCB7XG5cdFx0Y29uc3QgY2FjaGUgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG5cdFx0aWYgKCFjYWNoZSB8fCAhY2FjaGUuaGVhZGluZ3MpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblxuXHRcdC8vIEZpbmQgdGhlIGhlYWRpbmcgdGhhdCBjb250YWlucyB0aGlzIGxpbmVcblx0XHRmb3IgKGxldCBpID0gY2FjaGUuaGVhZGluZ3MubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdGNvbnN0IGhlYWRpbmcgPSBjYWNoZS5oZWFkaW5nc1tpXTtcblx0XHRcdGlmIChoZWFkaW5nLnBvc2l0aW9uLnN0YXJ0LmxpbmUgPD0gbGluZSkge1xuXHRcdFx0XHRyZXR1cm4gaGVhZGluZztcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxufVxuIiwgImltcG9ydCB7IEFwcCwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IENvbnRlbnRUeXBlLCBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IE1pZ3JhdGlvbk1vZGFsLCBNaWdyYXRpb25Db25mbGljdFJlc3VsdCB9IGZyb20gXCIuLi91aS9jb21wb25lbnRzL01pZ3JhdGlvbk1vZGFsXCI7XHJcbmltcG9ydCB7IEFzdHJvQ29tcG9zZXJTZXR0aW5nVGFiIH0gZnJvbSBcIi4uL3VpL3NldHRpbmdzLXRhYlwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIE1pZ3JhdGlvblNlcnZpY2Uge1xyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBhcHA6IEFwcCwgcHJpdmF0ZSBwbHVnaW46IEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UpIHsgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTWlncmF0ZSBvbGQgcG9zdHMvcGFnZXMgc2V0dGluZ3MgdG8gdW5pZmllZCBjb250ZW50IHR5cGVzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhc3luYyBtaWdyYXRlU2V0dGluZ3NJZk5lZWRlZCgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cclxuICAgICAgICAvLyBDaGVjayBpZiBtaWdyYXRpb24gaXMgYWxyZWFkeSBjb21wbGV0ZWRcclxuICAgICAgICBpZiAoc2V0dGluZ3MubWlncmF0aW9uQ29tcGxldGVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZXJlIGFyZSBvbGQgc2V0dGluZ3MgdG8gbWlncmF0ZVxyXG4gICAgICAgIGNvbnN0IGhhc1Bvc3RzU2V0dGluZ3MgPSBzZXR0aW5ncy5hdXRvbWF0ZVBvc3RDcmVhdGlvbiAhPT0gdW5kZWZpbmVkICYmIHNldHRpbmdzLmF1dG9tYXRlUG9zdENyZWF0aW9uO1xyXG4gICAgICAgIGNvbnN0IGhhc1BhZ2VzU2V0dGluZ3MgPSBzZXR0aW5ncy5lbmFibGVQYWdlcyAhPT0gdW5kZWZpbmVkICYmIHNldHRpbmdzLmVuYWJsZVBhZ2VzO1xyXG5cclxuICAgICAgICBpZiAoIWhhc1Bvc3RzU2V0dGluZ3MgJiYgIWhhc1BhZ2VzU2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgLy8gTm8gb2xkIHNldHRpbmdzIHRvIG1pZ3JhdGUsIG1hcmsgYXMgY29tcGxldGVkXHJcbiAgICAgICAgICAgIHNldHRpbmdzLm1pZ3JhdGlvbkNvbXBsZXRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDaGVjayBmb3IgbmFtaW5nIGNvbmZsaWN0c1xyXG4gICAgICAgIGNvbnN0IGxlZ2FjeUNvbnRlbnRUeXBlcyA9IChzZXR0aW5ncyBhcyB1bmtub3duIGFzIHsgY3VzdG9tQ29udGVudFR5cGVzPzogQ29udGVudFR5cGVbXSB9KS5jdXN0b21Db250ZW50VHlwZXM7XHJcbiAgICAgICAgY29uc3QgZXhpc3RpbmdDb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgbGVnYWN5Q29udGVudFR5cGVzIHx8IFtdO1xyXG4gICAgICAgIGNvbnN0IGNvbmZsaWN0czogc3RyaW5nW10gPSBbXTtcclxuICAgICAgICBpZiAoZXhpc3RpbmdDb250ZW50VHlwZXMuc29tZSgoY3Q6IENvbnRlbnRUeXBlKSA9PiBjdC5uYW1lID09PSBcIlBvc3RzXCIpKSB7XHJcbiAgICAgICAgICAgIGNvbmZsaWN0cy5wdXNoKFwiUG9zdHNcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChleGlzdGluZ0NvbnRlbnRUeXBlcy5zb21lKChjdDogQ29udGVudFR5cGUpID0+IGN0Lm5hbWUgPT09IFwiUGFnZXNcIikpIHtcclxuICAgICAgICAgICAgY29uZmxpY3RzLnB1c2goXCJQYWdlc1wiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBzaG91bGRNaWdyYXRlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgLy8gSWYgY29uZmxpY3RzIGV4aXN0LCBwcm9tcHQgdXNlclxyXG4gICAgICAgIGlmIChjb25mbGljdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdm9pZCAoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgTWlncmF0aW9uTW9kYWwodGhpcy5hcHAsIGNvbmZsaWN0cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0aW1lb3V0UHJvbWlzZSA9IG5ldyBQcm9taXNlPE1pZ3JhdGlvbkNvbmZsaWN0UmVzdWx0PigodGltZW91dFJlc29sdmUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZW91dFJlc29sdmUoeyBhY3Rpb246IFwic2tpcFwiIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMDAwKTsgLy8gMzAgc2Vjb25kIHRpbWVvdXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFByb21pc2UucmFjZShbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWwud2FpdEZvclJlc3VsdCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXRQcm9taXNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmFjdGlvbiA9PT0gXCJza2lwXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG91bGRNaWdyYXRlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIk1pZ3JhdGlvbiBza2lwcGVkLiBPbGQgcG9zdHMvcGFnZXMgc2V0dGluZ3Mgd2lsbCBiZSBpZ25vcmVkLlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIk1pZ3JhdGlvbiBtb2RhbCBlcnJvcjpcIiwgZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdWxkTWlncmF0ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIk1pZ3JhdGlvbiBza2lwcGVkIGR1ZSB0byBlcnJvci4gWW91IGNhbiBtaWdyYXRlIG1hbnVhbGx5IGluIHNldHRpbmdzLlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSkoKTtcclxuICAgICAgICAgICAgICAgIH0sIDUwMCk7IC8vIFNtYWxsIGRlbGF5IHRvIGVuc3VyZSBVSSBpcyByZWFkeVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghc2hvdWxkTWlncmF0ZSkge1xyXG4gICAgICAgICAgICBzZXR0aW5ncy5taWdyYXRpb25Db21wbGV0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUGVyZm9ybSBtaWdyYXRpb25cclxuICAgICAgICBjb25zdCBtaWdyYXRlZFR5cGVzOiBDb250ZW50VHlwZVtdID0gW107XHJcblxyXG4gICAgICAgIC8vIE1pZ3JhdGUgUG9zdHNcclxuICAgICAgICBpZiAoaGFzUG9zdHNTZXR0aW5ncyAmJiAhY29uZmxpY3RzLmluY2x1ZGVzKFwiUG9zdHNcIikpIHtcclxuICAgICAgICAgICAgY29uc3QgcG9zdHNUeXBlOiBDb250ZW50VHlwZSA9IHtcclxuICAgICAgICAgICAgICAgIGlkOiBgcG9zdHMtJHtEYXRlLm5vdygpfWAsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBcIlBvc3RzXCIsXHJcbiAgICAgICAgICAgICAgICBmb2xkZXI6IHNldHRpbmdzLnBvc3RzRm9sZGVyIHx8IFwiXCIsXHJcbiAgICAgICAgICAgICAgICBsaW5rQmFzZVBhdGg6IHNldHRpbmdzLnBvc3RzTGlua0Jhc2VQYXRoIHx8IFwiXCIsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogc2V0dGluZ3MuZGVmYXVsdFRlbXBsYXRlIHx8ICctLS1cXG50aXRsZTogXCJ7e3RpdGxlfX1cIlxcbmRhdGU6IHt7ZGF0ZX19XFxudGFnczogW11cXG4tLS1cXG4nLFxyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0aW9uTW9kZTogc2V0dGluZ3MuY3JlYXRpb25Nb2RlIHx8IFwiZmlsZVwiLFxyXG4gICAgICAgICAgICAgICAgaW5kZXhGaWxlTmFtZTogc2V0dGluZ3MuaW5kZXhGaWxlTmFtZSB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgaWdub3JlU3ViZm9sZGVyczogc2V0dGluZ3Mub25seUF1dG9tYXRlSW5Qb3N0c0ZvbGRlciB8fCBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGVuYWJsZVVuZGVyc2NvcmVQcmVmaXg6IHNldHRpbmdzLmVuYWJsZVVuZGVyc2NvcmVQcmVmaXggfHwgZmFsc2UsXHJcbiAgICAgICAgICAgICAgICB1c2VNZHhFeHRlbnNpb246IGZhbHNlLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBtaWdyYXRlZFR5cGVzLnB1c2gocG9zdHNUeXBlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIE1pZ3JhdGUgUGFnZXNcclxuICAgICAgICBpZiAoaGFzUGFnZXNTZXR0aW5ncyAmJiAhY29uZmxpY3RzLmluY2x1ZGVzKFwiUGFnZXNcIikpIHtcclxuICAgICAgICAgICAgY29uc3QgcGFnZXNUeXBlOiBDb250ZW50VHlwZSA9IHtcclxuICAgICAgICAgICAgICAgIGlkOiBgcGFnZXMtJHtEYXRlLm5vdygpfWAsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBcIlBhZ2VzXCIsXHJcbiAgICAgICAgICAgICAgICBmb2xkZXI6IHNldHRpbmdzLnBhZ2VzRm9sZGVyIHx8IFwiXCIsXHJcbiAgICAgICAgICAgICAgICBsaW5rQmFzZVBhdGg6IHNldHRpbmdzLnBhZ2VzTGlua0Jhc2VQYXRoIHx8IFwiXCIsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogc2V0dGluZ3MucGFnZVRlbXBsYXRlIHx8ICctLS1cXG50aXRsZTogXCJ7e3RpdGxlfX1cIlxcbmRlc2NyaXB0aW9uOiBcIlwiXFxuLS0tXFxuJyxcclxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGlvbk1vZGU6IHNldHRpbmdzLnBhZ2VzQ3JlYXRpb25Nb2RlIHx8IFwiZmlsZVwiLFxyXG4gICAgICAgICAgICAgICAgaW5kZXhGaWxlTmFtZTogc2V0dGluZ3MucGFnZXNJbmRleEZpbGVOYW1lIHx8IFwiXCIsXHJcbiAgICAgICAgICAgICAgICBpZ25vcmVTdWJmb2xkZXJzOiBzZXR0aW5ncy5vbmx5QXV0b21hdGVJblBhZ2VzRm9sZGVyIHx8IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgZW5hYmxlVW5kZXJzY29yZVByZWZpeDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICB1c2VNZHhFeHRlbnNpb246IGZhbHNlLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBtaWdyYXRlZFR5cGVzLnB1c2gocGFnZXNUeXBlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nRnJvbU5ldyA9IHNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcclxuICAgICAgICBjb25zdCBleGlzdGluZ0Zyb21MZWdhY3kgPSBsZWdhY3lDb250ZW50VHlwZXMgfHwgW107XHJcblxyXG4gICAgICAgIGxldCBleGlzdGluZ1R5cGVzOiBDb250ZW50VHlwZVtdID0gZXhpc3RpbmdGcm9tTmV3Lmxlbmd0aCA+IDAgPyBleGlzdGluZ0Zyb21OZXcgOiBleGlzdGluZ0Zyb21MZWdhY3k7XHJcbiAgICAgICAgbGV0IGZpbmFsVHlwZXM6IENvbnRlbnRUeXBlW10gPSBbLi4uZXhpc3RpbmdUeXBlc107XHJcblxyXG4gICAgICAgIGlmIChtaWdyYXRlZFR5cGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdOYW1lcyA9IG5ldyBTZXQoZXhpc3RpbmdUeXBlcy5tYXAoY3QgPT4gY3QubmFtZSkpO1xyXG4gICAgICAgICAgICBjb25zdCBuZXdNaWdyYXRlZFR5cGVzID0gbWlncmF0ZWRUeXBlcy5maWx0ZXIobXQgPT4gIWV4aXN0aW5nTmFtZXMuaGFzKG10Lm5hbWUpKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChuZXdNaWdyYXRlZFR5cGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGZpbmFsVHlwZXMgPSBbLi4uZXhpc3RpbmdUeXBlcywgLi4ubmV3TWlncmF0ZWRUeXBlc107XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHNldHRpbmdzLmNvbnRlbnRUeXBlcyA9IGZpbmFsVHlwZXM7XHJcblxyXG4gICAgICAgIC8vIENsZWFuIHVwIGxlZ2FjeSBmaWVsZHNcclxuICAgICAgICBjb25zdCBsZWdhY3lGaWVsZHMgPSBbXHJcbiAgICAgICAgICAgICdjdXN0b21Db250ZW50VHlwZXMnLCAnZW5hYmxlVW5kZXJzY29yZVByZWZpeCcsICdwb3N0c0ZvbGRlcicsICdwb3N0c0xpbmtCYXNlUGF0aCcsXHJcbiAgICAgICAgICAgICdhdXRvbWF0ZVBvc3RDcmVhdGlvbicsICdjcmVhdGlvbk1vZGUnLCAnaW5kZXhGaWxlTmFtZScsICdleGNsdWRlZERpcmVjdG9yaWVzJyxcclxuICAgICAgICAgICAgJ29ubHlBdXRvbWF0ZUluUG9zdHNGb2xkZXInLCAnZW5hYmxlUGFnZXMnLCAncGFnZXNGb2xkZXInLCAncGFnZXNMaW5rQmFzZVBhdGgnLFxyXG4gICAgICAgICAgICAncGFnZXNDcmVhdGlvbk1vZGUnLCAncGFnZXNJbmRleEZpbGVOYW1lJywgJ3BhZ2VUZW1wbGF0ZScsICdvbmx5QXV0b21hdGVJblBhZ2VzRm9sZGVyJ1xyXG4gICAgICAgIF07XHJcblxyXG4gICAgICAgIGNvbnN0IHNldHRpbmdzUmVjb3JkID0gc2V0dGluZ3MgYXMgdW5rbm93biBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcclxuICAgICAgICBmb3IgKGNvbnN0IGZpZWxkIG9mIGxlZ2FjeUZpZWxkcykge1xyXG4gICAgICAgICAgICBkZWxldGUgc2V0dGluZ3NSZWNvcmRbZmllbGRdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc2V0dGluZ3MubWlncmF0aW9uQ29tcGxldGVkID0gdHJ1ZTtcclxuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5sb2FkU2V0dGluZ3MoKTtcclxuXHJcbiAgICAgICAgaWYgKG1pZ3JhdGVkVHlwZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKGBNaWdyYXRpb24gY29tcGxldGVkOiAke21pZ3JhdGVkVHlwZXMubGVuZ3RofSBjb250ZW50IHR5cGUocykgbWlncmF0ZWQuYCk7XHJcblxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5nc1RhYiBpbnN0YW5jZW9mIEFzdHJvQ29tcG9zZXJTZXR0aW5nVGFiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2V0dGluZ3NUYWIgPSB0aGlzLnBsdWdpbi5zZXR0aW5nc1RhYjtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3NUYWIuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyIHx8IHNldHRpbmdzVGFiLmNvbnRhaW5lckVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5nc1RhYi5kaXNwbGF5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkNvdWxkIG5vdCByZWZyZXNoIHNldHRpbmdzIHRhYiBhZnRlciBtaWdyYXRpb246XCIsIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgMzAwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIiwgImltcG9ydCB7IEFwcCwgTW9kYWwgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgTWlncmF0aW9uQ29uZmxpY3RSZXN1bHQge1xyXG5cdGFjdGlvbjogXCJza2lwXCIgfCBcIm1pZ3JhdGVcIjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIE1pZ3JhdGlvbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG5cdHJlc3VsdDogTWlncmF0aW9uQ29uZmxpY3RSZXN1bHQgfCBudWxsID0gbnVsbDtcclxuXHRyZXNvbHZlUHJvbWlzZTogKChyZXN1bHQ6IE1pZ3JhdGlvbkNvbmZsaWN0UmVzdWx0KSA9PiB2b2lkKSB8IG51bGwgPSBudWxsO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgY29uZmxpY3RzOiBzdHJpbmdbXSkge1xyXG5cdFx0c3VwZXIoYXBwKTtcclxuXHR9XHJcblxyXG5cdG9uT3BlbigpIHtcclxuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG5cdFx0Y29udGVudEVsLmVtcHR5KCk7XHJcblx0XHRjb250ZW50RWwuYWRkQ2xhc3MoXCJhc3Ryby1jb21wb3Nlci1taWdyYXRpb24tbW9kYWxcIik7XHJcblxyXG5cdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBcIk1pZ3JhdGlvbiBjb25mbGljdCBkZXRlY3RlZFwiIH0pO1xyXG5cclxuXHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwge1xyXG5cdFx0XHR0ZXh0OiBcIllvdSBoYXZlIGV4aXN0aW5nIGNvbnRlbnQgdHlwZXMgd2l0aCBuYW1lcyB0aGF0IGNvbmZsaWN0IHdpdGggcG9zdHMgb3IgcGFnZXMuIEhvdyB3b3VsZCB5b3UgbGlrZSB0byBwcm9jZWVkP1wiLFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Y29uc3QgY29uZmxpY3RMaXN0ID0gY29udGVudEVsLmNyZWF0ZUVsKFwidWxcIik7XHJcblx0XHRjb25mbGljdExpc3QuY3JlYXRlRWwoXCJsaVwiLCB7IHRleHQ6IFwiU2tpcCBtaWdyYXRpb246IGtlZXAgeW91ciBleGlzdGluZyBwb3N0cy9wYWdlcyBzZXR0aW5ncyAodGhleSB3aWxsIGJlIGlnbm9yZWQpXCIgfSk7XHJcblx0XHRjb25mbGljdExpc3QuY3JlYXRlRWwoXCJsaVwiLCB7IHRleHQ6IFwiTWlncmF0ZSB3aXRoIHJlbmFtZWQgdHlwZXM6IGNyZWF0ZSAncG9zdHMgKG1pZ3JhdGVkKScgYW5kICdwYWdlcyAobWlncmF0ZWQpJyBjb250ZW50IHR5cGVzXCIgfSk7XHJcblxyXG5cdFx0Y29uc3QgYnV0dG9uQ29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJtb2RhbC1idXR0b24tY29udGFpbmVyXCIgfSk7XHJcblxyXG5cdFx0Y29uc3Qgc2tpcEJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7XHJcblx0XHRcdHRleHQ6IFwiU2tpcCBtaWdyYXRpb25cIixcclxuXHRcdFx0Y2xzOiBcIm1vZC1jdGFcIixcclxuXHRcdH0pO1xyXG5cdFx0c2tpcEJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG5cdFx0XHR0aGlzLnJlc3VsdCA9IHsgYWN0aW9uOiBcInNraXBcIiB9O1xyXG5cdFx0XHR0aGlzLmNsb3NlKCk7XHJcblx0XHR9O1xyXG5cclxuXHRcdGNvbnN0IG1pZ3JhdGVCdXR0b24gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xyXG5cdFx0XHR0ZXh0OiBcIk1pZ3JhdGUgd2l0aCByZW5hbWVkIHR5cGVzXCIsXHJcblx0XHRcdGNsczogXCJtb2QtY3RhXCIsXHJcblx0XHR9KTtcclxuXHRcdG1pZ3JhdGVCdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuXHRcdFx0dGhpcy5yZXN1bHQgPSB7IGFjdGlvbjogXCJtaWdyYXRlXCIgfTtcclxuXHRcdFx0dGhpcy5jbG9zZSgpO1xyXG5cdFx0fTtcclxuXHR9XHJcblxyXG5cdG9uQ2xvc2UoKSB7XHJcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xyXG5cdFx0aWYgKHRoaXMucmVzb2x2ZVByb21pc2UgJiYgdGhpcy5yZXN1bHQpIHtcclxuXHRcdFx0dGhpcy5yZXNvbHZlUHJvbWlzZSh0aGlzLnJlc3VsdCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRhc3luYyB3YWl0Rm9yUmVzdWx0KCk6IFByb21pc2U8TWlncmF0aW9uQ29uZmxpY3RSZXN1bHQ+IHtcclxuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG5cdFx0XHR0aGlzLnJlc29sdmVQcm9taXNlID0gcmVzb2x2ZTtcclxuXHRcdFx0dGhpcy5vcGVuKCk7XHJcblx0XHR9KTtcclxuXHR9XHJcbn1cclxuXHJcbiIsICJpbXBvcnQgeyBBcHAsIFRGaWxlLCBOb3RpY2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgQ29udGVudFR5cGUsIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgQ09OU1RBTlRTIH0gZnJvbSBcIi4uL3NldHRpbmdzXCI7XHJcbmltcG9ydCB7IG1hdGNoZXNGb2xkZXJQYXR0ZXJuLCBzb3J0QnlQYXR0ZXJuU3BlY2lmaWNpdHkgfSBmcm9tIFwiLi4vdXRpbHMvcGF0aC1tYXRjaGluZ1wiO1xyXG5pbXBvcnQgeyBUaXRsZU1vZGFsIH0gZnJvbSBcIi4uL3VpL3RpdGxlLW1vZGFsXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQ3JlYXRlRXZlbnRTZXJ2aWNlIHtcclxuICAgIHByaXZhdGUgbGFzdFByb2Nlc3NlZEZpbGVzOiBNYXA8c3RyaW5nLCBudW1iZXI+ID0gbmV3IE1hcCgpO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXHJcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2VcclxuICAgICkgeyB9XHJcblxyXG4gICAgcHVibGljIGhhbmRsZUNyZWF0ZShmaWxlOiBURmlsZSk6IHZvaWQge1xyXG4gICAgICAgIHZvaWQgKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuXHJcbiAgICAgICAgICAgIGlmICghKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkgfHwgKGZpbGUuZXh0ZW5zaW9uICE9PSBcIm1kXCIgJiYgZmlsZS5leHRlbnNpb24gIT09IFwibWR4XCIpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gZmlsZS5wYXRoO1xyXG5cclxuICAgICAgICAgICAgLy8gU2tpcCBpZiB0aGlzIGZpbGUgd2FzIGNyZWF0ZWQgYnkgdGhlIHBsdWdpbiBpdHNlbGYgKFRUTCBjaGVjaylcclxuICAgICAgICAgICAgY29uc3QgY3JlYXRlZFRpbWUgPSB0aGlzLnBsdWdpbi5wbHVnaW5DcmVhdGVkRmlsZXMuZ2V0KGZpbGVQYXRoKTtcclxuICAgICAgICAgICAgaWYgKGNyZWF0ZWRUaW1lICYmIG5vdyAtIGNyZWF0ZWRUaW1lIDwgNSAqIDYwICogMTAwMCkgeyAvLyA1IG1pbnV0ZXMgVFRMXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFBlci1maWxlIGRlYm91bmNlIGNoZWNrXHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3RQcm9jZXNzZWQgPSB0aGlzLmxhc3RQcm9jZXNzZWRGaWxlcy5nZXQoZmlsZVBhdGgpIHx8IDA7XHJcbiAgICAgICAgICAgIGlmIChsYXN0UHJvY2Vzc2VkID4gMCAmJiBub3cgLSBsYXN0UHJvY2Vzc2VkIDwgQ09OU1RBTlRTLkRFQk9VTkNFX01TKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIENsZWFuIHVwIG9sZCBlbnRyaWVzIGluIGxvY2FsIGRlYm91bmNlIG1hcFxyXG4gICAgICAgICAgICBpZiAobGFzdFByb2Nlc3NlZCA+IDAgJiYgbm93IC0gbGFzdFByb2Nlc3NlZCA+IDIwMDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubGFzdFByb2Nlc3NlZEZpbGVzLmRlbGV0ZShmaWxlUGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFBlcmlvZGljIGNsZWFudXAgb2YgZGVib3VuY2UgbWFwXHJcbiAgICAgICAgICAgIGNvbnN0IHBlcmlvZGljQ3V0b2ZmID0gbm93IC0gQ09OU1RBTlRTLkRFQk9VTkNFX01TICogMjtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBbcGF0aCwgdGltZV0gb2YgdGhpcy5sYXN0UHJvY2Vzc2VkRmlsZXMuZW50cmllcygpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGltZSA8IHBlcmlvZGljQ3V0b2ZmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0UHJvY2Vzc2VkRmlsZXMuZGVsZXRlKHBhdGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBSZWxvYWQgc2V0dGluZ3MgdG8gZW5zdXJlIHdlIGhhdmUgdGhlIGxhdGVzdFxyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5sb2FkU2V0dGluZ3MoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIENoZWNrIGJhY2tncm91bmQgcHJvY2Vzc2luZ1xyXG4gICAgICAgICAgICBjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcclxuICAgICAgICAgICAgY29uc3QgaXNBY3RpdmVGaWxlID0gYWN0aXZlRmlsZSAmJiBhY3RpdmVGaWxlLnBhdGggPT09IGZpbGUucGF0aDtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9jZXNzQmFja2dyb3VuZEZpbGVDaGFuZ2VzICYmICFpc0FjdGl2ZUZpbGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgY29udGVudFR5cGVzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG4gICAgICAgICAgICBjb25zdCBoYXNFbmFibGVkQ29udGVudFR5cGVzID0gY29udGVudFR5cGVzLnNvbWUoY3QgPT4gY3QuZW5hYmxlZCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIWhhc0VuYWJsZWRDb250ZW50VHlwZXMpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3Qgc29ydGVkQ29udGVudFR5cGVzID0gc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5KGNvbnRlbnRUeXBlcyk7XHJcbiAgICAgICAgICAgIGxldCBtYXRjaGVkQ29udGVudFR5cGVJZDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XHJcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoaW5nVHlwZXM6IENvbnRlbnRUeXBlW10gPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgY29udGVudFR5cGUgb2Ygc29ydGVkQ29udGVudFR5cGVzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWNvbnRlbnRUeXBlLmVuYWJsZWQpIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBtYXRjaGVzID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCFjb250ZW50VHlwZS5mb2xkZXIgfHwgY29udGVudFR5cGUuZm9sZGVyLnRyaW0oKSA9PT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZmlsZVBhdGguaW5jbHVkZXMoXCIvXCIpIHx8IGZpbGVQYXRoLnNwbGl0KFwiL1wiKS5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hlcyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtYXRjaGVzRm9sZGVyUGF0dGVybihmaWxlUGF0aCwgY29udGVudFR5cGUuZm9sZGVyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250ZW50VHlwZS5pZ25vcmVTdWJmb2xkZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhdGhTZWdtZW50cyA9IGZpbGVQYXRoLnNwbGl0KFwiL1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGF0aERlcHRoID0gcGF0aFNlZ21lbnRzLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGF0dGVyblNlZ21lbnRzID0gY29udGVudFR5cGUuZm9sZGVyLnNwbGl0KFwiL1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWREZXB0aCA9IHBhdHRlcm5TZWdtZW50cy5sZW5ndGg7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGVudFR5cGUuY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmb2xkZXJEZXB0aCA9IHBhdGhEZXB0aCAtIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9sZGVyRGVwdGggPT09IGV4cGVjdGVkRGVwdGggfHwgZm9sZGVyRGVwdGggPT09IGV4cGVjdGVkRGVwdGggKyAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hlcyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGF0aERlcHRoID09PSBleHBlY3RlZERlcHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hlcyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBtYXRjaGluZ1R5cGVzLnB1c2goY29udGVudFR5cGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbWF0Y2hlZENvbnRlbnRUeXBlSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hlZENvbnRlbnRUeXBlSWQgPSBjb250ZW50VHlwZS5pZDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChtYXRjaGluZ1R5cGVzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHR5cGVOYW1lcyA9IG1hdGNoaW5nVHlwZXMubWFwKGN0ID0+IGN0Lm5hbWUgfHwgXCJVbm5hbWVkXCIpLmpvaW4oXCIsIFwiKTtcclxuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYE11bHRpcGxlIGNvbnRlbnQgdHlwZXMgKCR7dHlwZU5hbWVzfSkgbWF0Y2ggdGhpcyBmaWxlLiBVc2luZyBtb3N0IHNwZWNpZmljOiAke21hdGNoaW5nVHlwZXNbMF0ubmFtZSB8fCBcIlVubmFtZWRcIn1gKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCFtYXRjaGVkQ29udGVudFR5cGVJZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzdGF0ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci5zdGF0KGZpbGUucGF0aCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGlzTmV3Tm90ZSA9IHN0YXQ/Lm10aW1lICYmIChub3cgLSBzdGF0Lm10aW1lIDwgQ09OU1RBTlRTLlNUQVRfTVRJTUVfVEhSRVNIT0xEKTtcclxuXHJcbiAgICAgICAgICAgIGlmICghaXNOZXdOb3RlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MCkpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGNvbnRlbnQ6IHN0cmluZztcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHJlYWRpbmcgZmlsZSBmb3IgY3JlYXRlIGRldGVjdGlvbjpcIiwgZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoY29udGVudC50cmltKCkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbnRlbnQuc3RhcnRzV2l0aCgnLS0tJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmcm9udG1hdHRlckVuZCA9IGNvbnRlbnQuaW5kZXhPZignXFxuLS0tJywgMyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZyb250bWF0dGVyRW5kICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmcm9udG1hdHRlclRleHQgPSBjb250ZW50LnNsaWNlKDQsIGZyb250bWF0dGVyRW5kKS50cmltKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gZnJvbnRtYXR0ZXJUZXh0LnNwbGl0KCdcXG4nKS5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKS5sZW5ndGggPiAwKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvY2Vzc0JhY2tncm91bmRGaWxlQ2hhbmdlcyAmJiBsaW5lcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5lcy5sZW5ndGggPiAxIHx8IChsaW5lcy5sZW5ndGggPT09IDEgJiYgIWxpbmVzWzBdLnN0YXJ0c1dpdGgoJ3RpdGxlOicpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudFdpdGhvdXRGcm9udG1hdHRlciA9IGNvbnRlbnQuc3RhcnRzV2l0aCgnLS0tJylcclxuICAgICAgICAgICAgICAgICAgICA/IGNvbnRlbnQuc2xpY2UoY29udGVudC5pbmRleE9mKCdcXG4tLS0nLCAzKSArIDQpLnRyaW0oKVxyXG4gICAgICAgICAgICAgICAgICAgIDogY29udGVudC50cmltKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29udGVudFdpdGhvdXRGcm9udG1hdHRlci5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmxhc3RQcm9jZXNzZWRGaWxlcy5zZXQoZmlsZS5wYXRoLCBub3cpO1xyXG5cclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3RQcm9jZXNzZWRGaWxlcy5kZWxldGUoZmlsZS5wYXRoKTtcclxuICAgICAgICAgICAgfSwgQ09OU1RBTlRTLkRFQk9VTkNFX01TICsgMTAwKTtcclxuXHJcbiAgICAgICAgICAgIG5ldyBUaXRsZU1vZGFsKHRoaXMuYXBwLCBmaWxlLCB0aGlzLnBsdWdpbiwgbWF0Y2hlZENvbnRlbnRUeXBlSWQsIGZhbHNlLCB0cnVlKS5vcGVuKCk7XHJcbiAgICAgICAgfSkoKTtcclxuICAgIH1cclxufVxyXG4iLCAiaW1wb3J0IHsgQXBwLCBURmlsZSwgbW9tZW50LCBUQWJzdHJhY3RGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBGcm9udG1hdHRlclNlcnZpY2Uge1xyXG4gICAgcHJpdmF0ZSBsYXN0UHJvY2Vzc2VkRmlsZTogc3RyaW5nID0gXCJcIjtcclxuICAgIHByaXZhdGUgbGFzdFByb2Nlc3NlZFRpbWU6IG51bWJlciA9IDA7XHJcbiAgICBwcml2YXRlIGRlYm91bmNlVGltZW91dDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XHJcbiAgICBwcml2YXRlIGRyYWZ0U3RhdHVzTWFwOiBNYXA8c3RyaW5nLCBib29sZWFuPiA9IG5ldyBNYXAoKTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGFwcDogQXBwLCBwcml2YXRlIHBsdWdpbjogQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSkge1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudHMoKTtcclxuXHJcbiAgICAgICAgLy8gQWxzbyByZS1pbml0aWFsaXplIHdoZW4gbGF5b3V0IGlzIHJlYWR5IGp1c3QgaW4gY2FzZVxyXG4gICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplRHJhZnRTdGF0dXNNYXAoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaW5pdGlhbGl6ZURyYWZ0U3RhdHVzTWFwKCkge1xyXG4gICAgICAgIHRoaXMuZHJhZnRTdGF0dXNNYXAuY2xlYXIoKTtcclxuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG4gICAgICAgIGNvbnN0IGRyYWZ0UHJvcCA9IHNldHRpbmdzLmRyYWZ0UHJvcGVydHkgfHwgXCJkcmFmdFwiO1xyXG4gICAgICAgIC8vIEluY2x1ZGUgYm90aCAubWQgYW5kIC5tZHggZmlsZXNcclxuICAgICAgICBjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKGYgPT4gZiBpbnN0YW5jZW9mIFRGaWxlICYmIChmLmV4dGVuc2lvbiA9PT0gJ21kJyB8fCBmLmV4dGVuc2lvbiA9PT0gJ21keCcpKSBhcyBURmlsZVtdO1xyXG5cclxuICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcclxuICAgICAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuICAgICAgICAgICAgY29uc3QgcmF3VmFsdWUgPSBjYWNoZT8uZnJvbnRtYXR0ZXI/LltkcmFmdFByb3BdO1xyXG4gICAgICAgICAgICB0aGlzLmRyYWZ0U3RhdHVzTWFwLnNldChmaWxlLnBhdGgsIHRoaXMuY2FsY3VsYXRlSXNEcmFmdChyYXdWYWx1ZSwgc2V0dGluZ3MpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjYWxjdWxhdGVJc0RyYWZ0KHJhd1ZhbHVlOiBhbnksIHNldHRpbmdzOiBhbnkpOiBib29sZWFuIHtcclxuICAgICAgICAvLyBJZiB1bmRlZmluZWQvbnVsbCwgYXNzdW1lIGl0J3MgTk9UIGEgZHJhZnQgdW5sZXNzIGxvZ2ljIHNheXMgb3RoZXJ3aXNlXHJcbiAgICAgICAgaWYgKHJhd1ZhbHVlID09PSB1bmRlZmluZWQgfHwgcmF3VmFsdWUgPT09IG51bGwpIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgLy8gQ29udmVydCB0byBzdHJpbmcgZm9yIGVhc2llciBtYXRjaGluZyBpZiBpdCdzIG5vdCBhIGJvb2xlYW5cclxuICAgICAgICBjb25zdCB2YWwgPSBTdHJpbmcocmF3VmFsdWUpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgIGlmIChzZXR0aW5ncy5kcmFmdExvZ2ljID09PSAnZmFsc2UtaXMtZHJhZnQnKSB7XHJcbiAgICAgICAgICAgIC8vIFwiRmFsc2UgPSBQdWJsaXNoZWRcIiwgc28gaXQncyBhIGRyYWZ0IGlmIGl0IGlzIGZhbHNlLCBcImZhbHNlXCIsIFwiMFwiLCBldGMuXHJcbiAgICAgICAgICAgIHJldHVybiB2YWwgPT09ICdmYWxzZScgfHwgdmFsID09PSAnMCcgfHwgcmF3VmFsdWUgPT09IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIFwiVHJ1ZSA9IERyYWZ0XCIsIHNvIGl0J3MgYSBkcmFmdCBpZiBpdCBpcyB0cnVlLCBcInRydWVcIiwgXCIxXCIsIGV0Yy5cclxuICAgICAgICAgICAgcmV0dXJuIHZhbCA9PT0gJ3RydWUnIHx8IHZhbCA9PT0gJzEnIHx8IHJhd1ZhbHVlID09PSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlZ2lzdGVyRXZlbnRzKCkge1xyXG4gICAgICAgIC8vIFdhdGNoIGZvciBtZXRhZGF0YSBjaGFuZ2VzIChwcm9wZXJ0eS1iYXNlZCBkcmFmdCBzeW5jKVxyXG4gICAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUub24oXCJjaGFuZ2VkXCIsIChmaWxlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbk1ldGFkYXRhQ2hhbmdlKGZpbGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIC8vIFdhdGNoIGZvciByZW5hbWVzICh1bmRlcnNjb3JlLXByZWZpeCBkcmFmdCBzeW5jKVxyXG4gICAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKFwicmVuYW1lXCIsIChmaWxlLCBvbGRQYXRoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vblJlbmFtZShmaWxlLCBvbGRQYXRoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgb25SZW5hbWUoZmlsZTogVEZpbGUsIG9sZFBhdGg6IHN0cmluZykge1xyXG4gICAgICAgIGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcbiAgICAgICAgaWYgKCFzZXR0aW5ncy5zeW5jRHJhZnREYXRlKSByZXR1cm47XHJcblxyXG4gICAgICAgIGNvbnN0IG9sZE5hbWUgPSBvbGRQYXRoLnNwbGl0KFwiL1wiKS5wb3AoKSB8fCBcIlwiO1xyXG4gICAgICAgIGNvbnN0IG5ld05hbWUgPSBmaWxlLm5hbWU7XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGlmIGl0IHdhcyBhbiB1bmRlcnNjb3JlIGRyYWZ0IGFuZCBpcyBub3cgbm90XHJcbiAgICAgICAgaWYgKG9sZE5hbWUuc3RhcnRzV2l0aChcIl9cIikgJiYgIW5ld05hbWUuc3RhcnRzV2l0aChcIl9cIikpIHtcclxuICAgICAgICAgICAgLy8gTmVlZCB0byBjaGVjayBjb250ZW50IHR5cGUgdG8gc2VlIGlmIHVuZGVyc2NvcmUgcHJlZml4IGlzIGVuYWJsZWRcclxuICAgICAgICAgICAgY29uc3QgY29udGVudFR5cGUgPSB0aGlzLnBsdWdpbi5maWxlT3BzPy5nZXRDb250ZW50VHlwZUJ5UGF0aChmaWxlLnBhdGgpO1xyXG4gICAgICAgICAgICBpZiAoY29udGVudFR5cGU/LmVuYWJsZVVuZGVyc2NvcmVQcmVmaXgpIHtcclxuICAgICAgICAgICAgICAgIHZvaWQgdGhpcy51cGRhdGVEYXRlKGZpbGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgb25NZXRhZGF0YUNoYW5nZShmaWxlOiBURmlsZSkge1xyXG4gICAgICAgIGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcbiAgICAgICAgaWYgKCFzZXR0aW5ncy5zeW5jRHJhZnREYXRlICYmICFzZXR0aW5ncy51cGRhdGVNb2RpZmllZERhdGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVHJhY2sgZHJhZnQgc3RhdHVzIGNoYW5nZXNcclxuICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xyXG4gICAgICAgIGNvbnN0IGRyYWZ0UHJvcCA9IHNldHRpbmdzLmRyYWZ0UHJvcGVydHkgfHwgXCJkcmFmdFwiO1xyXG4gICAgICAgIGNvbnN0IHJhd1ZhbHVlID0gY2FjaGU/LmZyb250bWF0dGVyPy5bZHJhZnRQcm9wXTtcclxuXHJcbiAgICAgICAgLy8gTG9naWM6IHRydWUtaXMtZHJhZnQgdnMgZmFsc2UtaXMtZHJhZnRcclxuICAgICAgICBjb25zdCBpc0N1cnJlbnRseURyYWZ0ID0gdGhpcy5jYWxjdWxhdGVJc0RyYWZ0KHJhd1ZhbHVlLCBzZXR0aW5ncyk7XHJcblxyXG4gICAgICAgIC8vIElmIGl0J3MgdGhlIGZpcnN0IHRpbWUgd2Ugc2VlIHRoaXMgZmlsZSwganVzdCByZWNvcmQgaXQgYW5kIHNraXBcclxuICAgICAgICBpZiAoIXRoaXMuZHJhZnRTdGF0dXNNYXAuaGFzKGZpbGUucGF0aCkpIHtcclxuICAgICAgICAgICAgdGhpcy5kcmFmdFN0YXR1c01hcC5zZXQoZmlsZS5wYXRoLCBpc0N1cnJlbnRseURyYWZ0KTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcHJldmlvdXNEcmFmdFN0YXR1cyA9IHRoaXMuZHJhZnRTdGF0dXNNYXAuZ2V0KGZpbGUucGF0aCk7XHJcblxyXG4gICAgICAgIGxldCBkcmFmdFN0YXR1c0NoYW5nZWRUb1B1Ymxpc2hlZCA9IGZhbHNlO1xyXG4gICAgICAgIC8vIFRyYW5zaXRpb24gZnJvbSBkcmFmdCB0byBub24tZHJhZnRcclxuICAgICAgICBpZiAocHJldmlvdXNEcmFmdFN0YXR1cyA9PT0gdHJ1ZSAmJiBpc0N1cnJlbnRseURyYWZ0ID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICBkcmFmdFN0YXR1c0NoYW5nZWRUb1B1Ymxpc2hlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBVcGRhdGUgdGhlIG1hcCBmb3IgbmV4dCB0aW1lXHJcbiAgICAgICAgdGhpcy5kcmFmdFN0YXR1c01hcC5zZXQoZmlsZS5wYXRoLCBpc0N1cnJlbnRseURyYWZ0KTtcclxuXHJcbiAgICAgICAgLy8gSWYgbm8gcHVibGljYXRpb24gY2hhbmdlIGFuZCBub3QgdXBkYXRpbmcgbW9kaWZpZWQgZGF0ZSwgc2tpcCBwcm9jZXNzaW5nXHJcbiAgICAgICAgaWYgKCFkcmFmdFN0YXR1c0NoYW5nZWRUb1B1Ymxpc2hlZCAmJiAhc2V0dGluZ3MudXBkYXRlTW9kaWZpZWREYXRlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFByZXZlbnQgaW5maW5pdGUgbG9vcHMgYW5kIHJlZHVuZGFudCBwcm9jZXNzaW5nXHJcbiAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgICAgICBpZiAodGhpcy5sYXN0UHJvY2Vzc2VkRmlsZSA9PT0gZmlsZS5wYXRoICYmIG5vdyAtIHRoaXMubGFzdFByb2Nlc3NlZFRpbWUgPCAyMDAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFVzZSBhIGRlYm91bmNlIHRvIHdhaXQgZm9yIHdyaXRpbmcgdG8gZmluaXNoXHJcbiAgICAgICAgaWYgKHRoaXMuZGVib3VuY2VUaW1lb3V0KSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5kZWJvdW5jZVRpbWVvdXQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5kZWJvdW5jZVRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHZvaWQgdGhpcy5wcm9jZXNzRmlsZShmaWxlLCBkcmFmdFN0YXR1c0NoYW5nZWRUb1B1Ymxpc2hlZCk7XHJcbiAgICAgICAgfSwgNTAwKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFzeW5jIHVwZGF0ZURhdGUoZmlsZTogVEZpbGUpIHtcclxuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG4gICAgICAgIGNvbnN0IGRhdGVGaWVsZCA9IHNldHRpbmdzLnB1Ymxpc2hEYXRlRmllbGQgfHwgXCJkYXRlXCI7XHJcblxyXG4gICAgICAgIGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnByb2Nlc3NGcm9udE1hdHRlcihmaWxlLCAoZnJvbnRtYXR0ZXIpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdG9kYXkgPSBtb21lbnQoKS5mb3JtYXQoc2V0dGluZ3MuZGF0ZUZvcm1hdCk7XHJcbiAgICAgICAgICAgIGlmIChmcm9udG1hdHRlcltkYXRlRmllbGRdICE9PSB0b2RheSkge1xyXG4gICAgICAgICAgICAgICAgZnJvbnRtYXR0ZXJbZGF0ZUZpZWxkXSA9IHRvZGF5O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sYXN0UHJvY2Vzc2VkRmlsZSA9IGZpbGUucGF0aDtcclxuICAgICAgICAgICAgICAgIHRoaXMubGFzdFByb2Nlc3NlZFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyBwcm9jZXNzRmlsZShmaWxlOiBURmlsZSwgZHJhZnRTdGF0dXNDaGFuZ2VkVG9QdWJsaXNoZWQ6IGJvb2xlYW4pIHtcclxuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG4gICAgICAgIGNvbnN0IHB1Ymxpc2hEYXRlRmllbGQgPSBzZXR0aW5ncy5wdWJsaXNoRGF0ZUZpZWxkIHx8IFwiZGF0ZVwiO1xyXG5cclxuICAgICAgICBhd2FpdCB0aGlzLmFwcC5maWxlTWFuYWdlci5wcm9jZXNzRnJvbnRNYXR0ZXIoZmlsZSwgKGZyb250bWF0dGVyKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBjaGFuZ2VkID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAvLyBIYW5kbGUgRHJhZnQgU3luYyAodHJpZ2dlcmVkIG9ubHkgb24gdGhlIHNwZWNpZmljIHRyYW5zaXRpb24pXHJcbiAgICAgICAgICAgIGlmIChzZXR0aW5ncy5zeW5jRHJhZnREYXRlICYmIGRyYWZ0U3RhdHVzQ2hhbmdlZFRvUHVibGlzaGVkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0b2RheSA9IG1vbWVudCgpLmZvcm1hdChzZXR0aW5ncy5kYXRlRm9ybWF0KTtcclxuICAgICAgICAgICAgICAgIGlmIChmcm9udG1hdHRlcltwdWJsaXNoRGF0ZUZpZWxkXSAhPT0gdG9kYXkpIHtcclxuICAgICAgICAgICAgICAgICAgICBmcm9udG1hdHRlcltwdWJsaXNoRGF0ZUZpZWxkXSA9IHRvZGF5O1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBIYW5kbGUgTW9kaWZpZWQgRGF0ZSBTeW5jXHJcbiAgICAgICAgICAgIGNvbnN0IG1vZGlmaWVkRmllbGQgPSBzZXR0aW5ncy5tb2RpZmllZERhdGVGaWVsZCB8fCBcIm1vZGlmaWVkXCI7XHJcbiAgICAgICAgICAgIGlmIChzZXR0aW5ncy51cGRhdGVNb2RpZmllZERhdGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5vdyA9IG1vbWVudCgpLmZvcm1hdChzZXR0aW5ncy5kYXRlRm9ybWF0KTtcclxuICAgICAgICAgICAgICAgIGlmIChmcm9udG1hdHRlclttb2RpZmllZEZpZWxkXSAhPT0gbm93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnJvbnRtYXR0ZXJbbW9kaWZpZWRGaWVsZF0gPSBub3c7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChjaGFuZ2VkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3RQcm9jZXNzZWRGaWxlID0gZmlsZS5wYXRoO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sYXN0UHJvY2Vzc2VkVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG4iLCAiLyoqXHJcbiAqIFdhaXRzIGZvciBhbiBlbGVtZW50IHRvIGFwcGVhciBpbiB0aGUgRE9NIHVzaW5nIE11dGF0aW9uT2JzZXJ2ZXIuXHJcbiAqIEBwYXJhbSBzZWxlY3RvciBDU1Mgc2VsZWN0b3IgdG8gd2FpdCBmb3JcclxuICogQHBhcmFtIHRpbWVvdXQgVGltZW91dCBpbiBtaWxsaXNlY29uZHMgKGRlZmF1bHQ6IDUwMDApXHJcbiAqIEByZXR1cm5zIFByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSBlbGVtZW50IG9yIHJlamVjdHMgb24gdGltZW91dFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHdhaXRGb3JFbGVtZW50KHNlbGVjdG9yOiBzdHJpbmcsIHRpbWVvdXQgPSA1MDAwKTogUHJvbWlzZTxFbGVtZW50PiB7XHJcblx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHRcdGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxuXHRcdGlmIChlbGVtZW50KSB7XHJcblx0XHRcdHJldHVybiByZXNvbHZlKGVsZW1lbnQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9ucykgPT4ge1xyXG5cdFx0XHRjb25zdCB0YXJnZXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcblx0XHRcdGlmICh0YXJnZXRFbGVtZW50KSB7XHJcblx0XHRcdFx0cmVzb2x2ZSh0YXJnZXRFbGVtZW50KTtcclxuXHRcdFx0XHRvYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KHRpbWVyKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0b2JzZXJ2ZXIub2JzZXJ2ZShkb2N1bWVudC5ib2R5LCB7XHJcblx0XHRcdGNoaWxkTGlzdDogdHJ1ZSxcclxuXHRcdFx0c3VidHJlZTogdHJ1ZSxcclxuXHRcdH0pO1xyXG5cclxuXHRcdGNvbnN0IHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRcdG9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuXHRcdFx0cmVqZWN0KG5ldyBFcnJvcihgVGltZW91dCB3YWl0aW5nIGZvciBlbGVtZW50IG1hdGNoaW5nIHNlbGVjdG9yOiAke3NlbGVjdG9yfWApKTtcclxuXHRcdH0sIHRpbWVvdXQpO1xyXG5cdH0pO1xyXG59XHJcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG9CQU9POzs7QUN1RkEsSUFBTSxtQkFBbUIsQ0FBQyxRQUFRLFdBQVcsWUFBWTtBQUV6RCxJQUFNLFlBQVk7QUFBQSxFQUN4QixhQUFhO0FBQUEsRUFDYixzQkFBc0I7QUFBQSxFQUN0Qix3QkFBd0I7QUFBQSxFQUN4Qiw0QkFBNEI7QUFDN0I7OztBQ2hHTyxJQUFNLG1CQUEwQztBQUFBLEVBQ3RELGlCQUNDO0FBQUEsRUFDRCxzQkFBc0I7QUFBQSxFQUN0QixZQUFZO0FBQUEsRUFDWix1QkFBdUI7QUFBQSxFQUN2Qix1QkFBdUI7QUFBQSxFQUN2Qix5QkFBeUI7QUFBQSxFQUN6QiwyQkFBMkI7QUFBQSxFQUMzQix5QkFBeUI7QUFBQSxFQUN6Qix5QkFBeUI7QUFBQSxFQUN6Qiw0QkFBNEI7QUFBQSxFQUM1QiwwQkFBMEI7QUFBQSxFQUMxQiw2QkFBNkI7QUFBQSxFQUM3QixnQkFBZ0I7QUFBQSxFQUNoQix3QkFBd0I7QUFBQSxFQUN4QixjQUFjLENBQUM7QUFBQSxFQUNmLG9CQUFvQjtBQUFBLEVBQ3BCLHVCQUF1QjtBQUFBLElBQ3RCLFNBQVM7QUFBQSxJQUNULFdBQVc7QUFBQSxJQUNYLFFBQVE7QUFBQSxFQUNUO0FBQUEsRUFDQSx3QkFBd0I7QUFBQSxFQUN4Qiw4QkFBOEI7QUFBQSxFQUM5QixlQUFlO0FBQUEsRUFDZixlQUFlO0FBQUEsRUFDZixZQUFZO0FBQUEsRUFDWixrQkFBa0I7QUFBQSxFQUNsQixvQkFBb0I7QUFB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QUFJLG9CQUFvQixVQUN2RSxJQUFJLFVBQVUsU0FBUyxlQUFlLElBQUksV0FBVyxVQUNyRCxJQUFJLFVBQVUsU0FBUyxlQUFlLElBQUksV0FBVztBQUV2RCxZQUFJLFNBQVUsWUFBVyxTQUFTLFFBQVEsWUFBWSxFQUFFO0FBRXhELFlBQUksMEJBQTBCLGFBQWEsbUJBQW1CO0FBQzdELGVBQUksVUFBSyxnQkFBTCxtQkFBa0IsY0FBYyxTQUFTLFlBQWEsTUFBSyxPQUFPO0FBQUEsUUFDdkU7QUFDQSxZQUFJLHlCQUF5QixhQUFhLFlBQVksYUFBYSxXQUFXO0FBQzdFLGVBQUksVUFBSyxnQkFBTCxtQkFBa0IsY0FBYyxTQUFTLFVBQVcsTUFBSyxPQUFPO0FBQUEsUUFDckU7QUFBQSxNQUNEO0FBQUEsSUFDRDtBQUFBLEVBQ0Q7QUFDRDsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJuZXdGaWxlIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImNvbnRlbnRUeXBlIiwgIl9hIiwgImhhc01hdGNoaW5nQ29udGVudFR5cGUiLCAic2V0dGluZ3MiLCAicGx1Z2luSW50ZXJmYWNlIiwgImZpbGUiLCAidHlwZSIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgIl9hIiwgInRvZ2dsZSIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiX2EiLCAidmF1bHRBY3Rpb25zIl0KfQo=
